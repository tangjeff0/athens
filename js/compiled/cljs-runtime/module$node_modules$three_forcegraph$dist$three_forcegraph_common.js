shadow$provide.module$node_modules$three_forcegraph$dist$three_forcegraph_common=function(global,require,module,exports){function _interopDefaultLegacy(e){return e&&"object"===typeof e&&"default"in e?e:{"default":e}}function _typeof(obj$jscomp$0){"@babel/helpers - typeof";_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};return _typeof(obj$jscomp$0)}
function _defineProperty(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value;return obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=
1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");
subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});superClass&&_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o$jscomp$0)}function _setPrototypeOf(o$jscomp$0,p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};return _setPrototypeOf(o$jscomp$0,
p$jscomp$0)}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e$231){return!1}}function _construct(Parent,args$jscomp$0,Class$jscomp$0){_construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);Parent=new (Function.bind.apply(Parent,a));Class&&
_setPrototypeOf(Parent,Class.prototype);return Parent};return _construct.apply(null,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};if(null==source)var target={};else{target={};var sourceKeys=Object.keys(source),i;for(i=0;i<sourceKeys.length;i++){var key=sourceKeys[i];0<=excluded.indexOf(key)||(target[key]=source[key])}}if(Object.getOwnPropertySymbols)for(i=Object.getOwnPropertySymbols(source),key=0;key<i.length;key++)sourceKeys=i[key],0<=excluded.indexOf(sourceKeys)||
Object.prototype.propertyIsEnumerable.call(source,sourceKeys)&&(target[sourceKeys]=source[sourceKeys]);return target}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;Super=Reflect.construct(Super,
arguments,NewTarget)}else Super=Super.apply(this,arguments);Super=!Super||"object"!==typeof Super&&"function"!==typeof Super?_assertThisInitialized(this):Super;return Super}}function _slicedToArray(arr,i){var JSCompiler_inline_result=Array.isArray(arr)?arr:void 0;if(!JSCompiler_inline_result)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(arr)){JSCompiler_inline_result=[];var _n=!0,_d=!1,_e=void 0;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done)&&(JSCompiler_inline_result.push(_s.value),
!i||JSCompiler_inline_result.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i["return"])_i["return"]()}finally{if(_d)throw _e;}}}else JSCompiler_inline_result=void 0;if(!(arr=JSCompiler_inline_result||_unsupportedIterableToArray(arr,i)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return arr}function _toConsumableArray(arr){var JSCompiler_inline_result=Array.isArray(arr)?
_arrayLikeToArray(arr):void 0;JSCompiler_inline_result||(JSCompiler_inline_result="undefined"!==typeof Symbol&&Symbol.iterator in Object(arr)?Array.from(arr):void 0);if(!(arr=JSCompiler_inline_result||_unsupportedIterableToArray(arr)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return arr}function _unsupportedIterableToArray(o,minLen){if(o){if("string"===typeof o)return _arrayLikeToArray(o,
minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function threeDigest(data,scene){var _ref=2<arguments.length&&void 0!==arguments[2]?arguments[2]:
{},_ref$objFilter=_ref.objFilter;_ref$objFilter=void 0===_ref$objFilter?function(){return!0}:_ref$objFilter;_ref=_objectWithoutProperties(_ref,["objFilter"]);return dataJoint__default["default"](data,scene.children.filter(_ref$objFilter),function(obj){return scene.add(obj)},function(obj){scene.remove(obj);emptyObject(obj)},_objectSpread2({objBindAttr:"__threeObj"},_ref))}function autoColorObjects(objects,colorByAccessor,colorField){colorByAccessor&&"string"===typeof colorField&&objects.filter(function(obj){return!obj[colorField]}).forEach(function(obj){obj[colorField]=
autoColorScale(colorByAccessor(obj))})}function getDagDepths(_ref,idAccessor){function traverse(nodes){for(var nodeStack=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],currentDepth=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=0,l=nodes.length;i<l;i++){var node=nodes[i];(-1===nodeStack.indexOf(node)||"continue"!==function(){var loop=[].concat(_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))),[node]).map(function(d){return idAccessor(d.data)});foundLoops.some(function(foundLoop){return foundLoop.length===
loop.length&&foundLoop.every(function(id,idx){return id===loop[idx]})})||(foundLoops.push(loop),onLoopError(loop));return"continue"}())&&currentDepth>node.depth&&(node.depth=currentDepth,traverse(node.out,[].concat(_toConsumableArray(nodeStack),[node]),currentDepth+(node.skip?0:1)))}}var links=_ref.links,_ref2=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},_ref2$nodeFilter=_ref2.nodeFilter,nodeFilter=void 0===_ref2$nodeFilter?function(){return!0}:_ref2$nodeFilter;_ref2=_ref2.onLoopError;
var onLoopError=void 0===_ref2?function(loopIds){throw"Invalid DAG structure! Found cycle in node path: ".concat(loopIds.join(" -\x3e "),".");}:_ref2,graph={};_ref.nodes.forEach(function(node){return graph[idAccessor(node)]={data:node,out:[],depth:-1,skip:!nodeFilter(node)}});links.forEach(function(_ref3){function getNodeId(node){return"object"===_typeof(node)?idAccessor(node):node}var target=_ref3.target;_ref3=getNodeId(_ref3.source);target=getNodeId(target);if(!graph.hasOwnProperty(_ref3))throw"Missing source node with id: ".concat(_ref3);
if(!graph.hasOwnProperty(target))throw"Missing target node with id: ".concat(target);graph[_ref3].out.push(graph[target])});var foundLoops=[];traverse(Object.values(graph));return Object.assign.apply(Object,[{}].concat(_toConsumableArray(Object.entries(graph).filter(function(_ref4){return!_slicedToArray(_ref4,2)[1].skip}).map(function(_ref6){_ref6=_slicedToArray(_ref6,2);return _defineProperty({},_ref6[0],_ref6[1].depth)}))))}global=require("module$node_modules$three$build$three");var d3Force3d=require("module$node_modules$d3_force_3d$dist$d3_force_3d"),
graph$jscomp$0=require("module$node_modules$ngraph_DOT_graph$index"),forcelayout=require("module$node_modules$ngraph_DOT_forcelayout$index"),Kapsule=require("module$node_modules$kapsule$dist$kapsule_common");exports=require("module$node_modules$accessor_fn$dist$accessor_fn_common");var d3Array=require("module$node_modules$d3_array$dist$d3_array"),dataJoint=require("module$node_modules$data_joint$dist$data_joint_common"),d3Scale=require("module$node_modules$d3_scale$dist$d3_scale"),d3ScaleChromatic=
require("module$node_modules$d3_scale_chromatic$dist$d3_scale_chromatic");require=require("module$node_modules$tinycolor2$tinycolor");graph$jscomp$0=_interopDefaultLegacy(graph$jscomp$0);forcelayout=_interopDefaultLegacy(forcelayout);Kapsule=_interopDefaultLegacy(Kapsule);var accessorFn__default=_interopDefaultLegacy(exports),dataJoint__default=_interopDefaultLegacy(dataJoint),tinyColor__default=_interopDefaultLegacy(require),materialDispose=function materialDispose(material){material instanceof Array?
material.forEach(materialDispose):(material.map&&material.map.dispose(),material.dispose())},deallocate=function deallocate(obj){obj.geometry&&obj.geometry.dispose();obj.material&&materialDispose(obj.material);obj.texture&&obj.texture.dispose();obj.children&&obj.children.forEach(deallocate)},emptyObject=function(obj){for(;obj.children.length;){var childObj=obj.children[0];obj.remove(childObj);deallocate(childObj)}},colorStr2Hex=function(str){return isNaN(str)?parseInt(tinyColor__default["default"](str).toHex(),
16):str},colorAlpha=function(str){return isNaN(str)?tinyColor__default["default"](str).getAlpha():1},autoColorScale=d3Scale.scaleOrdinal(d3ScaleChromatic.schemePaired),three=window.THREE?window.THREE:{Group:global.Group,Mesh:global.Mesh,MeshLambertMaterial:global.MeshLambertMaterial,Color:global.Color,BufferGeometry:global.BufferGeometry,BufferAttribute:global.BufferAttribute,Matrix4:global.Matrix4,Vector3:global.Vector3,SphereBufferGeometry:global.SphereBufferGeometry,CylinderBufferGeometry:global.CylinderBufferGeometry,
TubeBufferGeometry:global.TubeBufferGeometry,ConeBufferGeometry:global.ConeBufferGeometry,Line:global.Line,LineBasicMaterial:global.LineBasicMaterial,QuadraticBezierCurve3:global.QuadraticBezierCurve3,CubicBezierCurve3:global.CubicBezierCurve3,Box3:global.Box3},ngraph={graph:graph$jscomp$0["default"],forcelayout:forcelayout["default"]},setAttributeFn=(new three.BufferGeometry).setAttribute?"setAttribute":"addAttribute",applyMatrix4Fn=(new three.BufferGeometry).applyMatrix4?"applyMatrix4":"applyMatrix";
global=function(kapsule){var initKapsuleWithSelf=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,FromKapsule=function(_baseClass){function FromKapsule(){if(!(this instanceof FromKapsule))throw new TypeError("Cannot call a class as a function");var _this=arguments.length;for(var args=Array(_this),_key=0;_key<_this;_key++)args[_key]=arguments[_key];_this=_super.call.apply(_super,[this].concat(args));_this.__kapsuleInstance=kapsule().apply(void 0,[].concat(_toConsumableArray(initKapsuleWithSelf?
[_assertThisInitialized(_this)]:[]),args));return _this}_inherits(FromKapsule,_baseClass);var _super=_createSuper(FromKapsule);return FromKapsule}(1<arguments.length&&void 0!==arguments[1]?arguments[1]:Object);Object.keys(kapsule()).forEach(function(m){return FromKapsule.prototype[m]=function(){var _this$__kapsuleInstan,returnVal=(_this$__kapsuleInstan=this.__kapsuleInstance)[m].apply(_this$__kapsuleInstan,arguments);return returnVal===this.__kapsuleInstance?this:returnVal}});return FromKapsule}(Kapsule["default"]({props:{jsonUrl:{onChange:function(jsonUrl,
state){var _this=this;jsonUrl&&!state.fetchingJson&&(state.fetchingJson=!0,state.onLoading(),fetch(jsonUrl).then(function(r){return r.json()}).then(function(json){state.fetchingJson=!1;state.onFinishLoading(json);_this.graphData(json)}))},triggerUpdate:!1},graphData:{"default":{nodes:[],links:[]},onChange:function(graphData,state){(graphData.nodes.length||graphData.links.length)&&console.info("force-graph loading",graphData.nodes.length+" nodes",graphData.links.length+" links");state.engineRunning=
!1}},numDimensions:{"default":3,onChange:function(numDim,state){function eraseDimension(nodes,dim){nodes.forEach(function(d){delete d[dim];delete d["v".concat(dim)]})}var chargeForce=state.d3ForceLayout.force("charge");chargeForce&&chargeForce.strength(2<numDim?-60:-30);3>numDim&&eraseDimension(state.graphData.nodes,"z");2>numDim&&eraseDimension(state.graphData.nodes,"y")}},dagMode:{onChange:function(dagMode,state){!dagMode&&"d3"===state.forceEngine&&(state.graphData.nodes||[]).forEach(function(n){return n.fx=
n.fy=n.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{"default":function(node){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{"default":4},nodeId:{"default":"id"},nodeVal:{"default":"val"},nodeResolution:{"default":8},nodeColor:{"default":"color"},nodeAutoColorBy:{},nodeOpacity:{"default":.75},nodeVisibility:{"default":!0},nodeThreeObject:{},nodeThreeObjectExtend:{"default":!1},linkSource:{"default":"source"},linkTarget:{"default":"target"},linkVisibility:{"default":!0},linkColor:{"default":"color"},
linkAutoColorBy:{},linkOpacity:{"default":.2},linkWidth:{},linkResolution:{"default":6},linkCurvature:{"default":0,triggerUpdate:!1},linkCurveRotation:{"default":0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{"default":!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{"default":0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{"default":.5,triggerUpdate:!1},linkDirectionalArrowResolution:{"default":8},linkDirectionalParticles:{"default":0},
linkDirectionalParticleSpeed:{"default":.01,triggerUpdate:!1},linkDirectionalParticleWidth:{"default":.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{"default":4},forceEngine:{"default":"d3"},d3AlphaMin:{"default":0,triggerUpdate:!1},d3AlphaDecay:{"default":.0228,triggerUpdate:!1,onChange:function(alphaDecay,state){state.d3ForceLayout.alphaDecay(alphaDecay)}},d3AlphaTarget:{"default":0,triggerUpdate:!1,onChange:function(alphaTarget,state){state.d3ForceLayout.alphaTarget(alphaTarget)}},
d3VelocityDecay:{"default":.4,triggerUpdate:!1,onChange:function(velocityDecay,state){state.d3ForceLayout.velocityDecay(velocityDecay)}},ngraphPhysics:{"default":{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8E-4,dragCoefficient:.02}},warmupTicks:{"default":0,triggerUpdate:!1},cooldownTicks:{"default":Infinity,triggerUpdate:!1},cooldownTime:{"default":15E3,triggerUpdate:!1},onLoading:{"default":function(){},triggerUpdate:!1},onFinishLoading:{"default":function(){},triggerUpdate:!1},
onUpdate:{"default":function(){},triggerUpdate:!1},onFinishUpdate:{"default":function(){},triggerUpdate:!1},onEngineTick:{"default":function(){},triggerUpdate:!1},onEngineStop:{"default":function(){},triggerUpdate:!1}},methods:{refresh:function(state){state._flushObjects=!0;state._rerender();return this},d3Force:function(state,forceName,forceFn){if(void 0===forceFn)return state.d3ForceLayout.force(forceName);state.d3ForceLayout.force(forceName,forceFn);return this},d3ReheatSimulation:function(state){state.d3ForceLayout.alpha(1);
this.resetCountdown();return this},resetCountdown:function(state){state.cntTicks=0;state.startTickTime=new Date;state.engineRunning=!0;return this},tickFrame:function(state){function layoutTick(){++state.cntTicks>state.cooldownTicks||new Date-state.startTickTime>state.cooldownTime||isD3Sim&&0<state.d3AlphaMin&&state.d3ForceLayout.alpha()<state.d3AlphaMin?(state.engineRunning=!1,state.onEngineStop()):(state.layout[isD3Sim?"tick":"step"](),state.onEngineTick());state.graphData.nodes.forEach(function(node){var obj=
node.__threeObj;obj&&(node=isD3Sim?node:state.layout.getNodePosition(node[state.nodeId]),obj.position.x=node.x,obj.position.y=node.y||0,obj.position.z=node.z||0)});var linkWidthAccessor=accessorFn__default["default"](state.linkWidth),linkCurvatureAccessor=accessorFn__default["default"](state.linkCurvature),linkCurveRotationAccessor=accessorFn__default["default"](state.linkCurveRotation),linkThreeObjectExtendAccessor=accessorFn__default["default"](state.linkThreeObjectExtend);state.graphData.links.forEach(function(link){var lineObj=
link.__lineObj;if(lineObj){var pos=isD3Sim?link:state.layout.getLinkPosition(state.layout.graph.getLink(link.source,link.target).id),start=pos[isD3Sim?"source":"from"];pos=pos[isD3Sim?"target":"to"];if(start&&pos&&start.hasOwnProperty("x")&&pos.hasOwnProperty("x")){var pos$jscomp$0=isD3Sim?link:state.layout.getLinkPosition(state.layout.graph.getLink(link.source,link.target).id),start$jscomp$0=pos$jscomp$0[isD3Sim?"source":"from"],end=pos$jscomp$0[isD3Sim?"target":"to"];if(start$jscomp$0&&end&&start$jscomp$0.hasOwnProperty("x")&&
end.hasOwnProperty("x")){var curvature=linkCurvatureAccessor(link);if(curvature){pos$jscomp$0=new three.Vector3(start$jscomp$0.x,start$jscomp$0.y||0,start$jscomp$0.z||0);var vEnd=new three.Vector3(end.x,end.y||0,end.z||0),l=pos$jscomp$0.distanceTo(vEnd),curveRotation=linkCurveRotationAccessor(link);0<l?(l=end.x-start$jscomp$0.x,start$jscomp$0=end.y-start$jscomp$0.y||0,end=(new three.Vector3).subVectors(vEnd,pos$jscomp$0),curveRotation=end.clone().multiplyScalar(curvature).cross(0!==l||0!==start$jscomp$0?
new three.Vector3(0,0,1):new three.Vector3(0,1,0)).applyAxisAngle(end.normalize(),curveRotation).add((new three.Vector3).addVectors(pos$jscomp$0,vEnd).divideScalar(2)),pos$jscomp$0=new three.QuadraticBezierCurve3(pos$jscomp$0,curveRotation,vEnd)):(curvature*=70,curveRotation=-curveRotation,start$jscomp$0=curveRotation+Math.PI/2,pos$jscomp$0=new three.CubicBezierCurve3(pos$jscomp$0,(new three.Vector3(curvature*Math.cos(start$jscomp$0),curvature*Math.sin(start$jscomp$0),0)).add(pos$jscomp$0),(new three.Vector3(curvature*
Math.cos(curveRotation),curvature*Math.sin(curveRotation),0)).add(pos$jscomp$0),vEnd));link.__curve=pos$jscomp$0}else link.__curve=null}pos$jscomp$0=linkThreeObjectExtendAccessor(link);if(!state.linkPositionUpdate||!state.linkPositionUpdate(pos$jscomp$0?lineObj.children[1]:lineObj,{start:{x:start.x,y:start.y,z:start.z},end:{x:pos.x,y:pos.y,z:pos.z}},link)||pos$jscomp$0)if(pos$jscomp$0=link.__curve,lineObj=lineObj.children.length?lineObj.children[0]:lineObj,"Line"===lineObj.type){if(pos$jscomp$0)lineObj.geometry.setFromPoints(pos$jscomp$0.getPoints(30));
else{link=lineObj.geometry.getAttribute("position");if(!link||!link.array||6!==link.array.length)lineObj.geometry[setAttributeFn]("position",link=new three.BufferAttribute(new Float32Array(6),3));link.array[0]=start.x;link.array[1]=start.y||0;link.array[2]=start.z||0;link.array[3]=pos.x;link.array[4]=pos.y||0;link.array[5]=pos.z||0;link.needsUpdate=!0}lineObj.geometry.computeBoundingSphere()}else"Mesh"===lineObj.type&&(pos$jscomp$0?("TubeBufferGeometry"!==lineObj.geometry.type&&(lineObj.position.set(0,
0,0),lineObj.rotation.set(0,0,0),lineObj.scale.set(1,1,1)),start=Math.ceil(10*linkWidthAccessor(link))/10,start=new three.TubeBufferGeometry(pos$jscomp$0,30,start/2,state.linkResolution,!1),lineObj.geometry.dispose(),lineObj.geometry=start):("CylinderBufferGeometry"!==lineObj.geometry.type&&(link=Math.ceil(10*linkWidthAccessor(link))/10/2,link=new three.CylinderBufferGeometry(link,link,1,state.linkResolution,1,!1),link[applyMatrix4Fn]((new three.Matrix4).makeTranslation(0,.5,0)),link[applyMatrix4Fn]((new three.Matrix4).makeRotationX(Math.PI/
2)),lineObj.geometry.dispose(),lineObj.geometry=link),start=new three.Vector3(start.x,start.y||0,start.z||0),pos=new three.Vector3(pos.x,pos.y||0,pos.z||0),link=start.distanceTo(pos),lineObj.position.x=start.x,lineObj.position.y=start.y,lineObj.position.z=start.z,lineObj.scale.z=link,lineObj.parent.localToWorld(pos),lineObj.lookAt(pos)))}}})}var isD3Sim="ngraph"!==state.forceEngine;state.engineRunning&&layoutTick();(function(){var arrowRelPosAccessor=accessorFn__default["default"](state.linkDirectionalArrowRelPos),
arrowLengthAccessor=accessorFn__default["default"](state.linkDirectionalArrowLength),nodeValAccessor=accessorFn__default["default"](state.nodeVal);state.graphData.links.forEach(function(link){var arrowObj=link.__arrowObj;if(arrowObj){var pos=isD3Sim?link:state.layout.getLinkPosition(state.layout.graph.getLink(link.source,link.target).id),start=pos[isD3Sim?"source":"from"],end=pos[isD3Sim?"target":"to"];if(start&&end&&start.hasOwnProperty("x")&&end.hasOwnProperty("x")){var startR=Math.sqrt(Math.max(0,
nodeValAccessor(start)||1))*state.nodeRelSize,endR=Math.sqrt(Math.max(0,nodeValAccessor(end)||1))*state.nodeRelSize;pos=arrowLengthAccessor(link);var arrowRelPos=arrowRelPosAccessor(link),getPosAlongLine=link.__curve?function(t){return link.__curve.getPoint(t)}:function(t){return{x:start.x+(end.x-start.x)*t||0,y:start.y+(end.y-start.y)*t||0,z:start.z+(end.z-start.z)*t||0}},lineLen=link.__curve?link.__curve.getLength():Math.sqrt(["x","y","z"].map(function(dim){return Math.pow((end[dim]||0)-(start[dim]||
0),2)}).reduce(function(acc,v){return acc+v},0));startR=startR+pos+(lineLen-startR-endR-pos)*arrowRelPos;var arrowHead=getPosAlongLine(startR/lineLen),arrowTail=getPosAlongLine((startR-pos)/lineLen);["x","y","z"].forEach(function(dim){return arrowObj.position[dim]=arrowTail[dim]});pos=_construct(three.Vector3,_toConsumableArray(["x","y","z"].map(function(c){return arrowHead[c]})));arrowObj.parent.localToWorld(pos);arrowObj.lookAt(pos)}}})})();(function(){var particleSpeedAccessor=accessorFn__default["default"](state.linkDirectionalParticleSpeed);
state.graphData.links.forEach(function(link){var cyclePhotons=link.__photonsObj&&link.__photonsObj.children,singleHopPhotons=link.__singleHopPhotonsObj&&link.__singleHopPhotonsObj.children;if(singleHopPhotons&&singleHopPhotons.length||cyclePhotons&&cyclePhotons.length){var pos$jscomp$0=isD3Sim?link:state.layout.getLinkPosition(state.layout.graph.getLink(link.source,link.target).id),start=pos$jscomp$0[isD3Sim?"source":"from"],end=pos$jscomp$0[isD3Sim?"target":"to"];if(start&&end&&start.hasOwnProperty("x")&&
end.hasOwnProperty("x")){var particleSpeed=particleSpeedAccessor(link),getPhotonPos=link.__curve?function(t){return link.__curve.getPoint(t)}:function(t){return{x:start.x+(end.x-start.x)*t||0,y:start.y+(end.y-start.y)*t||0,z:start.z+(end.z-start.z)*t||0}};[].concat(_toConsumableArray(cyclePhotons||[]),_toConsumableArray(singleHopPhotons||[])).forEach(function(photon,idx){var singleHop="singleHopPhotons"===photon.parent.__linkThreeObjType;photon.hasOwnProperty("__progressRatio")||(photon.__progressRatio=
singleHop?0:idx/cyclePhotons.length);photon.__progressRatio+=particleSpeed;if(1<=photon.__progressRatio){if(singleHop){photon.parent.remove(photon);emptyObject(photon);return}photon.__progressRatio%=1}var pos=getPhotonPos(photon.__progressRatio);["x","y","z"].forEach(function(dim){return photon.position[dim]=pos[dim]})})}}})})();return this},emitParticle:function(state,link){if(link){if(!link.__singleHopPhotonsObj){var obj=new three.Group;obj.__linkThreeObjType="singleHopPhotons";link.__singleHopPhotonsObj=
obj;state.graphScene.add(obj)}obj=accessorFn__default["default"](state.linkDirectionalParticleWidth);obj=Math.ceil(10*obj(link))/10/2;var numSegments=state.linkDirectionalParticleResolution;obj=new three.SphereBufferGeometry(obj,numSegments,numSegments);numSegments=accessorFn__default["default"](state.linkColor);numSegments=accessorFn__default["default"](state.linkDirectionalParticleColor)(link)||numSegments(link)||"#f0f0f0";numSegments=new three.Color(colorStr2Hex(numSegments));state=new three.MeshLambertMaterial({color:numSegments,
transparent:!0,opacity:3*state.linkOpacity});link.__singleHopPhotonsObj.add(new three.Mesh(obj,state))}return this},getGraphBbox:function(state){var nodeFilter=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(!state.initialised)return null;var bboxes=function getBboxes(obj$jscomp$0){var bboxes=[];if(obj$jscomp$0.geometry){obj$jscomp$0.geometry.computeBoundingBox();var box=new three.Box3;box.copy(obj$jscomp$0.geometry.boundingBox).applyMatrix4(obj$jscomp$0.matrixWorld);
bboxes.push(box)}return bboxes.concat.apply(bboxes,_toConsumableArray((obj$jscomp$0.children||[]).filter(function(obj){return!obj.hasOwnProperty("__graphObjType")||"node"===obj.__graphObjType&&nodeFilter(obj.__data)}).map(getBboxes)))}(state.graphScene);return bboxes.length?Object.assign.apply(Object,_toConsumableArray(["x","y","z"].map(function(c){return _defineProperty({},c,[d3Array.min(bboxes,function(bb){return bb.min[c]}),d3Array.max(bboxes,function(bb){return bb.max[c]})])}))):null}},stateInit:function(){return{d3ForceLayout:d3Force3d.forceSimulation().force("link",
d3Force3d.forceLink()).force("charge",d3Force3d.forceManyBody()).force("center",d3Force3d.forceCenter()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(threeObj,state){state.graphScene=threeObj},update:function(state,changedProps){var hasAnyPropChanged=function(propList){return propList.some(function(p){return changedProps.hasOwnProperty(p)})};state.engineRunning=!1;state.onUpdate();null!==state.nodeAutoColorBy&&hasAnyPropChanged(["nodeAutoColorBy","graphData","nodeColor"])&&autoColorObjects(state.graphData.nodes,
accessorFn__default["default"](state.nodeAutoColorBy),state.nodeColor);null!==state.linkAutoColorBy&&hasAnyPropChanged(["linkAutoColorBy","graphData","linkColor"])&&autoColorObjects(state.graphData.links,accessorFn__default["default"](state.linkAutoColorBy),state.linkColor);if(state._flushObjects||hasAnyPropChanged("graphData nodeThreeObject nodeThreeObjectExtend nodeVal nodeColor nodeVisibility nodeRelSize nodeResolution nodeOpacity".split(" "))){var customObjectAccessor=accessorFn__default["default"](state.nodeThreeObject),
customObjectExtendAccessor=accessorFn__default["default"](state.nodeThreeObjectExtend),valAccessor=accessorFn__default["default"](state.nodeVal),colorAccessor=accessorFn__default["default"](state.nodeColor),visibilityAccessor=accessorFn__default["default"](state.nodeVisibility),sphereGeometries={},sphereMaterials={};threeDigest(state.graphData.nodes.filter(visibilityAccessor),state.graphScene,{purge:state._flushObjects||hasAnyPropChanged(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(obj){return"node"===
obj.__graphObjType},createObj:function(node){var customObj=customObjectAccessor(node);node=customObjectExtendAccessor(node);customObj&&state.nodeThreeObject===customObj&&(customObj=customObj.clone());if(customObj&&!node)var obj=customObj;else obj=new three.Mesh,obj.__graphDefaultObj=!0,customObj&&node&&obj.add(customObj);obj.__graphObjType="node";return obj},updateObj:function(obj,node){if(obj.__graphDefaultObj){var val=valAccessor(node)||1,radius=Math.cbrt(val)*state.nodeRelSize,numSegments=state.nodeResolution;
if("SphereBufferGeometry"!==obj.geometry.type||obj.geometry.parameters.radius!==radius||obj.geometry.parameters.widthSegments!==numSegments)sphereGeometries.hasOwnProperty(val)||(sphereGeometries[val]=new three.SphereBufferGeometry(radius,numSegments,numSegments)),obj.geometry.dispose(),obj.geometry=sphereGeometries[val];node=colorAccessor(node);val=new three.Color(colorStr2Hex(node||"#ffffaa"));radius=state.nodeOpacity*colorAlpha(node);"MeshLambertMaterial"===obj.material.type&&obj.material.color.equals(val)&&
obj.material.opacity===radius||(sphereMaterials.hasOwnProperty(node)||(sphereMaterials[node]=new three.MeshLambertMaterial({color:val,transparent:!0,opacity:radius})),obj.material.dispose(),obj.material=sphereMaterials[node])}}})}if(state._flushObjects||hasAnyPropChanged("graphData linkThreeObject linkThreeObjectExtend linkMaterial linkColor linkWidth linkVisibility linkResolution linkOpacity linkDirectionalArrowLength linkDirectionalArrowColor linkDirectionalArrowResolution linkDirectionalParticles linkDirectionalParticleWidth linkDirectionalParticleColor linkDirectionalParticleResolution".split(" "))){var _customObjectAccessor=
accessorFn__default["default"](state.linkThreeObject),_customObjectExtendAccessor=accessorFn__default["default"](state.linkThreeObjectExtend),customMaterialAccessor=accessorFn__default["default"](state.linkMaterial);visibilityAccessor=accessorFn__default["default"](state.linkVisibility);var _colorAccessor=accessorFn__default["default"](state.linkColor),widthAccessor=accessorFn__default["default"](state.linkWidth),cylinderGeometries={},lambertLineMaterials={},basicLineMaterials={};visibilityAccessor=
state.graphData.links.filter(visibilityAccessor);threeDigest(visibilityAccessor,state.graphScene,{objBindAttr:"__lineObj",purge:state._flushObjects||hasAnyPropChanged(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(obj){return"link"===obj.__graphObjType},createObj:function(link){var customObj=_customObjectAccessor(link),extendObj=_customObjectExtendAccessor(link);customObj&&state.linkThreeObject===customObj&&(customObj=customObj.clone());if(!customObj||extendObj)if(widthAccessor(link))var defaultObj=
new three.Mesh;else defaultObj=new three.BufferGeometry,defaultObj[setAttributeFn]("position",new three.BufferAttribute(new Float32Array(6),3)),defaultObj=new three.Line(defaultObj);customObj?extendObj?(extendObj=new three.Group,extendObj.__graphDefaultObj=!0,extendObj.add(defaultObj),extendObj.add(customObj)):extendObj=customObj:(extendObj=defaultObj,extendObj.__graphDefaultObj=!0);extendObj.renderOrder=10;extendObj.__graphObjType="link";return extendObj},updateObj:function(updObj,link){if(updObj.__graphDefaultObj){updObj=
updObj.children.length?updObj.children[0]:updObj;var linkWidth=Math.ceil(10*widthAccessor(link))/10,useCylinder=!!linkWidth;if(useCylinder){var r=linkWidth/2,numSegments=state.linkResolution;if("CylinderBufferGeometry"!==updObj.geometry.type||updObj.geometry.parameters.radiusTop!==r||updObj.geometry.parameters.radialSegments!==numSegments)cylinderGeometries.hasOwnProperty(linkWidth)||(r=new three.CylinderBufferGeometry(r,r,1,numSegments,1,!1),r[applyMatrix4Fn]((new three.Matrix4).makeTranslation(0,
.5,0)),r[applyMatrix4Fn]((new three.Matrix4).makeRotationX(Math.PI/2)),cylinderGeometries[linkWidth]=r),updObj.geometry.dispose(),updObj.geometry=cylinderGeometries[linkWidth]}(linkWidth=customMaterialAccessor(link))?updObj.material=linkWidth:(link=_colorAccessor(link),linkWidth=new three.Color(colorStr2Hex(link||"#f0f0f0")),r=state.linkOpacity*colorAlpha(link),numSegments=useCylinder?"MeshLambertMaterial":"LineBasicMaterial",updObj.material.type===numSegments&&updObj.material.color.equals(linkWidth)&&
updObj.material.opacity===r||(useCylinder=useCylinder?lambertLineMaterials:basicLineMaterials,useCylinder.hasOwnProperty(link)||(useCylinder[link]=new three[numSegments]({color:linkWidth,transparent:1>r,opacity:r,depthWrite:1<=r})),updObj.material.dispose(),updObj.material=useCylinder[link]))}}});if(state.linkDirectionalArrowLength||changedProps.hasOwnProperty("linkDirectionalArrowLength")){var arrowLengthAccessor=accessorFn__default["default"](state.linkDirectionalArrowLength),arrowColorAccessor=
accessorFn__default["default"](state.linkDirectionalArrowColor);threeDigest(visibilityAccessor.filter(arrowLengthAccessor),state.graphScene,{objBindAttr:"__arrowObj",objFilter:function(obj){return"arrow"===obj.__linkThreeObjType},createObj:function(){var obj=new three.Mesh(void 0,new three.MeshLambertMaterial({transparent:!0}));obj.__linkThreeObjType="arrow";return obj},updateObj:function(obj,link){var arrowLength=arrowLengthAccessor(link),numSegments=state.linkDirectionalArrowResolution;if("ConeBufferGeometry"!==
obj.geometry.type||obj.geometry.parameters.height!==arrowLength||obj.geometry.parameters.radialSegments!==numSegments)numSegments=new three.ConeBufferGeometry(.25*arrowLength,arrowLength,numSegments),numSegments.translate(0,arrowLength/2,0),numSegments.rotateX(Math.PI/2),obj.geometry.dispose(),obj.geometry=numSegments;obj.material.color=new three.Color(arrowColorAccessor(link)||_colorAccessor(link)||"#f0f0f0");obj.material.opacity=3*state.linkOpacity}})}if(state.linkDirectionalParticles||changedProps.hasOwnProperty("linkDirectionalParticles")){var particlesAccessor=
accessorFn__default["default"](state.linkDirectionalParticles),particleWidthAccessor=accessorFn__default["default"](state.linkDirectionalParticleWidth),particleColorAccessor=accessorFn__default["default"](state.linkDirectionalParticleColor),particleMaterials={},particleGeometries={};threeDigest(visibilityAccessor.filter(particlesAccessor),state.graphScene,{objBindAttr:"__photonsObj",objFilter:function(obj){return"photons"===obj.__linkThreeObjType},createObj:function(){var obj=new three.Group;obj.__linkThreeObjType=
"photons";return obj},updateObj:function(obj$jscomp$0,link){var numPhotons=Math.round(Math.abs(particlesAccessor(link))),curPhoton=!!obj$jscomp$0.children.length&&obj$jscomp$0.children[0],photonR=Math.ceil(10*particleWidthAccessor(link))/10/2,numSegments=state.linkDirectionalParticleResolution;if(curPhoton&&curPhoton.geometry.parameters.radius===photonR&&curPhoton.geometry.parameters.widthSegments===numSegments)var particleGeometry=curPhoton.geometry;else particleGeometries.hasOwnProperty(photonR)||
(particleGeometries[photonR]=new three.SphereBufferGeometry(photonR,numSegments,numSegments)),particleGeometry=particleGeometries[photonR],curPhoton&&curPhoton.geometry.dispose();link=particleColorAccessor(link)||_colorAccessor(link)||"#f0f0f0";photonR=new three.Color(colorStr2Hex(link));numSegments=3*state.linkOpacity;if(curPhoton&&curPhoton.material.color.equals(photonR)&&curPhoton.material.opacity===numSegments)var particleMaterial=curPhoton.material;else particleMaterials.hasOwnProperty(link)||
(particleMaterials[link]=new three.MeshLambertMaterial({color:photonR,transparent:!0,opacity:numSegments})),particleMaterial=particleMaterials[link],curPhoton&&curPhoton.material.dispose();threeDigest(_toConsumableArray(Array(numPhotons)).map(function(_,idx){return{idx:idx}}),obj$jscomp$0,{idAccessor:function(d){return d.idx},createObj:function(){return new three.Mesh(particleGeometry,particleMaterial)},updateObj:function(obj){obj.geometry=particleGeometry;obj.material=particleMaterial}})}})}}state._flushObjects=
!1;if(hasAnyPropChanged("graphData nodeId linkSource linkTarget numDimensions forceEngine dagMode dagNodeFilter dagLevelDistance".split(" "))){state.engineRunning=!1;state.graphData.links.forEach(function(link){link.source=link[state.linkSource];link.target=link[state.linkTarget]});if(hasAnyPropChanged="ngraph"!==state.forceEngine){(visibilityAccessor=state.d3ForceLayout).stop().alpha(1).numDimensions(state.numDimensions).nodes(state.graphData.nodes);var linkForce=state.d3ForceLayout.force("link");
linkForce&&linkForce.id(function(d){return d[state.nodeId]}).links(state.graphData.links);var nodeDepths=state.dagMode&&getDagDepths(state.graphData,function(node){return node[state.nodeId]},{nodeFilter:state.dagNodeFilter,onLoopError:state.onDagError||void 0}),maxDepth=Math.max.apply(Math,_toConsumableArray(Object.values(nodeDepths||[]))),dagLevelDistance=state.dagLevelDistance||state.graphData.nodes.length/(maxDepth||1)*2*(-1!==["radialin","radialout"].indexOf(state.dagMode)?.7:1);if(state.dagMode){linkForce=
function(fix,invert){return function(node){return fix?(nodeDepths[node[state.nodeId]]-maxDepth/2)*dagLevelDistance*(invert?-1:1):void 0}};var fxFn=linkForce(-1!==["lr","rl"].indexOf(state.dagMode),"rl"===state.dagMode),fyFn=linkForce(-1!==["td","bu"].indexOf(state.dagMode),"td"===state.dagMode),fzFn=linkForce(-1!==["zin","zout"].indexOf(state.dagMode),"zout"===state.dagMode);state.graphData.nodes.filter(state.dagNodeFilter).forEach(function(node){node.fx=fxFn(node);node.fy=fyFn(node);node.fz=fzFn(node)})}state.d3ForceLayout.force("dagRadial",
-1!==["radialin","radialout"].indexOf(state.dagMode)?d3Force3d.forceRadial(function(node){node=nodeDepths[node[state.nodeId]]||-1;return("radialin"===state.dagMode?maxDepth-node:node)*dagLevelDistance}).strength(function(node){return state.dagNodeFilter(node)?1:0}):null)}else{var _graph=ngraph.graph();state.graphData.nodes.forEach(function(node){_graph.addNode(node[state.nodeId])});state.graphData.links.forEach(function(link){_graph.addLink(link.source,link.target)});visibilityAccessor=ngraph.forcelayout(_graph,
_objectSpread2({dimensions:state.numDimensions},state.ngraphPhysics));visibilityAccessor.graph=_graph}for(linkForce=0;linkForce<state.warmupTicks&&!(hasAnyPropChanged&&0<state.d3AlphaMin&&state.d3ForceLayout.alpha()<state.d3AlphaMin);linkForce++)visibilityAccessor[hasAnyPropChanged?"tick":"step"]();state.layout=visibilityAccessor;this.resetCountdown()}state.engineRunning=!0;state.onFinishUpdate()}}),(window.THREE?window.THREE:{Group:global.Group}).Group,!0);module.exports=global}
//# sourceMappingURL=module$node_modules$three_forcegraph$dist$three_forcegraph_common.js.map
