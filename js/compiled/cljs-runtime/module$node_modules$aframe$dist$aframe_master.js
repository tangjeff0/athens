shadow$provide.module$node_modules$aframe$dist$aframe_master=function(global$jscomp$1,require,module$jscomp$3,exports$jscomp$3){(function(f){"object"===typeof exports$jscomp$3&&"undefined"!==typeof module$jscomp$3?module$jscomp$3.exports=f():"function"===typeof define&&define.amd?define([],f):("undefined"!==typeof window?window:"undefined"!==typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?self:this).AFRAME=f()})(function(){return function(){function r$jscomp$0(e,n,t){function o(i,
f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);f=Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f;}f=n[i]={exports:{}};e[i][0].call(f.exports,function(r){return o(e[i][1][r]||r)},f,f.exports,r$jscomp$0,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i$jscomp$0=0;i$jscomp$0<t.length;i$jscomp$0++)o(t[i$jscomp$0]);return o}return r$jscomp$0}()({1:[function(_dereq_,module,exports){var str=Object.prototype.toString;
module.exports=function(arr){return arr.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===str.call(arr.buffer)||Array.isArray(arr)}},{}],2:[function(_dereq_,module,exports){module.exports=function(num,def){return"number"===typeof num?num:"number"===typeof def?def:0}},{}],3:[function(_dereq_,module,exports){function getLens(b64){var len=b64.length;if(0<len%4)throw Error("Invalid string. Length must be a multiple of 4");b64=b64.indexOf("\x3d");-1===b64&&(b64=len);return[b64,b64===len?0:4-b64%4]}function encodeChunk(uint8,
start,end){for(var output=[],i=start;i<end;i+=3)start=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255),output.push(lookup[start>>18&63]+lookup[start>>12&63]+lookup[start>>6&63]+lookup[start&63]);return output.join("")}exports.byteLength=function(b64){b64=getLens(b64);var placeHoldersLen=b64[1];return 3*(b64[0]+placeHoldersLen)/4-placeHoldersLen};exports.toByteArray=function(b64){var lens=getLens(b64);var tmp=lens[0];lens=lens[1];for(var arr=new Arr(3*(tmp+lens)/4-lens),curByte=0,len=
0<lens?tmp-4:tmp,i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=tmp&255;2===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=tmp&255);1===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=
tmp&255);return arr};exports.fromByteArray=function(uint8){for(var len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));1===extraBytes?(uint8=uint8[len-1],parts.push(lookup[uint8>>2]+lookup[uint8<<4&63]+"\x3d\x3d")):2===extraBytes&&(uint8=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[uint8>>10]+lookup[uint8>>4&63]+lookup[uint8<<2&63]+"\x3d"));return parts.join("")};var lookup=[],revLookup=[],Arr="undefined"!==
typeof Uint8Array?Uint8Array:Array;for(_dereq_=0;64>_dereq_;++_dereq_)lookup[_dereq_]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[_dereq_],revLookup["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(_dereq_)]=_dereq_;revLookup[45]=62;revLookup[95]=63},{}],4:[function(_dereq_,module,exports){module.exports={createLink:function(href,attributes){var head=document.head||document.getElementsByTagName("head")[0],link=document.createElement("link");link.href=
href;link.rel="stylesheet";for(var key in attributes)attributes.hasOwnProperty(key)&&link.setAttribute("data-"+key,attributes[key]);head.appendChild(link)},createStyle:function(cssText,attributes){var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css";for(var key in attributes)attributes.hasOwnProperty(key)&&style.setAttribute("data-"+key,attributes[key]);style.sheet?(style.innerHTML=cssText,style.sheet.cssText=cssText,head.appendChild(style)):
style.styleSheet?(head.appendChild(style),style.styleSheet.cssText=cssText):(style.appendChild(document.createTextNode(cssText)),head.appendChild(style))}}},{}],5:[function(_dereq_,module,exports){var Buffer=_dereq_("buffer").Buffer;module.exports=function(a,b){if(Buffer.isBuffer(a)&&Buffer.isBuffer(b)){if("function"===typeof a.equals)return a.equals(b);if(a.length!==b.length)return!1;for(var i=0;i<a.length;i++)if(a[i]!==b[i])return!1;return!0}}},{buffer:6}],6:[function(_dereq_,module,exports){(function(global,
Buffer){function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===arr.foo()&&"function"===typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e$137){return!1}}function createBuffer(that,length){if((Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<length)throw new RangeError("Invalid typed array length");Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length),that.__proto__=Buffer.prototype):(null===that&&
(that=new Buffer(length)),that.length=length);return that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"===typeof arg){if("string"===typeof encodingOrOffset)throw Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"===typeof value)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&value instanceof ArrayBuffer){value.byteLength;if(0>encodingOrOffset||value.byteLength<encodingOrOffset)throw new RangeError("'offset' is out of bounds");if(value.byteLength<encodingOrOffset+(length||0))throw new RangeError("'length' is out of bounds");value=void 0===encodingOrOffset&&void 0===length?new Uint8Array(value):void 0===length?new Uint8Array(value,encodingOrOffset):new Uint8Array(value,encodingOrOffset,length);Buffer.TYPED_ARRAY_SUPPORT?(that=value,
that.__proto__=Buffer.prototype):that=fromArrayLike(that,value);return that}if("string"===typeof value){length=that;that=encodingOrOffset;if("string"!==typeof that||""===that)that="utf8";if(!Buffer.isEncoding(that))throw new TypeError('"encoding" must be a valid string encoding');encodingOrOffset=byteLength$jscomp$0(value,that)|0;length=createBuffer(length,encodingOrOffset);value=length.write(value,that);value!==encodingOrOffset&&(length=length.slice(0,value));return length}return fromObject(that,
value)}function assertSize(size){if("number"!==typeof size)throw new TypeError('"size" argument must be a number');if(0>size)throw new RangeError('"size" argument must not be negative');}function allocUnsafe(that,size){assertSize(size);that=createBuffer(that,0>size?0:checked(size)|0);if(!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromArrayLike(that,array){var length=0>array.length?0:checked(array.length)|0;that=createBuffer(that,length);for(var i=0;i<length;i+=
1)that[i]=array[i]&255;return that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;that=createBuffer(that,len);if(0===that.length)return that;obj.copy(that,0,0,len);return that}if(obj){if("undefined"!==typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return(len="number"!==typeof obj.length)||(len=obj.length,len=len!==len),len?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function checked(length){if(length>=(Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return length|0}function byteLength$jscomp$0(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;
"string"!==typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case "ascii":case "latin1":case "binary":return len;case "utf8":case "utf-8":case void 0:return utf8ToBytes(string).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*len;case "hex":return len>>>1;case "base64":return base64.toByteArray(base64clean(string)).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();
loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if(void 0===start||0>start)start=0;if(start>this.length)return"";if(void 0===end||end>this.length)end=this.length;if(0>=end)return"";end>>>=0;start>>>=0;if(end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case "hex":encoding=start;start=end;end=this.length;if(!encoding||0>encoding)encoding=0;if(!start||0>start||start>end)start=end;loweredCase="";for(end=encoding;end<start;++end)encoding=loweredCase,
loweredCase=this[end],loweredCase=16>loweredCase?"0"+loweredCase.toString(16):loweredCase.toString(16),loweredCase=encoding+loweredCase;return loweredCase;case "utf8":case "utf-8":return utf8Slice(this,start,end);case "ascii":encoding="";for(end=Math.min(this.length,end);start<end;++start)encoding+=String.fromCharCode(this[start]&127);return encoding;case "latin1":case "binary":encoding="";for(end=Math.min(this.length,end);start<end;++start)encoding+=String.fromCharCode(this[start]);return encoding;
case "base64":return start=0===start&&end===this.length?base64.fromByteArray(this):base64.fromByteArray(this.slice(start,end)),start;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":start=this.slice(start,end);end="";for(encoding=0;encoding<start.length;encoding+=2)end+=String.fromCharCode(start[encoding]+256*start[encoding+1]);return end;default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=!0}}function swap(b,n,m){var i=
b[n];b[n]=b[m];b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;"string"===typeof byteOffset?(encoding=byteOffset,byteOffset=0):2147483647<byteOffset?byteOffset=2147483647:-2147483648>byteOffset&&(byteOffset=-2147483648);byteOffset=+byteOffset;isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1);0>byteOffset&&(byteOffset=buffer.length+byteOffset);if(byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(0>byteOffset)if(dir)byteOffset=
0;else return-1;"string"===typeof val&&(val=Buffer.from(val,encoding));if(Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"===typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer");
}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&(encoding=String(encoding).toLowerCase(),"ucs2"===encoding||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(2>arr.length||2>val.length)return-1;indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}if(dir)for(encoding=-1;byteOffset<arrLength;byteOffset++)if(read(arr,
byteOffset)===read(val,-1===encoding?0:byteOffset-encoding)){if(-1===encoding&&(encoding=byteOffset),byteOffset-encoding+1===valLength)return encoding*indexSize}else-1!==encoding&&(byteOffset-=byteOffset-encoding),encoding=-1;else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength);0<=byteOffset;byteOffset--){arrLength=!0;for(encoding=0;encoding<valLength;encoding++)if(read(arr,byteOffset+encoding)!==read(val,encoding)){arrLength=!1;break}if(arrLength)return byteOffset}return-1}function utf8Slice(buf,
start,end){end=Math.min(buf.length,end);for(var res=[];start<end;){var firstByte=buf[start],codePoint=null,bytesPerSequence=239<firstByte?4:223<firstByte?3:191<firstByte?2:1;if(start+bytesPerSequence<=end)switch(bytesPerSequence){case 1:128>firstByte&&(codePoint=firstByte);break;case 2:var secondByte=buf[start+1];128===(secondByte&192)&&(firstByte=(firstByte&31)<<6|secondByte&63,127<firstByte&&(codePoint=firstByte));break;case 3:secondByte=buf[start+1];var thirdByte=buf[start+2];128===(secondByte&
192)&&128===(thirdByte&192)&&(firstByte=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63,2047<firstByte&&(55296>firstByte||57343<firstByte)&&(codePoint=firstByte));break;case 4:secondByte=buf[start+1];thirdByte=buf[start+2];var fourthByte=buf[start+3];128===(secondByte&192)&&128===(thirdByte&192)&&128===(fourthByte&192)&&(firstByte=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63,65535<firstByte&&1114112>firstByte&&(codePoint=firstByte))}null===codePoint?(codePoint=65533,bytesPerSequence=
1):65535<codePoint&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|codePoint&1023);res.push(codePoint);start+=bytesPerSequence}buf=res.length;if(buf<=MAX_ARGUMENTS_LENGTH)res=String.fromCharCode.apply(String,res);else{end="";for(start=0;start<buf;)end+=String.fromCharCode.apply(String,res.slice(start,start+=MAX_ARGUMENTS_LENGTH));res=end}return res}function checkOffset(offset,ext,length){if(0!==offset%1||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length");
}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range");}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?
i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(0>offset)throw new RangeError("Index out of range");}function writeFloat(buf,value,offset,littleEndian,noAssert){noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886E38,
-3.4028234663852886E38);ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157E308,-1.7976931348623157E308);ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}function base64clean(str){str=str.trim?str.trim():str.replace(/^\s+|\s+$/g,"");str=str.replace(INVALID_BASE64_RE,"");if(2>str.length)return"";for(;0!==str.length%4;)str+="\x3d";return str}function utf8ToBytes(string,
units){units=units||Infinity;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){codePoint=string.charCodeAt(i);if(55295<codePoint&&57344>codePoint){if(!leadSurrogate){if(56319<codePoint){-1<(units-=3)&&bytes.push(239,191,189);continue}else if(i+1===length){-1<(units-=3)&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){-1<(units-=3)&&bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-
56320)+65536}else leadSurrogate&&-1<(units-=3)&&bytes.push(239,191,189);leadSurrogate=null;if(128>codePoint){if(0>--units)break;bytes.push(codePoint)}else if(2048>codePoint){if(0>(units-=2))break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(65536>codePoint){if(0>(units-=3))break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(1114112>codePoint){if(0>(units-=4))break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else throw Error("Invalid code point");
}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(str.charCodeAt(i)&255);return byteArray}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}var base64=_dereq_("base64-js"),ieee754=_dereq_("ieee754"),isArray=_dereq_("isarray");exports.Buffer=Buffer;exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)};exports.INSPECT_MAX_BYTES=
50;Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport();exports.kMaxLength=Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823;Buffer.poolSize=8192;Buffer._augment=function(arr){arr.__proto__=Buffer.prototype;return arr};Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)};Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!==typeof Symbol&&
Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0}));Buffer.alloc=function(size,fill,encoding){assertSize(size);size=0>=size?createBuffer(null,size):void 0!==fill?"string"===typeof encoding?createBuffer(null,size).fill(fill,encoding):createBuffer(null,size).fill(fill):createBuffer(null,size);return size};Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,
size)};Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)};Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i];y=b[i];break}return x<y?-1:y<x?1:0};Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(i=length=0;i<list.length;++i)length+=list[i].length;length=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(length,pos);pos+=buf.length}return length};Buffer.byteLength=
byteLength$jscomp$0;Buffer.prototype._isBuffer=!0;Buffer.prototype.swap16=function(){var len=this.length;if(0!==len%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this};Buffer.prototype.swap32=function(){var len=this.length;if(0!==len%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this};Buffer.prototype.swap64=function(){var len=this.length;if(0!==
len%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this};Buffer.prototype.toString=function(){var length=this.length|0;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)};Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===Buffer.compare(this,b)};
Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;0<this.length&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... "));return"\x3cBuffer "+str+"\x3e"};Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");void 0===start&&(start=0);void 0===end&&(end=target?target.length:0);void 0===thisStart&&(thisStart=0);void 0===thisEnd&&(thisEnd=this.length);
if(0>start||end>target.length||0>thisStart||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y);thisStart=this.slice(thisStart,thisEnd);target=target.slice(start,end);for(start=0;start<len;++start)if(thisStart[start]!==target[start]){x=thisStart[start];y=target[start];
break}return x<y?-1:y<x?1:0};Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)};Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)};Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)};Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,
offset=0;else if(void 0===length&&"string"===typeof offset)encoding=offset,length=this.length,offset=0;else if(isFinite(offset))offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var remaining=this.length-offset;if(void 0===length||length>remaining)length=remaining;if(0<string.length&&(0>length||0>offset)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");
encoding||(encoding="utf8");for(remaining=!1;;)switch(encoding){case "hex":a:{offset=Number(offset)||0;encoding=this.length-offset;length?(length=Number(length),length>encoding&&(length=encoding)):length=encoding;encoding=string.length;if(0!==encoding%2)throw new TypeError("Invalid hex string");length>encoding/2&&(length=encoding/2);for(encoding=0;encoding<length;++encoding){remaining=parseInt(string.substr(2*encoding,2),16);if(isNaN(remaining)){string=encoding;break a}this[offset+encoding]=remaining}string=
encoding}return string;case "utf8":case "utf-8":return blitBuffer(utf8ToBytes(string,this.length-offset),this,offset,length);case "ascii":return blitBuffer(asciiToBytes(string),this,offset,length);case "latin1":case "binary":return blitBuffer(asciiToBytes(string),this,offset,length);case "base64":return blitBuffer(base64.toByteArray(base64clean(string)),this,offset,length);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":encoding=string;remaining=this.length-offset;for(var byteArray=[],i=0;i<
encoding.length&&!(0>(remaining-=2));++i){var lo=encoding.charCodeAt(i);string=lo>>8;lo%=256;byteArray.push(lo);byteArray.push(string)}return blitBuffer(byteArray,this,offset,length);default:if(remaining)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();remaining=!0}};Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;
start=~~start;end=void 0===end?len:~~end;0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len);0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len);end<start&&(end=start);if(Buffer.TYPED_ARRAY_SUPPORT)end=this.subarray(start,end),end.__proto__=Buffer.prototype;else{len=end-start;end=new Buffer(len,void 0);for(var i=0;i<len;++i)end[i]=this[i+start]}return end};Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0;byteLength|=0;noAssert||checkOffset(offset,byteLength,this.length);
noAssert=this[offset];for(var mul=1,i=0;++i<byteLength&&(mul*=256);)noAssert+=this[offset+i]*mul;return noAssert};Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0;byteLength|=0;noAssert||checkOffset(offset,byteLength,this.length);noAssert=this[offset+--byteLength];for(var mul=1;0<byteLength&&(mul*=256);)noAssert+=this[offset+--byteLength]*mul;return noAssert};Buffer.prototype.readUInt8=function(offset,noAssert){noAssert||checkOffset(offset,1,this.length);return this[offset]};
Buffer.prototype.readUInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function(offset,noAssert){noAssert||checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]};Buffer.prototype.readUInt32BE=function(offset,
noAssert){noAssert||checkOffset(offset,4,this.length);return 16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0;byteLength|=0;noAssert||checkOffset(offset,byteLength,this.length);noAssert=this[offset];for(var mul=1,i=0;++i<byteLength&&(mul*=256);)noAssert+=this[offset+i]*mul;noAssert>=128*mul&&(noAssert-=Math.pow(2,8*byteLength));return noAssert};Buffer.prototype.readIntBE=function(offset,byteLength,
noAssert){offset|=0;byteLength|=0;noAssert||checkOffset(offset,byteLength,this.length);noAssert=byteLength;for(var mul=1,val=this[offset+--noAssert];0<noAssert&&(mul*=256);)val+=this[offset+--noAssert]*mul;val>=128*mul&&(val-=Math.pow(2,8*byteLength));return val};Buffer.prototype.readInt8=function(offset,noAssert){noAssert||checkOffset(offset,1,this.length);return this[offset]&128?-1*(255-this[offset]+1):this[offset]};Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,
2,this.length);offset=this[offset]|this[offset+1]<<8;return offset&32768?offset|4294901760:offset};Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);offset=this[offset+1]|this[offset]<<8;return offset&32768?offset|4294901760:offset};Buffer.prototype.readInt32LE=function(offset,noAssert){noAssert||checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function(offset,
noAssert){noAssert||checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function(offset,noAssert){noAssert||checkOffset(offset,4,this.length);return ieee754.read(this,offset,!0,23,4)};Buffer.prototype.readFloatBE=function(offset,noAssert){noAssert||checkOffset(offset,4,this.length);return ieee754.read(this,offset,!1,23,4)};Buffer.prototype.readDoubleLE=function(offset,noAssert){noAssert||checkOffset(offset,8,this.length);
return ieee754.read(this,offset,!0,52,8)};Buffer.prototype.readDoubleBE=function(offset,noAssert){noAssert||checkOffset(offset,8,this.length);return ieee754.read(this,offset,!1,52,8)};Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value;offset|=0;byteLength|=0;noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);noAssert=1;var i=0;for(this[offset]=value&255;++i<byteLength&&(noAssert*=256);)this[offset+i]=value/noAssert&255;return offset+byteLength};
Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value;offset|=0;byteLength|=0;noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);noAssert=byteLength-1;var mul=1;for(this[offset+noAssert]=value&255;0<=--noAssert&&(mul*=256);)this[offset+noAssert]=value/mul&255;return offset+byteLength};Buffer.prototype.writeUInt8=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,1,255,0);Buffer.TYPED_ARRAY_SUPPORT||
(value=Math.floor(value));this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,2,65535,0);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value&255,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0);return offset+2};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,2,65535,0);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=
value>>>8,this[offset+1]=value&255):objectWriteUInt16(this,value,offset,!1);return offset+2};Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,4,4294967295,0);Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=value&255):objectWriteUInt32(this,value,offset,!0);return offset+4};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){value=+value;offset|=
0;noAssert||checkInt(this,value,offset,4,4294967295,0);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value&255):objectWriteUInt32(this,value,offset,!1);return offset+4};Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){value=+value;offset|=0;noAssert||(noAssert=Math.pow(2,8*byteLength-1),checkInt(this,value,offset,byteLength,noAssert-1,-noAssert));noAssert=0;var mul=1,sub=0;for(this[offset]=value&255;++noAssert<
byteLength&&(mul*=256);)0>value&&0===sub&&0!==this[offset+noAssert-1]&&(sub=1),this[offset+noAssert]=(value/mul>>0)-sub&255;return offset+byteLength};Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){value=+value;offset|=0;noAssert||(noAssert=Math.pow(2,8*byteLength-1),checkInt(this,value,offset,byteLength,noAssert-1,-noAssert));noAssert=byteLength-1;var mul=1,sub=0;for(this[offset+noAssert]=value&255;0<=--noAssert&&(mul*=256);)0>value&&0===sub&&0!==this[offset+noAssert+1]&&(sub=
1),this[offset+noAssert]=(value/mul>>0)-sub&255;return offset+byteLength};Buffer.prototype.writeInt8=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,1,127,-128);Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value));0>value&&(value=255+value+1);this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,2,32767,-32768);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=
value&255,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0);return offset+2};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,2,32767,-32768);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value&255):objectWriteUInt16(this,value,offset,!1);return offset+2};Buffer.prototype.writeInt32LE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,4,2147483647,-2147483648);
Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value&255,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0);return offset+4};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){value=+value;offset|=0;noAssert||checkInt(this,value,offset,4,2147483647,-2147483648);0>value&&(value=4294967295+value+1);Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value&255):objectWriteUInt32(this,
value,offset,!1);return offset+4};Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)};Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)};Buffer.prototype.copy=
function(target,targetStart,start,end){start||(start=0);end||0===end||(end=this.length);targetStart>=target.length&&(targetStart=target.length);targetStart||(targetStart=0);0<end&&end<start&&(end=start);if(end===start||0===target.length||0===this.length)return 0;if(0>targetStart)throw new RangeError("targetStart out of bounds");if(0>start||start>=this.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length);
target.length-targetStart<end-start&&(end=target.length-targetStart+start);var len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(end=len-1;0<=end;--end)target[end+targetStart]=this[end+start];else if(1E3>len||!Buffer.TYPED_ARRAY_SUPPORT)for(end=0;end<len;++end)target[end+targetStart]=this[end+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len};Buffer.prototype.fill=function(val,start,end,encoding){if("string"===typeof val){"string"===
typeof start?(encoding=start,start=0,end=this.length):"string"===typeof end&&(encoding=end,end=this.length);if(1===val.length){var code=val.charCodeAt(0);256>code&&(val=code)}if(void 0!==encoding&&"string"!==typeof encoding)throw new TypeError("encoding must be a string");if("string"===typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);}else"number"===typeof val&&(val&=255);if(0>start||this.length<start||this.length<end)throw new RangeError("Out of range index");
if(end<=start)return this;start>>>=0;end=void 0===end?this.length:end>>>0;val||(val=0);if("number"===typeof val)for(encoding=start;encoding<end;++encoding)this[encoding]=val;else for(val=Buffer.isBuffer(val)?val:utf8ToBytes((new Buffer(val,encoding)).toString()),code=val.length,encoding=0;encoding<end-start;++encoding)this[encoding+start]=val[encoding%code];return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!==typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{},_dereq_("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(_dereq_,module,exports){(function(){if("undefined"!==typeof window)try{var ce=new window.CustomEvent("test",{cancelable:!0});ce.preventDefault();if(!0!==ce.defaultPrevented)throw Error("Could not prevent default");}catch(e$139){ce=function(event,params){params=params||{};params.bubbles=!!params.bubbles;params.cancelable=!!params.cancelable;var evt=document.createEvent("CustomEvent");
evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);var origPrevent=evt.preventDefault;evt.preventDefault=function(){origPrevent.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e$138){this.defaultPrevented=!0}};return evt},ce.prototype=window.Event.prototype,window.CustomEvent=ce}})()},{}],8:[function(_dereq_,module,exports){function load(){try{var r=exports.storage.debug}catch(e$141){}return r}exports=module.exports=_dereq_("./debug");
exports.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};exports.formatArgs=function(){var args=arguments,useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ");if(!useColors)return args;useColors="color: "+this.color;args=[args[0],useColors,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;args[0].replace(/%[a-z%]/g,function(match){"%%"!==
match&&(index++,"%c"===match&&(lastC=index))});args.splice(lastC,0,useColors);return args};exports.save=function(namespaces){try{null==namespaces?exports.storage.removeItem("debug"):exports.storage.debug=namespaces}catch(e$140){}};exports.load=load;exports.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};if("undefined"!=
typeof chrome&&"undefined"!=typeof chrome.storage)var JSCompiler_temp=chrome.storage.local;else a:{try{JSCompiler_temp=window.localStorage;break a}catch(e$142){}JSCompiler_temp=void 0}exports.storage=JSCompiler_temp;exports.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");exports.formatters.j=function(v){return JSON.stringify(v)};exports.enable(load())},{"./debug":9}],9:[function(_dereq_,module,exports){exports=module.exports=function(namespace){function disabled(){}
function enabled(){null==enabled.useColors&&(enabled.useColors=exports.useColors());null==enabled.color&&enabled.useColors&&(enabled.color=exports.colors[prevColor++%exports.colors.length]);var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]);"string"!==typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%%"===match)return match;index++;format=exports.formatters[format];"function"===typeof format&&(match=
format.call(enabled,args[index]),args.splice(index,1),index--);return match});"function"===typeof exports.formatArgs&&(args=exports.formatArgs.apply(enabled,args));(enabled.log||exports.log||console.log.bind(console)).apply(enabled,args)}disabled.enabled=!1;enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn};exports.coerce=function(val){return val instanceof Error?val.stack||val.message:val};exports.disable=function(){exports.enable("")};exports.enable=
function(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")))};exports.enabled=function(name){var len;var i=0;for(len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;i=0;for(len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;
return!1};exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0},{}],10:[function(_dereq_,module,exports){function assignKey(to,from,key){var val=from[key];if(void 0!==val&&null!==val){if(hasOwnProperty.call(to,key)&&(void 0===to[key]||null===to[key]))throw new TypeError("Cannot convert undefined or null to object ("+key+")");hasOwnProperty.call(to,key)&&isObj(val)?to[key]=assign(Object(to[key]),from[key]):to[key]=val}}function assign(to,from){if(to===from)return to;from=Object(from);
for(var key in from)hasOwnProperty.call(from,key)&&assignKey(to,from,key);if(Object.getOwnPropertySymbols){key=Object.getOwnPropertySymbols(from);for(var i=0;i<key.length;i++)propIsEnumerable.call(from,key[i])&&assignKey(to,from,key[i])}return to}var isObj=_dereq_("is-obj"),hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(target){var val=target;if(null===val||void 0===val)throw new TypeError("Sources cannot be null or undefined");
target=Object(val);for(val=1;val<arguments.length;val++)assign(target,arguments[val]);return target}},{"is-obj":34}],11:[function(_dereq_,module,exports){var keys=_dereq_("object-keys"),hasSymbols="function"===typeof Symbol&&"symbol"===typeof Symbol("foo"),toStr=Object.prototype.toString,concat=Array.prototype.concat,origDefineProperty=Object.defineProperty;_dereq_=function(){var obj={};try{origDefineProperty(obj,"x",{enumerable:!1,value:obj});for(var _ in obj)return!1;return obj.x===obj}catch(e$143){return!1}};
var supportsDescriptors=origDefineProperty&&_dereq_();_dereq_=function(object$jscomp$0,map){var predicates=2<arguments.length?arguments[2]:{},props=keys(map);hasSymbols&&(props=concat.call(props,Object.getOwnPropertySymbols(map)));for(var i=0;i<props.length;i+=1){var object=object$jscomp$0,name=props[i],value=map[props[i]],predicate=predicates[props[i]];if(!(name in object)||"function"===typeof predicate&&"[object Function]"===toStr.call(predicate)&&predicate())supportsDescriptors?origDefineProperty(object,
name,{configurable:!0,enumerable:!1,value:value,writable:!0}):object[name]=value}};_dereq_.supportsDescriptors=!!supportsDescriptors;module.exports=_dereq_},{"object-keys":41}],12:[function(_dereq_,module,exports){(function(t$jscomp$2,n$jscomp$1,r$jscomp$1,i$jscomp$1){function st(e,t){for(var n=0,r=e.length;n<r;n++)gt(e[n],t)}function ut(e){return function(t){F(t)&&(gt(t,e),st(t.querySelectorAll(E),e))}}function at(e){var t=R.call(e,"is");e=e.nodeName.toUpperCase();var r=x.call(b,t?m+t.toUpperCase():
v+e);return t&&-1<r&&!(-1<E.indexOf(e+'[is\x3d"'+t+'"]'))?-1:r}function lt(e){var t=e.currentTarget,n=e.attrChange,r=e.attrName,i=e.target;Y&&(!i||i===t)&&t.attributeChangedCallback&&"style"!==r&&e.prevValue!==e.newValue&&t.attributeChangedCallback(r,n===e[f$jscomp$0]?null:e.prevValue,n===e[c$jscomp$0]?null:e.newValue)}function ct(e$jscomp$0){var t=ut(e$jscomp$0);return function(e){$.push(t,e.target)}}function ht(e){G&&(G=!1,e.currentTarget.removeEventListener(p,ht));st((e.target||n$jscomp$1).querySelectorAll(E),
e.detail===u$jscomp$0?u$jscomp$0:o$jscomp$0);if(j)for(var t=0,n=I.length;t<n;t++)e=I[t],S.contains(e)||(n--,I.splice(t--,1),gt(e,u$jscomp$0))}function pt(e,t){U.call(this,e,t);Z.call(this,{target:this})}function dt(e,t){P(e,t);nt?nt.observe(e,X):(Q&&(e.setAttribute=pt,e[s$jscomp$1]=tt(e),e.addEventListener(d$jscomp$0,Z)),e.addEventListener(h$jscomp$0,lt));e.createdCallback&&Y&&(e.created=!0,e.createdCallback(),e.created=!1)}function mt(e){throw Error("A "+e+" type is already registered");}function gt(e,
t){var n,r=at(e);-1<r&&(rt(e,w[r]),r=0,t!==o$jscomp$0||e[o$jscomp$0]?t===u$jscomp$0&&!e[u$jscomp$0]&&(e[o$jscomp$0]=!1,e[u$jscomp$0]=!0,r=1):(e[u$jscomp$0]=!1,e[o$jscomp$0]=!0,r=1,j&&0>x.call(I,e)&&I.push(e)),r&&(n=e[t+"Callback"])&&n.call(e))}if(!(i$jscomp$1 in n$jscomp$1)){var s$jscomp$1="__"+i$jscomp$1+(1E5*Math.random()>>0),o$jscomp$0="attached",u$jscomp$0="detached",f$jscomp$0="ADDITION",c$jscomp$0="REMOVAL",h$jscomp$0="DOMAttrModified",p="DOMContentLoaded",d$jscomp$0="DOMSubtreeModified",v=
"\x3c",m="\x3d",g=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,y="ANNOTATION-XML COLOR-PROFILE FONT-FACE FONT-FACE-SRC FONT-FACE-URI FONT-FACE-FORMAT FONT-FACE-NAME MISSING-GLYPH".split(" "),b=[],w=[],E="",S=n$jscomp$1.documentElement,x=b.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},T=r$jscomp$1.prototype,N=T.hasOwnProperty,C=T.isPrototypeOf,k=r$jscomp$1.defineProperty,L=r$jscomp$1.getOwnPropertyDescriptor,A=r$jscomp$1.getOwnPropertyNames,O=r$jscomp$1.getPrototypeOf,M=r$jscomp$1.setPrototypeOf,
_=!!r$jscomp$1.__proto__,D=r$jscomp$1.create||function yt(e){return e?(yt.prototype=e,new yt):this},P=M||(_?function(e,t){return e.__proto__=t,e}:A&&L?function(){return function(t$jscomp$0,n$jscomp$0){do for(var n,e=t$jscomp$0,t=n$jscomp$0,r=A(t),i=0,s=r.length;i<s;i++)n=r[i],N.call(e,n)||k(e,n,L(t,n));while((n$jscomp$0=O(n$jscomp$0))&&!C.call(n$jscomp$0,t$jscomp$0));return t$jscomp$0}}():function(e,t){for(var n in t)e[n]=t[n];return e}),H=t$jscomp$2.MutationObserver||t$jscomp$2.WebKitMutationObserver,
B=(t$jscomp$2.HTMLElement||t$jscomp$2.Element||t$jscomp$2.Node).prototype,j=!C.call(B,S),F=j?function(e){return 1===e.nodeType}:function(e){return C.call(B,e)},I=j&&[],q=B.cloneNode,R=B.getAttribute,U=B.setAttribute,z=B.removeAttribute,W=n$jscomp$1.createElement,X=H&&{attributes:!0,characterData:!0,attributeOldValue:!0},V=H||function(e){Q=!1;S.removeEventListener(h$jscomp$0,V)},$,J=t$jscomp$2.requestAnimationFrame||t$jscomp$2.webkitRequestAnimationFrame||t$jscomp$2.mozRequestAnimationFrame||t$jscomp$2.msRequestAnimationFrame||
function(e){setTimeout(e,10)},K=!1,Q=!0,G=!0,Y=!0,Z,et,tt,nt,rt,it;M||_?(rt=function(e,t){C.call(t,e)||dt(e,t)},it=dt):(rt=function(e,t){e[s$jscomp$1]||(e[s$jscomp$1]=r$jscomp$1(!0),dt(e,t))},it=rt);j?(Q=!1,function(){var t$jscomp$0=L(B,"addEventListener"),n$jscomp$0=t$jscomp$0.value,r$jscomp$0=function(e){var t=new CustomEvent(h$jscomp$0,{bubbles:!0});t.attrName=e;t.prevValue=R.call(this,e);t.newValue=null;t[c$jscomp$0]=t.attrChange=2;z.call(this,e);this.dispatchEvent(t)},i$jscomp$0=function(t,n){var r=
this.hasAttribute(t),i=r&&R.call(this,t);e=new CustomEvent(h$jscomp$0,{bubbles:!0});U.call(this,t,n);e.attrName=t;e.prevValue=r?i:null;e.newValue=n;r?e.MODIFICATION=e.attrChange=1:e[f$jscomp$0]=e.attrChange=0;this.dispatchEvent(e)},o=function(e){var t=e.currentTarget,n=t[s$jscomp$1];e=e.propertyName;var i;n.hasOwnProperty(e)&&(n=n[e],i=new CustomEvent(h$jscomp$0,{bubbles:!0}),i.attrName=n.name,i.prevValue=n.value||null,i.newValue=n.value=t[e]||null,null==i.prevValue?i[f$jscomp$0]=i.attrChange=0:i.MODIFICATION=
i.attrChange=1,t.dispatchEvent(i))};t$jscomp$0.value=function(e,t,u){e===h$jscomp$0&&this.attributeChangedCallback&&this.setAttribute!==i$jscomp$0&&(this[s$jscomp$1]={className:{name:"class",value:this.className}},this.setAttribute=i$jscomp$0,this.removeAttribute=r$jscomp$0,n$jscomp$0.call(this,"propertychange",o));n$jscomp$0.call(this,e,t,u)};k(B,"addEventListener",t$jscomp$0)}()):H||(S.addEventListener(h$jscomp$0,V),S.setAttribute(s$jscomp$1,1),S.removeAttribute(s$jscomp$1),Q&&(Z=function(e){var r,
i;if(this===e.target){e=this[s$jscomp$1];this[s$jscomp$1]=r=tt(this);for(i in r){if(!(i in e))return et(0,this,i,e[i],r[i],f$jscomp$0);if(r[i]!==e[i])return et(1,this,i,e[i],r[i],"MODIFICATION")}for(i in e)if(!(i in r))return et(2,this,i,e[i],r[i],c$jscomp$0)}},et=function(e,t,n,r,i,s){t={attrChange:e,currentTarget:t,attrName:n,prevValue:r,newValue:i};t[s]=e;lt(t)},tt=function(e){for(var n,r={},i=e.attributes,s=0,o=i.length;s<o;s++)e=i[s],n=e.name,"setAttribute"!==n&&(r[n]=e.value);return r}));n$jscomp$1[i$jscomp$1]=
function(t$jscomp$1,r$jscomp$0){var c=t$jscomp$1.toUpperCase();K||(K=!0,H?(nt=function(e$jscomp$0,t$jscomp$0){function n$jscomp$0(e,t){for(var n=0,r=e.length;n<r;t(e[n++]));}return new H(function(r){for(var i,s,o,u=0,a=r.length;u<a;u++)i=r[u],"childList"===i.type?(n$jscomp$0(i.addedNodes,e$jscomp$0),n$jscomp$0(i.removedNodes,t$jscomp$0)):(s=i.target,Y&&s.attributeChangedCallback&&"style"!==i.attributeName&&(o=R.call(s,i.attributeName),o!==i.oldValue&&s.attributeChangedCallback(i.attributeName,i.oldValue,
o)))})}(ut(o$jscomp$0),ut(u$jscomp$0)),nt.observe(n$jscomp$1,{childList:!0,subtree:!0})):($=[],J(function d(){for(;$.length;)$.shift().call(null,$.shift());J(d)}),n$jscomp$1.addEventListener("DOMNodeInserted",ct(o$jscomp$0)),n$jscomp$1.addEventListener("DOMNodeRemoved",ct(u$jscomp$0))),n$jscomp$1.addEventListener(p,ht),n$jscomp$1.addEventListener("readystatechange",ht),n$jscomp$1.createElement=function(e,t){var r=W.apply(n$jscomp$1,arguments),i=""+e,s=x.call(b,(t?m:v)+(t||i).toUpperCase()),o=-1<s;
t&&(r.setAttribute("is",t=t.toLowerCase()),o&&(i=i.toUpperCase(),o=-1<E.indexOf(i+'[is\x3d"'+t+'"]')));return Y=!n$jscomp$1.createElement.innerHTMLHelper,o&&it(r,w[s]),r},B.cloneNode=function(e){var t=q.call(this,!!e),n=at(t);-1<n&&it(t,w[n]);if(e){e=t.querySelectorAll(E);n=0;for(var n$jscomp$0=e.length,r;n<n$jscomp$0;n++)r=e[n],it(r,w[at(r)])}return t});-2<x.call(b,m+c)+x.call(b,v+c)&&mt(t$jscomp$1);if(!g.test(c)||-1<x.call(y,c))throw Error("The type "+t$jscomp$1+" is invalid");var i$jscomp$0=function(){return f?
n$jscomp$1.createElement(l,c):n$jscomp$1.createElement(l)},s$jscomp$0=r$jscomp$0||T,f=N.call(s$jscomp$0,"extends"),l=f?r$jscomp$0["extends"].toUpperCase():c,h;return f&&-1<x.call(b,v+l)&&mt(l),h=b.push((f?m:v)+c)-1,E=E.concat(E.length?",":"",f?l+'[is\x3d"'+t$jscomp$1.toLowerCase()+'"]':l),i$jscomp$0.prototype=w[h]=N.call(s$jscomp$0,"prototype")?s$jscomp$0.prototype:D(B),st(n$jscomp$1.querySelectorAll(E),o$jscomp$0),i$jscomp$0}}})(window,document,Object,"registerElement")},{}],13:[function(_dereq_,
module,exports){module.exports=function(dtype){switch(dtype){case "int8":return Int8Array;case "int16":return Int16Array;case "int32":return Int32Array;case "uint8":return Uint8Array;case "uint16":return Uint16Array;case "uint32":return Uint32Array;case "float32":return Float32Array;case "float64":return Float64Array;case "array":return Array;case "uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(_dereq_,module,exports){_dereq_=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,
"callee").get}():function(){throw new TypeError;};exports="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator;var getProto=Object.getPrototypeOf||function(x){return x.__proto__},TypedArray="undefined"===typeof Uint8Array?void 0:getProto(Uint8Array),INTRINSICS={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"===typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"===typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":exports?getProto([][Symbol.iterator]()):
void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":"undefined"===
typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"===typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"===typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,
"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"===typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"===typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"===typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"===typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,
"$ %Int8Array%":"undefined"===typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"===typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"===typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"===typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"===typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"===typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":exports?
getProto(getProto([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"===typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!==typeof Map&&exports?getProto((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"===typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,
"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"===typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"===typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"===typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"===typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"===typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"===typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"===
typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"===typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"===typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!==typeof Set&&exports?getProto((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"===typeof Set?
void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"===typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":exports?getProto(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":exports?Symbol:void 0,"$ %SymbolPrototype%":exports?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,
"$ %ThrowTypeError%":_dereq_,"$ %TypedArray%":TypedArray,"$ %TypedArrayPrototype%":TypedArray?TypedArray.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"===typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"===typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"===typeof Uint8ClampedArray?
void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"===typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"===typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"===typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"===typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"===typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"===
typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"===typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"===typeof WeakSet?void 0:WeakSet.prototype};module.exports=function(name,allowMissing){if(1<arguments.length&&"boolean"!==typeof allowMissing)throw new TypeError('"allowMissing" argument must be a boolean');var key="$ "+name;if(!(key in INTRINSICS))throw new SyntaxError("intrinsic "+name+" does not exist!");if("undefined"===typeof INTRINSICS[key]&&!allowMissing)throw new TypeError("intrinsic "+
name+" exists, but is not available. Please file an issue!");return INTRINSICS[key]}},{}],15:[function(_dereq_,module,exports){exports=_dereq_("./GetIntrinsic");var $Object=exports("%Object%"),$TypeError=exports("%TypeError%"),$String=exports("%String%"),assertRecord=_dereq_("./helpers/assertRecord"),$isNaN=_dereq_("./helpers/isNaN"),$isFinite=_dereq_("./helpers/isFinite"),sign=_dereq_("./helpers/sign"),mod=_dereq_("./helpers/mod");exports=_dereq_("is-callable");var toPrimitive=_dereq_("es-to-primitive/es5"),
has=_dereq_("has");module.exports={ToPrimitive:toPrimitive,ToBoolean:function(value){return!!value},ToNumber:function(value){return+value},ToInteger:function(value){value=this.ToNumber(value);return $isNaN(value)?0:0!==value&&$isFinite(value)?sign(value)*Math.floor(Math.abs(value)):value},ToInt32:function(x){return this.ToNumber(x)>>0},ToUint32:function(x){return this.ToNumber(x)>>>0},ToUint16:function(value){value=this.ToNumber(value);if($isNaN(value)||0===value||!$isFinite(value))return 0;value=
sign(value)*Math.floor(Math.abs(value));return mod(value,65536)},ToString:function(value){return $String(value)},ToObject:function(value){this.CheckObjectCoercible(value);return $Object(value)},CheckObjectCoercible:function(value,optMessage){if(null==value)throw new $TypeError(optMessage||"Cannot call method on "+value);return value},IsCallable:exports,SameValue:function(x,y){return x===y?0===x?1/x===1/y:!0:$isNaN(x)&&$isNaN(y)},Type:function(x){if(null===x)return"Null";if("undefined"===typeof x)return"Undefined";
if("function"===typeof x||"object"===typeof x)return"Object";if("number"===typeof x)return"Number";if("boolean"===typeof x)return"Boolean";if("string"===typeof x)return"String"},IsPropertyDescriptor:function(Desc){if("Object"!==this.Type(Desc))return!1;var allowed={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0},key;for(key in Desc)if(has(Desc,key)&&!allowed[key])return!1;allowed=has(Desc,"[[Value]]");Desc=has(Desc,"[[Get]]")||has(Desc,"[[Set]]");
if(allowed&&Desc)throw new $TypeError("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(Desc){if("undefined"===typeof Desc)return!1;assertRecord(this,"Property Descriptor","Desc",Desc);return has(Desc,"[[Get]]")||has(Desc,"[[Set]]")?!0:!1},IsDataDescriptor:function(Desc){if("undefined"===typeof Desc)return!1;assertRecord(this,"Property Descriptor","Desc",Desc);return has(Desc,"[[Value]]")||has(Desc,"[[Writable]]")?!0:!1},IsGenericDescriptor:function(Desc){if("undefined"===
typeof Desc)return!1;assertRecord(this,"Property Descriptor","Desc",Desc);return this.IsAccessorDescriptor(Desc)||this.IsDataDescriptor(Desc)?!1:!0},FromPropertyDescriptor:function(Desc){if("undefined"===typeof Desc)return Desc;assertRecord(this,"Property Descriptor","Desc",Desc);if(this.IsDataDescriptor(Desc))return{value:Desc["[[Value]]"],writable:!!Desc["[[Writable]]"],enumerable:!!Desc["[[Enumerable]]"],configurable:!!Desc["[[Configurable]]"]};if(this.IsAccessorDescriptor(Desc))return{get:Desc["[[Get]]"],
set:Desc["[[Set]]"],enumerable:!!Desc["[[Enumerable]]"],configurable:!!Desc["[[Configurable]]"]};throw new $TypeError("FromPropertyDescriptor must be called with a fully populated Property Descriptor");},ToPropertyDescriptor:function(Obj){if("Object"!==this.Type(Obj))throw new $TypeError("ToPropertyDescriptor requires an object");var desc={};has(Obj,"enumerable")&&(desc["[[Enumerable]]"]=this.ToBoolean(Obj.enumerable));has(Obj,"configurable")&&(desc["[[Configurable]]"]=this.ToBoolean(Obj.configurable));
has(Obj,"value")&&(desc["[[Value]]"]=Obj.value);has(Obj,"writable")&&(desc["[[Writable]]"]=this.ToBoolean(Obj.writable));if(has(Obj,"get")){var getter=Obj.get;if("undefined"!==typeof getter&&!this.IsCallable(getter))throw new TypeError("getter must be a function");desc["[[Get]]"]=getter}if(has(Obj,"set")){Obj=Obj.set;if("undefined"!==typeof Obj&&!this.IsCallable(Obj))throw new $TypeError("setter must be a function");desc["[[Set]]"]=Obj}if((has(desc,"[[Get]]")||has(desc,"[[Set]]"))&&(has(desc,"[[Value]]")||
has(desc,"[[Writable]]")))throw new $TypeError("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return desc}}},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(_dereq_,module,exports){exports=_dereq_("../GetIntrinsic");var $TypeError=exports("%TypeError%"),$SyntaxError=exports("%SyntaxError%"),has=_dereq_("has"),
predicates={"Property Descriptor":function(ES,Desc){if("Object"!==ES.Type(Desc))return!1;ES={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var key in Desc)if(has(Desc,key)&&!ES[key])return!1;key=has(Desc,"[[Value]]");Desc=has(Desc,"[[Get]]")||has(Desc,"[[Set]]");if(key&&Desc)throw new $TypeError("Property Descriptors may not be both accessor and data descriptors");return!0}};module.exports=function(ES,recordType,argumentName,value){var predicate=
predicates[recordType];if("function"!==typeof predicate)throw new $SyntaxError("unknown record type: "+recordType);if(!predicate(ES,value))throw new $TypeError(argumentName+" must be a "+recordType);console.log(predicate(ES,value),value)}},{"../GetIntrinsic":14,has:28}],17:[function(_dereq_,module,exports){var $isNaN=Number.isNaN||function(a){return a!==a};module.exports=Number.isFinite||function(x){return"number"===typeof x&&!$isNaN(x)&&Infinity!==x&&-Infinity!==x}},{}],18:[function(_dereq_,module,
exports){module.exports=Number.isNaN||function(a){return a!==a}},{}],19:[function(_dereq_,module,exports){module.exports=function(number,modulo){number%=modulo;return Math.floor(0<=number?number:number+modulo)}},{}],20:[function(_dereq_,module,exports){module.exports=function(number){return 0<=number?1:-1}},{}],21:[function(_dereq_,module,exports){var toStr=Object.prototype.toString,isPrimitive=_dereq_("./helpers/isPrimitive"),isCallable=_dereq_("is-callable"),ES5internalSlots={"[[DefaultValue]]":function(O){var actualHint=
1<arguments.length?arguments[1]:"[object Date]"===toStr.call(O)?String:Number;if(actualHint===String||actualHint===Number){actualHint=actualHint===String?["toString","valueOf"]:["valueOf","toString"];var i;for(i=0;i<actualHint.length;++i)if(isCallable(O[actualHint[i]])){var value=O[actualHint[i]]();if(isPrimitive(value))return value}throw new TypeError("No default value");}throw new TypeError("invalid [[DefaultValue]] hint supplied");}};module.exports=function(input){return isPrimitive(input)?input:
1<arguments.length?ES5internalSlots["[[DefaultValue]]"](input,arguments[1]):ES5internalSlots["[[DefaultValue]]"](input)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(_dereq_,module,exports){module.exports=function(value){return null===value||"function"!==typeof value&&"object"!==typeof value}},{}],23:[function(_dereq_,module,exports){var dtype=_dereq_("dtype");module.exports=function(data,output,offset){if(!data)throw new TypeError("must specify data as first parameter");offset=+(offset||
0)|0;if(Array.isArray(data)&&data[0]&&"number"===typeof data[0][0]){var dim=data[0].length,length=data.length*dim;output&&"string"!==typeof output||(output=new (dtype(output||"float32"))(length+offset));var j=output.length-offset;if(length!==j)throw Error("source length "+length+" ("+dim+"x"+data.length+") does not match destination length "+j);for(length=0;length<data.length;length++)for(j=0;j<dim;j++)output[offset++]=null===data[length][j]?NaN:data[length][j]}else if(output&&"string"!==typeof output)output.set(data,
offset);else if(dim=dtype(output||"float32"),Array.isArray(data)||"array"===output)for(output=new dim(data.length+offset),length=0,dim=output.length;offset<dim;offset++,length++)output[offset]=null===data[length]?NaN:data[length];else 0===offset?output=new dim(data):(output=new dim(data.length+offset),output.set(data,offset));return output}},{dtype:13}],24:[function(_dereq_,module,exports){var isCallable=_dereq_("is-callable"),toStr=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty;
module.exports=function(list,iterator,thisArg){if(!isCallable(iterator))throw new TypeError("iterator must be a function");var receiver;3<=arguments.length&&(receiver=thisArg);if("[object Array]"===toStr.call(list)){var receiver$jscomp$0=receiver;receiver=0;for(var len=list.length;receiver<len;receiver++)hasOwnProperty.call(list,receiver)&&(null==receiver$jscomp$0?iterator(list[receiver],receiver,list):iterator.call(receiver$jscomp$0,list[receiver],receiver,list))}else if("string"===typeof list)for(receiver$jscomp$0=
receiver,receiver=0,len=list.length;receiver<len;receiver++)null==receiver$jscomp$0?iterator(list.charAt(receiver),receiver,list):iterator.call(receiver$jscomp$0,list.charAt(receiver),receiver,list);else for(receiver$jscomp$0 in list)hasOwnProperty.call(list,receiver$jscomp$0)&&(null==receiver?iterator(list[receiver$jscomp$0],receiver$jscomp$0,list):iterator.call(receiver,list[receiver$jscomp$0],receiver$jscomp$0,list))}},{"is-callable":32}],25:[function(_dereq_,module,exports){var slice=Array.prototype.slice,
toStr=Object.prototype.toString;module.exports=function(that){var target=this;if("function"!==typeof target||"[object Function]"!==toStr.call(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var args=slice.call(arguments,1),bound,boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)boundArgs.push("$"+i);bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof
bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))});target.prototype&&(boundLength=function(){},boundLength.prototype=target.prototype,bound.prototype=new boundLength,boundLength.prototype=null);return bound}},{}],26:[function(_dereq_,module,exports){_dereq_=_dereq_("./implementation");module.exports=Function.prototype.bind||_dereq_},{"./implementation":25}],27:[function(_dereq_,
module,exports){_dereq_="undefined"!==typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{};module.exports="undefined"!==typeof window?window:"undefined"!==typeof _dereq_?_dereq_:"undefined"!==typeof self?self:{}},{}],28:[function(_dereq_,module,exports){_dereq_=_dereq_("function-bind");module.exports=_dereq_.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(_dereq_,module,exports){exports.read=function(buffer,
offset,isLE,mLen,nBytes){var m=8*nBytes-mLen-1;var eMax=(1<<m)-1,eBias=eMax>>1,nBits=-7;nBytes=isLE?nBytes-1:0;var d=isLE?-1:1,s=buffer[offset+nBytes];nBytes+=d;isLE=s&(1<<-nBits)-1;s>>=-nBits;for(nBits+=m;0<nBits;isLE=256*isLE+buffer[offset+nBytes],nBytes+=d,nBits-=8);m=isLE&(1<<-nBits)-1;isLE>>=-nBits;for(nBits+=mLen;0<nBits;m=256*m+buffer[offset+nBytes],nBytes+=d,nBits-=8);if(0===isLE)isLE=1-eBias;else{if(isLE===eMax)return m?NaN:Infinity*(s?-1:1);m+=Math.pow(2,mLen);isLE-=eBias}return(s?-1:1)*
m*Math.pow(2,isLE-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0;nBytes=isLE?0:nBytes-1;var d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;value=Math.abs(value);isNaN(value)||Infinity===value?(value=isNaN(value)?1:0,isLE=eMax):(isLE=Math.floor(Math.log(value)/Math.LN2),1>value*(c=Math.pow(2,-isLE))&&(isLE--,c*=2),value=1<=isLE+eBias?value+rt/c:value+rt*Math.pow(2,1-eBias),
2<=value*c&&(isLE++,c/=2),isLE+eBias>=eMax?(value=0,isLE=eMax):1<=isLE+eBias?(value=(value*c-1)*Math.pow(2,mLen),isLE+=eBias):(value=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),isLE=0));for(;8<=mLen;buffer[offset+nBytes]=value&255,nBytes+=d,value/=256,mLen-=8);isLE=isLE<<mLen|value;for(eLen+=mLen;0<eLen;buffer[offset+nBytes]=isLE&255,nBytes+=d,isLE/=256,eLen-=8);buffer[offset+nBytes-d]|=128*s}},{}],30:[function(_dereq_,module,exports){module.exports="function"===typeof Object.create?function(ctor,
superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:function(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],31:[function(_dereq_,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"===typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}
module.exports=function(obj){return null!=obj&&(isBuffer(obj)||"function"===typeof obj.readFloatLE&&"function"===typeof obj.slice&&isBuffer(obj.slice(0,0))||!!obj._isBuffer)}},{}],32:[function(_dereq_,module,exports){var fnToStr=Function.prototype.toString,constructorRegex=/^\s*class\b/,isES6ClassFn=function(value){try{var fnStr=fnToStr.call(value);return constructorRegex.test(fnStr)}catch(e$144){return!1}},toStr=Object.prototype.toString,hasToStringTag="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;
module.exports=function(value){if(!value||"function"!==typeof value&&"object"!==typeof value)return!1;if("function"===typeof value&&!value.prototype)return!0;if(hasToStringTag){try{if(isES6ClassFn(value))var JSCompiler_inline_result=!1;else fnToStr.call(value),JSCompiler_inline_result=!0}catch(e$145){JSCompiler_inline_result=!1}return JSCompiler_inline_result}if(isES6ClassFn(value))return!1;value=toStr.call(value);return"[object Function]"===value||"[object GeneratorFunction]"===value}},{}],33:[function(_dereq_,
module,exports){module.exports=function(fn){var string=toString.call(fn);return"[object Function]"===string||"function"===typeof fn&&"[object RegExp]"!==string||"undefined"!==typeof window&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)};var toString=Object.prototype.toString},{}],34:[function(_dereq_,module,exports){module.exports=function(x){var type=typeof x;return null!==x&&("object"===type||"function"===type)}},{}],35:[function(_dereq_,module,exports){var toString=
{}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],36:[function(_dereq_,module,exports){function TextLayout(opt){this.glyphs=[];this._measure=this.computeMetrics.bind(this);this.update(opt)}function getGlyphById(font,id){if(!font.chars||0===font.chars.length)return null;id=findChar(font.chars,id);return 0<=id?font.chars[id]:null}function getXHeight(font){for(var i=0;i<X_HEIGHTS.length;i++){var id=X_HEIGHTS[i].charCodeAt(0);id=findChar(font.chars,
id);if(0<=id)return font.chars[id].height}return 0}function getCapHeight(font){for(var i=0;i<CAP_HEIGHTS.length;i++){var id=CAP_HEIGHTS[i].charCodeAt(0);id=findChar(font.chars,id);if(0<=id)return font.chars[id].height}return 0}function getKerning(font,left,right){if(!font.kernings||0===font.kernings.length)return 0;font=font.kernings;for(var i=0;i<font.length;i++){var kern=font[i];if(kern.first===left&&kern.second===right)return kern.amount}return 0}function getAlignType(align){return"center"===align?
1:"right"===align?2:0}function findChar(array,value,start){for(start=start||0;start<array.length;start++)if(array[start].id===value)return start;return-1}var wordWrap=_dereq_("word-wrapper"),xtend=_dereq_("xtend"),number=_dereq_("as-number"),X_HEIGHTS="xeaonsrcumvwz".split(""),M_WIDTHS=["m","w"],CAP_HEIGHTS="HINEFKLTUVWXYZ".split("");module.exports=function(opt){return new TextLayout(opt)};TextLayout.prototype.update=function(opt){this._opt=opt=xtend({measure:this._measure},opt);this._opt.tabSize=
number(this._opt.tabSize,4);if(!opt.font)throw Error("must provide a valid bitmap font");var glyphs=this.glyphs,text=opt.text||"",font=opt.font;this._setupSpaceGlyphs(font);var lines=wordWrap.lines(text,opt),minWidth=opt.width||0;glyphs.length=0;var maxLineWidth=lines.reduce(function(prev,line){return Math.max(prev,line.width,minWidth)},0),x=0,y=0,lineHeight=number(opt.lineHeight,font.common.lineHeight),baseline=font.common.base,descender=lineHeight-baseline,letterSpacing=opt.letterSpacing||0;opt=
lineHeight*lines.length-descender;var align=getAlignType(this._opt.align);y-=opt;this._width=maxLineWidth;this._height=opt;this._descender=lineHeight-baseline;this._baseline=baseline;this._xHeight=getXHeight(font);this._capHeight=getCapHeight(font);this._lineHeight=lineHeight;this._ascender=lineHeight-descender-this._xHeight;var self=this;lines.forEach(function(line,lineIndex){var end=line.end,lineWidth=line.width;for(line=line.start;line<end;line++){var id=text.charCodeAt(line);if(id=self.getGlyph(font,
id)){lastGlyph&&(x+=getKerning(font,lastGlyph.id,id.id));var lastGlyph=x;1===align?lastGlyph+=(maxLineWidth-lineWidth)/2:2===align&&(lastGlyph+=maxLineWidth-lineWidth);glyphs.push({position:[lastGlyph,y],data:id,index:line,line:lineIndex});x+=id.xadvance+letterSpacing;lastGlyph=id}}y+=lineHeight;x=0});this._linesTotal=lines.length};TextLayout.prototype._setupSpaceGlyphs=function(font){this._fallbackTabGlyph=this._fallbackSpaceGlyph=null;if(font.chars&&0!==font.chars.length){var JSCompiler_temp;if(!(JSCompiler_temp=
getGlyphById(font,32)))a:{for(JSCompiler_temp=0;JSCompiler_temp<M_WIDTHS.length;JSCompiler_temp++){var id=M_WIDTHS[JSCompiler_temp].charCodeAt(0);id=findChar(font.chars,id);if(0<=id){JSCompiler_temp=font.chars[id];break a}}JSCompiler_temp=0}font=JSCompiler_temp||font.chars[0];JSCompiler_temp=this._opt.tabSize*font.xadvance;this._fallbackSpaceGlyph=font;this._fallbackTabGlyph=xtend(font,{x:0,y:0,xadvance:JSCompiler_temp,id:9,xoffset:0,yoffset:0,width:0,height:0})}};TextLayout.prototype.getGlyph=function(font,
id){return(font=getGlyphById(font,id))?font:9===id?this._fallbackTabGlyph:32===id?this._fallbackSpaceGlyph:null};TextLayout.prototype.computeMetrics=function(text,start,end,width){var letterSpacing=this._opt.letterSpacing||0,font=this._opt.font,curPen=0,curWidth=0,count=0;if(!font.chars||0===font.chars.length)return{start:start,end:start,width:0};end=Math.min(text.length,end);for(var i=start;i<end;i++){var glyph=text.charCodeAt(i);if(glyph=this.getGlyph(font,glyph)){var kern=lastGlyph?getKerning(font,
lastGlyph.id,glyph.id):0;curPen+=kern;kern=curPen+glyph.xadvance+letterSpacing;var nextWidth=curPen+glyph.width;if(nextWidth>=width||kern>=width)break;curPen=kern;curWidth=nextWidth;var lastGlyph=glyph}count++}lastGlyph&&(curWidth+=lastGlyph.xoffset);return{start:start,end:start+count,width:curWidth}};"width height descender ascender xHeight baseline capHeight lineHeight".split(" ").forEach(function(name){Object.defineProperty(TextLayout.prototype,name,{get:(new Function(["return function "+name+
"() {","  return this._"+name,"}"].join("\n")))(),configurable:!0})})},{"as-number":2,"word-wrapper":68,xtend:71}],37:[function(_dereq_,module,exports){(function(Buffer){function getBinaryOpts(opt){if(xml2)return xtend(opt,{responseType:"arraybuffer"});if("undefined"===typeof self.XMLHttpRequest)throw Error("your browser does not support XHR loading");var req=new self.XMLHttpRequest;req.overrideMimeType("text/plain; charset\x3dx-user-defined");return xtend({xhr:req},opt)}var xhr=_dereq_("xhr"),noop=
function(){},parseASCII=_dereq_("parse-bmfont-ascii"),parseXML=_dereq_("parse-bmfont-xml"),readBinary=_dereq_("parse-bmfont-binary"),isBinaryFormat=_dereq_("./lib/is-binary"),xtend=_dereq_("xtend"),xml2=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;module.exports=function(opt,cb){cb="function"===typeof cb?cb:noop;"string"===typeof opt?opt={uri:opt}:opt||(opt={});opt.binary&&(opt=getBinaryOpts(opt));xhr(opt,function(err,res,body){if(err)return cb(err);if(!/^2/.test(res.statusCode))return cb(Error("http status code: "+
res.statusCode));if(!body)return cb(Error("no body result"));err=!1;"[object ArrayBuffer]"===Object.prototype.toString.call(body)&&(body=new Uint8Array(body),body=new Buffer(body,"binary"));isBinaryFormat(body)&&(err=!0,"string"===typeof body&&(body=new Buffer(body,"binary")));err||(Buffer.isBuffer(body)&&(body=body.toString(opt.encoding)),body=body.trim());try{var type=res.headers["content-type"];var result=err?readBinary(body):/json/.test(type)||"{"===body.charAt(0)?JSON.parse(body):/xml/.test(type)||
"\x3c"===body.charAt(0)?parseXML(body):parseASCII(body)}catch(e$146){cb(Error("error parsing font "+e$146.message)),cb=noop}cb(null,result)})}}).call(this,_dereq_("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:69,xtend:71}],38:[function(_dereq_,module,exports){(function(Buffer){var equal=_dereq_("buffer-equal"),HEADER=new Buffer([66,77,70,3]);module.exports=function(buf){return"string"===typeof buf?"BMF"===buf.substring(0,
3):4<buf.length&&equal(buf.slice(0,4),HEADER)}}).call(this,_dereq_("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(_dereq_,module,exports){var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(){try{if(!Object.assign)return!1;var test1=new String("abc");test1[5]="de";if("5"===Object.getOwnPropertyNames(test1)[0])return!1;var test2={};for(test1=0;10>test1;test1++)test2["_"+
String.fromCharCode(test1)]=test1;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},test3)).join("")?!1:!0}catch(err){return!1}}()?Object.assign:function(target,source){if(null===target||void 0===target)throw new TypeError("Object.assign cannot be called with null or undefined");var to=Object(target);
for(var symbols,s=1;s<arguments.length;s++){var from=Object(arguments[s]);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},{}],40:[function(_dereq_,module,exports){if(!Object.keys){var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArgs=_dereq_("./isArguments");_dereq_=Object.prototype.propertyIsEnumerable;
var hasDontEnumBug=!_dereq_.call({toString:null},"toString"),hasProtoEnumBug=_dereq_.call(function(){},"prototype"),dontEnums="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,
$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if("undefined"===typeof window)return!1;for(var k in window)try{if(!excludedKeys["$"+k]&&has.call(window,k)&&null!==window[k]&&"object"===typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e$147){return!0}}catch(e$148){return!0}return!1}();var keysShim=function(object){var isObject=
null!==object&&"object"===typeof object,isFunction="[object Function]"===toStr.call(object),isArguments=isArgs(object),isString=isObject&&"[object String]"===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError("Object.keys called on a non-object");isObject=hasProtoEnumBug&&isFunction;if(isString&&0<object.length&&!has.call(object,0))for(isString=0;isString<object.length;++isString)theKeys.push(String(isString));if(isArguments&&0<object.length)for(isArguments=
0;isArguments<object.length;++isArguments)theKeys.push(String(isArguments));else for(var name in object)isObject&&"prototype"===name||!has.call(object,name)||theKeys.push(String(name));if(hasDontEnumBug){if("undefined"!==typeof window&&hasAutomationEqualityBug)try{var skipConstructor=equalsConstructorPrototype(object)}catch(e$149){skipConstructor=!1}else skipConstructor=equalsConstructorPrototype(object);for(isArguments=0;isArguments<dontEnums.length;++isArguments)skipConstructor&&"constructor"===
dontEnums[isArguments]||!has.call(object,dontEnums[isArguments])||theKeys.push(dontEnums[isArguments])}return theKeys}}module.exports=keysShim},{"./isArguments":42}],41:[function(_dereq_,module,exports){var slice=Array.prototype.slice,isArgs=_dereq_("./isArguments"),origKeys=Object.keys,keysShim=origKeys?function(o){return origKeys(o)}:_dereq_("./implementation"),originalKeys=Object.keys;keysShim.shim=function(){Object.keys?function(){var args=Object.keys(arguments);return args&&args.length===arguments.length}(1,
2)||(Object.keys=function(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}):Object.keys=keysShim;return Object.keys||keysShim};module.exports=keysShim},{"./implementation":40,"./isArguments":42}],42:[function(_dereq_,module,exports){var toStr=Object.prototype.toString;module.exports=function(value){var str=toStr.call(value),isArgs="[object Arguments]"===str;isArgs||(isArgs="[object Array]"!==str&&null!==value&&"object"===typeof value&&"number"===typeof value.length&&
0<=value.length&&"[object Function]"===toStr.call(value.callee));return isArgs}},{}],43:[function(_dereq_,module,exports){function splitLine(line,idx){line=line.replace(/\t+/g," ").trim();if(!line)return null;var space=line.indexOf(" ");if(-1===space)throw Error("no named row at line "+idx);idx=line.substring(0,space);line=line.substring(space+1);line=line.replace(/letter=['"]\S+['"]/gi,"");line=line.split("\x3d");line=line.map(function(str){return str.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});
space=[];for(var i=0;i<line.length;i++){var dt=line[i];0===i?space.push({key:dt[0],data:""}):i===line.length-1?space[space.length-1].data=parseData(dt[0]):(space[space.length-1].data=parseData(dt[0]),space.push({key:dt[1],data:""}))}var out={key:idx,data:{}};space.forEach(function(v){out.data[v.key]=v.data});return out}function parseData(data){return data&&0!==data.length?0===data.indexOf('"')||0===data.indexOf("'")?data.substring(1,data.length-1):-1!==data.indexOf(",")?parseIntList(data):parseInt(data,
10):""}function parseIntList(data){return data.split(",").map(function(val){return parseInt(val,10)})}module.exports=function(data){if(!data)throw Error("no data provided");data=data.toString().trim();var output={pages:[],chars:[],kernings:[]};data=data.split(/\r\n?|\n/g);if(0===data.length)throw Error("no data in BMFont file");for(var i=0;i<data.length;i++){var lineData=splitLine(data[i],i);if(lineData)if("page"===lineData.key){if("number"!==typeof lineData.data.id)throw Error("malformed file at line "+
i+" -- needs page id\x3dN");if("string"!==typeof lineData.data.file)throw Error("malformed file at line "+i+' -- needs page file\x3d"path"');output.pages[lineData.data.id]=lineData.data.file}else"chars"!==lineData.key&&"kernings"!==lineData.key&&("char"===lineData.key?output.chars.push(lineData.data):"kerning"===lineData.key?output.kernings.push(lineData.data):output[lineData.key]=lineData.data)}return output}},{}],44:[function(_dereq_,module,exports){function readBlock(target,buf,i){if(i>buf.length-
1)return 0;var blockID=buf.readUInt8(i++),blockSize=buf.readInt32LE(i);i+=4;switch(blockID){case 1:blockID={};blockID.size=buf.readInt16LE(i);var bitField=buf.readUInt8(i+2);blockID.smooth=bitField>>7&1;blockID.unicode=bitField>>6&1;blockID.italic=bitField>>5&1;blockID.bold=bitField>>4&1;bitField>>3&1&&(blockID.fixedHeight=1);blockID.charset=buf.readUInt8(i+3)||"";blockID.stretchH=buf.readUInt16LE(i+4);blockID.aa=buf.readUInt8(i+6);blockID.padding=[buf.readInt8(i+7),buf.readInt8(i+8),buf.readInt8(i+
9),buf.readInt8(i+10)];blockID.spacing=[buf.readInt8(i+11),buf.readInt8(i+12)];blockID.outline=buf.readUInt8(i+13);blockID.face=readNameNT(buf,i+14).toString("utf8");target.info=blockID;break;case 2:blockID={};blockID.lineHeight=buf.readUInt16LE(i);blockID.base=buf.readUInt16LE(i+2);blockID.scaleW=buf.readUInt16LE(i+4);blockID.scaleH=buf.readUInt16LE(i+6);blockID.pages=buf.readUInt16LE(i+8);buf.readUInt8(i+10);blockID.packed=0;blockID.alphaChnl=buf.readUInt8(i+11);blockID.redChnl=buf.readUInt8(i+
12);blockID.greenChnl=buf.readUInt8(i+13);blockID.blueChnl=buf.readUInt8(i+14);target.common=blockID;break;case 3:blockID=[];bitField=readNameNT(buf,i);for(var len=bitField.length+1,count=blockSize/len,c=0;c<count;c++)blockID[c]=buf.slice(i,i+bitField.length).toString("utf8"),i+=len;target.pages=blockID;break;case 4:blockID=[];bitField=blockSize/20;for(len=0;len<bitField;len++)count={},c=20*len,count.id=buf.readUInt32LE(i+0+c),count.x=buf.readUInt16LE(i+4+c),count.y=buf.readUInt16LE(i+6+c),count.width=
buf.readUInt16LE(i+8+c),count.height=buf.readUInt16LE(i+10+c),count.xoffset=buf.readInt16LE(i+12+c),count.yoffset=buf.readInt16LE(i+14+c),count.xadvance=buf.readInt16LE(i+16+c),count.page=buf.readUInt8(i+18+c),count.chnl=buf.readUInt8(i+19+c),blockID[len]=count;target.chars=blockID;break;case 5:blockID=[];bitField=blockSize/10;for(len=0;len<bitField;len++)count={},c=10*len,count.first=buf.readUInt32LE(i+0+c),count.second=buf.readUInt32LE(i+4+c),count.amount=buf.readInt16LE(i+8+c),blockID[len]=count;
target.kernings=blockID}return 5+blockSize}function readNameNT(buf,offset){for(var pos=offset;pos<buf.length&&0!==buf[pos];pos++);return buf.slice(offset,pos)}var HEADER=[66,77,70];module.exports=function(buf){if(6>buf.length)throw Error("invalid buffer length for BMFont");if(!HEADER.every(function(byte,i){return buf.readUInt8(i)===byte}))throw Error("BMFont missing BMF byte header");var i$jscomp$0=3;if(3<buf.readUInt8(i$jscomp$0++))throw Error("Only supports BMFont Binary v3 (BMFont App v1.10)");
for(var target={kernings:[],chars:[]},b=0;5>b;b++)i$jscomp$0+=readBlock(target,buf,i$jscomp$0);return target}},{}],45:[function(_dereq_,module,exports){function getAttribs(element){return getAttribList(element).reduce(function(dict,attrib){var key=attrib.nodeName;key=NAME_MAP[key.toLowerCase()]||key;dict[key]=attrib.nodeValue;return dict},{})}function getAttribList(element){for(var attribs=[],i=0;i<element.attributes.length;i++)attribs.push(element.attributes[i]);return attribs}var parseAttributes=
_dereq_("./parse-attribs"),parseFromString=_dereq_("xml-parse-from-string"),NAME_MAP={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};module.exports=function(data){data=data.toString();var xmlRoot=parseFromString(data),output={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(key){var element=xmlRoot.getElementsByTagName(key)[0];element&&(output[key]=parseAttributes(getAttribs(element)))});
data=xmlRoot.getElementsByTagName("pages")[0];if(!data)throw Error("malformed file -- no \x3cpages\x3e element");data=data.getElementsByTagName("page");for(var i=0;i<data.length;i++){var p=data[i],id=parseInt(p.getAttribute("id"),10);p=p.getAttribute("file");if(isNaN(id))throw Error('malformed file -- page "id" attribute is NaN');if(!p)throw Error('malformed file -- needs page "file" attribute');output.pages[parseInt(id,10)]=p}["chars","kernings"].forEach(function(key){var element=xmlRoot.getElementsByTagName(key)[0];
if(element){var childTag=key.substring(0,key.length-1);element=element.getElementsByTagName(childTag);for(childTag=0;childTag<element.length;childTag++)output[key].push(parseAttributes(getAttribs(element[childTag])))}});return output}},{"./parse-attribs":46,"xml-parse-from-string":70}],46:[function(_dereq_,module,exports){function parseIntList(data){return data.split(",").map(function(val){return parseInt(val,10)})}module.exports=function(obj){"chasrset"in obj&&(obj.charset=obj.chasrset,delete obj.chasrset);
for(var k in obj)"face"!==k&&"charset"!==k&&(obj[k]="padding"===k||"spacing"===k?parseIntList(obj[k]):parseInt(obj[k],10));return obj}},{}],47:[function(_dereq_,module,exports){var trim=_dereq_("string.prototype.trim"),forEach=_dereq_("for-each");module.exports=function(headers){if(!headers)return{};var result={};forEach(trim(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim(row.slice(0,index)).toLowerCase();row=trim(row.slice(index+1));"undefined"===typeof result[key]?result[key]=
row:"[object Array]"===Object.prototype.toString.call(result[key])?result[key].push(row):result[key]=[result[key],row]});return result}},{"for-each":24,"string.prototype.trim":53}],48:[function(_dereq_,module,exports){(function(global){var performance=global.performance||{},present=function(){for(var names=["now","webkitNow","msNow","mozNow","oNow"];names.length;){var name=names.shift();if(name in performance)return performance[name].bind(performance)}var dateNow=Date.now||function(){return(new Date).getTime()},
navigationStart=(performance.timing||{}).navigationStart||dateNow();return function(){return dateNow()-navigationStart}}();present.performanceNow=performance.now;present.noConflict=function(){performance.now=present.performanceNow};present.conflict=function(){performance.now=present};present.conflict();module.exports=present}).call(this,"undefined"!==typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],49:[function(_dereq_,module,exports){function defaultSetTimout(){throw Error("setTimeout has not been defined");
}function defaultClearTimeout(){throw Error("clearTimeout has not been defined");}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e$153){try{return cachedSetTimeout.call(null,fun,0)}catch(e$152){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);
if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e$155){try{return cachedClearTimeout.call(null,marker)}catch(e$154){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=
runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){currentQueue=queue;for(queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1;len=queue.length}currentQueue=null;draining=!1;runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun;this.array=array}function noop(){}_dereq_=module.exports={};try{var cachedSetTimeout="function"===typeof setTimeout?setTimeout:defaultSetTimout}catch(e$150){cachedSetTimeout=defaultSetTimout}try{var cachedClearTimeout=
"function"===typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e$151){cachedClearTimeout=defaultClearTimeout}var queue=[],draining=!1,currentQueue,queueIndex=-1;_dereq_.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args));1!==queue.length||draining||runTimeout(drainQueue)};Item.prototype.run=function(){this.fun.apply(null,this.array)};_dereq_.title="browser";_dereq_.browser=
!0;_dereq_.env={};_dereq_.argv=[];_dereq_.version="";_dereq_.versions={};_dereq_.on=noop;_dereq_.addListener=noop;_dereq_.once=noop;_dereq_.off=noop;_dereq_.removeListener=noop;_dereq_.removeAllListeners=noop;_dereq_.emit=noop;_dereq_.prependListener=noop;_dereq_.prependOnceListener=noop;_dereq_.listeners=function(name){return[]};_dereq_.binding=function(name){throw Error("process.binding is not supported");};_dereq_.cwd=function(){return"/"};_dereq_.chdir=function(dir){throw Error("process.chdir is not supported");
};_dereq_.umask=function(){return 0}},{}],50:[function(_dereq_,module,exports){(function(setImmediate){(function(root){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof fn)throw new TypeError("not a function");this._value=this._state=null;this._deferreds=[];doResolve(fn,bind(resolve$jscomp$0,this),bind(reject$jscomp$0,this))}function handle(deferred){var me=
this;null===this._state?this._deferreds.push(deferred):asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)(me._state?deferred.resolve:deferred.reject)(me._value);else{try{var ret=cb(me._value)}catch(e$156){deferred.reject(e$156);return}deferred.resolve(ret)}})}function resolve$jscomp$0(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"===typeof newValue||"function"===typeof newValue)){var then=
newValue.then;if("function"===typeof then){doResolve(bind(then,newValue),bind(resolve$jscomp$0,this),bind(reject$jscomp$0,this));return}}this._state=!0;this._value=newValue;finale.call(this)}catch(e$157){reject$jscomp$0.call(this,e$157)}}function reject$jscomp$0(newValue){this._state=!1;this._value=newValue;finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++)handle.call(this,this._deferreds[i]);this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled=
"function"===typeof onFulfilled?onFulfilled:null;this.onRejected="function"===typeof onRejected?onRejected:null;this.resolve=resolve;this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){done||(done=!0,onRejected(ex))}}var setTimeoutFunc=setTimeout,asap="function"===typeof setImmediate&&setImmediate||function(fn){setTimeoutFunc(fn,1)},isArray=Array.isArray||
function(value){return"[object Array]"===Object.prototype.toString.call(value)};Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})};Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,
reject){function res(i,val$jscomp$0){try{if(val$jscomp$0&&("object"===typeof val$jscomp$0||"function"===typeof val$jscomp$0)){var then=val$jscomp$0.then;if("function"===typeof then){then.call(val$jscomp$0,function(val){res(i,val)},reject);return}}args[i]=val$jscomp$0;0===--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i$jscomp$0=0;i$jscomp$0<args.length;i$jscomp$0++)res(i$jscomp$0,args[i$jscomp$0])})};Promise.resolve=function(value){return value&&
"object"===typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})};Promise._setImmediateFn=function(fn){asap=fn};"undefined"!==typeof module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)})(this)}).call(this,
_dereq_("timers").setImmediate)},{timers:66}],51:[function(_dereq_,module,exports){var dtype=_dereq_("dtype"),anArray=_dereq_("an-array"),isBuffer=_dereq_("is-buffer"),CW=[0,2,3],CCW=[2,1,3];module.exports=function(array,opt){array&&(anArray(array)||isBuffer(array))||(opt=array||{},array=null);opt="number"===typeof opt?{count:opt}:opt||{};var type="string"===typeof opt.type?opt.type:"uint16",start=opt.start||0,dir=!1!==opt.clockwise?CW:CCW,a=dir[0],b=dir[1];dir=dir[2];opt=6*("number"===typeof opt.count?
opt.count:1);array=array||new (dtype(type))(opt);for(var j=type=0;type<opt;type+=6,j+=4){var x=type+start;array[x+0]=j+0;array[x+1]=j+1;array[x+2]=j+2;array[x+3]=j+a;array[x+4]=j+b;array[x+5]=j+dir}return array}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(_dereq_,module,exports){exports=_dereq_("function-bind");var ES=_dereq_("es-abstract/es5"),replace=exports.call(Function.call,String.prototype.replace),leftWhitespace=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,
rightWhitespace=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;module.exports=function(){var S=ES.ToString(ES.CheckObjectCoercible(this));return replace(replace(S,leftWhitespace,""),rightWhitespace,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(_dereq_,module,exports){var bind=_dereq_("function-bind");exports=_dereq_("define-properties");var implementation=_dereq_("./implementation"),
getPolyfill=_dereq_("./polyfill");_dereq_=_dereq_("./shim");bind=bind.call(Function.call,getPolyfill());exports(bind,{getPolyfill:getPolyfill,implementation:implementation,shim:_dereq_});module.exports=bind},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(_dereq_,module,exports){var implementation=_dereq_("./implementation");module.exports=function(){return String.prototype.trim?String.prototype.trim:implementation}},{"./implementation":52}],
55:[function(_dereq_,module,exports){var define=_dereq_("define-properties"),getPolyfill=_dereq_("./polyfill");module.exports=function(){var polyfill=getPolyfill();define(String.prototype,{trim:polyfill},{trim:function(){return String.prototype.trim!==polyfill}});return polyfill}},{"./polyfill":54,"define-properties":11}],56:[function(_dereq_,module,exports){function minMax(val,min,max){return Math.min(Math.max(val,min),max)}function parseEasingParameters(string){return(string=easingFunctionRegex.exec(string))?
string[1].split(",").map(function(p){return parseFloat(p)}):[]}function spring(string,duration){function solver(t){var progress=duration?duration*t/1E3:t;progress=1>zeta?Math.exp(-progress*zeta*w0)*(1*Math.cos(wd*progress)+b*Math.sin(wd*progress)):(1+b*progress)*Math.exp(-progress*w0);return 0===t||1===t?t:1-progress}function getDuration(){var cached=cache.springs[string];if(cached)return cached;cached=1/6;for(var elapsed=0,rest=0;;)if(elapsed+=cached,1===solver(elapsed)){if(rest++,16<=rest)break}else rest=
0;cached=elapsed*cached*1E3;return cache.springs[string]=cached}var params=parseEasingParameters(string),mass=minMax(is.und(params[0])?1:params[0],.1,100),stiffness=minMax(is.und(params[1])?100:params[1],.1,100),damping=minMax(is.und(params[2])?10:params[2],.1,100);params=minMax(is.und(params[3])?0:params[3],.1,100);var w0=Math.sqrt(stiffness/mass),zeta=damping/(2*Math.sqrt(stiffness*mass)),wd=1>zeta?w0*Math.sqrt(1-zeta*zeta):0,b=1>zeta?(zeta*w0+-params)/wd:-params+w0;return duration?solver:getDuration}
function elastic(amplitude,period){void 0===amplitude&&(amplitude=1);void 0===period&&(period=.5);var a=minMax(amplitude,1,10),p=minMax(period,.1,2);return function(t){return 0===t||1===t?t:-a*Math.pow(2,10*(t-1))*Math.sin(2*(t-1-p/(2*Math.PI)*Math.asin(1/a))*Math.PI/p)}}function steps(steps){void 0===steps&&(steps=10);return function(t){return 1/steps*Math.round(t*steps)}}function parseEasings(easing,duration){if(is.fnc(easing))return easing;var name=easing.split("(")[0],ease=penner[name],args=parseEasingParameters(easing);
switch(name){case "spring":return spring(easing,duration);case "cubicBezier":return bezier.apply(null,args);case "steps":return steps.apply(null,args);default:return is.fnc(ease)?ease.apply(null,args):bezier.apply(null,ease)}}function selectString(str){try{return document.querySelectorAll(str)}catch(e$158){}}function filterArray(arr,callback){for(var result=auxArrayFilter,len=arr.length,thisArg=2<=arguments.length?arguments[1]:void 0,i=0;i<len;i++)if(i in arr){var val=arr[i];callback.call(thisArg,
val,i,arr)&&result.push(val)}auxArrayFilter=arr;auxArrayFilter.length=0;return result}function flattenArray(arr,result){result||(result=[]);for(var i=0,length=arr.length;i<length;i++){var value=arr[i];Array.isArray(value)?flattenArray(value,result):result.push(value)}return result}function toArray(o){if(is.arr(o))return o;is.str(o)&&(o=selectString(o)||o);return o instanceof NodeList||o instanceof HTMLCollection?[].slice.call(o):[o]}function arrayContains(arr,val){return arr.some(function(a){return a===
val})}function cloneObject(o){var clone={},p;for(p in o)clone[p]=o[p];return clone}function replaceObjectProps(o1,o2){var o=cloneObject(o1),p;for(p in o1)o[p]=o2.hasOwnProperty(p)?o2[p]:o1[p];return o}function mergeObjects(o1,o2){var o=cloneObject(o1),p;for(p in o2)o[p]=is.und(o1[p])?o2[p]:o1[p];return o}function hexToRgba(hexValue){hexValue=hexValue.replace(hexToRgbaHexRegex,function(m,r,g,b){return r+r+g+g+b+b});var rgb=hexToRgbaRgbRegex.exec(hexValue);hexValue=parseInt(rgb[1],16);var g$jscomp$0=
parseInt(rgb[2],16);rgb=parseInt(rgb[3],16);return"rgba("+hexValue+","+g$jscomp$0+","+rgb+",1)"}function hslToRgba(hslValue){function hue2rgb(p,q,t){0>t&&(t+=1);1<t&&--t;return t<1/6?p+6*(q-p)*t:.5>t?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var hsl=hslToRgbaHsl1Regex.exec(hslValue)||hslToRgbaHsl2Regex.exec(hslValue);hslValue=parseInt(hsl[1],10)/360;var s=parseInt(hsl[2],10)/100,l=parseInt(hsl[3],10)/100;hsl=hsl[4]||1;if(0==s)l=s=hslValue=l;else{var q$jscomp$0=.5>l?l*(1+s):l+s-l*s,p$jscomp$0=2*l-q$jscomp$0;l=hue2rgb(p$jscomp$0,
q$jscomp$0,hslValue+1/3);s=hue2rgb(p$jscomp$0,q$jscomp$0,hslValue);hslValue=hue2rgb(p$jscomp$0,q$jscomp$0,hslValue-1/3)}return"rgba("+255*l+","+255*s+","+255*hslValue+","+hsl+")"}function getUnit(val){if(val=unitRegex.exec(val))return val[2]}function getFunctionValue(val,animatable){return is.fnc(val)?val(animatable.target,animatable.id,animatable.total):val}function convertPxToUnit(el,value,unit){var valueUnit=getUnit(value);if(arrayContains([unit,"deg","rad","turn"],valueUnit))return value;valueUnit=
cache.CSS[value+unit];if(!is.und(valueUnit))return valueUnit;valueUnit=document.createElement(el.tagName);el=el.parentNode&&el.parentNode!==document?el.parentNode:document.body;el.appendChild(valueUnit);valueUnit.style.position="absolute";valueUnit.style.width=100+unit;var factor=100/valueUnit.offsetWidth;el.removeChild(valueUnit);el=factor*parseFloat(value);return cache.CSS[value+unit]=el}function getCSSValue(el,prop,unit){if(prop in el.style){var uppercasePropName=prop.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase();prop=el.style[prop]||getComputedStyle(el).getPropertyValue(uppercasePropName)||"0";return unit?convertPxToUnit(el,prop,unit):prop}}function getAnimationType(el,prop){if(is.dom(el)&&!is.inp(el)&&(el.getAttribute(prop)||is.svg(el)&&el[prop]))return"attribute";if(is.dom(el)&&arrayContains(validTransforms,prop))return"transform";if(is.dom(el)&&"transform"!==prop&&getCSSValue(el,prop))return"css";if(null!=el[prop])return"object"}function getElementTransforms(el){if(is.dom(el)){el=
el.style.transform||"";for(var transforms=new Map,m;m=transformRegex.exec(el);)transforms.set(m[1],m[2]);return transforms}}function getOriginalTargetValue(target,propName,unit,animatable){switch(getAnimationType(target,propName)){case "transform":if(-1<propName.indexOf("scale"))var JSCompiler_temp=1;else JSCompiler_temp=-1<propName.indexOf("translate")||"perspective"===propName?"px":-1<propName.indexOf("rotate")||-1<propName.indexOf("skew")?"deg":void 0,JSCompiler_temp=0+JSCompiler_temp;JSCompiler_temp=
getElementTransforms(target).get(propName)||JSCompiler_temp;animatable&&(animatable.transforms.list.set(propName,JSCompiler_temp),animatable.transforms.last=propName);return unit?convertPxToUnit(target,JSCompiler_temp,unit):JSCompiler_temp;case "css":return getCSSValue(target,propName,unit);case "attribute":return target.getAttribute(propName);default:return target[propName]||0}}function getRelativeValue(to,from){var operator=operatorRegex.exec(to);if(!operator)return to;var u=getUnit(to)||0;from=
parseFloat(from);to=parseFloat(to.replace(operator[0],""));switch(operator[0][0]){case "+":return from+to+u;case "-":return from-to+u;case "*":return from*to+u}}function validateValue(val,unit){if(is.col(val))return val=is.rgb(val)?(unit=rgbRegex.exec(val))?"rgba("+unit[1]+",1)":val:is.hex(val)?hexToRgba(val):is.hsl(val)?hslToRgba(val):void 0,val;var originalUnit=getUnit(val);originalUnit=originalUnit?val.substr(0,val.length-originalUnit.length):val;return unit&&!whitespaceRegex.test(val)?originalUnit+
unit:originalUnit}function getDistance(p1,p2){return Math.sqrt(Math.pow(p2.x-p1.x,2)+Math.pow(p2.y-p1.y,2))}function getPolylineLength(el){el=el.points;for(var totalLength=0,previousPos,i=0;i<el.numberOfItems;i++){var currentPos=el.getItem(i);0<i&&(totalLength+=getDistance(previousPos,currentPos));previousPos=currentPos}return totalLength}function getTotalLength(el){if(el.getTotalLength)return el.getTotalLength();switch(el.tagName.toLowerCase()){case "circle":return 2*Math.PI*el.getAttribute("r");
case "rect":return 2*el.getAttribute("width")+2*el.getAttribute("height");case "line":return getDistance({x:el.getAttribute("x1"),y:el.getAttribute("y1")},{x:el.getAttribute("x2"),y:el.getAttribute("y2")});case "polyline":return getPolylineLength(el);case "polygon":var points=el.points;return getPolylineLength(el)+getDistance(points.getItem(points.numberOfItems-1),points.getItem(0))}}function getParentSvg(pathEl,svgData){svgData=svgData||{};var JSCompiler_temp;if(!(JSCompiler_temp=svgData.el)){for(pathEl=
pathEl.parentNode;is.svg(pathEl)&&(pathEl=pathEl.parentNode,is.svg(pathEl.parentNode)););JSCompiler_temp=pathEl}pathEl=JSCompiler_temp;var rect=pathEl.getBoundingClientRect(),viewBoxAttr=pathEl.getAttribute("viewBox");JSCompiler_temp=rect.width;rect=rect.height;svgData=svgData.viewBox||(viewBoxAttr?viewBoxAttr.split(" "):[0,0,JSCompiler_temp,rect]);return{el:pathEl,viewBox:svgData,x:svgData[0]/1,y:svgData[1]/1,w:JSCompiler_temp/svgData[2],h:rect/svgData[3]}}function getPathProgress(path,progress){function point(offset){void 0===
offset&&(offset=0);return path.el.getPointAtLength(1<=progress+offset?progress+offset:0)}var svg=getParentSvg(path.el,path.svg),p=point(),p0=point(-1),p1=point(1);switch(path.property){case "x":return(p.x-svg.x)*svg.w;case "y":return(p.y-svg.y)*svg.h;case "angle":return 180*Math.atan2(p1.y-p0.y,p1.x-p0.x)/Math.PI}}function decomposeValue(val,unit){var value=validateValue(is.pth(val)?val.totalLength:val,unit)+"";return{original:value,numbers:value.match(valueRegex)?value.match(valueRegex).map(Number):
[0],strings:is.str(val)||unit?value.split(valueRegex):[]}}function parseTargets(targets){targets=targets?flattenArray(is.arr(targets)?targets.map(toArray):toArray(targets)):[];return filterArray(targets,function(item,pos,self){return self.indexOf(item)===pos})}function getAnimatables(targets){var parsed=parseTargets(targets);return parsed.map(function(t,i){return{target:t,id:i,total:parsed.length,transforms:{list:getElementTransforms(t)}}})}function normalizePropertyTweens(prop,tweenSettings){var settings=
cloneObject(tweenSettings);springRegex.test(settings.easing)&&(settings.duration=spring(settings.easing));if(is.arr(prop)){var l=prop.length;2!==l||is.obj(prop[0])?is.fnc(tweenSettings.duration)||(settings.duration=tweenSettings.duration/l):prop={value:prop}}var propArray=is.arr(prop)?prop:[prop];return propArray.map(function(v,i){v=is.obj(v)&&!is.pth(v)?v:{value:v};is.und(v.delay)&&(v.delay=i?0:tweenSettings.delay);is.und(v.endDelay)&&(v.endDelay=i===propArray.length-1?tweenSettings.endDelay:0);
return v}).map(function(k){return mergeObjects(k,settings)})}function flattenKeyframes(keyframes){for(var propertyNames=filterArray(flattenArray(keyframes.map(function(key){return Object.keys(key)})),function(p){return is.key(p)}).reduce(function(a,b){0>a.indexOf(b)&&a.push(b);return a},[]),properties={},loop=function(i){var propName=propertyNames[i];properties[propName]=keyframes.map(function(key){var newKey={},p;for(p in key)is.key(p)?p==propName&&(newKey.value=key[p]):newKey[p]=key[p];return newKey})},
i$jscomp$0=0;i$jscomp$0<propertyNames.length;i$jscomp$0++)loop(i$jscomp$0);return properties}function normalizeTweenValues(tween,animatable){var t={},p;for(p in tween){var value=getFunctionValue(tween[p],animatable);is.arr(value)&&(value=value.map(function(v){return getFunctionValue(v,animatable)}),1===value.length&&(value=value[0]));t[p]=value}t.duration=parseFloat(t.duration);t.delay=parseFloat(t.delay);return t}function normalizeTweens(prop,animatable){var previousTween;return prop.tweens.map(function(t){t=
normalizeTweenValues(t,animatable);var tweenValue=t.value,to=is.arr(tweenValue)?tweenValue[1]:tweenValue,toUnit=getUnit(to),originalValue=getOriginalTargetValue(animatable.target,prop.name,toUnit,animatable),previousValue=previousTween?previousTween.to.original:originalValue,from=is.arr(tweenValue)?tweenValue[0]:previousValue;originalValue=getUnit(from)||getUnit(originalValue);toUnit=toUnit||originalValue;is.und(to)&&(to=previousValue);t.from=decomposeValue(from,toUnit);t.to=decomposeValue(getRelativeValue(to,
from),toUnit);t.start=previousTween?previousTween.end:0;t.end=t.start+t.delay+t.duration+t.endDelay;t.easing=parseEasings(t.easing,t.duration);t.isPath=is.pth(tweenValue);t.isColor=is.col(t.from.original);t.isColor&&(t.round=1);return previousTween=t})}function setTargetsValue(targets,properties){targets=getAnimatables(targets);for(var i=0,len=targets.length;i<len;i++){var animatable=targets[i],property;for(property in properties){var value=getFunctionValue(properties[property],animatable),target=
animatable.target,valueUnit=getUnit(value),originalValue=getOriginalTargetValue(target,property,valueUnit,animatable);valueUnit=valueUnit||getUnit(originalValue);value=getRelativeValue(validateValue(value,valueUnit),originalValue);originalValue=getAnimationType(target,property);setProgressValue[originalValue](target,property,value,animatable.transforms,!0)}}}function getAnimations(animatables,properties){return filterArray(flattenArray(animatables.map(function(animatable){return properties.map(function(prop){var animType=
getAnimationType(animatable.target,prop.name);if(animType){var tweens=normalizeTweens(prop,animatable),lastTween=tweens[tweens.length-1];prop={type:animType,property:prop.name,animatable:animatable,tweens:tweens,duration:lastTween.end,delay:tweens[0].delay,endDelay:lastTween.endDelay}}else prop=void 0;return prop})})),function(a){return!is.und(a)})}function getInstanceTimings(animations,tweenSettings){var animLength=animations.length,timings={};timings.duration=animLength?Math.max.apply(Math,animations.map(function(anim){return(anim.timelineOffset?
anim.timelineOffset:0)+anim.duration})):tweenSettings.duration;timings.delay=animLength?Math.min.apply(Math,animations.map(function(anim){return(anim.timelineOffset?anim.timelineOffset:0)+anim.delay})):tweenSettings.delay;timings.endDelay=animLength?timings.duration-Math.max.apply(Math,animations.map(function(anim){return(anim.timelineOffset?anim.timelineOffset:0)+anim.duration-anim.endDelay})):tweenSettings.endDelay;return timings}function createNewInstance(params$jscomp$0){var instanceSettings=
replaceObjectProps(defaultInstanceSettings,params$jscomp$0),tweenSettings=replaceObjectProps(defaultTweenSettings,params$jscomp$0),params=params$jscomp$0,properties=[],keyframes=params.keyframes;keyframes&&(params=mergeObjects(flattenKeyframes(keyframes),params));for(var p in params)is.key(p)&&properties.push({name:p,tweens:normalizePropertyTweens(params[p],tweenSettings)});params$jscomp$0=getAnimatables(params$jscomp$0.targets);properties=getAnimations(params$jscomp$0,properties);tweenSettings=getInstanceTimings(properties,
tweenSettings);params=instanceID;instanceID++;return mergeObjects(instanceSettings,{id:params,children:[],animatables:params$jscomp$0,animations:properties,duration:tweenSettings.duration,delay:tweenSettings.delay,endDelay:tweenSettings.endDelay})}function anime(params){function makePromise(){return window.Promise&&new Promise(function(_resolve){return resolve=_resolve})}function toggleInstanceDirection(){instance.reversed=!instance.reversed;for(var i=0,len=children.length;i<len;i++)children[i].reversed=
instance.reversed}function adjustTime(time){return instance.reversed?instance.duration-time:time}function resetTime(){startTime=0;lastTime=adjustTime(instance.currentTime)*(1/anime.speed)}function setAnimationsProgress(insTime){for(var i=0,animations=instance.animations,animationsLength=animations.length;i<animationsLength;){var anim=animations[i],animatable=anim.animatable,tweens=anim.tweens,tweenLength=tweens.length-1,tween=tweens[tweenLength];tweenLength&&(tween=filterArray(tweens,function(t){return insTime<
t.end})[0]||tween);tweens=minMax(insTime-tween.start-tween.delay,0,tween.duration)/tween.duration;var eased=isNaN(tweens)?1:tween.easing(tweens);tweens=tween.to.strings;var round=tween.round;tweenLength=[];var toNumbersLength=tween.to.numbers.length,progress=void 0;for(progress=0;progress<toNumbersLength;progress++){var value=void 0;value=tween.to.numbers[progress];var fromNumber=tween.from.numbers[progress]||0;value=tween.isPath?getPathProgress(tween.value,eased*value):fromNumber+eased*(value-fromNumber);
round&&(tween.isColor&&2<progress||(value=Math.round(value*round)/round));tweenLength.push(value)}if(tween=tweens.length)for(progress=tweens[0],eased=0;eased<tween;eased++)round=tweens[eased+1],toNumbersLength=tweenLength[eased],isNaN(toNumbersLength)||(progress=round?progress+(toNumbersLength+round):progress+(toNumbersLength+" "));else progress=tweenLength[0];setProgressValue[anim.type](animatable.target,anim.property,progress,animatable.transforms);anim.currentValue=progress;i++}}function setCallback(cb){if(instance[cb]&&
!instance.passThrough)instance[cb](instance)}function setInstanceProgress(engineTime){var insDuration=instance.duration,insDelay=instance.delay,insEndDelay=insDuration-instance.endDelay,insTime=adjustTime(engineTime);instance.progress=minMax(insTime/insDuration*100,0,100);instance.reversePlayback=insTime<instance.currentTime;if(children)if(instance.reversePlayback)for(var i$1=childrenLength;i$1--;){var child=children[i$1];child&&child.seek(insTime-child.timelineOffset)}else for(i$1=0;i$1<childrenLength;i$1++)(child=
children[i$1])&&child.seek(insTime-child.timelineOffset);!instance.began&&0<instance.currentTime&&(instance.began=!0,setCallback("begin"),setCallback("loopBegin"));insTime<=insDelay&&0!==instance.currentTime&&setAnimationsProgress(0);(insTime>=insEndDelay&&instance.currentTime!==insDuration||!insDuration)&&setAnimationsProgress(insDuration);insTime>insDelay&&insTime<insEndDelay?(instance.changeBegan||(instance.changeBegan=!0,instance.changeCompleted=!1,setCallback("changeBegin")),setCallback("change"),
setAnimationsProgress(insTime)):instance.changeBegan&&(instance.changeCompleted=!0,instance.changeBegan=!1,setCallback("changeComplete"));instance.currentTime=minMax(insTime,0,insDuration);instance.began&&setCallback("update");engineTime>=insDuration&&(lastTime=0,instance.remaining&&!0!==instance.remaining&&instance.remaining--,instance.remaining?(startTime=now,setCallback("loopComplete"),setCallback("loopBegin"),"alternate"===instance.direction&&toggleInstanceDirection()):(instance.paused=!0,instance.completed||
(instance.completed=!0,setCallback("loopComplete"),setCallback("complete"),"Promise"in window&&(resolve(),promise=makePromise()))))}void 0===params&&(params={});var startTime=0,lastTime=0,now=0,children,childrenLength=0,resolve=null,promise=makePromise(),instance=createNewInstance(params);instance.reset=function(){var direction=instance.direction;instance.passThrough=!1;instance.currentTime=0;instance.progress=0;instance.paused=!0;instance.began=!1;instance.changeBegan=!1;instance.completed=!1;instance.changeCompleted=
!1;instance.reversePlayback=!1;instance.reversed="reverse"===direction;instance.remaining=instance.loop;children=instance.children;for(var i=childrenLength=children.length;i--;)instance.children[i].reset();(instance.reversed&&!0!==instance.loop||"alternate"===direction&&1===instance.loop)&&instance.remaining++;setAnimationsProgress(0)};instance.set=function(targets,properties){setTargetsValue(targets,properties);return instance};instance.tick=function(t){now=t;startTime||(startTime=now);setInstanceProgress((now+
(lastTime-startTime))*anime.speed)};instance.seek=function(time){setInstanceProgress(adjustTime(time))};instance.pause=function(){instance.paused=!0;resetTime()};instance.play=function(){instance.paused&&(instance.paused=!1,activeInstances.push(instance),resetTime(),raf||engine())};instance.reverse=function(){toggleInstanceDirection();resetTime()};instance.restart=function(){instance.reset();instance.play()};instance.finished=promise;instance.reset();instance.autoplay&&instance.play();return instance}
function removeTargetsFromAnimations(targetsArray,animations){for(var a=animations.length;a--;)arrayContains(targetsArray,animations[a].animatable.target)&&animations.splice(a,1)}var defaultInstanceSettings={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},defaultTweenSettings={duration:1E3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},validTransforms="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skew skewX skewY perspective".split(" "),
cache={CSS:{},springs:{}},hexRegex=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,rgbPrefixRegex=/^rgb/,hslRegex=/^hsl/,is={arr:function(a){return Array.isArray(a)},obj:function(a){return-1<Object.prototype.toString.call(a).indexOf("Object")},pth:function(a){return is.obj(a)&&a.hasOwnProperty("totalLength")},svg:function(a){return a instanceof SVGElement},inp:function(a){return a instanceof HTMLInputElement},dom:function(a){return a.nodeType||is.svg(a)},str:function(a){return"string"===typeof a},fnc:function(a){return"function"===
typeof a},und:function(a){return"undefined"===typeof a},hex:function(a){return hexRegex.test(a)},rgb:function(a){return rgbPrefixRegex.test(a)},hsl:function(a){return hslRegex.test(a)},col:function(a){return is.hex(a)||is.rgb(a)||is.hsl(a)},key:function(a){return!defaultInstanceSettings.hasOwnProperty(a)&&!defaultTweenSettings.hasOwnProperty(a)&&"targets"!==a&&"keyframes"!==a}},easingFunctionRegex=/\(([^)]+)\)/,bezier=function(){function calcBezier(aT,aA1,aA2){return(((1-3*aA2+3*aA1)*aT+(3*aA2-6*
aA1))*aT+3*aA1)*aT}return function(mX1,mY1,mX2,mY2){if(0<=mX1&&1>=mX1&&0<=mX2&&1>=mX2){var sampleValues=new Float32Array(11);if(mX1!==mY1||mX2!==mY2)for(var i$jscomp$0=0;11>i$jscomp$0;++i$jscomp$0)sampleValues[i$jscomp$0]=calcBezier(.1*i$jscomp$0,mX1,mX2);return function(x){if(mX1===mY1&&mX2===mY2||0===x||1===x)return x;for(var intervalStart=0,currentSample=1;10!==currentSample&&sampleValues[currentSample]<=x;++currentSample)intervalStart+=.1;--currentSample;currentSample=intervalStart+(x-sampleValues[currentSample])/
(sampleValues[currentSample+1]-sampleValues[currentSample])*.1;var initialSlope=3*(1-3*mX2+3*mX1)*currentSample*currentSample+2*(3*mX2-6*mX1)*currentSample+3*mX1;if(.001<=initialSlope){for(intervalStart=0;4>intervalStart;++intervalStart){initialSlope=3*(1-3*mX2+3*mX1)*currentSample*currentSample+2*(3*mX2-6*mX1)*currentSample+3*mX1;if(0===initialSlope)break;var currentX=calcBezier(currentSample,mX1,mX2)-x;currentSample-=currentX/initialSlope}x=currentSample}else if(0===initialSlope)x=currentSample;
else{currentSample=intervalStart;intervalStart+=.1;var i=0;do currentX=currentSample+(intervalStart-currentSample)/2,initialSlope=calcBezier(currentX,mX1,mX2)-x,0<initialSlope?intervalStart=currentX:currentSample=currentX;while(1E-7<Math.abs(initialSlope)&&10>++i);x=currentX}return calcBezier(x,mY1,mY2)}}}}(),penner=function(){var names="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),curves={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,
.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],elastic],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(a,p){return function(t){return 1-elastic(a,p)(1-t)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(a,p){return function(t){return.5>t?elastic(a,p)(2*t)/2:1-elastic(a,
p)(-2*t+2)/2}}]},eases={linear:[.25,.25,.75,.75]},coords;for(coords in curves)for(var i=0,len=curves[coords].length;i<len;i++)eases["ease"+coords+names[i]]=curves[coords][i];return eases}(),auxArrayFilter=[],rgbRegex=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g,hexToRgbaHexRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,hexToRgbaRgbRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,hslToRgbaHsl1Regex=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,hslToRgbaHsl2Regex=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g,
unitRegex=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/,transformRegex=/(\w+)\(([^)]*)\)/g,operatorRegex=/^(\*=|\+=|-=)/,whitespaceRegex=/\s/g,valueRegex=/-?\d*\.?\d+/g,springRegex=/^spring/,setProgressValue={css:function(t,p,v){return t.style[p]=v},attribute:function(t,p,v){return t.setAttribute(p,v)},object:function(t,p,v){return t[p]=v},transform:function(t,p,v,transforms,manual){transforms.list.set(p,v);if(p===transforms.last||manual){var str="";transforms.list.forEach(function(value,
prop){str+=prop+"("+value+") "});t.style.transform=str}}},instanceID=0,activeInstances=[],pausedInstances=[],raf,engine=function(){function play(){raf=requestAnimationFrame(step)}function step(t){var activeInstancesLength=activeInstances.length;if(activeInstancesLength){for(var i=0;i<activeInstancesLength;){var activeInstance=activeInstances[i];activeInstance.paused?(activeInstance=activeInstances.indexOf(activeInstance),-1<activeInstance&&(activeInstances.splice(activeInstance,1),activeInstancesLength=
activeInstances.length)):activeInstance.tick(t);i++}play()}else raf=cancelAnimationFrame(raf)}return play}();document.addEventListener("visibilitychange",function(){if(document.hidden){for(var i=0,len=activeInstances.length;i<len;i++)activeInstance[i].pause();pausedInstances=activeInstances.slice(0);activeInstances=[]}else for(i=0,len=pausedInstances.length;i<len;i++)pausedInstances[i].play()});anime.version="3.0.0";anime.speed=1;anime.running=activeInstances;anime.remove=function(targets){targets=
parseTargets(targets);for(var i=activeInstances.length;i--;){var instance=activeInstances[i],animations=instance.animations,children=instance.children;removeTargetsFromAnimations(targets,animations);for(var c=children.length;c--;){var child=children[c],childAnimations=child.animations;removeTargetsFromAnimations(targets,childAnimations);childAnimations.length||child.children.length||children.splice(c,1)}animations.length||children.length||instance.pause()}};anime.get=getOriginalTargetValue;anime.set=
setTargetsValue;anime.convertPx=convertPxToUnit;anime.path=function(path,percent){var pathEl=is.str(path)?selectString(path)[0]:path,p=percent||100;return function(property){return{property:property,el:pathEl,svg:getParentSvg(pathEl),totalLength:getTotalLength(pathEl)*(p/100)}}};anime.setDashoffset=function(el){var pathLength=getTotalLength(el);el.setAttribute("stroke-dasharray",pathLength);return pathLength};anime.stagger=function(val$jscomp$0,params){void 0===params&&(params={});var direction=params.direction||
"normal",easing=params.easing?parseEasings(params.easing):null,grid=params.grid,axis=params.axis,fromIndex=params.from||0,fromFirst="first"===fromIndex,fromCenter="center"===fromIndex,fromLast="last"===fromIndex,isRange=is.arr(val$jscomp$0),val1=isRange?parseFloat(val$jscomp$0[0]):parseFloat(val$jscomp$0),val2=isRange?parseFloat(val$jscomp$0[1]):0,unit=getUnit(isRange?val$jscomp$0[1]:val$jscomp$0)||0,start=params.start||0+(isRange?val1:0),values=[],maxValue=0;return function(el,i,t){fromFirst&&(fromIndex=
0);fromCenter&&(fromIndex=(t-1)/2);fromLast&&(fromIndex=t-1);if(!values.length){for(el=0;el<t;el++){if(grid){var distanceX=(fromCenter?(grid[0]-1)/2:fromIndex%grid[0])-el%grid[0],distanceY=(fromCenter?(grid[1]-1)/2:Math.floor(fromIndex/grid[0]))-Math.floor(el/grid[0]),value=Math.sqrt(distanceX*distanceX+distanceY*distanceY);"x"===axis&&(value=-distanceX);"y"===axis&&(value=-distanceY);values.push(value)}else values.push(Math.abs(fromIndex-el));maxValue=Math.max.apply(Math,values)}easing&&(values=
values.map(function(val){return easing(val/maxValue)*maxValue}));"reverse"===direction&&(values=values.map(function(val){return axis?0>val?-1*val:-val:Math.abs(maxValue-val)}))}return start+Math.round(100*values[i])/100*(isRange?(val2-val1)/maxValue:val1)+unit}};anime.timeline=function(params){void 0===params&&(params={});var tl=anime(params);tl.duration=0;tl.add=function(instanceParams,timelineOffset){var tlIndex=activeInstances.indexOf(tl),children=tl.children;-1<tlIndex&&activeInstances.splice(tlIndex,
1);for(tlIndex=0;tlIndex<children.length;tlIndex++)children[tlIndex].passThrough=!0;instanceParams=mergeObjects(instanceParams,replaceObjectProps(defaultTweenSettings,params));instanceParams.targets=instanceParams.targets||params.targets;tlIndex=tl.duration;instanceParams.autoplay=!1;instanceParams.direction=tl.direction;instanceParams.timelineOffset=is.und(timelineOffset)?tlIndex:getRelativeValue(timelineOffset,tlIndex);tl.passThrough=!0;tl.seek(instanceParams.timelineOffset);timelineOffset=anime(instanceParams);
timelineOffset.passThrough=!0;children.push(timelineOffset);children=getInstanceTimings(children,params);tl.delay=children.delay;tl.endDelay=children.endDelay;tl.duration=children.duration;tl.seek(0);tl.reset();tl.autoplay&&tl.play();return tl};return tl};anime.easing=parseEasings;anime.penner=penner;anime.random=function(min,max){return Math.floor(Math.random()*(max-min+1))+min};module.exports=anime},{}],57:[function(_dereq_,module,exports$jscomp$0){(function(global,factory){"object"===typeof exports$jscomp$0&&
"undefined"!==typeof module?factory(exports$jscomp$0):(global="undefined"!==typeof globalThis?globalThis:global||self,factory(global.THREE={}))})(this,function(exports){function EventDispatcher(){}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,
protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function Texture(image,
mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding){void 0===image&&(image=Texture.DEFAULT_IMAGE);void 0===mapping&&(mapping=Texture.DEFAULT_MAPPING);void 0===wrapS&&(wrapS=1001);void 0===wrapT&&(wrapT=1001);void 0===magFilter&&(magFilter=1006);void 0===minFilter&&(minFilter=1008);void 0===format&&(format=1023);void 0===type&&(type=1009);void 0===anisotropy&&(anisotropy=1);void 0===encoding&&(encoding=3E3);Object.defineProperty(this,"id",{value:textureId++});this.uuid=MathUtils.generateUUID();
this.name="";this.image=image;this.mipmaps=[];this.mapping=mapping;this.wrapS=wrapS;this.wrapT=wrapT;this.magFilter=magFilter;this.minFilter=minFilter;this.anisotropy=anisotropy;this.format=format;this.internalFormat=null;this.type=type;this.offset=new Vector2(0,0);this.repeat=new Vector2(1,1);this.center=new Vector2(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new Matrix3;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=encoding;this.version=
0;this.onUpdate=null}function serializeImage(image){if("undefined"!==typeof HTMLImageElement&&image instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&image instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&image instanceof ImageBitmap)return ImageUtils.getDataURL(image);if(image.data)return{data:Array.prototype.slice.call(image.data),width:image.width,height:image.height,type:image.data.constructor.name};console.warn("THREE.Texture: Unable to serialize Texture.");
return{}}function WebGLRenderTarget(width,height,options){this.width=width;this.height=height;this.scissor=new Vector4(0,0,width,height);this.scissorTest=!1;this.viewport=new Vector4(0,0,width,height);options=options||{};this.texture=new Texture(void 0,options.mapping,options.wrapS,options.wrapT,options.magFilter,options.minFilter,options.format,options.type,options.anisotropy,options.encoding);this.texture.image={};this.texture.image.width=width;this.texture.image.height=height;this.texture.generateMipmaps=
void 0!==options.generateMipmaps?options.generateMipmaps:!1;this.texture.minFilter=void 0!==options.minFilter?options.minFilter:1006;this.depthBuffer=void 0!==options.depthBuffer?options.depthBuffer:!0;this.stencilBuffer=void 0!==options.stencilBuffer?options.stencilBuffer:!1;this.depthTexture=void 0!==options.depthTexture?options.depthTexture:null}function WebGLMultisampleRenderTarget(width,height,options){WebGLRenderTarget.call(this,width,height,options);this.samples=4}function satForAxes(axes,
v0,v1,v2,extents){for(var i=0,j=axes.length-3;i<=j;i+=3){_testAxis.fromArray(axes,i);var r=extents.x*Math.abs(_testAxis.x)+extents.y*Math.abs(_testAxis.y)+extents.z*Math.abs(_testAxis.z),p0=v0.dot(_testAxis),p1=v1.dot(_testAxis),p2=v2.dot(_testAxis);if(Math.max(-Math.max(p0,p1,p2),Math.min(p0,p1,p2))>r)return!1}return!0}function Object3D(){Object.defineProperty(this,"id",{value:_object3DId++});this.uuid=MathUtils.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=
Object3D.DefaultUp.clone();var position=new Vector3,rotation=new Euler,quaternion=new Quaternion,scale=new Vector3(1,1,1);rotation._onChange(function(){quaternion.setFromEuler(rotation,!1)});quaternion._onChange(function(){rotation.setFromQuaternion(quaternion,void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:position},rotation:{configurable:!0,enumerable:!0,value:rotation},quaternion:{configurable:!0,enumerable:!0,value:quaternion},scale:{configurable:!0,enumerable:!0,
value:scale},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}});this.matrix=new Matrix4;this.matrixWorld=new Matrix4;this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Layers;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.animations=[];this.userData={}}function hue2rgb(p,q,t){0>t&&(t+=1);1<t&&--t;return t<1/6?p+6*(q-p)*t:.5>t?q:t<2/3?p+6*(q-p)*(2/3-t):p}function SRGBToLinear(c){return.04045>
c?.0773993808*c:Math.pow(.9478672986*c+.0521327014,2.4)}function LinearToSRGB(c){return.0031308>c?12.92*c:1.055*Math.pow(c,.41666)-.055}function Material(){Object.defineProperty(this,"id",{value:materialId++});this.uuid=MathUtils.generateUUID();this.name="";this.type="Material";this.fog=!0;this.blending=1;this.side=0;this.vertexColors=this.flatShading=!1;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=
null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.stencilWriteMask=255;this.stencilFunc=519;this.stencilRef=0;this.stencilFuncMask=255;this.stencilZPass=this.stencilZFail=this.stencilFail=7680;this.stencilWrite=!1;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.toneMapped=
this.visible=!0;this.userData={};this.version=0}function MeshBasicMaterial(parameters){Material.call(this);this.type="MeshBasicMaterial";this.color=new Color(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphTargets=this.skinning=!1;this.setValues(parameters)}
function BufferAttribute(array,itemSize,normalized){if(Array.isArray(array))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=array;this.itemSize=itemSize;this.count=void 0!==array?array.length/itemSize:0;this.normalized=!0===normalized;this.usage=35044;this.updateRange={offset:0,count:-1};this.version=0}function Int8BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Int8Array(array),itemSize,normalized)}function Uint8BufferAttribute(array,
itemSize,normalized){BufferAttribute.call(this,new Uint8Array(array),itemSize,normalized)}function Uint8ClampedBufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Uint8ClampedArray(array),itemSize,normalized)}function Int16BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Int16Array(array),itemSize,normalized)}function Uint16BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Uint16Array(array),itemSize,normalized)}function Int32BufferAttribute(array,
itemSize,normalized){BufferAttribute.call(this,new Int32Array(array),itemSize,normalized)}function Uint32BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Uint32Array(array),itemSize,normalized)}function Float16BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Uint16Array(array),itemSize,normalized)}function Float32BufferAttribute(array,itemSize,normalized){BufferAttribute.call(this,new Float32Array(array),itemSize,normalized)}function Float64BufferAttribute(array,
itemSize,normalized){BufferAttribute.call(this,new Float64Array(array),itemSize,normalized)}function arrayMax(array){if(0===array.length)return-Infinity;for(var max=array[0],i=1,l=array.length;i<l;++i)array[i]>max&&(max=array[i]);return max}function BufferGeometry(){Object.defineProperty(this,"id",{value:_bufferGeometryId+=2});this.uuid=MathUtils.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=!1;this.groups=
[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}function Mesh(geometry,material){Object3D.call(this);this.type="Mesh";this.geometry=void 0!==geometry?geometry:new BufferGeometry;this.material=void 0!==material?material:new MeshBasicMaterial;this.updateMorphTargets()}function checkIntersection(object,material,raycaster,ray,pA,pB,pC,point){if(null===(1===material.side?ray.intersectTriangle(pC,pB,pA,!0,point):ray.intersectTriangle(pA,pB,pC,2!==material.side,
point)))return null;_intersectionPointWorld.copy(point);_intersectionPointWorld.applyMatrix4(object.matrixWorld);material=raycaster.ray.origin.distanceTo(_intersectionPointWorld);return material<raycaster.near||material>raycaster.far?null:{distance:material,point:_intersectionPointWorld.clone(),object:object}}function checkBufferGeometryIntersection(object,material,raycaster,ray,position,morphPosition,morphTargetsRelative,uv,uv2,a,b,c){_vA.fromBufferAttribute(position,a);_vB.fromBufferAttribute(position,
b);_vC.fromBufferAttribute(position,c);position=object.morphTargetInfluences;if(material.morphTargets&&morphPosition&&position){_morphA.set(0,0,0);_morphB.set(0,0,0);_morphC.set(0,0,0);for(var i=0,il=morphPosition.length;i<il;i++){var influence=position[i],morphAttribute=morphPosition[i];0!==influence&&(_tempA.fromBufferAttribute(morphAttribute,a),_tempB.fromBufferAttribute(morphAttribute,b),_tempC.fromBufferAttribute(morphAttribute,c),morphTargetsRelative?(_morphA.addScaledVector(_tempA,influence),
_morphB.addScaledVector(_tempB,influence),_morphC.addScaledVector(_tempC,influence)):(_morphA.addScaledVector(_tempA.sub(_vA),influence),_morphB.addScaledVector(_tempB.sub(_vB),influence),_morphC.addScaledVector(_tempC.sub(_vC),influence)))}_vA.add(_morphA);_vB.add(_morphB);_vC.add(_morphC)}object.isSkinnedMesh&&(object.boneTransform(a,_vA),object.boneTransform(b,_vB),object.boneTransform(c,_vC));if(object=checkIntersection(object,material,raycaster,ray,_vA,_vB,_vC,_intersectionPoint))uv&&(_uvA.fromBufferAttribute(uv,
a),_uvB.fromBufferAttribute(uv,b),_uvC.fromBufferAttribute(uv,c),object.uv=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),uv2&&(_uvA.fromBufferAttribute(uv2,a),_uvB.fromBufferAttribute(uv2,b),_uvC.fromBufferAttribute(uv2,c),object.uv2=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),uv=new Face3(a,b,c),Triangle.getNormal(_vA,_vB,_vC,uv.normal),object.face=uv;return object}function cloneUniforms(src){var dst={},u;for(u in src){dst[u]={};for(var p in src[u]){var property=
src[u][p];property&&(property.isColor||property.isMatrix3||property.isMatrix4||property.isVector2||property.isVector3||property.isVector4||property.isTexture)?dst[u][p]=property.clone():Array.isArray(property)?dst[u][p]=property.slice():dst[u][p]=property}}return dst}function mergeUniforms(uniforms){for(var merged={},u=0;u<uniforms.length;u++){var tmp=cloneUniforms(uniforms[u]),p;for(p in tmp)merged[p]=tmp[p]}return merged}function ShaderMaterial(parameters){Material.call(this);this.type="ShaderMaterial";
this.defines={};this.uniforms={};this.vertexShader="\nvoid main() {\n\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n";this.fragmentShader="\nvoid main() {\n\tgl_FragColor \x3d vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues=
{color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.glslVersion=null;void 0!==parameters&&(void 0!==parameters.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(parameters))}function Camera(){Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new Matrix4;this.projectionMatrix=new Matrix4;this.projectionMatrixInverse=new Matrix4}function PerspectiveCamera(fov,
aspect,near,far){void 0===fov&&(fov=50);void 0===aspect&&(aspect=1);void 0===near&&(near=.1);void 0===far&&(far=2E3);Camera.call(this);this.type="PerspectiveCamera";this.fov=fov;this.zoom=1;this.near=near;this.far=far;this.focus=10;this.aspect=aspect;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function CubeCamera(near,far,renderTarget){Object3D.call(this);this.type="CubeCamera";if(!0!==renderTarget.isWebGLCubeRenderTarget)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");
else{this.renderTarget=renderTarget;var cameraPX=new PerspectiveCamera(90,1,near,far);cameraPX.layers=this.layers;cameraPX.up.set(0,-1,0);cameraPX.lookAt(new Vector3(1,0,0));this.add(cameraPX);var cameraNX=new PerspectiveCamera(90,1,near,far);cameraNX.layers=this.layers;cameraNX.up.set(0,-1,0);cameraNX.lookAt(new Vector3(-1,0,0));this.add(cameraNX);var cameraPY=new PerspectiveCamera(90,1,near,far);cameraPY.layers=this.layers;cameraPY.up.set(0,0,1);cameraPY.lookAt(new Vector3(0,1,0));this.add(cameraPY);
var cameraNY=new PerspectiveCamera(90,1,near,far);cameraNY.layers=this.layers;cameraNY.up.set(0,0,-1);cameraNY.lookAt(new Vector3(0,-1,0));this.add(cameraNY);var cameraPZ=new PerspectiveCamera(90,1,near,far);cameraPZ.layers=this.layers;cameraPZ.up.set(0,-1,0);cameraPZ.lookAt(new Vector3(0,0,1));this.add(cameraPZ);var cameraNZ=new PerspectiveCamera(90,1,near,far);cameraNZ.layers=this.layers;cameraNZ.up.set(0,-1,0);cameraNZ.lookAt(new Vector3(0,0,-1));this.add(cameraNZ);this.update=function(renderer,
scene){null===this.parent&&this.updateMatrixWorld();var currentXrEnabled=renderer.xr.enabled,currentRenderTarget=renderer.getRenderTarget();renderer.xr.enabled=!1;var generateMipmaps=renderTarget.texture.generateMipmaps;renderTarget.texture.generateMipmaps=!1;renderer.setRenderTarget(renderTarget,0);renderer.render(scene,cameraPX);renderer.setRenderTarget(renderTarget,1);renderer.render(scene,cameraNX);renderer.setRenderTarget(renderTarget,2);renderer.render(scene,cameraPY);renderer.setRenderTarget(renderTarget,
3);renderer.render(scene,cameraNY);renderer.setRenderTarget(renderTarget,4);renderer.render(scene,cameraPZ);renderTarget.texture.generateMipmaps=generateMipmaps;renderer.setRenderTarget(renderTarget,5);renderer.render(scene,cameraNZ);renderer.setRenderTarget(currentRenderTarget);renderer.xr.enabled=currentXrEnabled}}}function CubeTexture(images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding){images=void 0!==images?images:[];Texture.call(this,images,void 0!==mapping?mapping:
301,wrapS,wrapT,magFilter,minFilter,void 0!==format?format:1022,type,anisotropy,encoding);this.flipY=!1;this._needsFlipEnvMap=!0}function WebGLCubeRenderTarget(size,options,dummy){Number.isInteger(options)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),options=dummy);WebGLRenderTarget.call(this,size,size,options);options=options||{};this.texture=new CubeTexture(void 0,options.mapping,options.wrapS,options.wrapT,options.magFilter,
options.minFilter,options.format,options.type,options.anisotropy,options.encoding);this.texture._needsFlipEnvMap=!1}function DataTexture(data,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy,encoding){Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding);this.image={data:data||null,width:width||1,height:height||1};this.magFilter=void 0!==magFilter?magFilter:1003;this.minFilter=void 0!==minFilter?minFilter:1003;this.flipY=this.generateMipmaps=
!1;this.unpackAlignment=1;this.needsUpdate=!0}function WebGLAnimation(){function onAnimationFrame(time,frame){animationLoop(time,frame);requestId=context.requestAnimationFrame(onAnimationFrame)}var context=null,isAnimating=!1,animationLoop=null,requestId=null;return{start:function(){!0!==isAnimating&&null!==animationLoop&&(requestId=context.requestAnimationFrame(onAnimationFrame),isAnimating=!0)},stop:function(){context.cancelAnimationFrame(requestId);isAnimating=!1},setAnimationLoop:function(callback){animationLoop=
callback},setContext:function(value){context=value}}}function WebGLAttributes(gl,capabilities){function createBuffer(attribute,bufferType){var array=attribute.array,usage=attribute.usage,buffer=gl.createBuffer();gl.bindBuffer(bufferType,buffer);gl.bufferData(bufferType,array,usage);attribute.onUploadCallback();bufferType=5126;array instanceof Float32Array?bufferType=5126:array instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):array instanceof
Uint16Array?attribute.isFloat16BufferAttribute?isWebGL2?bufferType=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):bufferType=5123:array instanceof Int16Array?bufferType=5122:array instanceof Uint32Array?bufferType=5125:array instanceof Int32Array?bufferType=5124:array instanceof Int8Array?bufferType=5120:array instanceof Uint8Array&&(bufferType=5121);return{buffer:buffer,type:bufferType,bytesPerElement:array.BYTES_PER_ELEMENT,version:attribute.version}}
var isWebGL2=capabilities.isWebGL2,buffers=new WeakMap;return{get:function(attribute){attribute.isInterleavedBufferAttribute&&(attribute=attribute.data);return buffers.get(attribute)},remove:function(attribute){attribute.isInterleavedBufferAttribute&&(attribute=attribute.data);var data=buffers.get(attribute);data&&(gl.deleteBuffer(data.buffer),buffers.delete(attribute))},update:function(attribute,bufferType){if(attribute.isGLBufferAttribute)bufferType=buffers.get(attribute),(!bufferType||bufferType.version<
attribute.version)&&buffers.set(attribute,{buffer:attribute.buffer,type:attribute.type,bytesPerElement:attribute.elementSize,version:attribute.version});else{attribute.isInterleavedBufferAttribute&&(attribute=attribute.data);var data=buffers.get(attribute);if(void 0===data)buffers.set(attribute,createBuffer(attribute,bufferType));else if(data.version<attribute.version){var array=attribute.array,updateRange=attribute.updateRange;gl.bindBuffer(bufferType,data.buffer);-1===updateRange.count?gl.bufferSubData(bufferType,
0,array):(isWebGL2?gl.bufferSubData(bufferType,updateRange.offset*array.BYTES_PER_ELEMENT,array,updateRange.offset,updateRange.count):gl.bufferSubData(bufferType,updateRange.offset*array.BYTES_PER_ELEMENT,array.subarray(updateRange.offset,updateRange.offset+updateRange.count)),updateRange.count=-1);data.version=attribute.version}}}}}function WebGLBackground(renderer$jscomp$0,cubemaps,state,objects,premultipliedAlpha){function setClear(color,alpha){state.buffers.color.setClear(color.r,color.g,color.b,
alpha,premultipliedAlpha)}var clearColor=new Color(0),clearAlpha=0,planeMesh,boxMesh,currentBackground=null,currentBackgroundVersion=0,currentTonemapping=null;return{getClearColor:function(){return clearColor},setClearColor:function(color,alpha){void 0===alpha&&(alpha=1);clearColor.set(color);clearAlpha=alpha;setClear(clearColor,clearAlpha)},getClearAlpha:function(){return clearAlpha},setClearAlpha:function(alpha){clearAlpha=alpha;setClear(clearColor,clearAlpha)},render:function(renderList,scene$jscomp$0,
camera$jscomp$0,forceClear){(scene$jscomp$0=!0===scene$jscomp$0.isScene?scene$jscomp$0.background:null)&&scene$jscomp$0.isTexture&&(scene$jscomp$0=cubemaps.get(scene$jscomp$0));camera$jscomp$0=renderer$jscomp$0.xr;(camera$jscomp$0=camera$jscomp$0.getSession&&camera$jscomp$0.getSession())&&"additive"===camera$jscomp$0.environmentBlendMode&&(scene$jscomp$0=null);null===scene$jscomp$0?setClear(clearColor,clearAlpha):scene$jscomp$0&&scene$jscomp$0.isColor&&(setClear(scene$jscomp$0,1),forceClear=!0);(renderer$jscomp$0.autoClear||
forceClear)&&renderer$jscomp$0.clear(renderer$jscomp$0.autoClearColor,renderer$jscomp$0.autoClearDepth,renderer$jscomp$0.autoClearStencil);if(scene$jscomp$0&&(scene$jscomp$0.isCubeTexture||scene$jscomp$0.isWebGLCubeRenderTarget||306===scene$jscomp$0.mapping)){void 0===boxMesh&&(boxMesh=new Mesh(new BoxBufferGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.cube.uniforms),vertexShader:ShaderLib.cube.vertexShader,fragmentShader:ShaderLib.cube.fragmentShader,
side:1,depthTest:!1,depthWrite:!1,fog:!1})),boxMesh.geometry.deleteAttribute("normal"),boxMesh.geometry.deleteAttribute("uv"),boxMesh.onBeforeRender=function(renderer,scene,camera){this.matrixWorld.copyPosition(camera.matrixWorld)},Object.defineProperty(boxMesh.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),objects.update(boxMesh));scene$jscomp$0.isWebGLCubeRenderTarget&&(scene$jscomp$0=scene$jscomp$0.texture);boxMesh.material.uniforms.envMap.value=scene$jscomp$0;boxMesh.material.uniforms.flipEnvMap.value=
scene$jscomp$0.isCubeTexture&&scene$jscomp$0._needsFlipEnvMap?-1:1;if(currentBackground!==scene$jscomp$0||currentBackgroundVersion!==scene$jscomp$0.version||currentTonemapping!==renderer$jscomp$0.toneMapping)boxMesh.material.needsUpdate=!0,currentBackground=scene$jscomp$0,currentBackgroundVersion=scene$jscomp$0.version,currentTonemapping=renderer$jscomp$0.toneMapping;renderList.unshift(boxMesh,boxMesh.geometry,boxMesh.material,0,0,null)}else if(scene$jscomp$0&&scene$jscomp$0.isTexture){void 0===planeMesh&&
(planeMesh=new Mesh(new PlaneBufferGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),planeMesh.geometry.deleteAttribute("normal"),Object.defineProperty(planeMesh.material,"map",{get:function(){return this.uniforms.t2D.value}}),objects.update(planeMesh));planeMesh.material.uniforms.t2D.value=scene$jscomp$0;
!0===scene$jscomp$0.matrixAutoUpdate&&scene$jscomp$0.updateMatrix();planeMesh.material.uniforms.uvTransform.value.copy(scene$jscomp$0.matrix);if(currentBackground!==scene$jscomp$0||currentBackgroundVersion!==scene$jscomp$0.version||currentTonemapping!==renderer$jscomp$0.toneMapping)planeMesh.material.needsUpdate=!0,currentBackground=scene$jscomp$0,currentBackgroundVersion=scene$jscomp$0.version,currentTonemapping=renderer$jscomp$0.toneMapping;renderList.unshift(planeMesh,planeMesh.geometry,planeMesh.material,
0,0,null)}}}}function WebGLBindingStates(gl,extensions,attributes,capabilities){function bindVertexArrayObject(vao){return capabilities.isWebGL2?gl.bindVertexArray(vao):extension.bindVertexArrayOES(vao)}function deleteVertexArrayObject(vao){return capabilities.isWebGL2?gl.deleteVertexArray(vao):extension.deleteVertexArrayOES(vao)}function createBindingState(vao){for(var newAttributes=[],enabledAttributes=[],attributeDivisors=[],i=0;i<maxVertexAttributes;i++)newAttributes[i]=0,enabledAttributes[i]=
0,attributeDivisors[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:newAttributes,enabledAttributes:enabledAttributes,attributeDivisors:attributeDivisors,object:vao,attributes:{},index:null}}function initAttributes(){for(var newAttributes=currentState.newAttributes,i=0,il=newAttributes.length;i<il;i++)newAttributes[i]=0}function enableAttribute(attribute){enableAttributeAndDivisor(attribute,0)}function enableAttributeAndDivisor(attribute,meshPerAttribute){var enabledAttributes=currentState.enabledAttributes,
attributeDivisors=currentState.attributeDivisors;currentState.newAttributes[attribute]=1;0===enabledAttributes[attribute]&&(gl.enableVertexAttribArray(attribute),enabledAttributes[attribute]=1);attributeDivisors[attribute]!==meshPerAttribute&&((capabilities.isWebGL2?gl:extensions.get("ANGLE_instanced_arrays"))[capabilities.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](attribute,meshPerAttribute),attributeDivisors[attribute]=meshPerAttribute)}function disableUnusedAttributes(){for(var newAttributes=
currentState.newAttributes,enabledAttributes=currentState.enabledAttributes,i=0,il=enabledAttributes.length;i<il;i++)enabledAttributes[i]!==newAttributes[i]&&(gl.disableVertexAttribArray(i),enabledAttributes[i]=0)}function reset(){resetDefaultState();currentState!==defaultState&&(currentState=defaultState,bindVertexArrayObject(currentState.object))}function resetDefaultState(){defaultState.geometry=null;defaultState.program=null;defaultState.wireframe=!1}var maxVertexAttributes=gl.getParameter(34921),
extension=capabilities.isWebGL2?null:extensions.get("OES_vertex_array_object"),vaoAvailable=capabilities.isWebGL2||null!==extension,bindingStates={},defaultState=createBindingState(null),currentState=defaultState;return{setup:function(object,material,program,geometry,index){var updateBuffers=!1;if(vaoAvailable){updateBuffers=!0===material.wireframe;var programMap=bindingStates[geometry.id];void 0===programMap&&(programMap={},bindingStates[geometry.id]=programMap);var stateMap=programMap[program.id];
void 0===stateMap&&(stateMap={},programMap[program.id]=stateMap);programMap=stateMap[updateBuffers];void 0===programMap&&(programMap=createBindingState(capabilities.isWebGL2?gl.createVertexArray():extension.createVertexArrayOES()),stateMap[updateBuffers]=programMap);updateBuffers=programMap;currentState!==updateBuffers&&(currentState=updateBuffers,bindVertexArrayObject(currentState.object));a:{updateBuffers=currentState.attributes;stateMap=geometry.attributes;programMap=0;for(var key in stateMap){var cachedAttribute=
updateBuffers[key],geometryAttribute=stateMap[key];if(void 0===cachedAttribute||cachedAttribute.attribute!==geometryAttribute||cachedAttribute.data!==geometryAttribute.data){updateBuffers=!0;break a}programMap++}updateBuffers=currentState.attributesNum!==programMap||currentState.index!==index?!0:!1}if(updateBuffers){key={};stateMap=geometry.attributes;programMap=0;for(var key$jscomp$0 in stateMap)cachedAttribute=stateMap[key$jscomp$0],geometryAttribute={},geometryAttribute.attribute=cachedAttribute,
cachedAttribute.data&&(geometryAttribute.data=cachedAttribute.data),key[key$jscomp$0]=geometryAttribute,programMap++;currentState.attributes=key;currentState.attributesNum=programMap;currentState.index=index}}else if(key$jscomp$0=!0===material.wireframe,currentState.geometry!==geometry.id||currentState.program!==program.id||currentState.wireframe!==key$jscomp$0)currentState.geometry=geometry.id,currentState.program=program.id,currentState.wireframe=key$jscomp$0,updateBuffers=!0;!0===object.isInstancedMesh&&
(updateBuffers=!0);null!==index&&attributes.update(index,34963);if(updateBuffers){if(!1!==capabilities.isWebGL2||!object.isInstancedMesh&&!geometry.isInstancedBufferGeometry||null!==extensions.get("ANGLE_instanced_arrays")){initAttributes();key$jscomp$0=geometry.attributes;program=program.getAttributes();material=material.defaultAttributeValues;for(var name in program)if(updateBuffers=program[name],0<=updateBuffers){var geometryAttribute$jscomp$0=key$jscomp$0[name];if(void 0!==geometryAttribute$jscomp$0){if(key=
geometryAttribute$jscomp$0.normalized,cachedAttribute=geometryAttribute$jscomp$0.itemSize,programMap=attributes.get(geometryAttribute$jscomp$0),void 0!==programMap){var buffer=programMap.buffer;stateMap=programMap.type;programMap=programMap.bytesPerElement;if(geometryAttribute$jscomp$0.isInterleavedBufferAttribute){var data=geometryAttribute$jscomp$0.data;geometryAttribute=data.stride;geometryAttribute$jscomp$0=geometryAttribute$jscomp$0.offset;data&&data.isInstancedInterleavedBuffer?(enableAttributeAndDivisor(updateBuffers,
data.meshPerAttribute),void 0===geometry._maxInstanceCount&&(geometry._maxInstanceCount=data.meshPerAttribute*data.count)):enableAttribute(updateBuffers);gl.bindBuffer(34962,buffer);geometryAttribute*=programMap;programMap*=geometryAttribute$jscomp$0;!0!==capabilities.isWebGL2||5124!==stateMap&&5125!==stateMap?gl.vertexAttribPointer(updateBuffers,cachedAttribute,stateMap,key,geometryAttribute,programMap):gl.vertexAttribIPointer(updateBuffers,cachedAttribute,stateMap,geometryAttribute,programMap)}else geometryAttribute$jscomp$0.isInstancedBufferAttribute?
(enableAttributeAndDivisor(updateBuffers,geometryAttribute$jscomp$0.meshPerAttribute),void 0===geometry._maxInstanceCount&&(geometry._maxInstanceCount=geometryAttribute$jscomp$0.meshPerAttribute*geometryAttribute$jscomp$0.count)):enableAttribute(updateBuffers),gl.bindBuffer(34962,buffer),programMap=cachedAttribute,!0!==capabilities.isWebGL2||5124!==stateMap&&5125!==stateMap?gl.vertexAttribPointer(updateBuffers,programMap,stateMap,key,0,0):gl.vertexAttribIPointer(updateBuffers,programMap,stateMap,
0,0)}}else if("instanceMatrix"===name)stateMap=attributes.get(object.instanceMatrix),void 0!==stateMap&&(key=stateMap.buffer,stateMap=stateMap.type,enableAttributeAndDivisor(updateBuffers+0,1),enableAttributeAndDivisor(updateBuffers+1,1),enableAttributeAndDivisor(updateBuffers+2,1),enableAttributeAndDivisor(updateBuffers+3,1),gl.bindBuffer(34962,key),gl.vertexAttribPointer(updateBuffers+0,4,stateMap,!1,64,0),gl.vertexAttribPointer(updateBuffers+1,4,stateMap,!1,64,16),gl.vertexAttribPointer(updateBuffers+
2,4,stateMap,!1,64,32),gl.vertexAttribPointer(updateBuffers+3,4,stateMap,!1,64,48));else if("instanceColor"===name)stateMap=attributes.get(object.instanceColor),void 0!==stateMap&&(key=stateMap.buffer,stateMap=stateMap.type,enableAttributeAndDivisor(updateBuffers,1),gl.bindBuffer(34962,key),gl.vertexAttribPointer(updateBuffers,3,stateMap,!1,12,0));else if(void 0!==material&&(key=material[name],void 0!==key))switch(key.length){case 2:gl.vertexAttrib2fv(updateBuffers,key);break;case 3:gl.vertexAttrib3fv(updateBuffers,
key);break;case 4:gl.vertexAttrib4fv(updateBuffers,key);break;default:gl.vertexAttrib1fv(updateBuffers,key)}}disableUnusedAttributes()}null!==index&&gl.bindBuffer(34963,attributes.get(index).buffer)}},reset:reset,resetDefaultState:resetDefaultState,dispose:function(){reset();for(var geometryId in bindingStates){var programMap=bindingStates[geometryId],programId;for(programId in programMap){var stateMap=programMap[programId],wireframe;for(wireframe in stateMap)deleteVertexArrayObject(stateMap[wireframe].object),
delete stateMap[wireframe];delete programMap[programId]}delete bindingStates[geometryId]}},releaseStatesOfGeometry:function(geometry){if(void 0!==bindingStates[geometry.id]){var programMap=bindingStates[geometry.id],programId;for(programId in programMap){var stateMap=programMap[programId],wireframe;for(wireframe in stateMap)deleteVertexArrayObject(stateMap[wireframe].object),delete stateMap[wireframe];delete programMap[programId]}delete bindingStates[geometry.id]}},releaseStatesOfProgram:function(program){for(var geometryId in bindingStates){var programMap=
bindingStates[geometryId];if(void 0!==programMap[program.id]){var stateMap=programMap[program.id],wireframe;for(wireframe in stateMap)deleteVertexArrayObject(stateMap[wireframe].object),delete stateMap[wireframe];delete programMap[program.id]}}},initAttributes:initAttributes,enableAttribute:enableAttribute,disableUnusedAttributes:disableUnusedAttributes}}function WebGLBufferRenderer(gl,extensions,info,capabilities){var isWebGL2=capabilities.isWebGL2,mode;this.setMode=function(value){mode=value};this.render=
function(start,count){gl.drawArrays(mode,start,count);info.update(count,mode,1)};this.renderInstances=function(start,count,primcount){if(0!==primcount){if(isWebGL2){var extension=gl;var methodName="drawArraysInstanced"}else if(extension=extensions.get("ANGLE_instanced_arrays"),methodName="drawArraysInstancedANGLE",null===extension){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}extension[methodName](mode,
start,count,primcount);info.update(count,mode,primcount)}}}function WebGLCapabilities(gl,extensions,parameters){function getMaxPrecision(precision){if("highp"===precision){if(0<gl.getShaderPrecisionFormat(35633,36338).precision&&0<gl.getShaderPrecisionFormat(35632,36338).precision)return"highp";precision="mediump"}return"mediump"===precision&&0<gl.getShaderPrecisionFormat(35633,36337).precision&&0<gl.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var maxAnisotropy,isWebGL2="undefined"!==
typeof WebGL2RenderingContext&&gl instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&gl instanceof WebGL2ComputeRenderingContext,precision$jscomp$0=void 0!==parameters.precision?parameters.precision:"highp",maxPrecision=getMaxPrecision(precision$jscomp$0);maxPrecision!==precision$jscomp$0&&(console.warn("THREE.WebGLRenderer:",precision$jscomp$0,"not supported, using",maxPrecision,"instead."),precision$jscomp$0=maxPrecision);parameters=!0===parameters.logarithmicDepthBuffer;
maxPrecision=gl.getParameter(34930);var maxVertexTextures=gl.getParameter(35660),maxTextureSize=gl.getParameter(3379),maxCubemapSize=gl.getParameter(34076),maxAttributes=gl.getParameter(34921),maxVertexUniforms=gl.getParameter(36347),maxVaryings=gl.getParameter(36348),maxFragmentUniforms=gl.getParameter(36349),vertexTextures=0<maxVertexTextures,floatFragmentTextures=isWebGL2||!!extensions.get("OES_texture_float"),floatVertexTextures=vertexTextures&&floatFragmentTextures,maxSamples=isWebGL2?gl.getParameter(36183):
0;return{isWebGL2:isWebGL2,getMaxAnisotropy:function(){if(void 0!==maxAnisotropy)return maxAnisotropy;var extension=extensions.get("EXT_texture_filter_anisotropic");return maxAnisotropy=null!==extension?gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:getMaxPrecision,precision:precision$jscomp$0,logarithmicDepthBuffer:parameters,maxTextures:maxPrecision,maxVertexTextures:maxVertexTextures,maxTextureSize:maxTextureSize,maxCubemapSize:maxCubemapSize,maxAttributes:maxAttributes,
maxVertexUniforms:maxVertexUniforms,maxVaryings:maxVaryings,maxFragmentUniforms:maxFragmentUniforms,vertexTextures:vertexTextures,floatFragmentTextures:floatFragmentTextures,floatVertexTextures:floatVertexTextures,maxSamples:maxSamples}}function WebGLClipping(properties){function resetGlobalState(){uniform.value!==globalState&&(uniform.value=globalState,uniform.needsUpdate=0<numGlobalPlanes);scope.numPlanes=numGlobalPlanes;scope.numIntersection=0}function projectPlanes(planes,camera,dstOffset,skipTransform){var nPlanes=
null!==planes?planes.length:0,dstArray=null;if(0!==nPlanes){dstArray=uniform.value;if(!0!==skipTransform||null===dstArray){skipTransform=dstOffset+4*nPlanes;camera=camera.matrixWorldInverse;viewNormalMatrix.getNormalMatrix(camera);if(null===dstArray||dstArray.length<skipTransform)dstArray=new Float32Array(skipTransform);for(skipTransform=0;skipTransform!==nPlanes;++skipTransform,dstOffset+=4)plane.copy(planes[skipTransform]).applyMatrix4(camera,viewNormalMatrix),plane.normal.toArray(dstArray,dstOffset),
dstArray[dstOffset+3]=plane.constant}uniform.value=dstArray;uniform.needsUpdate=!0}scope.numPlanes=nPlanes;scope.numIntersection=0;return dstArray}var scope=this,globalState=null,numGlobalPlanes=0,localClippingEnabled=!1,renderingShadows=!1,plane=new Plane,viewNormalMatrix=new Matrix3,uniform={value:null,needsUpdate:!1};this.uniform=uniform;this.numIntersection=this.numPlanes=0;this.init=function(planes,enableLocalClipping,camera){var enabled=0!==planes.length||enableLocalClipping||0!==numGlobalPlanes||
localClippingEnabled;localClippingEnabled=enableLocalClipping;globalState=projectPlanes(planes,camera,0);numGlobalPlanes=planes.length;return enabled};this.beginShadows=function(){renderingShadows=!0;projectPlanes(null)};this.endShadows=function(){renderingShadows=!1;resetGlobalState()};this.setState=function(material,camera,useCache){var planes=material.clippingPlanes,clipIntersection=material.clipIntersection,clipShadows=material.clipShadows;material=properties.get(material);if(!localClippingEnabled||
null===planes||0===planes.length||renderingShadows&&!clipShadows)renderingShadows?projectPlanes(null):resetGlobalState();else{clipShadows=renderingShadows?0:numGlobalPlanes;var lGlobal=4*clipShadows,dstArray=material.clippingState||null;uniform.value=dstArray;dstArray=projectPlanes(planes,camera,lGlobal,useCache);for(camera=0;camera!==lGlobal;++camera)dstArray[camera]=globalState[camera];material.clippingState=dstArray;this.numIntersection=clipIntersection?this.numPlanes:0;this.numPlanes+=clipShadows}}}
function WebGLCubeMaps(renderer){function mapTextureMapping(texture,mapping){303===mapping?texture.mapping=301:304===mapping&&(texture.mapping=302);return texture}function onTextureDispose(event){event=event.target;event.removeEventListener("dispose",onTextureDispose);var cubemap=cubemaps.get(event);void 0!==cubemap&&(cubemaps.delete(event),cubemap.dispose())}var cubemaps=new WeakMap;return{get:function(texture){if(texture&&texture.isTexture){var mapping=texture.mapping;if(303===mapping||304===mapping){if(cubemaps.has(texture))return mapping=
cubemaps.get(texture).texture,mapTextureMapping(mapping,texture.mapping);var image=texture.image;if(image&&0<image.height){mapping=renderer.getRenderList();var currentRenderTarget=renderer.getRenderTarget(),currentRenderState=renderer.getRenderState();image=new WebGLCubeRenderTarget(image.height/2);image.fromEquirectangularTexture(renderer,texture);cubemaps.set(texture,image);renderer.setRenderTarget(currentRenderTarget);renderer.setRenderList(mapping);renderer.setRenderState(currentRenderState);
texture.addEventListener("dispose",onTextureDispose);return mapTextureMapping(image.texture,texture.mapping)}return null}}return texture},dispose:function(){cubemaps=new WeakMap}}}function WebGLExtensions(gl){var extensions={};return{has:function(name){if(void 0!==extensions[name])return null!==extensions[name];switch(name){case "WEBGL_depth_texture":var extension=gl.getExtension("WEBGL_depth_texture")||gl.getExtension("MOZ_WEBGL_depth_texture")||gl.getExtension("WEBKIT_WEBGL_depth_texture");break;
case "EXT_texture_filter_anisotropic":extension=gl.getExtension("EXT_texture_filter_anisotropic")||gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":extension=gl.getExtension("WEBGL_compressed_texture_s3tc")||gl.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":extension=gl.getExtension("WEBGL_compressed_texture_pvrtc")||
gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:extension=gl.getExtension(name)}extensions[name]=extension;return null!==extension},get:function(name){this.has(name)||console.warn("THREE.WebGLRenderer: "+name+" extension not supported.");return extensions[name]}}}function WebGLGeometries(gl,attributes,info,bindingStates){function onGeometryDispose(event){event=event.target;var buffergeometry=geometries.get(event);null!==buffergeometry.index&&attributes.remove(buffergeometry.index);
for(var name in buffergeometry.attributes)attributes.remove(buffergeometry.attributes[name]);event.removeEventListener("dispose",onGeometryDispose);geometries.delete(event);if(name=wireframeAttributes.get(buffergeometry))attributes.remove(name),wireframeAttributes.delete(buffergeometry);bindingStates.releaseStatesOfGeometry(buffergeometry);!0===event.isInstancedBufferGeometry&&delete event._maxInstanceCount;info.memory.geometries--}function updateWireframeAttribute(geometry){var indices=[],geometryIndex=
geometry.index,geometryPosition=geometry.attributes.position;if(null!==geometryIndex){geometryPosition=geometryIndex.array;geometryIndex=geometryIndex.version;for(var i=0,l=geometryPosition.length;i<l;i+=3){var a=geometryPosition[i+0],b=geometryPosition[i+1],c=geometryPosition[i+2];indices.push(a,b,b,c,c,a)}}else for(i=geometryPosition.array,geometryIndex=geometryPosition.version,geometryPosition=0,i=i.length/3-1;geometryPosition<i;geometryPosition+=3)l=geometryPosition+0,a=geometryPosition+1,b=geometryPosition+
2,indices.push(l,a,a,b,b,l);indices=new (65535<arrayMax(indices)?Uint32BufferAttribute:Uint16BufferAttribute)(indices,1);indices.version=geometryIndex;(geometryIndex=wireframeAttributes.get(geometry))&&attributes.remove(geometryIndex);wireframeAttributes.set(geometry,indices)}var geometries=new WeakMap,wireframeAttributes=new WeakMap;return{get:function(object,geometry){var buffergeometry=geometries.get(geometry);if(buffergeometry)return buffergeometry;geometry.addEventListener("dispose",onGeometryDispose);
geometry.isBufferGeometry?buffergeometry=geometry:geometry.isGeometry&&(void 0===geometry._bufferGeometry&&(geometry._bufferGeometry=(new BufferGeometry).setFromObject(object)),buffergeometry=geometry._bufferGeometry);geometries.set(geometry,buffergeometry);info.memory.geometries++;return buffergeometry},update:function(geometry){var geometryAttributes=geometry.attributes;for(name in geometryAttributes)attributes.update(geometryAttributes[name],34962);geometry=geometry.morphAttributes;for(var _name in geometry){geometryAttributes=
geometry[_name];var name=0;for(var l=geometryAttributes.length;name<l;name++)attributes.update(geometryAttributes[name],34962)}},getWireframeAttribute:function(geometry){var currentAttribute=wireframeAttributes.get(geometry);if(currentAttribute){var geometryIndex=geometry.index;null!==geometryIndex&&currentAttribute.version<geometryIndex.version&&updateWireframeAttribute(geometry)}else updateWireframeAttribute(geometry);return wireframeAttributes.get(geometry)}}}function WebGLIndexedBufferRenderer(gl,
extensions,info,capabilities){var isWebGL2=capabilities.isWebGL2,mode,type,bytesPerElement;this.setMode=function(value){mode=value};this.setIndex=function(value){type=value.type;bytesPerElement=value.bytesPerElement};this.render=function(start,count){gl.drawElements(mode,count,type,start*bytesPerElement);info.update(count,mode,1)};this.renderInstances=function(start,count,primcount){if(0!==primcount){if(isWebGL2){var extension=gl;var methodName="drawElementsInstanced"}else if(extension=extensions.get("ANGLE_instanced_arrays"),
methodName="drawElementsInstancedANGLE",null===extension){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}extension[methodName](mode,count,type,start*bytesPerElement,primcount);info.update(count,mode,primcount)}}}function WebGLInfo(gl){var render={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:render,programs:null,autoReset:!0,reset:function(){render.frame++;
render.calls=0;render.triangles=0;render.points=0;render.lines=0},update:function(count,mode,instanceCount){render.calls++;switch(mode){case 4:render.triangles+=count/3*instanceCount;break;case 1:render.lines+=count/2*instanceCount;break;case 3:render.lines+=instanceCount*(count-1);break;case 2:render.lines+=instanceCount*count;break;case 0:render.points+=instanceCount*count;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",mode)}}}}function numericalSort(a,b){return a[0]-b[0]}function absNumericalSort(a,
b){return Math.abs(b[1])-Math.abs(a[1])}function WebGLMorphtargets(gl){for(var influencesList={},morphInfluences=new Float32Array(8),workInfluences=[],i=0;8>i;i++)workInfluences[i]=[i,0];return{update:function(object,geometry,material,program){var objectInfluences=object.morphTargetInfluences;object=void 0===objectInfluences?0:objectInfluences.length;var influences=influencesList[geometry.id];if(void 0===influences){influences=[];for(var _i=0;_i<object;_i++)influences[_i]=[_i,0];influencesList[geometry.id]=
influences}for(_i=0;_i<object;_i++){var influence=influences[_i];influence[0]=_i;influence[1]=objectInfluences[_i]}influences.sort(absNumericalSort);for(objectInfluences=0;8>objectInfluences;objectInfluences++)objectInfluences<object&&influences[objectInfluences][1]?(workInfluences[objectInfluences][0]=influences[objectInfluences][0],workInfluences[objectInfluences][1]=influences[objectInfluences][1]):(workInfluences[objectInfluences][0]=Number.MAX_SAFE_INTEGER,workInfluences[objectInfluences][1]=
0);workInfluences.sort(numericalSort);object=material.morphTargets&&geometry.morphAttributes.position;material=material.morphNormals&&geometry.morphAttributes.normal;for(objectInfluences=influences=0;8>objectInfluences;objectInfluences++)influence=workInfluences[objectInfluences],_i=influence[0],influence=influence[1],_i!==Number.MAX_SAFE_INTEGER&&influence?(object&&geometry.getAttribute("morphTarget"+objectInfluences)!==object[_i]&&geometry.setAttribute("morphTarget"+objectInfluences,object[_i]),
material&&geometry.getAttribute("morphNormal"+objectInfluences)!==material[_i]&&geometry.setAttribute("morphNormal"+objectInfluences,material[_i]),morphInfluences[objectInfluences]=influence,influences+=influence):(object&&!0===geometry.hasAttribute("morphTarget"+objectInfluences)&&geometry.deleteAttribute("morphTarget"+objectInfluences),material&&!0===geometry.hasAttribute("morphNormal"+objectInfluences)&&geometry.deleteAttribute("morphNormal"+objectInfluences),morphInfluences[objectInfluences]=
0);geometry=geometry.morphTargetsRelative?1:1-influences;program.getUniforms().setValue(gl,"morphTargetBaseInfluence",geometry);program.getUniforms().setValue(gl,"morphTargetInfluences",morphInfluences)}}}function WebGLObjects(gl,geometries,attributes,info){var updateMap=new WeakMap;return{update:function(object){var frame=info.render.frame,geometry=object.geometry,buffergeometry=geometries.get(object,geometry);updateMap.get(buffergeometry)!==frame&&(geometry.isGeometry&&buffergeometry.updateFromObject(object),
geometries.update(buffergeometry),updateMap.set(buffergeometry,frame));object.isInstancedMesh&&(attributes.update(object.instanceMatrix,34962),null!==object.instanceColor&&attributes.update(object.instanceColor,34962));return buffergeometry},dispose:function(){updateMap=new WeakMap}}}function DataTexture2DArray(data,width,height,depth){void 0===data&&(data=null);void 0===width&&(width=1);void 0===height&&(height=1);void 0===depth&&(depth=1);Texture.call(this,null);this.image={data:data,width:width,
height:height,depth:depth};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.needsUpdate=!0}function DataTexture3D(data,width,height,depth){void 0===data&&(data=null);void 0===width&&(width=1);void 0===height&&(height=1);void 0===depth&&(depth=1);Texture.call(this,null);this.image={data:data,width:width,height:height,depth:depth};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.needsUpdate=!0}function flatten(array,
nBlocks,blockSize){var firstElem=array[0];if(0>=firstElem||0<firstElem)return array;var n=nBlocks*blockSize,r=arrayCacheF32[n];void 0===r&&(r=new Float32Array(n),arrayCacheF32[n]=r);if(0!==nBlocks)for(firstElem.toArray(r,0),firstElem=1,n=0;firstElem!==nBlocks;++firstElem)n+=blockSize,array[firstElem].toArray(r,n);return r}function arraysEqual(a,b){if(a.length!==b.length)return!1;for(var i=0,l=a.length;i<l;i++)if(a[i]!==b[i])return!1;return!0}function copyArray(a,b){for(var i=0,l=b.length;i<l;i++)a[i]=
b[i]}function allocTexUnits(textures,n){var r=arrayCacheI32[n];void 0===r&&(r=new Int32Array(n),arrayCacheI32[n]=r);for(var i=0;i!==n;++i)r[i]=textures.allocateTextureUnit();return r}function setValueV1f(gl,v){var cache=this.cache;cache[0]!==v&&(gl.uniform1f(this.addr,v),cache[0]=v)}function setValueV2f(gl,v){var cache=this.cache;if(void 0!==v.x){if(cache[0]!==v.x||cache[1]!==v.y)gl.uniform2f(this.addr,v.x,v.y),cache[0]=v.x,cache[1]=v.y}else arraysEqual(cache,v)||(gl.uniform2fv(this.addr,v),copyArray(cache,
v))}function setValueV3f(gl,v){var cache=this.cache;if(void 0!==v.x){if(cache[0]!==v.x||cache[1]!==v.y||cache[2]!==v.z)gl.uniform3f(this.addr,v.x,v.y,v.z),cache[0]=v.x,cache[1]=v.y,cache[2]=v.z}else if(void 0!==v.r){if(cache[0]!==v.r||cache[1]!==v.g||cache[2]!==v.b)gl.uniform3f(this.addr,v.r,v.g,v.b),cache[0]=v.r,cache[1]=v.g,cache[2]=v.b}else arraysEqual(cache,v)||(gl.uniform3fv(this.addr,v),copyArray(cache,v))}function setValueV4f(gl,v){var cache=this.cache;if(void 0!==v.x){if(cache[0]!==v.x||cache[1]!==
v.y||cache[2]!==v.z||cache[3]!==v.w)gl.uniform4f(this.addr,v.x,v.y,v.z,v.w),cache[0]=v.x,cache[1]=v.y,cache[2]=v.z,cache[3]=v.w}else arraysEqual(cache,v)||(gl.uniform4fv(this.addr,v),copyArray(cache,v))}function setValueM2(gl,v){var cache=this.cache,elements=v.elements;void 0===elements?arraysEqual(cache,v)||(gl.uniformMatrix2fv(this.addr,!1,v),copyArray(cache,v)):arraysEqual(cache,elements)||(mat2array.set(elements),gl.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(cache,elements))}function setValueM3(gl,
v){var cache=this.cache,elements=v.elements;void 0===elements?arraysEqual(cache,v)||(gl.uniformMatrix3fv(this.addr,!1,v),copyArray(cache,v)):arraysEqual(cache,elements)||(mat3array.set(elements),gl.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(cache,elements))}function setValueM4(gl,v){var cache=this.cache,elements=v.elements;void 0===elements?arraysEqual(cache,v)||(gl.uniformMatrix4fv(this.addr,!1,v),copyArray(cache,v)):arraysEqual(cache,elements)||(mat4array.set(elements),gl.uniformMatrix4fv(this.addr,
!1,mat4array),copyArray(cache,elements))}function setValueT1(gl,v,textures){var cache=this.cache,unit=textures.allocateTextureUnit();cache[0]!==unit&&(gl.uniform1i(this.addr,unit),cache[0]=unit);textures.safeSetTexture2D(v||emptyTexture,unit)}function setValueT2DArray1(gl,v,textures){var cache=this.cache,unit=textures.allocateTextureUnit();cache[0]!==unit&&(gl.uniform1i(this.addr,unit),cache[0]=unit);textures.setTexture2DArray(v||emptyTexture2dArray,unit)}function setValueT3D1(gl,v,textures){var cache=
this.cache,unit=textures.allocateTextureUnit();cache[0]!==unit&&(gl.uniform1i(this.addr,unit),cache[0]=unit);textures.setTexture3D(v||emptyTexture3d,unit)}function setValueT6(gl,v,textures){var cache=this.cache,unit=textures.allocateTextureUnit();cache[0]!==unit&&(gl.uniform1i(this.addr,unit),cache[0]=unit);textures.safeSetTextureCube(v||emptyCubeTexture,unit)}function setValueV1i(gl,v){var cache=this.cache;cache[0]!==v&&(gl.uniform1i(this.addr,v),cache[0]=v)}function setValueV2i(gl,v){var cache=
this.cache;arraysEqual(cache,v)||(gl.uniform2iv(this.addr,v),copyArray(cache,v))}function setValueV3i(gl,v){var cache=this.cache;arraysEqual(cache,v)||(gl.uniform3iv(this.addr,v),copyArray(cache,v))}function setValueV4i(gl,v){var cache=this.cache;arraysEqual(cache,v)||(gl.uniform4iv(this.addr,v),copyArray(cache,v))}function setValueV1ui(gl,v){var cache=this.cache;cache[0]!==v&&(gl.uniform1ui(this.addr,v),cache[0]=v)}function getSingularSetter(type){switch(type){case 5126:return setValueV1f;case 35664:return setValueV2f;
case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;
case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(gl,v){gl.uniform1fv(this.addr,v)}function setValueV1iArray(gl,v){gl.uniform1iv(this.addr,v)}function setValueV2iArray(gl,v){gl.uniform2iv(this.addr,v)}function setValueV3iArray(gl,v){gl.uniform3iv(this.addr,v)}function setValueV4iArray(gl,v){gl.uniform4iv(this.addr,v)}function setValueV2fArray(gl,v){v=flatten(v,this.size,2);gl.uniform2fv(this.addr,v)}function setValueV3fArray(gl,v){v=flatten(v,this.size,
3);gl.uniform3fv(this.addr,v)}function setValueV4fArray(gl,v){v=flatten(v,this.size,4);gl.uniform4fv(this.addr,v)}function setValueM2Array(gl,v){v=flatten(v,this.size,4);gl.uniformMatrix2fv(this.addr,!1,v)}function setValueM3Array(gl,v){v=flatten(v,this.size,9);gl.uniformMatrix3fv(this.addr,!1,v)}function setValueM4Array(gl,v){v=flatten(v,this.size,16);gl.uniformMatrix4fv(this.addr,!1,v)}function setValueT1Array(gl,v,textures){var n=v.length,units=allocTexUnits(textures,n);gl.uniform1iv(this.addr,
units);for(gl=0;gl!==n;++gl)textures.safeSetTexture2D(v[gl]||emptyTexture,units[gl])}function setValueT6Array(gl,v,textures){var n=v.length,units=allocTexUnits(textures,n);gl.uniform1iv(this.addr,units);for(gl=0;gl!==n;++gl)textures.safeSetTextureCube(v[gl]||emptyCubeTexture,units[gl])}function getPureArraySetter(type){switch(type){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;
case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35680:case 36300:case 36308:case 36293:return setValueT6Array}}function SingleUniform(id,activeInfo,addr){this.id=id;this.addr=addr;this.cache=[];this.setValue=getSingularSetter(activeInfo.type)}
function PureArrayUniform(id,activeInfo,addr){this.id=id;this.addr=addr;this.cache=[];this.size=activeInfo.size;this.setValue=getPureArraySetter(activeInfo.type)}function StructuredUniform(id){this.id=id;this.seq=[];this.map={}}function WebGLUniforms(gl,program){this.seq=[];this.map={};for(var n=gl.getProgramParameter(program,35718),i=0;i<n;++i){var info=gl.getActiveUniform(program,i),addr=gl.getUniformLocation(program,info.name),container=this,path=info.name,pathLength=path.length;for(RePathPart.lastIndex=
0;;){var match=RePathPart.exec(path),matchEnd=RePathPart.lastIndex,id=match[1],subscript=match[3];"]"===match[2]&&(id|=0);if(void 0===subscript||"["===subscript&&matchEnd+2===pathLength){path=container;info=void 0===subscript?new SingleUniform(id,info,addr):new PureArrayUniform(id,info,addr);path.seq.push(info);path.map[info.id]=info;break}else subscript=container.map[id],void 0===subscript&&(subscript=new StructuredUniform(id),id=container,container=subscript,id.seq.push(container),id.map[container.id]=
container),container=subscript}}}function WebGLShader(gl,type,string){type=gl.createShader(type);gl.shaderSource(type,string);gl.compileShader(type);return type}function getEncodingComponents(encoding){switch(encoding){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];
case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",encoding),["Linear","( value )"]}}function getShaderErrors(gl,shader,type){var status=gl.getShaderParameter(shader,35713),log=gl.getShaderInfoLog(shader).trim();if(status&&""===log)return"";gl=gl.getShaderSource(shader).split("\n");for(shader=0;shader<gl.length;shader++)gl[shader]=shader+1+": "+gl[shader];gl=gl.join("\n");return"THREE.WebGLShader: gl.getShaderInfoLog() "+type+"\n"+log+gl}
function getTexelDecodingFunction(functionName,encoding){encoding=getEncodingComponents(encoding);return"vec4 "+functionName+"( vec4 value ) { return "+encoding[0]+"ToLinear"+encoding[1]+"; }"}function getTexelEncodingFunction(functionName,encoding){encoding=getEncodingComponents(encoding);return"vec4 "+functionName+"( vec4 value ) { return LinearTo"+encoding[0]+encoding[1]+"; }"}function getToneMappingFunction(functionName,toneMapping){switch(toneMapping){case 1:toneMapping="Linear";break;case 2:toneMapping=
"Reinhard";break;case 3:toneMapping="OptimizedCineon";break;case 4:toneMapping="ACESFilmic";break;case 5:toneMapping="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",toneMapping),toneMapping="Linear"}return"vec3 "+functionName+"( vec3 color ) { return "+toneMapping+"ToneMapping( color ); }"}function generateDefines(defines){var chunks=[],name;for(name in defines){var value=defines[name];!1!==value&&chunks.push("#define "+name+" "+value)}return chunks.join("\n")}function filterEmptyLine(string){return""!==
string}function replaceLightNums(string,parameters){return string.replace(/NUM_DIR_LIGHTS/g,parameters.numDirLights).replace(/NUM_SPOT_LIGHTS/g,parameters.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,parameters.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,parameters.numPointLights).replace(/NUM_HEMI_LIGHTS/g,parameters.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,parameters.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,parameters.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,
parameters.numPointLightShadows)}function replaceClippingPlaneNums(string,parameters){return string.replace(/NUM_CLIPPING_PLANES/g,parameters.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,parameters.numClippingPlanes-parameters.numClipIntersection)}function includeReplacer(match,include){match=ShaderChunk[include];if(void 0===match)throw Error("Can not resolve #include \x3c"+include+"\x3e");return match.replace(includePattern,includeReplacer)}function deprecatedLoopReplacer(match,start,end,
snippet){console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.");return loopReplacer(match,start,end,snippet)}function loopReplacer(match,start,end,snippet){match="";for(start=parseInt(start);start<parseInt(end);start++)match+=snippet.replace(/\[\s*i\s*\]/g,"[ "+start+" ]").replace(/UNROLLED_LOOP_INDEX/g,start);return match}function generatePrecision(parameters){var precisionstring="precision "+parameters.precision+" float;\nprecision "+
parameters.precision+" int;";"highp"===parameters.precision?precisionstring+="\n#define HIGH_PRECISION":"mediump"===parameters.precision?precisionstring+="\n#define MEDIUM_PRECISION":"lowp"===parameters.precision&&(precisionstring+="\n#define LOW_PRECISION");return precisionstring}function generateShadowMapTypeDefine(parameters){var shadowMapTypeDefine="SHADOWMAP_TYPE_BASIC";1===parameters.shadowMapType?shadowMapTypeDefine="SHADOWMAP_TYPE_PCF":2===parameters.shadowMapType?shadowMapTypeDefine="SHADOWMAP_TYPE_PCF_SOFT":
3===parameters.shadowMapType&&(shadowMapTypeDefine="SHADOWMAP_TYPE_VSM");return shadowMapTypeDefine}function generateEnvMapTypeDefine(parameters){var envMapTypeDefine="ENVMAP_TYPE_CUBE";if(parameters.envMap)switch(parameters.envMapMode){case 301:case 302:envMapTypeDefine="ENVMAP_TYPE_CUBE";break;case 306:case 307:envMapTypeDefine="ENVMAP_TYPE_CUBE_UV"}return envMapTypeDefine}function generateEnvMapModeDefine(parameters){var envMapModeDefine="ENVMAP_MODE_REFLECTION";if(parameters.envMap)switch(parameters.envMapMode){case 302:case 307:envMapModeDefine=
"ENVMAP_MODE_REFRACTION"}return envMapModeDefine}function generateEnvMapBlendingDefine(parameters){var envMapBlendingDefine="ENVMAP_BLENDING_NONE";if(parameters.envMap)switch(parameters.combine){case 0:envMapBlendingDefine="ENVMAP_BLENDING_MULTIPLY";break;case 1:envMapBlendingDefine="ENVMAP_BLENDING_MIX";break;case 2:envMapBlendingDefine="ENVMAP_BLENDING_ADD"}return envMapBlendingDefine}function WebGLProgram(renderer,cacheKey,parameters,bindingStates){var gl=renderer.getContext(),defines=parameters.defines,
vertexShader=parameters.vertexShader,fragmentShader=parameters.fragmentShader,shadowMapTypeDefine=generateShadowMapTypeDefine(parameters),envMapTypeDefine=generateEnvMapTypeDefine(parameters),envMapModeDefine=generateEnvMapModeDefine(parameters),envMapBlendingDefine=generateEnvMapBlendingDefine(parameters),gammaFactorDefine=0<renderer.gammaFactor?renderer.gammaFactor:1,customExtensions=parameters.isWebGL2?"":[parameters.extensionDerivatives||parameters.envMapCubeUV||parameters.bumpMap||parameters.tangentSpaceNormalMap||
parameters.clearcoatNormalMap||parameters.flatShading||"physical"===parameters.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(parameters.extensionFragDepth||parameters.logarithmicDepthBuffer)&&parameters.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",parameters.extensionDrawBuffers&&parameters.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(parameters.extensionShaderTextureLOD||parameters.envMap)&&parameters.rendererExtensionShaderTextureLod?
"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join("\n"),customDefines=generateDefines(defines),program=gl.createProgram(),versionString=parameters.glslVersion?"#version "+parameters.glslVersion+"\n":"";parameters.isRawShaderMaterial?(defines=[customDefines].filter(filterEmptyLine).join("\n"),0<defines.length&&(defines+="\n"),shadowMapTypeDefine=[customExtensions,customDefines].filter(filterEmptyLine).join("\n"),0<shadowMapTypeDefine.length&&(shadowMapTypeDefine+="\n")):
(defines=[generatePrecision(parameters),"#define SHADER_NAME "+parameters.shaderName,customDefines,parameters.instancing?"#define USE_INSTANCING":"",parameters.instancingColor?"#define USE_INSTANCING_COLOR":"",parameters.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+gammaFactorDefine,"#define MAX_BONES "+parameters.maxBones,parameters.useFog&&parameters.fog?"#define USE_FOG":"",parameters.useFog&&parameters.fogExp2?"#define FOG_EXP2":"",parameters.map?"#define USE_MAP":
"",parameters.envMap?"#define USE_ENVMAP":"",parameters.envMap?"#define "+envMapModeDefine:"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.aoMap?"#define USE_AOMAP":"",parameters.emissiveMap?"#define USE_EMISSIVEMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":"",parameters.normalMap&&parameters.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",parameters.normalMap&&parameters.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":
"",parameters.clearcoatMap?"#define USE_CLEARCOATMAP":"",parameters.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",parameters.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",parameters.displacementMap&&parameters.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.roughnessMap?"#define USE_ROUGHNESSMAP":"",parameters.metalnessMap?"#define USE_METALNESSMAP":"",parameters.alphaMap?"#define USE_ALPHAMAP":"",parameters.transmissionMap?
"#define USE_TRANSMISSIONMAP":"",parameters.vertexTangents?"#define USE_TANGENT":"",parameters.vertexColors?"#define USE_COLOR":"",parameters.vertexUvs?"#define USE_UV":"",parameters.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",parameters.flatShading?"#define FLAT_SHADED":"",parameters.skinning?"#define USE_SKINNING":"",parameters.useVertexTexture?"#define BONE_TEXTURE":"",parameters.morphTargets?"#define USE_MORPHTARGETS":"",parameters.morphNormals&&!1===parameters.flatShading?"#define USE_MORPHNORMALS":
"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":"",parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.sizeAttenuation?"#define USE_SIZEATTENUATION":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",parameters.logarithmicDepthBuffer&&parameters.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;",
"uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS",
"\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;",
"\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n"),shadowMapTypeDefine=[customExtensions,generatePrecision(parameters),"#define SHADER_NAME "+parameters.shaderName,customDefines,parameters.alphaTest?"#define ALPHATEST "+parameters.alphaTest+(parameters.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+gammaFactorDefine,parameters.useFog&&parameters.fog?"#define USE_FOG":"",parameters.useFog&&parameters.fogExp2?"#define FOG_EXP2":"",parameters.map?"#define USE_MAP":"",parameters.matcap?
"#define USE_MATCAP":"",parameters.envMap?"#define USE_ENVMAP":"",parameters.envMap?"#define "+envMapTypeDefine:"",parameters.envMap?"#define "+envMapModeDefine:"",parameters.envMap?"#define "+envMapBlendingDefine:"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.aoMap?"#define USE_AOMAP":"",parameters.emissiveMap?"#define USE_EMISSIVEMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":"",parameters.normalMap&&parameters.objectSpaceNormalMap?
"#define OBJECTSPACE_NORMALMAP":"",parameters.normalMap&&parameters.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",parameters.clearcoatMap?"#define USE_CLEARCOATMAP":"",parameters.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",parameters.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.roughnessMap?"#define USE_ROUGHNESSMAP":"",parameters.metalnessMap?"#define USE_METALNESSMAP":"",parameters.alphaMap?"#define USE_ALPHAMAP":
"",parameters.sheen?"#define USE_SHEEN":"",parameters.transmissionMap?"#define USE_TRANSMISSIONMAP":"",parameters.vertexTangents?"#define USE_TANGENT":"",parameters.vertexColors||parameters.instancingColor?"#define USE_COLOR":"",parameters.vertexUvs?"#define USE_UV":"",parameters.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",parameters.gradientMap?"#define USE_GRADIENTMAP":"",parameters.flatShading?"#define FLAT_SHADED":"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":
"",parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",parameters.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",parameters.logarithmicDepthBuffer&&parameters.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(parameters.extensionShaderTextureLOD||parameters.envMap)&&parameters.rendererExtensionShaderTextureLod?
"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==parameters.toneMapping?"#define TONE_MAPPING":"",0!==parameters.toneMapping?ShaderChunk.tonemapping_pars_fragment:"",0!==parameters.toneMapping?getToneMappingFunction("toneMapping",parameters.toneMapping):"",parameters.dithering?"#define DITHERING":"",ShaderChunk.encodings_pars_fragment,parameters.map?getTexelDecodingFunction("mapTexelToLinear",parameters.mapEncoding):"",parameters.matcap?
getTexelDecodingFunction("matcapTexelToLinear",parameters.matcapEncoding):"",parameters.envMap?getTexelDecodingFunction("envMapTexelToLinear",parameters.envMapEncoding):"",parameters.emissiveMap?getTexelDecodingFunction("emissiveMapTexelToLinear",parameters.emissiveMapEncoding):"",parameters.lightMap?getTexelDecodingFunction("lightMapTexelToLinear",parameters.lightMapEncoding):"",getTexelEncodingFunction("linearToOutputTexel",parameters.outputEncoding),parameters.depthPacking?"#define DEPTH_PACKING "+
parameters.depthPacking:"","\n"].filter(filterEmptyLine).join("\n"));vertexShader=vertexShader.replace(includePattern,includeReplacer);vertexShader=replaceLightNums(vertexShader,parameters);vertexShader=replaceClippingPlaneNums(vertexShader,parameters);fragmentShader=fragmentShader.replace(includePattern,includeReplacer);fragmentShader=replaceLightNums(fragmentShader,parameters);fragmentShader=replaceClippingPlaneNums(fragmentShader,parameters);vertexShader=vertexShader.replace(unrollLoopPattern,
loopReplacer).replace(deprecatedUnrollLoopPattern,deprecatedLoopReplacer);fragmentShader=fragmentShader.replace(unrollLoopPattern,loopReplacer).replace(deprecatedUnrollLoopPattern,deprecatedLoopReplacer);parameters.isWebGL2&&!0!==parameters.isRawShaderMaterial&&(versionString="#version 300 es\n",defines="#define attribute in\n#define varying out\n#define texture2D texture\n"+defines,shadowMapTypeDefine=["#define varying in","300 es"===parameters.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===
parameters.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+shadowMapTypeDefine);fragmentShader=versionString+
shadowMapTypeDefine+fragmentShader;vertexShader=WebGLShader(gl,35633,versionString+defines+vertexShader);fragmentShader=WebGLShader(gl,35632,fragmentShader);gl.attachShader(program,vertexShader);gl.attachShader(program,fragmentShader);void 0!==parameters.index0AttributeName?gl.bindAttribLocation(program,0,parameters.index0AttributeName):!0===parameters.morphTargets&&gl.bindAttribLocation(program,0,"position");gl.linkProgram(program);if(renderer.debug.checkShaderErrors){renderer=gl.getProgramInfoLog(program).trim();
versionString=gl.getShaderInfoLog(vertexShader).trim();envMapTypeDefine=gl.getShaderInfoLog(fragmentShader).trim();envMapBlendingDefine=envMapModeDefine=!0;if(!1===gl.getProgramParameter(program,35714))envMapModeDefine=!1,gammaFactorDefine=getShaderErrors(gl,vertexShader,"vertex"),customExtensions=getShaderErrors(gl,fragmentShader,"fragment"),console.error("THREE.WebGLProgram: shader error: ",gl.getError(),"35715",gl.getProgramParameter(program,35715),"gl.getProgramInfoLog",renderer,gammaFactorDefine,
customExtensions);else if(""!==renderer)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",renderer);else if(""===versionString||""===envMapTypeDefine)envMapBlendingDefine=!1;envMapBlendingDefine&&(this.diagnostics={runnable:envMapModeDefine,programLog:renderer,vertexShader:{log:versionString,prefix:defines},fragmentShader:{log:envMapTypeDefine,prefix:shadowMapTypeDefine}})}gl.deleteShader(vertexShader);gl.deleteShader(fragmentShader);var cachedUniforms;this.getUniforms=function(){void 0===
cachedUniforms&&(cachedUniforms=new WebGLUniforms(gl,program));return cachedUniforms};var cachedAttributes;this.getAttributes=function(){if(void 0===cachedAttributes){for(var attributes={},n=gl.getProgramParameter(program,35721),i=0;i<n;i++){var name=gl.getActiveAttrib(program,i).name;attributes[name]=gl.getAttribLocation(program,name)}cachedAttributes=attributes}return cachedAttributes};this.destroy=function(){bindingStates.releaseStatesOfProgram(this);gl.deleteProgram(program);this.program=void 0};
this.name=parameters.shaderName;this.id=programIdCount++;this.cacheKey=cacheKey;this.usedTimes=1;this.program=program;this.vertexShader=vertexShader;this.fragmentShader=fragmentShader;return this}function WebGLPrograms(renderer,cubemaps,extensions,capabilities,bindingStates,clipping){function getTextureEncodingFromMap(map){if(map)map.isTexture?encoding=map.encoding:map.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),
encoding=map.texture.encoding);else var encoding=3E3;return encoding}var programs=[],isWebGL2=capabilities.isWebGL2,logarithmicDepthBuffer=capabilities.logarithmicDepthBuffer,floatVertexTextures=capabilities.floatVertexTextures,maxVertexUniforms=capabilities.maxVertexUniforms,vertexTextures=capabilities.vertexTextures,precision=capabilities.precision,shaderIDs={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",
MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},parameterNames="precision isWebGL2 supportsVertexTextures outputEncoding instancing instancingColor map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen transmissionMap".split(" ");
return{getParameters:function(material,lights,shadows,scene,object){var fog=scene.fog;scene=material.isMeshStandardMaterial?scene.environment:null;scene=cubemaps.get(material.envMap||scene);var shaderID=shaderIDs[material.type];if(object.isSkinnedMesh){var JSCompiler_temp=object.skeleton.bones;if(floatVertexTextures)JSCompiler_temp=1024;else{var maxBones=Math.min(Math.floor((maxVertexUniforms-20)/4),JSCompiler_temp.length);maxBones<JSCompiler_temp.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+
JSCompiler_temp.length+" bones. This GPU supports "+maxBones+"."),JSCompiler_temp=0):JSCompiler_temp=maxBones}}else JSCompiler_temp=0;null!==material.precision&&(precision=capabilities.getMaxPrecision(material.precision),precision!==material.precision&&console.warn("THREE.WebGLProgram.getParameters:",material.precision,"not supported, using",precision,"instead."));if(shaderID){var fragmentShader=ShaderLib[shaderID];maxBones=fragmentShader.vertexShader;fragmentShader=fragmentShader.fragmentShader}else maxBones=
material.vertexShader,fragmentShader=material.fragmentShader;var currentRenderTarget=renderer.getRenderTarget();return{isWebGL2:isWebGL2,shaderID:shaderID,shaderName:material.type,vertexShader:maxBones,fragmentShader:fragmentShader,defines:material.defines,isRawShaderMaterial:!0===material.isRawShaderMaterial,glslVersion:material.glslVersion,precision:precision,instancing:!0===object.isInstancedMesh,instancingColor:!0===object.isInstancedMesh&&null!==object.instanceColor,supportsVertexTextures:vertexTextures,
outputEncoding:null!==currentRenderTarget?getTextureEncodingFromMap(currentRenderTarget.texture):renderer.outputEncoding,map:!!material.map,mapEncoding:getTextureEncodingFromMap(material.map),matcap:!!material.matcap,matcapEncoding:getTextureEncodingFromMap(material.matcap),envMap:!!scene,envMapMode:scene&&scene.mapping,envMapEncoding:getTextureEncodingFromMap(scene),envMapCubeUV:!!scene&&(306===scene.mapping||307===scene.mapping),lightMap:!!material.lightMap,lightMapEncoding:getTextureEncodingFromMap(material.lightMap),
aoMap:!!material.aoMap,emissiveMap:!!material.emissiveMap,emissiveMapEncoding:getTextureEncodingFromMap(material.emissiveMap),bumpMap:!!material.bumpMap,normalMap:!!material.normalMap,objectSpaceNormalMap:1===material.normalMapType,tangentSpaceNormalMap:0===material.normalMapType,clearcoatMap:!!material.clearcoatMap,clearcoatRoughnessMap:!!material.clearcoatRoughnessMap,clearcoatNormalMap:!!material.clearcoatNormalMap,displacementMap:!!material.displacementMap,roughnessMap:!!material.roughnessMap,
metalnessMap:!!material.metalnessMap,specularMap:!!material.specularMap,alphaMap:!!material.alphaMap,gradientMap:!!material.gradientMap,sheen:!!material.sheen,transmissionMap:!!material.transmissionMap,combine:material.combine,vertexTangents:material.normalMap&&material.vertexTangents,vertexColors:material.vertexColors,vertexUvs:!!material.map||!!material.bumpMap||!!material.normalMap||!!material.specularMap||!!material.alphaMap||!!material.emissiveMap||!!material.roughnessMap||!!material.metalnessMap||
!!material.clearcoatMap||!!material.clearcoatRoughnessMap||!!material.clearcoatNormalMap||!!material.displacementMap||!!material.transmissionMap,uvsVertexOnly:!(material.map||material.bumpMap||material.normalMap||material.specularMap||material.alphaMap||material.emissiveMap||material.roughnessMap||material.metalnessMap||material.clearcoatNormalMap||material.transmissionMap)&&!!material.displacementMap,fog:!!fog,useFog:material.fog,fogExp2:fog&&fog.isFogExp2,flatShading:material.flatShading,sizeAttenuation:material.sizeAttenuation,
logarithmicDepthBuffer:logarithmicDepthBuffer,skinning:material.skinning&&0<JSCompiler_temp,maxBones:JSCompiler_temp,useVertexTexture:floatVertexTextures,morphTargets:material.morphTargets,morphNormals:material.morphNormals,maxMorphTargets:renderer.maxMorphTargets,maxMorphNormals:renderer.maxMorphNormals,numDirLights:lights.directional.length,numPointLights:lights.point.length,numSpotLights:lights.spot.length,numRectAreaLights:lights.rectArea.length,numHemiLights:lights.hemi.length,numDirLightShadows:lights.directionalShadowMap.length,
numPointLightShadows:lights.pointShadowMap.length,numSpotLightShadows:lights.spotShadowMap.length,numClippingPlanes:clipping.numPlanes,numClipIntersection:clipping.numIntersection,dithering:material.dithering,shadowMapEnabled:renderer.shadowMap.enabled&&0<shadows.length,shadowMapType:renderer.shadowMap.type,toneMapping:material.toneMapped?renderer.toneMapping:0,physicallyCorrectLights:renderer.physicallyCorrectLights,premultipliedAlpha:material.premultipliedAlpha,alphaTest:material.alphaTest,doubleSided:2===
material.side,flipSided:1===material.side,depthPacking:void 0!==material.depthPacking?material.depthPacking:!1,index0AttributeName:material.index0AttributeName,extensionDerivatives:material.extensions&&material.extensions.derivatives,extensionFragDepth:material.extensions&&material.extensions.fragDepth,extensionDrawBuffers:material.extensions&&material.extensions.drawBuffers,extensionShaderTextureLOD:material.extensions&&material.extensions.shaderTextureLOD,rendererExtensionFragDepth:isWebGL2||extensions.has("EXT_frag_depth"),
rendererExtensionDrawBuffers:isWebGL2||extensions.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:isWebGL2||extensions.has("EXT_shader_texture_lod"),customProgramCacheKey:material.customProgramCacheKey()}},getProgramCacheKey:function(parameters){var array=[];parameters.shaderID?array.push(parameters.shaderID):(array.push(parameters.fragmentShader),array.push(parameters.vertexShader));if(void 0!==parameters.defines)for(var name in parameters.defines)array.push(name),array.push(parameters.defines[name]);
if(!1===parameters.isRawShaderMaterial){for(name=0;name<parameterNames.length;name++)array.push(parameters[parameterNames[name]]);array.push(renderer.outputEncoding);array.push(renderer.gammaFactor)}array.push(parameters.customProgramCacheKey);return array.join()},getUniforms:function(material){var shaderID=shaderIDs[material.type];return shaderID?UniformsUtils.clone(ShaderLib[shaderID].uniforms):material.uniforms},acquireProgram:function(parameters,cacheKey){for(var program,p=0,pl=programs.length;p<
pl;p++){var preexistingProgram=programs[p];if(preexistingProgram.cacheKey===cacheKey){program=preexistingProgram;++program.usedTimes;break}}void 0===program&&(program=new WebGLProgram(renderer,cacheKey,parameters,bindingStates),programs.push(program));return program},releaseProgram:function(program){if(0===--program.usedTimes){var i=programs.indexOf(program);programs[i]=programs[programs.length-1];programs.pop();program.destroy()}},programs:programs}}function WebGLProperties(){var properties=new WeakMap;
return{get:function(object){var map=properties.get(object);void 0===map&&(map={},properties.set(object,map));return map},remove:function(object){properties.delete(object)},update:function(object,key,value){properties.get(object)[key]=value},dispose:function(){properties=new WeakMap}}}function painterSortStable(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?
a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function reversePainterSortStable(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function WebGLRenderList(properties){function getNextRenderItem(object,geometry,material,groupOrder,z,group){var renderItem=renderItems[renderItemsIndex],materialProperties=properties.get(material);void 0===renderItem?(renderItem={id:object.id,object:object,geometry:geometry,
material:material,program:materialProperties.program||defaultProgram,groupOrder:groupOrder,renderOrder:object.renderOrder,z:z,group:group},renderItems[renderItemsIndex]=renderItem):(renderItem.id=object.id,renderItem.object=object,renderItem.geometry=geometry,renderItem.material=material,renderItem.program=materialProperties.program||defaultProgram,renderItem.groupOrder=groupOrder,renderItem.renderOrder=object.renderOrder,renderItem.z=z,renderItem.group=group);renderItemsIndex++;return renderItem}
var renderItems=[],renderItemsIndex=0,opaque=[],transparent=[],defaultProgram={id:-1};return{opaque:opaque,transparent:transparent,init:function(){renderItemsIndex=0;opaque.length=0;transparent.length=0},push:function(object,geometry,material,groupOrder,z,group){object=getNextRenderItem(object,geometry,material,groupOrder,z,group);(!0===material.transparent?transparent:opaque).push(object)},unshift:function(object,geometry,material,groupOrder,z,group){object=getNextRenderItem(object,geometry,material,
groupOrder,z,group);(!0===material.transparent?transparent:opaque).unshift(object)},finish:function(){for(var i=renderItemsIndex,il=renderItems.length;i<il;i++){var renderItem=renderItems[i];if(null===renderItem.id)break;renderItem.id=null;renderItem.object=null;renderItem.geometry=null;renderItem.material=null;renderItem.program=null;renderItem.group=null}},sort:function(customOpaqueSort,customTransparentSort){1<opaque.length&&opaque.sort(customOpaqueSort||painterSortStable);1<transparent.length&&
transparent.sort(customTransparentSort||reversePainterSortStable)}}}function WebGLRenderLists(properties){var lists=new WeakMap;return{get:function(scene,camera){var cameras=lists.get(scene);if(void 0===cameras){var list=new WebGLRenderList(properties);lists.set(scene,new WeakMap);lists.get(scene).set(camera,list)}else list=cameras.get(camera),void 0===list&&(list=new WebGLRenderList(properties),cameras.set(camera,list));return list},dispose:function(){lists=new WeakMap}}}function UniformsCache(){var lights=
{};return{get:function(light){if(void 0!==lights[light.id])return lights[light.id];switch(light.type){case "DirectionalLight":var uniforms={direction:new Vector3,color:new Color};break;case "SpotLight":uniforms={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case "PointLight":uniforms={position:new Vector3,color:new Color,distance:0,decay:0};break;case "HemisphereLight":uniforms={direction:new Vector3,skyColor:new Color,groundColor:new Color};
break;case "RectAreaLight":uniforms={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return lights[light.id]=uniforms}}}function ShadowUniformsCache(){var lights={};return{get:function(light){if(void 0!==lights[light.id])return lights[light.id];switch(light.type){case "DirectionalLight":var uniforms={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case "SpotLight":uniforms={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};
break;case "PointLight":uniforms={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1E3}}return lights[light.id]=uniforms}}}function shadowCastingLightsFirst(lightA,lightB){return(lightB.castShadow?1:0)-(lightA.castShadow?1:0)}function WebGLLights(extensions,capabilities){for(var cache=new UniformsCache,shadowCache=ShadowUniformsCache(),state={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,
numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;9>i;i++)state.probe.push(new Vector3);var vector3=new Vector3,matrix4=new Matrix4,matrix42=new Matrix4;return{setup:function(lights,shadows,camera){for(var g=
shadows=0,b=0,_i=0;9>_i;_i++)state.probe[_i].set(0,0,0);var pointLength=_i=0,spotLength=0,rectAreaLength=0,hemiLength=0,numDirectionalShadows=0,numPointShadows=0,numSpotShadows=0;camera=camera.matrixWorldInverse;lights.sort(shadowCastingLightsFirst);for(var _i2=0,l=lights.length;_i2<l;_i2++){var light=lights[_i2],color=light.color,intensity=light.intensity,distance=light.distance,shadowMap=light.shadow&&light.shadow.map?light.shadow.map.texture:null;if(light.isAmbientLight)shadows+=color.r*intensity,
g+=color.g*intensity,b+=color.b*intensity;else if(light.isLightProbe)for(shadowMap=0;9>shadowMap;shadowMap++)state.probe[shadowMap].addScaledVector(light.sh.coefficients[shadowMap],intensity);else if(light.isDirectionalLight){intensity=cache.get(light);intensity.color.copy(light.color).multiplyScalar(light.intensity);intensity.direction.setFromMatrixPosition(light.matrixWorld);vector3.setFromMatrixPosition(light.target.matrixWorld);intensity.direction.sub(vector3);intensity.direction.transformDirection(camera);
if(light.castShadow){var shadow=light.shadow;color=shadowCache.get(light);color.shadowBias=shadow.bias;color.shadowNormalBias=shadow.normalBias;color.shadowRadius=shadow.radius;color.shadowMapSize=shadow.mapSize;state.directionalShadow[_i]=color;state.directionalShadowMap[_i]=shadowMap;state.directionalShadowMatrix[_i]=light.shadow.matrix;numDirectionalShadows++}state.directional[_i]=intensity;_i++}else light.isSpotLight?(shadow=cache.get(light),shadow.position.setFromMatrixPosition(light.matrixWorld),
shadow.position.applyMatrix4(camera),shadow.color.copy(color).multiplyScalar(intensity),shadow.distance=distance,shadow.direction.setFromMatrixPosition(light.matrixWorld),vector3.setFromMatrixPosition(light.target.matrixWorld),shadow.direction.sub(vector3),shadow.direction.transformDirection(camera),shadow.coneCos=Math.cos(light.angle),shadow.penumbraCos=Math.cos(light.angle*(1-light.penumbra)),shadow.decay=light.decay,light.castShadow&&(intensity=light.shadow,color=shadowCache.get(light),color.shadowBias=
intensity.bias,color.shadowNormalBias=intensity.normalBias,color.shadowRadius=intensity.radius,color.shadowMapSize=intensity.mapSize,state.spotShadow[spotLength]=color,state.spotShadowMap[spotLength]=shadowMap,state.spotShadowMatrix[spotLength]=light.shadow.matrix,numSpotShadows++),state.spot[spotLength]=shadow,spotLength++):light.isRectAreaLight?(shadowMap=cache.get(light),shadowMap.color.copy(color).multiplyScalar(intensity),shadowMap.position.setFromMatrixPosition(light.matrixWorld),shadowMap.position.applyMatrix4(camera),
matrix42.identity(),matrix4.copy(light.matrixWorld),matrix4.premultiply(camera),matrix42.extractRotation(matrix4),shadowMap.halfWidth.set(.5*light.width,0,0),shadowMap.halfHeight.set(0,.5*light.height,0),shadowMap.halfWidth.applyMatrix4(matrix42),shadowMap.halfHeight.applyMatrix4(matrix42),state.rectArea[rectAreaLength]=shadowMap,rectAreaLength++):light.isPointLight?(intensity=cache.get(light),intensity.position.setFromMatrixPosition(light.matrixWorld),intensity.position.applyMatrix4(camera),intensity.color.copy(light.color).multiplyScalar(light.intensity),
intensity.distance=light.distance,intensity.decay=light.decay,light.castShadow&&(shadow=light.shadow,color=shadowCache.get(light),color.shadowBias=shadow.bias,color.shadowNormalBias=shadow.normalBias,color.shadowRadius=shadow.radius,color.shadowMapSize=shadow.mapSize,color.shadowCameraNear=shadow.camera.near,color.shadowCameraFar=shadow.camera.far,state.pointShadow[pointLength]=color,state.pointShadowMap[pointLength]=shadowMap,state.pointShadowMatrix[pointLength]=light.shadow.matrix,numPointShadows++),
state.point[pointLength]=intensity,pointLength++):light.isHemisphereLight&&(shadowMap=cache.get(light),shadowMap.direction.setFromMatrixPosition(light.matrixWorld),shadowMap.direction.transformDirection(camera),shadowMap.direction.normalize(),shadowMap.skyColor.copy(light.color).multiplyScalar(intensity),shadowMap.groundColor.copy(light.groundColor).multiplyScalar(intensity),state.hemi[hemiLength]=shadowMap,hemiLength++)}0<rectAreaLength&&(capabilities.isWebGL2?(state.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,
state.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):!0===extensions.has("OES_texture_float_linear")?(state.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,state.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):!0===extensions.has("OES_texture_half_float_linear")?(state.rectAreaLTC1=UniformsLib.LTC_HALF_1,state.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions."));state.ambient[0]=shadows;state.ambient[1]=g;state.ambient[2]=b;lights=state.hash;if(lights.directionalLength!==
_i||lights.pointLength!==pointLength||lights.spotLength!==spotLength||lights.rectAreaLength!==rectAreaLength||lights.hemiLength!==hemiLength||lights.numDirectionalShadows!==numDirectionalShadows||lights.numPointShadows!==numPointShadows||lights.numSpotShadows!==numSpotShadows)state.directional.length=_i,state.spot.length=spotLength,state.rectArea.length=rectAreaLength,state.point.length=pointLength,state.hemi.length=hemiLength,state.directionalShadow.length=numDirectionalShadows,state.directionalShadowMap.length=
numDirectionalShadows,state.pointShadow.length=numPointShadows,state.pointShadowMap.length=numPointShadows,state.spotShadow.length=numSpotShadows,state.spotShadowMap.length=numSpotShadows,state.directionalShadowMatrix.length=numDirectionalShadows,state.pointShadowMatrix.length=numPointShadows,state.spotShadowMatrix.length=numSpotShadows,lights.directionalLength=_i,lights.pointLength=pointLength,lights.spotLength=spotLength,lights.rectAreaLength=rectAreaLength,lights.hemiLength=hemiLength,lights.numDirectionalShadows=
numDirectionalShadows,lights.numPointShadows=numPointShadows,lights.numSpotShadows=numSpotShadows,state.version=nextVersion++},state:state}}function WebGLRenderState(extensions,capabilities){var lights=new WebGLLights(extensions,capabilities),lightsArray=[],shadowsArray=[];return{init:function(){lightsArray.length=0;shadowsArray.length=0},state:{lightsArray:lightsArray,shadowsArray:shadowsArray,lights:lights},setupLights:function(camera){lights.setup(lightsArray,shadowsArray,camera)},pushLight:function(light){lightsArray.push(light)},
pushShadow:function(shadowLight){shadowsArray.push(shadowLight)}}}function WebGLRenderStates(extensions,capabilities){var renderStates=new WeakMap;return{get:function(scene,camera){if(!1===renderStates.has(scene)){var renderState=new WebGLRenderState(extensions,capabilities);renderStates.set(scene,new WeakMap);renderStates.get(scene).set(camera,renderState)}else!1===renderStates.get(scene).has(camera)?(renderState=new WebGLRenderState(extensions,capabilities),renderStates.get(scene).set(camera,renderState)):
renderState=renderStates.get(scene).get(camera);return renderState},dispose:function(){renderStates=new WeakMap}}}function MeshDepthMaterial(parameters){Material.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.fog=!1;this.setValues(parameters)}function MeshDistanceMaterial(parameters){Material.call(this);
this.type="MeshDistanceMaterial";this.referencePosition=new Vector3;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.fog=!1;this.setValues(parameters)}function WebGLShadowMap(_renderer,_objects,maxTextureSize){function getDepthMaterialVariant(useMorphing,useSkinning,useInstancing){useInstancing=useMorphing<<0|useSkinning<<1|useInstancing<<2;var material=_depthMaterials[useInstancing];
void 0===material&&(material=new MeshDepthMaterial({depthPacking:3201,morphTargets:useMorphing,skinning:useSkinning}),_depthMaterials[useInstancing]=material);return material}function getDistanceMaterialVariant(useMorphing,useSkinning,useInstancing){useInstancing=useMorphing<<0|useSkinning<<1|useInstancing<<2;var material=_distanceMaterials[useInstancing];void 0===material&&(material=new MeshDistanceMaterial({morphTargets:useMorphing,skinning:useSkinning}),_distanceMaterials[useInstancing]=material);
return material}function getDepthMaterial(object,geometry,material,light,shadowCameraNear,shadowCameraFar,type){var getMaterialVariant=getDepthMaterialVariant,customMaterial=object.customDepthMaterial;!0===light.isPointLight&&(getMaterialVariant=getDistanceMaterialVariant,customMaterial=object.customDistanceMaterial);void 0===customMaterial?(customMaterial=!1,!0===material.morphTargets&&(customMaterial=geometry.morphAttributes&&geometry.morphAttributes.position&&0<geometry.morphAttributes.position.length),
geometry=!1,!0===object.isSkinnedMesh&&(!0===material.skinning?geometry=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",object)),object=getMaterialVariant(customMaterial,geometry,!0===object.isInstancedMesh)):object=customMaterial;_renderer.localClippingEnabled&&!0===material.clipShadows&&0!==material.clippingPlanes.length&&(customMaterial=object.uuid,getMaterialVariant=material.uuid,geometry=_materialCache[customMaterial],void 0===geometry&&(geometry=
{},_materialCache[customMaterial]=geometry),customMaterial=geometry[getMaterialVariant],void 0===customMaterial&&(customMaterial=object.clone(),geometry[getMaterialVariant]=customMaterial),object=customMaterial);object.visible=material.visible;object.wireframe=material.wireframe;object.side=3===type?null!==material.shadowSide?material.shadowSide:material.side:null!==material.shadowSide?material.shadowSide:shadowSide[material.side];object.clipShadows=material.clipShadows;object.clippingPlanes=material.clippingPlanes;
object.clipIntersection=material.clipIntersection;object.wireframeLinewidth=material.wireframeLinewidth;object.linewidth=material.linewidth;!0===light.isPointLight&&!0===object.isMeshDistanceMaterial&&(object.referencePosition.setFromMatrixPosition(light.matrixWorld),object.nearDistance=shadowCameraNear,object.farDistance=shadowCameraFar);return object}function renderObject(object,camera,shadowCamera,light,type){if(!1!==object.visible){if(object.layers.test(camera.layers)&&(object.isMesh||object.isLine||
object.isPoints)&&(object.castShadow||object.receiveShadow&&3===type)&&(!object.frustumCulled||_frustum.intersectsObject(object))){object.modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse,object.matrixWorld);var geometry=_objects.update(object),material=object.material;if(Array.isArray(material))for(var groups=geometry.groups,k=0,kl=groups.length;k<kl;k++){var group=groups[k],groupMaterial=material[group.materialIndex];groupMaterial&&groupMaterial.visible&&(groupMaterial=getDepthMaterial(object,
geometry,groupMaterial,light,shadowCamera.near,shadowCamera.far,type),_renderer.renderBufferDirect(shadowCamera,null,geometry,groupMaterial,object,group))}else material.visible&&(material=getDepthMaterial(object,geometry,material,light,shadowCamera.near,shadowCamera.far,type),_renderer.renderBufferDirect(shadowCamera,null,geometry,material,object,null))}object=object.children;geometry=0;for(material=object.length;geometry<material;geometry++)renderObject(object[geometry],camera,shadowCamera,light,
type)}}var _frustum=new Frustum,_shadowMapSize=new Vector2,_viewportSize=new Vector2,_viewport=new Vector4,_depthMaterials=[],_distanceMaterials=[],_materialCache={},shadowSide={0:1,1:0,2:2},shadowMaterialVertical=new ShaderMaterial({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:"\nvoid main() {\n\n\tgl_Position \x3d vec4( position, 1.0 );\n\n}\n",fragmentShader:"\nuniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n\n#include \x3cpacking\x3e\n\nvoid main() {\n\n\tfloat mean \x3d 0.0;\n\tfloat squared_mean \x3d 0.0;\n\n\t// This seems totally useless but it's a crazy work around for a Adreno compiler bug\n\tfloat depth \x3d unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\n\tfor ( float i \x3d -1.0; i \x3c 1.0 ; i +\x3d SAMPLE_RATE) {\n\n\t\t#ifdef HORIZONAL_PASS\n\n\t\t\tvec2 distribution \x3d unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean +\x3d distribution.x;\n\t\t\tsquared_mean +\x3d distribution.y * distribution.y + distribution.x * distribution.x;\n\n\t\t#else\n\n\t\t\tfloat depth \x3d unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean +\x3d depth;\n\t\t\tsquared_mean +\x3d depth * depth;\n\n\t\t#endif\n\n\t}\n\n\tmean \x3d mean * HALF_SAMPLE_RATE;\n\tsquared_mean \x3d squared_mean * HALF_SAMPLE_RATE;\n\n\tfloat std_dev \x3d sqrt( squared_mean - mean * mean );\n\n\tgl_FragColor \x3d pack2HalfToRGBA( vec2( mean, std_dev ) );\n\n}\n"}),
shadowMaterialHorizonal=shadowMaterialVertical.clone();shadowMaterialHorizonal.defines.HORIZONAL_PASS=1;var fullScreenTri=new BufferGeometry;fullScreenTri.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var fullScreenMesh=new Mesh(fullScreenTri,shadowMaterialVertical),scope=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(lights,scene,camera){if(!1!==scope.enabled&&(!1!==scope.autoUpdate||!1!==scope.needsUpdate)&&
0!==lights.length){var currentRenderTarget=_renderer.getRenderTarget(),activeCubeFace=_renderer.getActiveCubeFace(),activeMipmapLevel=_renderer.getActiveMipmapLevel(),_state=_renderer.state;_state.setBlending(0);_state.buffers.color.setClear(1,1,1,1);_state.buffers.depth.setTest(!0);_state.setScissorTest(!1);for(var i=0,il=lights.length;i<il;i++){var light=lights[i],shadow=light.shadow;if(void 0===shadow)console.warn("THREE.WebGLShadowMap:",light,"has no shadow.");else if(!1!==shadow.autoUpdate||
!1!==shadow.needsUpdate){_shadowMapSize.copy(shadow.mapSize);var shadowFrameExtents=shadow.getFrameExtents();_shadowMapSize.multiply(shadowFrameExtents);_viewportSize.copy(shadow.mapSize);if(_shadowMapSize.x>maxTextureSize||_shadowMapSize.y>maxTextureSize)_shadowMapSize.x>maxTextureSize&&(_viewportSize.x=Math.floor(maxTextureSize/shadowFrameExtents.x),_shadowMapSize.x=_viewportSize.x*shadowFrameExtents.x,shadow.mapSize.x=_viewportSize.x),_shadowMapSize.y>maxTextureSize&&(_viewportSize.y=Math.floor(maxTextureSize/
shadowFrameExtents.y),_shadowMapSize.y=_viewportSize.y*shadowFrameExtents.y,shadow.mapSize.y=_viewportSize.y);null!==shadow.map||shadow.isPointLightShadow||3!==this.type||(shadowFrameExtents={minFilter:1006,magFilter:1006,format:1023},shadow.map=new WebGLRenderTarget(_shadowMapSize.x,_shadowMapSize.y,shadowFrameExtents),shadow.map.texture.name=light.name+".shadowMap",shadow.mapPass=new WebGLRenderTarget(_shadowMapSize.x,_shadowMapSize.y,shadowFrameExtents),shadow.camera.updateProjectionMatrix());
null===shadow.map&&(shadow.map=new WebGLRenderTarget(_shadowMapSize.x,_shadowMapSize.y,{minFilter:1003,magFilter:1003,format:1023}),shadow.map.texture.name=light.name+".shadowMap",shadow.camera.updateProjectionMatrix());_renderer.setRenderTarget(shadow.map);_renderer.clear();shadowFrameExtents=shadow.getViewportCount();for(var vp=0;vp<shadowFrameExtents;vp++){var viewport=shadow.getViewport(vp);_viewport.set(_viewportSize.x*viewport.x,_viewportSize.y*viewport.y,_viewportSize.x*viewport.z,_viewportSize.y*
viewport.w);_state.viewport(_viewport);shadow.updateMatrices(light,vp);_frustum=shadow.getFrustum();renderObject(scene,camera,shadow.camera,light,this.type)}shadow.isPointLightShadow||3!==this.type||(light=shadow,shadowFrameExtents=camera,vp=_objects.update(fullScreenMesh),shadowMaterialVertical.uniforms.shadow_pass.value=light.map.texture,shadowMaterialVertical.uniforms.resolution.value=light.mapSize,shadowMaterialVertical.uniforms.radius.value=light.radius,_renderer.setRenderTarget(light.mapPass),
_renderer.clear(),_renderer.renderBufferDirect(shadowFrameExtents,null,vp,shadowMaterialVertical,fullScreenMesh,null),shadowMaterialHorizonal.uniforms.shadow_pass.value=light.mapPass.texture,shadowMaterialHorizonal.uniforms.resolution.value=light.mapSize,shadowMaterialHorizonal.uniforms.radius.value=light.radius,_renderer.setRenderTarget(light.map),_renderer.clear(),_renderer.renderBufferDirect(shadowFrameExtents,null,vp,shadowMaterialHorizonal,fullScreenMesh,null));shadow.needsUpdate=!1}}scope.needsUpdate=
!1;_renderer.setRenderTarget(currentRenderTarget,activeCubeFace,activeMipmapLevel)}}}function WebGLState(gl,extensions,capabilities){function createTexture(type,target,count){var data=new Uint8Array(4),texture=gl.createTexture();gl.bindTexture(type,texture);gl.texParameteri(type,10241,9728);gl.texParameteri(type,10240,9728);for(type=0;type<count;type++)gl.texImage2D(target+type,0,6408,1,1,0,6408,5121,data);return texture}function enable(id){!0!==enabledCapabilities[id]&&(gl.enable(id),enabledCapabilities[id]=
!0)}function disable(id){!1!==enabledCapabilities[id]&&(gl.disable(id),enabledCapabilities[id]=!1)}function setBlending(blending,blendEquation,blendSrc,blendDst,blendEquationAlpha,blendSrcAlpha,blendDstAlpha,premultipliedAlpha){if(0===blending)currentBlendingEnabled&&(disable(3042),currentBlendingEnabled=!1);else if(currentBlendingEnabled||(enable(3042),currentBlendingEnabled=!0),5!==blending){if(blending!==currentBlending||premultipliedAlpha!==currentPremultipledAlpha){if(100!==currentBlendEquation||
100!==currentBlendEquationAlpha)gl.blendEquation(32774),currentBlendEquationAlpha=currentBlendEquation=100;if(premultipliedAlpha)switch(blending){case 1:gl.blendFuncSeparate(1,771,1,771);break;case 2:gl.blendFunc(1,1);break;case 3:gl.blendFuncSeparate(0,0,769,771);break;case 4:gl.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",blending)}else switch(blending){case 1:gl.blendFuncSeparate(770,771,1,771);break;case 2:gl.blendFunc(770,1);break;case 3:gl.blendFunc(0,
769);break;case 4:gl.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",blending)}currentBlendDstAlpha=currentBlendSrcAlpha=currentBlendDst=currentBlendSrc=null;currentBlending=blending;currentPremultipledAlpha=premultipliedAlpha}}else{blendEquationAlpha=blendEquationAlpha||blendEquation;blendSrcAlpha=blendSrcAlpha||blendSrc;blendDstAlpha=blendDstAlpha||blendDst;if(blendEquation!==currentBlendEquation||blendEquationAlpha!==currentBlendEquationAlpha)gl.blendEquationSeparate(equationToGL[blendEquation],
equationToGL[blendEquationAlpha]),currentBlendEquation=blendEquation,currentBlendEquationAlpha=blendEquationAlpha;if(blendSrc!==currentBlendSrc||blendDst!==currentBlendDst||blendSrcAlpha!==currentBlendSrcAlpha||blendDstAlpha!==currentBlendDstAlpha)gl.blendFuncSeparate(factorToGL[blendSrc],factorToGL[blendDst],factorToGL[blendSrcAlpha],factorToGL[blendDstAlpha]),currentBlendSrc=blendSrc,currentBlendDst=blendDst,currentBlendSrcAlpha=blendSrcAlpha,currentBlendDstAlpha=blendDstAlpha;currentBlending=blending;
currentPremultipledAlpha=null}}function setFlipSided(flipSided){currentFlipSided!==flipSided&&(flipSided?gl.frontFace(2304):gl.frontFace(2305),currentFlipSided=flipSided)}function setCullFace(cullFace){0!==cullFace?(enable(2884),cullFace!==currentCullFace&&(1===cullFace?gl.cullFace(1029):2===cullFace?gl.cullFace(1028):gl.cullFace(1032))):disable(2884);currentCullFace=cullFace}function setPolygonOffset(polygonOffset,factor,units){if(polygonOffset){if(enable(32823),currentPolygonOffsetFactor!==factor||
currentPolygonOffsetUnits!==units)gl.polygonOffset(factor,units),currentPolygonOffsetFactor=factor,currentPolygonOffsetUnits=units}else disable(32823)}function activeTexture(webglSlot){void 0===webglSlot&&(webglSlot=33984+maxTextures-1);currentTextureSlot!==webglSlot&&(gl.activeTexture(webglSlot),currentTextureSlot=webglSlot)}var _equationToGL,_factorToGL;capabilities=capabilities.isWebGL2;var colorBuffer=new function(){var locked=!1,color=new Vector4,currentColorMask=null,currentColorClear=new Vector4(0,
0,0,0);return{setMask:function(colorMask){currentColorMask===colorMask||locked||(gl.colorMask(colorMask,colorMask,colorMask,colorMask),currentColorMask=colorMask)},setLocked:function(lock){locked=lock},setClear:function(r,g,b,a,premultipliedAlpha){!0===premultipliedAlpha&&(r*=a,g*=a,b*=a);color.set(r,g,b,a);!1===currentColorClear.equals(color)&&(gl.clearColor(r,g,b,a),currentColorClear.copy(color))},reset:function(){locked=!1;currentColorMask=null;currentColorClear.set(-1,0,0,0)}}},depthBuffer=new function(){var locked=
!1,currentDepthMask=null,currentDepthFunc=null,currentDepthClear=null;return{setTest:function(depthTest){depthTest?enable(2929):disable(2929)},setMask:function(depthMask){currentDepthMask===depthMask||locked||(gl.depthMask(depthMask),currentDepthMask=depthMask)},setFunc:function(depthFunc){if(currentDepthFunc!==depthFunc){if(depthFunc)switch(depthFunc){case 0:gl.depthFunc(512);break;case 1:gl.depthFunc(519);break;case 2:gl.depthFunc(513);break;case 3:gl.depthFunc(515);break;case 4:gl.depthFunc(514);
break;case 5:gl.depthFunc(518);break;case 6:gl.depthFunc(516);break;case 7:gl.depthFunc(517);break;default:gl.depthFunc(515)}else gl.depthFunc(515);currentDepthFunc=depthFunc}},setLocked:function(lock){locked=lock},setClear:function(depth){currentDepthClear!==depth&&(gl.clearDepth(depth),currentDepthClear=depth)},reset:function(){locked=!1;currentDepthClear=currentDepthFunc=currentDepthMask=null}}},stencilBuffer=new function(){var locked=!1,currentStencilMask=null,currentStencilFunc=null,currentStencilRef=
null,currentStencilFuncMask=null,currentStencilFail=null,currentStencilZFail=null,currentStencilZPass=null,currentStencilClear=null;return{setTest:function(stencilTest){locked||(stencilTest?enable(2960):disable(2960))},setMask:function(stencilMask){currentStencilMask===stencilMask||locked||(gl.stencilMask(stencilMask),currentStencilMask=stencilMask)},setFunc:function(stencilFunc,stencilRef,stencilMask){if(currentStencilFunc!==stencilFunc||currentStencilRef!==stencilRef||currentStencilFuncMask!==stencilMask)gl.stencilFunc(stencilFunc,
stencilRef,stencilMask),currentStencilFunc=stencilFunc,currentStencilRef=stencilRef,currentStencilFuncMask=stencilMask},setOp:function(stencilFail,stencilZFail,stencilZPass){if(currentStencilFail!==stencilFail||currentStencilZFail!==stencilZFail||currentStencilZPass!==stencilZPass)gl.stencilOp(stencilFail,stencilZFail,stencilZPass),currentStencilFail=stencilFail,currentStencilZFail=stencilZFail,currentStencilZPass=stencilZPass},setLocked:function(lock){locked=lock},setClear:function(stencil){currentStencilClear!==
stencil&&(gl.clearStencil(stencil),currentStencilClear=stencil)},reset:function(){locked=!1;currentStencilClear=currentStencilZPass=currentStencilZFail=currentStencilFail=currentStencilFuncMask=currentStencilRef=currentStencilFunc=currentStencilMask=null}}},enabledCapabilities={},currentProgram=null,currentBlendingEnabled=null,currentBlending=null,currentBlendEquation=null,currentBlendSrc=null,currentBlendDst=null,currentBlendEquationAlpha=null,currentBlendSrcAlpha=null,currentBlendDstAlpha=null,
currentPremultipledAlpha=!1,currentFlipSided=null,currentCullFace=null,currentLineWidth=null,currentPolygonOffsetFactor=null,currentPolygonOffsetUnits=null,maxTextures=gl.getParameter(35661),lineWidthAvailable=!1,version=0;version=gl.getParameter(7938);-1!==version.indexOf("WebGL")?(version=parseFloat(/^WebGL ([0-9])/.exec(version)[1]),lineWidthAvailable=1<=version):-1!==version.indexOf("OpenGL ES")&&(version=parseFloat(/^OpenGL ES ([0-9])/.exec(version)[1]),lineWidthAvailable=2<=version);var currentTextureSlot=
null,currentBoundTextures={},currentScissor=new Vector4,currentViewport=new Vector4,emptyTextures={};emptyTextures[3553]=createTexture(3553,3553,1);emptyTextures[34067]=createTexture(34067,34069,6);colorBuffer.setClear(0,0,0,1);depthBuffer.setClear(1);stencilBuffer.setClear(0);enable(2929);depthBuffer.setFunc(3);setFlipSided(!1);setCullFace(1);enable(2884);setBlending(0);var equationToGL=(_equationToGL={},_equationToGL[100]=32774,_equationToGL[101]=32778,_equationToGL[102]=32779,_equationToGL);capabilities?
(equationToGL[103]=32775,equationToGL[104]=32776):(extensions=extensions.get("EXT_blend_minmax"),null!==extensions&&(equationToGL[103]=extensions.MIN_EXT,equationToGL[104]=extensions.MAX_EXT));var factorToGL=(_factorToGL={},_factorToGL[200]=0,_factorToGL[201]=1,_factorToGL[202]=768,_factorToGL[204]=770,_factorToGL[210]=776,_factorToGL[208]=774,_factorToGL[206]=772,_factorToGL[203]=769,_factorToGL[205]=771,_factorToGL[209]=775,_factorToGL[207]=773,_factorToGL);return{buffers:{color:colorBuffer,depth:depthBuffer,
stencil:stencilBuffer},enable:enable,disable:disable,useProgram:function(program){return currentProgram!==program?(gl.useProgram(program),currentProgram=program,!0):!1},setBlending:setBlending,setMaterial:function(material,frontFaceCW){2===material.side?disable(2884):enable(2884);var flipSided=1===material.side;frontFaceCW&&(flipSided=!flipSided);setFlipSided(flipSided);1===material.blending&&!1===material.transparent?setBlending(0):setBlending(material.blending,material.blendEquation,material.blendSrc,
material.blendDst,material.blendEquationAlpha,material.blendSrcAlpha,material.blendDstAlpha,material.premultipliedAlpha);depthBuffer.setFunc(material.depthFunc);depthBuffer.setTest(material.depthTest);depthBuffer.setMask(material.depthWrite);colorBuffer.setMask(material.colorWrite);frontFaceCW=material.stencilWrite;stencilBuffer.setTest(frontFaceCW);frontFaceCW&&(stencilBuffer.setMask(material.stencilWriteMask),stencilBuffer.setFunc(material.stencilFunc,material.stencilRef,material.stencilFuncMask),
stencilBuffer.setOp(material.stencilFail,material.stencilZFail,material.stencilZPass));setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits)},setFlipSided:setFlipSided,setCullFace:setCullFace,setLineWidth:function(width){width!==currentLineWidth&&(lineWidthAvailable&&gl.lineWidth(width),currentLineWidth=width)},setPolygonOffset:setPolygonOffset,setScissorTest:function(scissorTest){scissorTest?enable(3089):disable(3089)},activeTexture:activeTexture,bindTexture:function(webglType,
webglTexture){null===currentTextureSlot&&activeTexture();var boundTexture=currentBoundTextures[currentTextureSlot];void 0===boundTexture&&(boundTexture={type:void 0,texture:void 0},currentBoundTextures[currentTextureSlot]=boundTexture);if(boundTexture.type!==webglType||boundTexture.texture!==webglTexture)gl.bindTexture(webglType,webglTexture||emptyTextures[webglType]),boundTexture.type=webglType,boundTexture.texture=webglTexture},unbindTexture:function(){var boundTexture=currentBoundTextures[currentTextureSlot];
void 0!==boundTexture&&void 0!==boundTexture.type&&(gl.bindTexture(boundTexture.type,null),boundTexture.type=void 0,boundTexture.texture=void 0)},compressedTexImage2D:function(){try{gl.compressedTexImage2D.apply(gl,arguments)}catch(error){console.error("THREE.WebGLState:",error)}},texImage2D:function(){try{gl.texImage2D.apply(gl,arguments)}catch(error){console.error("THREE.WebGLState:",error)}},texImage3D:function(){try{gl.texImage3D.apply(gl,arguments)}catch(error){console.error("THREE.WebGLState:",
error)}},scissor:function(scissor){!1===currentScissor.equals(scissor)&&(gl.scissor(scissor.x,scissor.y,scissor.z,scissor.w),currentScissor.copy(scissor))},viewport:function(viewport){!1===currentViewport.equals(viewport)&&(gl.viewport(viewport.x,viewport.y,viewport.z,viewport.w),currentViewport.copy(viewport))},reset:function(){enabledCapabilities={};currentTextureSlot=null;currentBoundTextures={};currentBlendDstAlpha=currentBlendSrcAlpha=currentBlendEquationAlpha=currentBlendDst=currentBlendSrc=
currentBlendEquation=currentBlending=currentBlendingEnabled=currentProgram=null;currentPremultipledAlpha=!1;currentPolygonOffsetUnits=currentPolygonOffsetFactor=currentLineWidth=currentCullFace=currentFlipSided=null;colorBuffer.reset();depthBuffer.reset();stencilBuffer.reset()}}}function WebGLTextures(_gl,extensions,state,properties,capabilities,utils,info){function createCanvas(width,height){return useOffscreenCanvas?new OffscreenCanvas(width,height):document.createElementNS("http://www.w3.org/1999/xhtml",
"canvas")}function resizeImage(image,needsPowerOfTwo,needsNewCanvas,maxSize){var scale=1;if(image.width>maxSize||image.height>maxSize)scale=maxSize/Math.max(image.width,image.height);if(1>scale||!0===needsPowerOfTwo){if("undefined"!==typeof HTMLImageElement&&image instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&image instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&image instanceof ImageBitmap)return maxSize=needsPowerOfTwo?MathUtils.floorPowerOfTwo:Math.floor,
needsPowerOfTwo=maxSize(scale*image.width),scale=maxSize(scale*image.height),void 0===_canvas&&(_canvas=createCanvas(needsPowerOfTwo,scale)),needsNewCanvas=needsNewCanvas?createCanvas(needsPowerOfTwo,scale):_canvas,needsNewCanvas.width=needsPowerOfTwo,needsNewCanvas.height=scale,needsNewCanvas.getContext("2d").drawImage(image,0,0,needsPowerOfTwo,scale),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+image.width+"x"+image.height+") to ("+needsPowerOfTwo+"x"+scale+")."),needsNewCanvas;
"data"in image&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+image.width+"x"+image.height+").")}return image}function isPowerOfTwo(image){return MathUtils.isPowerOfTwo(image.width)&&MathUtils.isPowerOfTwo(image.height)}function textureNeedsGenerateMipmaps(texture,supportsMips){return texture.generateMipmaps&&supportsMips&&1003!==texture.minFilter&&1006!==texture.minFilter}function generateMipmap(target,texture,width,height){_gl.generateMipmap(target);properties.get(texture).__maxMipLevel=
Math.log(Math.max(width,height))*Math.LOG2E}function getInternalFormat(internalFormatName,glFormat,glType){if(!1===isWebGL2)return glFormat;if(null!==internalFormatName){if(void 0!==_gl[internalFormatName])return _gl[internalFormatName];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+internalFormatName+"'")}internalFormatName=glFormat;6403===glFormat&&(5126===glType&&(internalFormatName=33326),5131===glType&&(internalFormatName=33325),5121===glType&&(internalFormatName=
33321));6407===glFormat&&(5126===glType&&(internalFormatName=34837),5131===glType&&(internalFormatName=34843),5121===glType&&(internalFormatName=32849));6408===glFormat&&(5126===glType&&(internalFormatName=34836),5131===glType&&(internalFormatName=34842),5121===glType&&(internalFormatName=32856));33325!==internalFormatName&&33326!==internalFormatName&&34842!==internalFormatName&&34836!==internalFormatName||extensions.get("EXT_color_buffer_float");return internalFormatName}function filterFallback(f){return 1003===
f||1004===f||1005===f?9728:9729}function onTextureDispose(event){event=event.target;event.removeEventListener("dispose",onTextureDispose);var textureProperties=properties.get(event);void 0!==textureProperties.__webglInit&&(_gl.deleteTexture(textureProperties.__webglTexture),properties.remove(event));event.isVideoTexture&&_videoTextures.delete(event);info.memory.textures--}function onRenderTargetDispose(event){event=event.target;event.removeEventListener("dispose",onRenderTargetDispose);var renderTargetProperties=
properties.get(event),textureProperties=properties.get(event.texture);if(event){void 0!==textureProperties.__webglTexture&&_gl.deleteTexture(textureProperties.__webglTexture);event.depthTexture&&event.depthTexture.dispose();if(event.isWebGLCubeRenderTarget)for(textureProperties=0;6>textureProperties;textureProperties++)_gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer[textureProperties]),renderTargetProperties.__webglDepthbuffer&&_gl.deleteRenderbuffer(renderTargetProperties.__webglDepthbuffer[textureProperties]);
else _gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer),renderTargetProperties.__webglDepthbuffer&&_gl.deleteRenderbuffer(renderTargetProperties.__webglDepthbuffer),renderTargetProperties.__webglMultisampledFramebuffer&&_gl.deleteFramebuffer(renderTargetProperties.__webglMultisampledFramebuffer),renderTargetProperties.__webglColorRenderbuffer&&_gl.deleteRenderbuffer(renderTargetProperties.__webglColorRenderbuffer),renderTargetProperties.__webglDepthRenderbuffer&&_gl.deleteRenderbuffer(renderTargetProperties.__webglDepthRenderbuffer);
properties.remove(event.texture);properties.remove(event)}info.memory.textures--}function setTexture2D(texture,slot){var textureProperties=properties.get(texture);if(texture.isVideoTexture){var frame=info.render.frame;_videoTextures.get(texture)!==frame&&(_videoTextures.set(texture,frame),texture.update())}if(0<texture.version&&textureProperties.__version!==texture.version)if(frame=texture.image,void 0===frame)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===
frame.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{uploadTexture(textureProperties,texture,slot);return}state.activeTexture(33984+slot);state.bindTexture(3553,textureProperties.__webglTexture)}function setTextureCube(texture,slot){var textureProperties=properties.get(texture);if(0<texture.version&&textureProperties.__version!==texture.version){if(6===texture.image.length){initTexture(textureProperties,texture);state.activeTexture(33984+slot);
state.bindTexture(34067,textureProperties.__webglTexture);_gl.pixelStorei(37440,texture.flipY);var isCompressed=texture&&(texture.isCompressedTexture||texture.image[0].isCompressedTexture),isDataTexture=texture.image[0]&&texture.image[0].isDataTexture;slot=[];for(var i=0;6>i;i++)slot[i]=isCompressed||isDataTexture?isDataTexture?texture.image[i].image:texture.image[i]:resizeImage(texture.image[i],!1,!0,maxCubemapSize);i=slot[0];var supportsMips=isPowerOfTwo(i)||isWebGL2,glFormat=utils.convert(texture.format),
glType=utils.convert(texture.type),glInternalFormat=getInternalFormat(texture.internalFormat,glFormat,glType);setTextureParameters(34067,texture,supportsMips);if(isCompressed){for(isDataTexture=0;6>isDataTexture;isDataTexture++){var mipmaps=slot[isDataTexture].mipmaps;for(isCompressed=0;isCompressed<mipmaps.length;isCompressed++){var mipmap=mipmaps[isCompressed];1023!==texture.format&&1022!==texture.format?null!==glFormat?state.compressedTexImage2D(34069+isDataTexture,isCompressed,glInternalFormat,
mipmap.width,mipmap.height,0,mipmap.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):state.texImage2D(34069+isDataTexture,isCompressed,glInternalFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data)}}textureProperties.__maxMipLevel=mipmaps.length-1}else{mipmaps=texture.mipmaps;for(isCompressed=0;6>isCompressed;isCompressed++)if(isDataTexture)for(state.texImage2D(34069+isCompressed,0,glInternalFormat,slot[isCompressed].width,
slot[isCompressed].height,0,glFormat,glType,slot[isCompressed].data),mipmap=0;mipmap<mipmaps.length;mipmap++){var mipmapImage=mipmaps[mipmap].image[isCompressed].image;state.texImage2D(34069+isCompressed,mipmap+1,glInternalFormat,mipmapImage.width,mipmapImage.height,0,glFormat,glType,mipmapImage.data)}else for(state.texImage2D(34069+isCompressed,0,glInternalFormat,glFormat,glType,slot[isCompressed]),mipmap=0;mipmap<mipmaps.length;mipmap++)state.texImage2D(34069+isCompressed,mipmap+1,glInternalFormat,
glFormat,glType,mipmaps[mipmap].image[isCompressed]);textureProperties.__maxMipLevel=mipmaps.length}textureNeedsGenerateMipmaps(texture,supportsMips)&&generateMipmap(34067,texture,i.width,i.height);textureProperties.__version=texture.version;if(texture.onUpdate)texture.onUpdate(texture)}}else state.activeTexture(33984+slot),state.bindTexture(34067,textureProperties.__webglTexture)}function setTextureParameters(textureType,texture,supportsMips){supportsMips?(_gl.texParameteri(textureType,10242,wrappingToGL[texture.wrapS]),
_gl.texParameteri(textureType,10243,wrappingToGL[texture.wrapT]),32879!==textureType&&35866!==textureType||_gl.texParameteri(textureType,32882,wrappingToGL[texture.wrapR]),_gl.texParameteri(textureType,10240,filterToGL[texture.magFilter]),_gl.texParameteri(textureType,10241,filterToGL[texture.minFilter])):(_gl.texParameteri(textureType,10242,33071),_gl.texParameteri(textureType,10243,33071),32879!==textureType&&35866!==textureType||_gl.texParameteri(textureType,32882,33071),1001===texture.wrapS&&
1001===texture.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),_gl.texParameteri(textureType,10240,filterFallback(texture.magFilter)),_gl.texParameteri(textureType,10241,filterFallback(texture.minFilter)),1003!==texture.minFilter&&1006!==texture.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
!(supportsMips=extensions.get("EXT_texture_filter_anisotropic"))||1015===texture.type&&null===extensions.get("OES_texture_float_linear")||1016===texture.type&&null===(isWebGL2||extensions.get("OES_texture_half_float_linear"))||!(1<texture.anisotropy||properties.get(texture).__currentAnisotropy)||(_gl.texParameterf(textureType,supportsMips.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(texture.anisotropy,capabilities.getMaxAnisotropy())),properties.get(texture).__currentAnisotropy=texture.anisotropy)}function initTexture(textureProperties,
texture){void 0===textureProperties.__webglInit&&(textureProperties.__webglInit=!0,texture.addEventListener("dispose",onTextureDispose),textureProperties.__webglTexture=_gl.createTexture(),info.memory.textures++)}function uploadTexture(textureProperties,texture,slot){var textureType=3553;texture.isDataTexture2DArray&&(textureType=35866);texture.isDataTexture3D&&(textureType=32879);initTexture(textureProperties,texture);state.activeTexture(33984+slot);state.bindTexture(textureType,textureProperties.__webglTexture);
_gl.pixelStorei(37440,texture.flipY);_gl.pixelStorei(37441,texture.premultiplyAlpha);_gl.pixelStorei(3317,texture.unpackAlignment);slot=isWebGL2?!1:1001!==texture.wrapS||1001!==texture.wrapT||1003!==texture.minFilter&&1006!==texture.minFilter;slot=slot&&!1===isPowerOfTwo(texture.image);slot=resizeImage(texture.image,slot,!1,maxTextureSize);var supportsMips=isPowerOfTwo(slot)||isWebGL2,glFormat=utils.convert(texture.format),glType=utils.convert(texture.type),glInternalFormat=getInternalFormat(texture.internalFormat,
glFormat,glType);setTextureParameters(textureType,texture,supportsMips);var mipmaps=texture.mipmaps;if(texture.isDepthTexture)glInternalFormat=6402,isWebGL2?glInternalFormat=1015===texture.type?36012:1014===texture.type?33190:1020===texture.type?35056:33189:1015===texture.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===texture.format&&6402===glInternalFormat&&1012!==texture.type&&1014!==texture.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),
texture.type=1012,glType=utils.convert(texture.type)),1027===texture.format&&6402===glInternalFormat&&(glInternalFormat=34041,1020!==texture.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),texture.type=1020,glType=utils.convert(texture.type))),state.texImage2D(3553,0,glInternalFormat,slot.width,slot.height,0,glFormat,glType,null);else if(texture.isDataTexture)if(0<mipmaps.length&&supportsMips){for(var i=0,il=mipmaps.length;i<il;i++){var mipmap=
mipmaps[i];state.texImage2D(3553,i,glInternalFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data)}texture.generateMipmaps=!1;textureProperties.__maxMipLevel=mipmaps.length-1}else state.texImage2D(3553,0,glInternalFormat,slot.width,slot.height,0,glFormat,glType,slot.data),textureProperties.__maxMipLevel=0;else if(texture.isCompressedTexture){i=0;for(il=mipmaps.length;i<il;i++)mipmap=mipmaps[i],1023!==texture.format&&1022!==texture.format?null!==glFormat?state.compressedTexImage2D(3553,
i,glInternalFormat,mipmap.width,mipmap.height,0,mipmap.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):state.texImage2D(3553,i,glInternalFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);textureProperties.__maxMipLevel=mipmaps.length-1}else if(texture.isDataTexture2DArray)state.texImage3D(35866,0,glInternalFormat,slot.width,slot.height,slot.depth,0,glFormat,glType,slot.data),textureProperties.__maxMipLevel=0;else if(texture.isDataTexture3D)state.texImage3D(32879,
0,glInternalFormat,slot.width,slot.height,slot.depth,0,glFormat,glType,slot.data),textureProperties.__maxMipLevel=0;else if(0<mipmaps.length&&supportsMips){i=0;for(il=mipmaps.length;i<il;i++)mipmap=mipmaps[i],state.texImage2D(3553,i,glInternalFormat,glFormat,glType,mipmap);texture.generateMipmaps=!1;textureProperties.__maxMipLevel=mipmaps.length-1}else state.texImage2D(3553,0,glInternalFormat,glFormat,glType,slot),textureProperties.__maxMipLevel=0;textureNeedsGenerateMipmaps(texture,supportsMips)&&
generateMipmap(textureType,texture,slot.width,slot.height);textureProperties.__version=texture.version;if(texture.onUpdate)texture.onUpdate(texture)}function setupFrameBufferTexture(framebuffer,renderTarget,attachment,textureTarget){var glFormat=utils.convert(renderTarget.texture.format),glType=utils.convert(renderTarget.texture.type),glInternalFormat=getInternalFormat(renderTarget.texture.internalFormat,glFormat,glType);state.texImage2D(textureTarget,0,glInternalFormat,renderTarget.width,renderTarget.height,
0,glFormat,glType,null);_gl.bindFramebuffer(36160,framebuffer);_gl.framebufferTexture2D(36160,attachment,textureTarget,properties.get(renderTarget.texture).__webglTexture,0);_gl.bindFramebuffer(36160,null)}function setupRenderBufferStorage(renderbuffer,renderTarget,isMultisample){_gl.bindRenderbuffer(36161,renderbuffer);if(renderTarget.depthBuffer&&!renderTarget.stencilBuffer){var glInternalFormat=33189;isMultisample?((isMultisample=renderTarget.depthTexture)&&isMultisample.isDepthTexture&&(1015===
isMultisample.type?glInternalFormat=36012:1014===isMultisample.type&&(glInternalFormat=33190)),isMultisample=getRenderTargetSamples(renderTarget),_gl.renderbufferStorageMultisample(36161,isMultisample,glInternalFormat,renderTarget.width,renderTarget.height)):_gl.renderbufferStorage(36161,glInternalFormat,renderTarget.width,renderTarget.height);_gl.framebufferRenderbuffer(36160,36096,36161,renderbuffer)}else renderTarget.depthBuffer&&renderTarget.stencilBuffer?(isMultisample?(isMultisample=getRenderTargetSamples(renderTarget),
_gl.renderbufferStorageMultisample(36161,isMultisample,35056,renderTarget.width,renderTarget.height)):_gl.renderbufferStorage(36161,34041,renderTarget.width,renderTarget.height),_gl.framebufferRenderbuffer(36160,33306,36161,renderbuffer)):(renderbuffer=utils.convert(renderTarget.texture.format),glInternalFormat=utils.convert(renderTarget.texture.type),renderbuffer=getInternalFormat(renderTarget.texture.internalFormat,renderbuffer,glInternalFormat),isMultisample?(isMultisample=getRenderTargetSamples(renderTarget),
_gl.renderbufferStorageMultisample(36161,isMultisample,renderbuffer,renderTarget.width,renderTarget.height)):_gl.renderbufferStorage(36161,renderbuffer,renderTarget.width,renderTarget.height));_gl.bindRenderbuffer(36161,null)}function getRenderTargetSamples(renderTarget){return isWebGL2&&renderTarget.isWebGLMultisampleRenderTarget?Math.min(maxSamples,renderTarget.samples):0}var _wrappingToGL,_filterToGL,isWebGL2=capabilities.isWebGL2,maxTextures=capabilities.maxTextures,maxCubemapSize=capabilities.maxCubemapSize,
maxTextureSize=capabilities.maxTextureSize,maxSamples=capabilities.maxSamples,_videoTextures=new WeakMap,_canvas,useOffscreenCanvas=!1;try{useOffscreenCanvas="undefined"!==typeof OffscreenCanvas&&null!==(new OffscreenCanvas(1,1)).getContext("2d")}catch(err){}var textureUnits=0,wrappingToGL=(_wrappingToGL={},_wrappingToGL[1E3]=10497,_wrappingToGL[1001]=33071,_wrappingToGL[1002]=33648,_wrappingToGL),filterToGL=(_filterToGL={},_filterToGL[1003]=9728,_filterToGL[1004]=9984,_filterToGL[1005]=9986,_filterToGL[1006]=
9729,_filterToGL[1007]=9985,_filterToGL[1008]=9987,_filterToGL),warnedTexture2D=!1,warnedTextureCube=!1;this.allocateTextureUnit=function(){var textureUnit=textureUnits;textureUnit>=maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+textureUnit+" texture units while this GPU supports only "+maxTextures);textureUnits+=1;return textureUnit};this.resetTextureUnits=function(){textureUnits=0};this.setTexture2D=setTexture2D;this.setTexture2DArray=function(texture,slot){var textureProperties=
properties.get(texture);0<texture.version&&textureProperties.__version!==texture.version?uploadTexture(textureProperties,texture,slot):(state.activeTexture(33984+slot),state.bindTexture(35866,textureProperties.__webglTexture))};this.setTexture3D=function(texture,slot){var textureProperties=properties.get(texture);0<texture.version&&textureProperties.__version!==texture.version?uploadTexture(textureProperties,texture,slot):(state.activeTexture(33984+slot),state.bindTexture(32879,textureProperties.__webglTexture))};
this.setTextureCube=setTextureCube;this.setupRenderTarget=function(renderTarget){var renderTargetProperties=properties.get(renderTarget),textureProperties=properties.get(renderTarget.texture);renderTarget.addEventListener("dispose",onRenderTargetDispose);textureProperties.__webglTexture=_gl.createTexture();info.memory.textures++;var isCube=!0===renderTarget.isWebGLCubeRenderTarget,isMultisample=!0===renderTarget.isWebGLMultisampleRenderTarget,supportsMips=isPowerOfTwo(renderTarget)||isWebGL2;!isWebGL2||
1022!==renderTarget.texture.format||1015!==renderTarget.texture.type&&1016!==renderTarget.texture.type||(renderTarget.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead."));if(isCube)for(renderTargetProperties.__webglFramebuffer=[],isMultisample=0;6>isMultisample;isMultisample++)renderTargetProperties.__webglFramebuffer[isMultisample]=_gl.createFramebuffer();else if(renderTargetProperties.__webglFramebuffer=_gl.createFramebuffer(),
isMultisample)if(isWebGL2){renderTargetProperties.__webglMultisampledFramebuffer=_gl.createFramebuffer();renderTargetProperties.__webglColorRenderbuffer=_gl.createRenderbuffer();_gl.bindRenderbuffer(36161,renderTargetProperties.__webglColorRenderbuffer);isMultisample=utils.convert(renderTarget.texture.format);var glType=utils.convert(renderTarget.texture.type);isMultisample=getInternalFormat(renderTarget.texture.internalFormat,isMultisample,glType);glType=getRenderTargetSamples(renderTarget);_gl.renderbufferStorageMultisample(36161,
glType,isMultisample,renderTarget.width,renderTarget.height);_gl.bindFramebuffer(36160,renderTargetProperties.__webglMultisampledFramebuffer);_gl.framebufferRenderbuffer(36160,36064,36161,renderTargetProperties.__webglColorRenderbuffer);_gl.bindRenderbuffer(36161,null);renderTarget.depthBuffer&&(renderTargetProperties.__webglDepthRenderbuffer=_gl.createRenderbuffer(),setupRenderBufferStorage(renderTargetProperties.__webglDepthRenderbuffer,renderTarget,!0));_gl.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
if(isCube){state.bindTexture(34067,textureProperties.__webglTexture);setTextureParameters(34067,renderTarget.texture,supportsMips);for(textureProperties=0;6>textureProperties;textureProperties++)setupFrameBufferTexture(renderTargetProperties.__webglFramebuffer[textureProperties],renderTarget,36064,34069+textureProperties);textureNeedsGenerateMipmaps(renderTarget.texture,supportsMips)&&generateMipmap(34067,renderTarget.texture,renderTarget.width,renderTarget.height);state.bindTexture(34067,null)}else state.bindTexture(3553,
textureProperties.__webglTexture),setTextureParameters(3553,renderTarget.texture,supportsMips),setupFrameBufferTexture(renderTargetProperties.__webglFramebuffer,renderTarget,36064,3553),textureNeedsGenerateMipmaps(renderTarget.texture,supportsMips)&&generateMipmap(3553,renderTarget.texture,renderTarget.width,renderTarget.height),state.bindTexture(3553,null);if(renderTarget.depthBuffer){renderTargetProperties=properties.get(renderTarget);supportsMips=!0===renderTarget.isWebGLCubeRenderTarget;if(renderTarget.depthTexture){if(supportsMips)throw Error("target.depthTexture not supported in Cube render targets");
if(renderTarget&&renderTarget.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");_gl.bindFramebuffer(36160,renderTargetProperties.__webglFramebuffer);if(!renderTarget.depthTexture||!renderTarget.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");properties.get(renderTarget.depthTexture).__webglTexture&&renderTarget.depthTexture.image.width===renderTarget.width&&renderTarget.depthTexture.image.height===
renderTarget.height||(renderTarget.depthTexture.image.width=renderTarget.width,renderTarget.depthTexture.image.height=renderTarget.height,renderTarget.depthTexture.needsUpdate=!0);setTexture2D(renderTarget.depthTexture,0);renderTargetProperties=properties.get(renderTarget.depthTexture).__webglTexture;if(1026===renderTarget.depthTexture.format)_gl.framebufferTexture2D(36160,36096,3553,renderTargetProperties,0);else if(1027===renderTarget.depthTexture.format)_gl.framebufferTexture2D(36160,33306,3553,
renderTargetProperties,0);else throw Error("Unknown depthTexture format");}else if(supportsMips)for(renderTargetProperties.__webglDepthbuffer=[],supportsMips=0;6>supportsMips;supportsMips++)_gl.bindFramebuffer(36160,renderTargetProperties.__webglFramebuffer[supportsMips]),renderTargetProperties.__webglDepthbuffer[supportsMips]=_gl.createRenderbuffer(),setupRenderBufferStorage(renderTargetProperties.__webglDepthbuffer[supportsMips],renderTarget,!1);else _gl.bindFramebuffer(36160,renderTargetProperties.__webglFramebuffer),
renderTargetProperties.__webglDepthbuffer=_gl.createRenderbuffer(),setupRenderBufferStorage(renderTargetProperties.__webglDepthbuffer,renderTarget,!1);_gl.bindFramebuffer(36160,null)}};this.updateRenderTargetMipmap=function(renderTarget){var texture=renderTarget.texture,supportsMips=isPowerOfTwo(renderTarget)||isWebGL2;if(textureNeedsGenerateMipmaps(texture,supportsMips)){supportsMips=renderTarget.isWebGLCubeRenderTarget?34067:3553;var webglTexture=properties.get(texture).__webglTexture;state.bindTexture(supportsMips,
webglTexture);generateMipmap(supportsMips,texture,renderTarget.width,renderTarget.height);state.bindTexture(supportsMips,null)}};this.updateMultisampleRenderTarget=function(renderTarget){if(renderTarget.isWebGLMultisampleRenderTarget)if(isWebGL2){var renderTargetProperties=properties.get(renderTarget);_gl.bindFramebuffer(36008,renderTargetProperties.__webglMultisampledFramebuffer);_gl.bindFramebuffer(36009,renderTargetProperties.__webglFramebuffer);var width=renderTarget.width,height=renderTarget.height,
mask=16384;renderTarget.depthBuffer&&(mask|=256);renderTarget.stencilBuffer&&(mask|=1024);_gl.blitFramebuffer(0,0,width,height,0,0,width,height,mask,9728);_gl.bindFramebuffer(36160,renderTargetProperties.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")};this.safeSetTexture2D=function(texture,slot){texture&&texture.isWebGLRenderTarget&&(!1===warnedTexture2D&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),
warnedTexture2D=!0),texture=texture.texture);setTexture2D(texture,slot)};this.safeSetTextureCube=function(texture,slot){texture&&texture.isWebGLCubeRenderTarget&&(!1===warnedTextureCube&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),warnedTextureCube=!0),texture=texture.texture);setTextureCube(texture,slot)}}function WebGLUtils(gl,extensions,capabilities){var isWebGL2=capabilities.isWebGL2;return{convert:function(p){if(1009===
p)return 5121;if(1017===p)return 32819;if(1018===p)return 32820;if(1019===p)return 33635;if(1010===p)return 5120;if(1011===p)return 5122;if(1012===p)return 5123;if(1013===p)return 5124;if(1014===p)return 5125;if(1015===p)return 5126;if(1016===p){if(isWebGL2)return 5131;var extension=extensions.get("OES_texture_half_float");return null!==extension?extension.HALF_FLOAT_OES:null}if(1021===p)return 6406;if(1022===p)return 6407;if(1023===p)return 6408;if(1024===p)return 6409;if(1025===p)return 6410;if(1026===
p)return 6402;if(1027===p)return 34041;if(1028===p)return 6403;if(1029===p)return 36244;if(1030===p)return 33319;if(1031===p)return 33320;if(1032===p)return 36248;if(1033===p)return 36249;if(33776===p||33777===p||33778===p||33779===p)if(extension=extensions.get("WEBGL_compressed_texture_s3tc"),null!==extension){if(33776===p)return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===p)return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===p)return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===
p)return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(35840===p||35841===p||35842===p||35843===p)if(extension=extensions.get("WEBGL_compressed_texture_pvrtc"),null!==extension){if(35840===p)return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===p)return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===p)return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===p)return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(36196===p)return extension=extensions.get("WEBGL_compressed_texture_etc1"),
null!==extension?extension.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===p||37496===p)if(extension=extensions.get("WEBGL_compressed_texture_etc"),null!==extension){if(37492===p)return extension.COMPRESSED_RGB8_ETC2;if(37496===p)return extension.COMPRESSED_RGBA8_ETC2_EAC}if(37808===p||37809===p||37810===p||37811===p||37812===p||37813===p||37814===p||37815===p||37816===p||37817===p||37818===p||37819===p||37820===p||37821===p||37840===p||37841===p||37842===p||37843===p||37844===p||37845===p||37846===p||
37847===p||37848===p||37849===p||37850===p||37851===p||37852===p||37853===p)return extension=extensions.get("WEBGL_compressed_texture_astc"),null!==extension?p:null;if(36492===p)return extension=extensions.get("EXT_texture_compression_bptc"),null!==extension?p:null;if(1020===p){if(isWebGL2)return 34042;extension=extensions.get("WEBGL_depth_texture");return null!==extension?extension.UNSIGNED_INT_24_8_WEBGL:null}}}}function Group(){Object3D.call(this);this.type="Group"}function ArrayCamera(array){void 0===
array&&(array=[]);PerspectiveCamera.call(this);this.cameras=array}function WebVRManager(renderer){function onVRDisplayPresentChange(){if(scope.isPresenting=null!==device&&!0===device.isPresenting){var eyeParameters=device.getEyeParameters("left");renderWidth=2*eyeParameters.renderWidth*framebufferScaleFactor;renderHeight=eyeParameters.renderHeight*framebufferScaleFactor;currentPixelRatio=renderer.getPixelRatio();renderer.getSize(currentSize);renderer.setDrawingBufferSize(renderWidth,renderHeight,
1);cameraL.viewport.set(0,0,renderWidth/2,renderHeight);cameraR.viewport.set(renderWidth/2,0,renderWidth/2,renderHeight);animation.start();scope.dispatchEvent({type:"sessionstart"})}else scope.enabled&&renderer.setDrawingBufferSize(currentSize.width,currentSize.height,currentPixelRatio),animation.stop(),scope.dispatchEvent({type:"sessionend"})}function updateViewportFromBounds(viewport,bounds){null!==bounds&&4===bounds.length&&viewport.set(bounds[0]*renderWidth,bounds[1]*renderHeight,bounds[2]*renderWidth,
bounds[3]*renderHeight)}var renderWidth,renderHeight,scope=this,device=null,frameData=null,poseTarget=null,controllers=[],standingMatrix=new Matrix4,standingMatrixInverse=new Matrix4,framebufferScaleFactor=1,referenceSpaceType="local-floor";"undefined"!==typeof window&&"VRFrameData"in window&&(frameData=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",onVRDisplayPresentChange,!1));var matrixWorldInverse=new Matrix4,tempQuaternion=new Quaternion,tempPosition=new Vector3,cameraL=
new PerspectiveCamera;cameraL.viewport=new Vector4;cameraL.layers.enable(1);var cameraR=new PerspectiveCamera;cameraR.viewport=new Vector4;cameraR.layers.enable(2);var cameraVR=new ArrayCamera([cameraL,cameraR]);cameraVR.layers.enable(1);cameraVR.layers.enable(2);var currentSize=new Vector2,currentPixelRatio,triggers=[],grips=[];this.enabled=!1;this.getController=function(id){var controller=controllers[id];void 0===controller&&(controller=new Group,controller.matrixAutoUpdate=!1,controller.visible=
!1,controllers[id]=controller);return controller};this.getDevice=function(){return device};this.setDevice=function(value){void 0!==value&&(device=value);animation.setContext(value)};this.setFramebufferScaleFactor=function(value){framebufferScaleFactor=value};this.setReferenceSpaceType=function(value){referenceSpaceType=value};this.setPoseTarget=function(object){void 0!==object&&(poseTarget=object)};this.getCamera=function(camera){var userHeight="local-floor"===referenceSpaceType?1.6:0;device.depthNear=
camera.near;device.depthFar=camera.far;device.getFrameData(frameData);if("local-floor"===referenceSpaceType){var stageParameters=device.stageParameters;stageParameters?standingMatrix.fromArray(stageParameters.sittingToStandingTransform):standingMatrix.makeTranslation(0,userHeight,0)}stageParameters=frameData.pose;userHeight=null!==poseTarget?poseTarget:camera;userHeight.matrix.copy(standingMatrix);userHeight.matrix.decompose(userHeight.position,userHeight.quaternion,userHeight.scale);null!==stageParameters.orientation&&
(tempQuaternion.fromArray(stageParameters.orientation),userHeight.quaternion.multiply(tempQuaternion));null!==stageParameters.position&&(tempQuaternion.setFromRotationMatrix(standingMatrix),tempPosition.fromArray(stageParameters.position),tempPosition.applyQuaternion(tempQuaternion),userHeight.position.add(tempPosition));userHeight.updateMatrixWorld();stageParameters=userHeight.children;for(var i=0,l=stageParameters.length;i<l;i++)stageParameters[i].updateMatrixWorld(!0);cameraL.near=camera.near;
cameraR.near=camera.near;cameraL.far=camera.far;cameraR.far=camera.far;cameraL.matrixWorldInverse.fromArray(frameData.leftViewMatrix);cameraR.matrixWorldInverse.fromArray(frameData.rightViewMatrix);standingMatrixInverse.getInverse(standingMatrix);"local-floor"===referenceSpaceType&&(cameraL.matrixWorldInverse.multiply(standingMatrixInverse),cameraR.matrixWorldInverse.multiply(standingMatrixInverse));camera=userHeight.parent;null!==camera&&(matrixWorldInverse.getInverse(camera.matrixWorld),cameraL.matrixWorldInverse.multiply(matrixWorldInverse),
cameraR.matrixWorldInverse.multiply(matrixWorldInverse));cameraL.matrixWorld.getInverse(cameraL.matrixWorldInverse);cameraR.matrixWorld.getInverse(cameraR.matrixWorldInverse);cameraL.projectionMatrix.fromArray(frameData.leftProjectionMatrix);cameraR.projectionMatrix.fromArray(frameData.rightProjectionMatrix);l=cameraL;userHeight=cameraR;cameraLPos.setFromMatrixPosition(l.matrixWorld);cameraRPos.setFromMatrixPosition(userHeight.matrixWorld);camera=cameraLPos.distanceTo(cameraRPos);var projL=l.projectionMatrix.elements,
projR=userHeight.projectionMatrix.elements,near=projL[14]/(projL[10]-1);userHeight=projL[14]/(projL[10]+1);stageParameters=(projL[9]+1)/projL[5];i=(projL[9]-1)/projL[5];var leftFov=(projL[8]-1)/projL[0],rightFov=(projR[8]+1)/projR[0];projL=near*leftFov;projR=near*rightFov;rightFov=camera/(-leftFov+rightFov);leftFov=rightFov*-leftFov;l.matrixWorld.decompose(cameraVR.position,cameraVR.quaternion,cameraVR.scale);cameraVR.translateX(leftFov);cameraVR.translateZ(rightFov);cameraVR.matrixWorld.compose(cameraVR.position,
cameraVR.quaternion,cameraVR.scale);cameraVR.matrixWorldInverse.getInverse(cameraVR.matrixWorld);l=near+rightFov;near=userHeight+rightFov;cameraVR.projectionMatrix.makePerspective(projL-leftFov,projR+(camera-leftFov),stageParameters*userHeight/near*l,i*userHeight/near*l,l,near);camera=device.getLayers();camera.length&&(camera=camera[0],updateViewportFromBounds(cameraL.viewport,camera.leftBounds),updateViewportFromBounds(cameraR.viewport,camera.rightBounds));a:for(camera=0;camera<controllers.length;camera++){userHeight=
controllers[camera];b:{stageParameters=camera;i=navigator.getGamepads&&navigator.getGamepads();l=0;for(near=i.length;l<near;l++)if((projL=i[l])&&("Daydream Controller"===projL.id||"Gear VR Controller"===projL.id||"Oculus Go Controller"===projL.id||"OpenVR Gamepad"===projL.id||projL.id.startsWith("Oculus Touch")||projL.id.startsWith("HTC Vive Focus")||projL.id.startsWith("Spatial Controller"))&&(projR=projL.hand,0===stageParameters&&(""===projR||"right"===projR)||1===stageParameters&&"left"===projR)){stageParameters=
projL;break b}stageParameters=void 0}if(void 0!==stageParameters&&void 0!==stageParameters.pose){if(null===stageParameters.pose)break a;i=stageParameters.pose;!1===i.hasPosition&&userHeight.position.set(.2,-.6,-.05);null!==i.position&&userHeight.position.fromArray(i.position);null!==i.orientation&&userHeight.quaternion.fromArray(i.orientation);userHeight.matrix.compose(userHeight.position,userHeight.quaternion,userHeight.scale);userHeight.matrix.premultiply(standingMatrix);userHeight.matrix.decompose(userHeight.position,
userHeight.quaternion,userHeight.scale);userHeight.matrixWorldNeedsUpdate=!0;userHeight.visible=!0;i="Daydream Controller"===stageParameters.id?0:1;void 0===triggers[camera]&&(triggers[camera]=!1);triggers[camera]!==stageParameters.buttons[i].pressed&&(triggers[camera]=stageParameters.buttons[i].pressed,!0===triggers[camera]?userHeight.dispatchEvent({type:"selectstart"}):(userHeight.dispatchEvent({type:"selectend"}),userHeight.dispatchEvent({type:"select"})));i=2;void 0===grips[camera]&&(grips[camera]=
!1);void 0!==stageParameters.buttons[i]&&grips[camera]!==stageParameters.buttons[i].pressed&&(grips[camera]=stageParameters.buttons[i].pressed,!0===grips[camera]?userHeight.dispatchEvent({type:"squeezestart"}):(userHeight.dispatchEvent({type:"squeezeend"}),userHeight.dispatchEvent({type:"squeeze"})))}else userHeight.visible=!1}return cameraVR};this.getStandingMatrix=function(){return standingMatrix};this.isPresenting=!1;var animation=new WebGLAnimation;this.setAnimationLoop=function(callback){animation.setAnimationLoop(callback);
this.isPresenting&&animation.start()};this.submitFrame=function(){this.isPresenting&&device.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",onVRDisplayPresentChange)};this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function WebXRController(){this._hand=this._grip=this._targetRay=null}function WebXRManager(renderer,gl){function onSessionEvent(event){var controller=
inputSourcesMap.get(event.inputSource);controller&&controller.dispatchEvent({type:event.type,data:event.inputSource})}function onSessionEnd(){inputSourcesMap.forEach(function(controller,inputSource){controller.disconnect(inputSource)});inputSourcesMap.clear();renderer.setFramebuffer(null);renderer.setRenderTarget(renderer.getRenderTarget());animation.stop();scope.isPresenting=!1;scope.dispatchEvent({type:"sessionend"})}function onRequestReferenceSpace(value){referenceSpace=value;animation.setContext(session);
animation.start();scope.isPresenting=!0;scope.dispatchEvent({type:"sessionstart"})}function updateInputSources(event){for(var inputSources=session.inputSources,i=0;i<controllers.length;i++)inputSourcesMap.set(inputSources[i],controllers[i]);for(inputSources=0;inputSources<event.removed.length;inputSources++){i=event.removed[inputSources];var controller=inputSourcesMap.get(i);controller&&(controller.dispatchEvent({type:"disconnected",data:i}),inputSourcesMap.delete(i))}for(inputSources=0;inputSources<
event.added.length;inputSources++)i=event.added[inputSources],(controller=inputSourcesMap.get(i))&&controller.dispatchEvent({type:"connected",data:i})}function updateCamera(camera,parent){null===parent?camera.matrixWorld.copy(camera.matrix):camera.matrixWorld.multiplyMatrices(parent.matrixWorld,camera.matrix);camera.matrixWorldInverse.copy(camera.matrixWorld).invert()}var scope=this,session=null,framebufferScaleFactor=1,referenceSpace=null,referenceSpaceType="local-floor",pose=null,poseTarget=null,
controllers=[],inputSourcesMap=new Map,layers=[],baseLayer,cameraL=new PerspectiveCamera;cameraL.layers.enable(1);cameraL.viewport=new Vector4;var cameraR=new PerspectiveCamera;cameraR.layers.enable(2);cameraR.viewport=new Vector4;var cameras$jscomp$0=[cameraL,cameraR],cameraVR=new ArrayCamera;cameraVR.layers.enable(1);cameraVR.layers.enable(2);var _currentDepthNear=null,_currentDepthFar=null;this.isPresenting=this.enabled=this.layersEnabled=!1;this.getCameraPose=function(){return pose};this.getController=
function(id){id=controllers[index];void 0===id&&(id=new WebXRController,controllers[index]=id);return id.getTargetRaySpace()};this.getControllerGrip=function(index){var controller=controllers[index];void 0===controller&&(controller=new WebXRController,controllers[index]=controller);return controller.getGripSpace()};this.getHand=function(index){var controller=controllers[index];void 0===controller&&(controller=new WebXRController,controllers[index]=controller);return controller.getHandSpace()};this.setFramebufferScaleFactor=
function(value){framebufferScaleFactor=value;!0===scope.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(value){referenceSpaceType=value;!0===scope.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};this.getReferenceSpace=function(){return referenceSpace};this.getSession=function(){return session};this.addLayer=function(layer){window.XRWebGLBinding&&this.layersEnabled&&
session&&(layers.push(layer),session.updateRenderState({layers:layers}))};this.removeLayer=function(layer){window.XRWebGLBinding&&this.layersEnabled&&session&&(layers.splice(layers.indexOf(layer),1),session.updateRenderState({layers:layers}))};this.setSession=function(value){session=value;null!==session&&(session.addEventListener("select",onSessionEvent),session.addEventListener("selectstart",onSessionEvent),session.addEventListener("selectend",onSessionEvent),session.addEventListener("squeeze",onSessionEvent),
session.addEventListener("squeezestart",onSessionEvent),session.addEventListener("squeezeend",onSessionEvent),session.addEventListener("end",onSessionEnd),value=gl.getContextAttributes(),!0!==value.xrCompatible&&gl.makeXRCompatible(),baseLayer=new XRWebGLLayer(session,gl,{antialias:value.antialias,alpha:value.alpha,depth:value.depth,stencil:value.stencil,framebufferScaleFactor:framebufferScaleFactor}),window.XRWebGLBinding&&this.layersEnabled?this.addLayer(baseLayer):session.updateRenderState({baseLayer:baseLayer}),
session.requestReferenceSpace(referenceSpaceType).then(onRequestReferenceSpace),session.addEventListener("inputsourceschange",updateInputSources))};var cameraLPos=new Vector3,cameraRPos=new Vector3;this.setPoseTarget=function(object){void 0!==object&&(poseTarget=object)};this.getCamera=function(camera){cameraVR.near=cameraR.near=cameraL.near=camera.near;cameraVR.far=cameraR.far=cameraL.far=camera.far;if(_currentDepthNear!==cameraVR.near||_currentDepthFar!==cameraVR.far)session.updateRenderState({depthNear:cameraVR.near,
depthFar:cameraVR.far}),_currentDepthNear=cameraVR.near,_currentDepthFar=cameraVR.far;var parent=camera.parent,cameras=cameraVR.cameras;camera=poseTarget||camera;updateCamera(cameraVR,parent);for(var i=0;i<cameras.length;i++)updateCamera(cameras[i],parent);camera.matrixWorld.copy(cameraVR.matrixWorld);parent=camera.children;camera=0;for(i=parent.length;camera<i;camera++)parent[camera].updateMatrixWorld(!0);if(2===cameras.length){cameraLPos.setFromMatrixPosition(cameraL.matrixWorld);cameraRPos.setFromMatrixPosition(cameraR.matrixWorld);
cameras=cameraLPos.distanceTo(cameraRPos);var projL=cameraL.projectionMatrix.elements,projR=cameraR.projectionMatrix.elements,near=projL[14]/(projL[10]-1);parent=projL[14]/(projL[10]+1);camera=(projL[9]+1)/projL[5];i=(projL[9]-1)/projL[5];var leftFov=(projL[8]-1)/projL[0],rightFov=(projR[8]+1)/projR[0];projR=near*leftFov;projL=near*rightFov;rightFov=cameras/(-leftFov+rightFov);leftFov=rightFov*-leftFov;cameraL.matrixWorld.decompose(cameraVR.position,cameraVR.quaternion,cameraVR.scale);cameraVR.translateX(leftFov);
cameraVR.translateZ(rightFov);cameraVR.matrixWorld.compose(cameraVR.position,cameraVR.quaternion,cameraVR.scale);cameraVR.matrixWorldInverse.copy(cameraVR.matrixWorld).invert();near+=rightFov;rightFov=parent+rightFov;cameraVR.projectionMatrix.makePerspective(projR-leftFov,projL+(cameras-leftFov),camera*parent/rightFov*near,i*parent/rightFov*near,near,rightFov)}else cameraVR.projectionMatrix.copy(cameraL.projectionMatrix);return cameraVR};var onAnimationFrameCallback=null,animation=new WebGLAnimation;
animation.setAnimationLoop(function(time,frame){pose=frame.getViewerPose(referenceSpace);if(null!==pose){var views=pose.views;renderer.setFramebuffer(baseLayer.framebuffer);var cameraVRNeedsUpdate=!1;views.length!==cameraVR.cameras.length&&(cameraVR.cameras.length=0,cameraVRNeedsUpdate=!0);for(var i=0;i<views.length;i++){var view=views[i],viewport=baseLayer.getViewport(view),camera=cameras$jscomp$0[i];camera.matrix.fromArray(view.transform.matrix);camera.projectionMatrix.fromArray(view.projectionMatrix);
camera.viewport.set(viewport.x,viewport.y,viewport.width,viewport.height);0===i&&cameraVR.matrix.copy(camera.matrix);!0===cameraVRNeedsUpdate&&cameraVR.cameras.push(camera)}}views=session.inputSources;for(cameraVRNeedsUpdate=0;cameraVRNeedsUpdate<controllers.length;cameraVRNeedsUpdate++)controllers[cameraVRNeedsUpdate].update(views[cameraVRNeedsUpdate],frame,referenceSpace);onAnimationFrameCallback&&onAnimationFrameCallback(time,frame)});this.setAnimationLoop=function(callback){onAnimationFrameCallback=
callback};this.dispose=function(){}}function WebGLMaterials(properties){function refreshUniformsCommon(uniforms,material){uniforms.opacity.value=material.opacity;material.color&&uniforms.diffuse.value.copy(material.color);material.emissive&&uniforms.emissive.value.copy(material.emissive).multiplyScalar(material.emissiveIntensity);material.map&&(uniforms.map.value=material.map);material.alphaMap&&(uniforms.alphaMap.value=material.alphaMap);material.specularMap&&(uniforms.specularMap.value=material.specularMap);
var envMap=properties.get(material).envMap;envMap&&(uniforms.envMap.value=envMap,uniforms.flipEnvMap.value=envMap.isCubeTexture&&envMap._needsFlipEnvMap?-1:1,uniforms.reflectivity.value=material.reflectivity,uniforms.refractionRatio.value=material.refractionRatio,envMap=properties.get(envMap).__maxMipLevel,void 0!==envMap&&(uniforms.maxMipLevel.value=envMap));material.lightMap&&(uniforms.lightMap.value=material.lightMap,uniforms.lightMapIntensity.value=material.lightMapIntensity);material.aoMap&&
(uniforms.aoMap.value=material.aoMap,uniforms.aoMapIntensity.value=material.aoMapIntensity);if(material.map)var uvScaleMap=material.map;else material.specularMap?uvScaleMap=material.specularMap:material.displacementMap?uvScaleMap=material.displacementMap:material.normalMap?uvScaleMap=material.normalMap:material.bumpMap?uvScaleMap=material.bumpMap:material.roughnessMap?uvScaleMap=material.roughnessMap:material.metalnessMap?uvScaleMap=material.metalnessMap:material.alphaMap?uvScaleMap=material.alphaMap:
material.emissiveMap?uvScaleMap=material.emissiveMap:material.clearcoatMap?uvScaleMap=material.clearcoatMap:material.clearcoatNormalMap?uvScaleMap=material.clearcoatNormalMap:material.clearcoatRoughnessMap&&(uvScaleMap=material.clearcoatRoughnessMap);void 0!==uvScaleMap&&(uvScaleMap.isWebGLRenderTarget&&(uvScaleMap=uvScaleMap.texture),!0===uvScaleMap.matrixAutoUpdate&&uvScaleMap.updateMatrix(),uniforms.uvTransform.value.copy(uvScaleMap.matrix));if(material.aoMap)var uv2ScaleMap=material.aoMap;else material.lightMap&&
(uv2ScaleMap=material.lightMap);void 0!==uv2ScaleMap&&(uv2ScaleMap.isWebGLRenderTarget&&(uv2ScaleMap=uv2ScaleMap.texture),!0===uv2ScaleMap.matrixAutoUpdate&&uv2ScaleMap.updateMatrix(),uniforms.uv2Transform.value.copy(uv2ScaleMap.matrix))}function refreshUniformsStandard(uniforms,material){uniforms.roughness.value=material.roughness;uniforms.metalness.value=material.metalness;material.roughnessMap&&(uniforms.roughnessMap.value=material.roughnessMap);material.metalnessMap&&(uniforms.metalnessMap.value=
material.metalnessMap);material.emissiveMap&&(uniforms.emissiveMap.value=material.emissiveMap);material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,uniforms.bumpScale.value=material.bumpScale,1===material.side&&(uniforms.bumpScale.value*=-1));material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale),1===material.side&&uniforms.normalScale.value.negate());material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,
uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);properties.get(material).envMap&&(uniforms.envMapIntensity.value=material.envMapIntensity)}return{refreshFogUniforms:function(uniforms,fog){uniforms.fogColor.value.copy(fog.color);fog.isFog?(uniforms.fogNear.value=fog.near,uniforms.fogFar.value=fog.far):fog.isFogExp2&&(uniforms.fogDensity.value=fog.density)},refreshMaterialUniforms:function(uniforms,material,pixelRatio,height){if(material.isMeshBasicMaterial)refreshUniformsCommon(uniforms,
material);else if(material.isMeshLambertMaterial)refreshUniformsCommon(uniforms,material),material.emissiveMap&&(uniforms.emissiveMap.value=material.emissiveMap);else if(material.isMeshToonMaterial)refreshUniformsCommon(uniforms,material),material.gradientMap&&(uniforms.gradientMap.value=material.gradientMap),material.emissiveMap&&(uniforms.emissiveMap.value=material.emissiveMap),material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,uniforms.bumpScale.value=material.bumpScale,1===material.side&&
(uniforms.bumpScale.value*=-1)),material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale),1===material.side&&uniforms.normalScale.value.negate()),material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);else if(material.isMeshPhongMaterial)refreshUniformsCommon(uniforms,material),uniforms.specular.value.copy(material.specular),
uniforms.shininess.value=Math.max(material.shininess,1E-4),material.emissiveMap&&(uniforms.emissiveMap.value=material.emissiveMap),material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,uniforms.bumpScale.value=material.bumpScale,1===material.side&&(uniforms.bumpScale.value*=-1)),material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale),1===material.side&&uniforms.normalScale.value.negate()),material.displacementMap&&(uniforms.displacementMap.value=
material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);else if(material.isMeshStandardMaterial)refreshUniformsCommon(uniforms,material),material.isMeshPhysicalMaterial?(refreshUniformsStandard(uniforms,material),uniforms.reflectivity.value=material.reflectivity,uniforms.clearcoat.value=material.clearcoat,uniforms.clearcoatRoughness.value=material.clearcoatRoughness,material.sheen&&uniforms.sheen.value.copy(material.sheen),
material.clearcoatMap&&(uniforms.clearcoatMap.value=material.clearcoatMap),material.clearcoatRoughnessMap&&(uniforms.clearcoatRoughnessMap.value=material.clearcoatRoughnessMap),material.clearcoatNormalMap&&(uniforms.clearcoatNormalScale.value.copy(material.clearcoatNormalScale),uniforms.clearcoatNormalMap.value=material.clearcoatNormalMap,1===material.side&&uniforms.clearcoatNormalScale.value.negate()),uniforms.transmission.value=material.transmission,material.transmissionMap&&(uniforms.transmissionMap.value=
material.transmissionMap)):refreshUniformsStandard(uniforms,material);else if(material.isMeshMatcapMaterial)refreshUniformsCommon(uniforms,material),material.matcap&&(uniforms.matcap.value=material.matcap),material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,uniforms.bumpScale.value=material.bumpScale,1===material.side&&(uniforms.bumpScale.value*=-1)),material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale),1===material.side&&uniforms.normalScale.value.negate()),
material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);else if(material.isMeshDepthMaterial)refreshUniformsCommon(uniforms,material),material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);else if(material.isMeshDistanceMaterial)refreshUniformsCommon(uniforms,
material),material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias),uniforms.referencePosition.value.copy(material.referencePosition),uniforms.nearDistance.value=material.nearDistance,uniforms.farDistance.value=material.farDistance;else if(material.isMeshNormalMaterial)refreshUniformsCommon(uniforms,material),material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,
uniforms.bumpScale.value=material.bumpScale,1===material.side&&(uniforms.bumpScale.value*=-1)),material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale),1===material.side&&uniforms.normalScale.value.negate()),material.displacementMap&&(uniforms.displacementMap.value=material.displacementMap,uniforms.displacementScale.value=material.displacementScale,uniforms.displacementBias.value=material.displacementBias);else if(material.isLineBasicMaterial)uniforms.diffuse.value.copy(material.color),
uniforms.opacity.value=material.opacity,material.isLineDashedMaterial&&(uniforms.dashSize.value=material.dashSize,uniforms.totalSize.value=material.dashSize+material.gapSize,uniforms.scale.value=material.scale);else if(material.isPointsMaterial){uniforms.diffuse.value.copy(material.color);uniforms.opacity.value=material.opacity;uniforms.size.value=material.size*pixelRatio;uniforms.scale.value=.5*height;material.map&&(uniforms.map.value=material.map);material.alphaMap&&(uniforms.alphaMap.value=material.alphaMap);
if(material.map)var uvScaleMap=material.map;else material.alphaMap&&(uvScaleMap=material.alphaMap);void 0!==uvScaleMap&&(!0===uvScaleMap.matrixAutoUpdate&&uvScaleMap.updateMatrix(),uniforms.uvTransform.value.copy(uvScaleMap.matrix))}else if(material.isSpriteMaterial){uniforms.diffuse.value.copy(material.color);uniforms.opacity.value=material.opacity;uniforms.rotation.value=material.rotation;material.map&&(uniforms.map.value=material.map);material.alphaMap&&(uniforms.alphaMap.value=material.alphaMap);
if(material.map)var uvScaleMap$jscomp$0=material.map;else material.alphaMap&&(uvScaleMap$jscomp$0=material.alphaMap);void 0!==uvScaleMap$jscomp$0&&(!0===uvScaleMap$jscomp$0.matrixAutoUpdate&&uvScaleMap$jscomp$0.updateMatrix(),uniforms.uvTransform.value.copy(uvScaleMap$jscomp$0.matrix))}else material.isShadowMaterial?(uniforms.color.value.copy(material.color),uniforms.opacity.value=material.opacity):material.isShaderMaterial&&(material.uniformsNeedUpdate=!1)}}}function createCanvasElement(){var canvas=
document.createElementNS("http://www.w3.org/1999/xhtml","canvas");canvas.style.display="block";return canvas}function WebGLRenderer(parameters){function getContext(contextNames,contextAttributes){for(var i=0;i<contextNames.length;i++){var context=_canvas.getContext(contextNames[i],contextAttributes);if(null!==context)return context}return null}function initGLContext(){extensions=new WebGLExtensions(_gl);capabilities=new WebGLCapabilities(_gl,extensions,parameters);!1===capabilities.isWebGL2&&(extensions.get("WEBGL_depth_texture"),
extensions.get("OES_texture_float"),extensions.get("OES_texture_half_float"),extensions.get("OES_texture_half_float_linear"),extensions.get("OES_standard_derivatives"),extensions.get("OES_element_index_uint"),extensions.get("OES_vertex_array_object"),extensions.get("ANGLE_instanced_arrays"));extensions.get("OES_texture_float_linear");utils=new WebGLUtils(_gl,extensions,capabilities);state=new WebGLState(_gl,extensions,capabilities);state.scissor(_currentScissor.copy(_scissor).multiplyScalar(_pixelRatio).floor());
state.viewport(_currentViewport.copy(_viewport).multiplyScalar(_pixelRatio).floor());info=new WebGLInfo(_gl);properties=new WebGLProperties;textures=new WebGLTextures(_gl,extensions,state,properties,capabilities,utils,info);cubemaps=new WebGLCubeMaps(_this);attributes=new WebGLAttributes(_gl,capabilities);bindingStates=new WebGLBindingStates(_gl,extensions,attributes,capabilities);geometries=new WebGLGeometries(_gl,attributes,info,bindingStates);objects=new WebGLObjects(_gl,geometries,attributes,
info);morphtargets=new WebGLMorphtargets(_gl);clipping=new WebGLClipping(properties);programCache=new WebGLPrograms(_this,cubemaps,extensions,capabilities,bindingStates,clipping);materials=new WebGLMaterials(properties);renderLists=new WebGLRenderLists(properties);renderStates=new WebGLRenderStates(extensions,capabilities);background=new WebGLBackground(_this,cubemaps,state,objects,_premultipliedAlpha);bufferRenderer=new WebGLBufferRenderer(_gl,extensions,info,capabilities);indexedBufferRenderer=
new WebGLIndexedBufferRenderer(_gl,extensions,info,capabilities);info.programs=programCache.programs;_this.capabilities=capabilities;_this.extensions=extensions;_this.properties=properties;_this.renderLists=renderLists;_this.state=state;_this.info=info}function onContextLost(event){event.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");_isContextLost=!0}function onContextRestore(){console.log("THREE.WebGLRenderer: Context Restored.");_isContextLost=!1;initGLContext()}function onMaterialDispose(event){event=
event.target;event.removeEventListener("dispose",onMaterialDispose);releaseMaterialProgramReference(event);properties.remove(event)}function releaseMaterialProgramReference(material){material=properties.get(material).program;void 0!==material&&programCache.releaseProgram(material)}function renderObjectImmediate(object$jscomp$0,program){object$jscomp$0.render(function(object){_this.renderBufferImmediate(object,program)})}function projectObject(object,camera,groupOrder,sortObjects){if(!1!==object.visible){if(object.layers.test(camera.layers))if(object.isGroup)groupOrder=
object.renderOrder;else if(object.isLOD)!0===object.autoUpdate&&object.update(camera);else if(object.isLight)currentRenderState.pushLight(object),object.castShadow&&currentRenderState.pushShadow(object);else if(object.isSprite){if(!object.frustumCulled||_frustum.intersectsSprite(object)){sortObjects&&_vector3.setFromMatrixPosition(object.matrixWorld).applyMatrix4(_projScreenMatrix);var geometry=objects.update(object),material=object.material;material.visible&&currentRenderList.push(object,geometry,
material,groupOrder,_vector3.z,null)}}else if(object.isImmediateRenderObject)sortObjects&&_vector3.setFromMatrixPosition(object.matrixWorld).applyMatrix4(_projScreenMatrix),currentRenderList.push(object,null,object.material,groupOrder,_vector3.z,null);else if(object.isMesh||object.isLine||object.isPoints)if(object.isSkinnedMesh&&object.skeleton.frame!==info.render.frame&&(object.skeleton.update(),object.skeleton.frame=info.render.frame),!object.frustumCulled||_frustum.intersectsObject(object))if(sortObjects&&
_vector3.setFromMatrixPosition(object.matrixWorld).applyMatrix4(_projScreenMatrix),geometry=objects.update(object),material=object.material,Array.isArray(material))for(var groups=geometry.groups,i=0,l=groups.length;i<l;i++){var group=groups[i],groupMaterial=material[group.materialIndex];groupMaterial&&groupMaterial.visible&&currentRenderList.push(object,geometry,groupMaterial,groupOrder,_vector3.z,group)}else material.visible&&currentRenderList.push(object,geometry,material,groupOrder,_vector3.z,
null);object=object.children;geometry=0;for(material=object.length;geometry<material;geometry++)projectObject(object[geometry],camera,groupOrder,sortObjects)}}function renderObjects(renderList,scene,camera){for(var overrideMaterial=!0===scene.isScene?scene.overrideMaterial:null,i=0,l=renderList.length;i<l;i++){var renderItem=renderList[i],object=renderItem.object,geometry=renderItem.geometry,material=null===overrideMaterial?renderItem.material:overrideMaterial;renderItem=renderItem.group;if(camera.isArrayCamera){_currentArrayCamera=
camera;for(var cameras=camera.cameras,j=0,jl=cameras.length;j<jl;j++){var camera2=cameras[j];object.layers.test(camera2.layers)&&(state.viewport(_currentViewport.copy(camera2.viewport)),currentRenderState.setupLights(camera2),renderObject(object,scene,camera2,geometry,material,renderItem))}}else _currentArrayCamera=null,renderObject(object,scene,camera,geometry,material,renderItem)}}function renderObject(object,scene,camera,geometry,material,group){object.onBeforeRender(_this,scene,camera,geometry,
material,group);currentRenderState=renderStates.get(scene,_currentArrayCamera||camera);object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld);object.normalMatrix.getNormalMatrix(object.modelViewMatrix);if(object.isImmediateRenderObject){var program=setProgram(camera,scene,material,object);state.setMaterial(material);bindingStates.reset();renderObjectImmediate(object,program)}else _this.renderBufferDirect(camera,scene,geometry,material,object,group);object.onAfterRender(_this,
scene,camera,geometry,material,group);currentRenderState=renderStates.get(scene,_currentArrayCamera||camera)}function initMaterial(material,scene,object){!0!==scene.isScene&&(scene=_emptyScene);var materialProperties=properties.get(material),lights=currentRenderState.state.lights,lightsStateVersion=lights.state.version;object=programCache.getParameters(material,lights.state,currentRenderState.state.shadowsArray,scene,object);var programCacheKey=programCache.getProgramCacheKey(object),program=materialProperties.program,
programChange=!0;if(void 0===program)material.addEventListener("dispose",onMaterialDispose);else if(program.cacheKey!==programCacheKey)releaseMaterialProgramReference(material);else{if(materialProperties.lightsStateVersion===lightsStateVersion&&void 0!==object.shaderID){scene=material.isMeshStandardMaterial?scene.environment:null;materialProperties.envMap=cubemaps.get(material.envMap||scene);return}programChange=!1}programChange&&(object.uniforms=programCache.getUniforms(material),material.onBeforeCompile(object,
_this),program=programCache.acquireProgram(object,programCacheKey),materialProperties.program=program,materialProperties.uniforms=object.uniforms,materialProperties.outputEncoding=object.outputEncoding);object=materialProperties.uniforms;if(!material.isShaderMaterial&&!material.isRawShaderMaterial||!0===material.clipping)materialProperties.numClippingPlanes=clipping.numPlanes,materialProperties.numIntersection=clipping.numIntersection,object.clippingPlanes=clipping.uniform;materialProperties.environment=
material.isMeshStandardMaterial?scene.environment:null;materialProperties.fog=scene.fog;materialProperties.envMap=cubemaps.get(material.envMap||materialProperties.environment);materialProperties.needsLights=material.isMeshLambertMaterial||material.isMeshToonMaterial||material.isMeshPhongMaterial||material.isMeshStandardMaterial||material.isShadowMaterial||material.isShaderMaterial&&!0===material.lights;materialProperties.lightsStateVersion=lightsStateVersion;materialProperties.needsLights&&(object.ambientLightColor.value=
lights.state.ambient,object.lightProbe.value=lights.state.probe,object.directionalLights.value=lights.state.directional,object.directionalLightShadows.value=lights.state.directionalShadow,object.spotLights.value=lights.state.spot,object.spotLightShadows.value=lights.state.spotShadow,object.rectAreaLights.value=lights.state.rectArea,object.ltc_1.value=lights.state.rectAreaLTC1,object.ltc_2.value=lights.state.rectAreaLTC2,object.pointLights.value=lights.state.point,object.pointLightShadows.value=lights.state.pointShadow,
object.hemisphereLights.value=lights.state.hemi,object.directionalShadowMap.value=lights.state.directionalShadowMap,object.directionalShadowMatrix.value=lights.state.directionalShadowMatrix,object.spotShadowMap.value=lights.state.spotShadowMap,object.spotShadowMatrix.value=lights.state.spotShadowMatrix,object.pointShadowMap.value=lights.state.pointShadowMap,object.pointShadowMatrix.value=lights.state.pointShadowMatrix);material=materialProperties.program.getUniforms();material=WebGLUniforms.seqWithValue(material.seq,
object);materialProperties.uniformsList=material}function setProgram(camera,scene,material,object){!0!==scene.isScene&&(scene=_emptyScene);textures.resetTextureUnits();var fog=scene.fog,environment=material.isMeshStandardMaterial?scene.environment:null,encoding=null===_currentRenderTarget?_this.outputEncoding:_currentRenderTarget.texture.encoding,envMap=cubemaps.get(material.envMap||environment),materialProperties=properties.get(material),lights=currentRenderState.state.lights;!0!==_clippingEnabled||
!0!==_localClippingEnabled&&camera===_currentCamera||clipping.setState(material,camera,camera===_currentCamera&&material.id===_currentMaterialId);material.version===materialProperties.__version?material.fog&&materialProperties.fog!==fog?initMaterial(material,scene,object):materialProperties.environment!==environment?initMaterial(material,scene,object):materialProperties.needsLights&&materialProperties.lightsStateVersion!==lights.state.version?initMaterial(material,scene,object):void 0===materialProperties.numClippingPlanes||
materialProperties.numClippingPlanes===clipping.numPlanes&&materialProperties.numIntersection===clipping.numIntersection?materialProperties.outputEncoding!==encoding?initMaterial(material,scene,object):materialProperties.envMap!==envMap&&initMaterial(material,scene,object):initMaterial(material,scene,object):(initMaterial(material,scene,object),materialProperties.__version=material.version);var refreshProgram=!1;lights=envMap=!1;scene=materialProperties.program;environment=scene.getUniforms();encoding=
materialProperties.uniforms;state.useProgram(scene.program)&&(lights=envMap=refreshProgram=!0);material.id!==_currentMaterialId&&(_currentMaterialId=material.id,envMap=!0);if(refreshProgram||_currentCamera!==camera){environment.setValue(_gl,"projectionMatrix",camera.projectionMatrix);capabilities.logarithmicDepthBuffer&&environment.setValue(_gl,"logDepthBufFC",2/(Math.log(camera.far+1)/Math.LN2));_currentCamera!==camera&&(_currentCamera=camera,lights=envMap=!0);if(material.isShaderMaterial||material.isMeshPhongMaterial||
material.isMeshToonMaterial||material.isMeshStandardMaterial||material.envMap)refreshProgram=environment.map.cameraPosition,void 0!==refreshProgram&&refreshProgram.setValue(_gl,_vector3.setFromMatrixPosition(camera.matrixWorld));(material.isMeshPhongMaterial||material.isMeshToonMaterial||material.isMeshLambertMaterial||material.isMeshBasicMaterial||material.isMeshStandardMaterial||material.isShaderMaterial)&&environment.setValue(_gl,"isOrthographic",!0===camera.isOrthographicCamera);(material.isMeshPhongMaterial||
material.isMeshToonMaterial||material.isMeshLambertMaterial||material.isMeshBasicMaterial||material.isMeshStandardMaterial||material.isShaderMaterial||material.isShadowMaterial||material.skinning)&&environment.setValue(_gl,"viewMatrix",camera.matrixWorldInverse)}if(material.skinning&&(environment.setOptional(_gl,object,"bindMatrix"),environment.setOptional(_gl,object,"bindMatrixInverse"),camera=object.skeleton))if(refreshProgram=camera.bones,capabilities.floatVertexTextures){if(null===camera.boneTexture){refreshProgram=
Math.sqrt(4*refreshProgram.length);refreshProgram=MathUtils.ceilPowerOfTwo(refreshProgram);refreshProgram=Math.max(refreshProgram,4);var boneMatrices=new Float32Array(refreshProgram*refreshProgram*4);boneMatrices.set(camera.boneMatrices);var boneTexture=new DataTexture(boneMatrices,refreshProgram,refreshProgram,1023,1015);camera.boneMatrices=boneMatrices;camera.boneTexture=boneTexture;camera.boneTextureSize=refreshProgram}environment.setValue(_gl,"boneTexture",camera.boneTexture,textures);environment.setValue(_gl,
"boneTextureSize",camera.boneTextureSize)}else environment.setOptional(_gl,camera,"boneMatrices");if(envMap||materialProperties.receiveShadow!==object.receiveShadow)materialProperties.receiveShadow=object.receiveShadow,environment.setValue(_gl,"receiveShadow",object.receiveShadow);envMap&&(environment.setValue(_gl,"toneMappingExposure",_this.toneMappingExposure),materialProperties.needsLights&&(camera=lights,encoding.ambientLightColor.needsUpdate=camera,encoding.lightProbe.needsUpdate=camera,encoding.directionalLights.needsUpdate=
camera,encoding.directionalLightShadows.needsUpdate=camera,encoding.pointLights.needsUpdate=camera,encoding.pointLightShadows.needsUpdate=camera,encoding.spotLights.needsUpdate=camera,encoding.spotLightShadows.needsUpdate=camera,encoding.rectAreaLights.needsUpdate=camera,encoding.hemisphereLights.needsUpdate=camera),fog&&material.fog&&materials.refreshFogUniforms(encoding,fog),materials.refreshMaterialUniforms(encoding,material,_pixelRatio,_height),WebGLUniforms.upload(_gl,materialProperties.uniformsList,
encoding,textures));material.isShaderMaterial&&!0===material.uniformsNeedUpdate&&(WebGLUniforms.upload(_gl,materialProperties.uniformsList,encoding,textures),material.uniformsNeedUpdate=!1);material.isSpriteMaterial&&environment.setValue(_gl,"center",object.center);environment.setValue(_gl,"modelViewMatrix",object.modelViewMatrix);environment.setValue(_gl,"normalMatrix",object.normalMatrix);environment.setValue(_gl,"modelMatrix",object.matrixWorld);return scene}parameters=parameters||{};var _canvas=
void 0!==parameters.canvas?parameters.canvas:createCanvasElement(),_context=void 0!==parameters.context?parameters.context:null,_alpha=void 0!==parameters.alpha?parameters.alpha:!1,_depth=void 0!==parameters.depth?parameters.depth:!0,_stencil=void 0!==parameters.stencil?parameters.stencil:!0,_antialias=void 0!==parameters.antialias?parameters.antialias:!1,_premultipliedAlpha=void 0!==parameters.premultipliedAlpha?parameters.premultipliedAlpha:!0,_preserveDrawingBuffer=void 0!==parameters.preserveDrawingBuffer?
parameters.preserveDrawingBuffer:!1,_powerPreference=void 0!==parameters.powerPreference?parameters.powerPreference:"default",_failIfMajorPerformanceCaveat=void 0!==parameters.failIfMajorPerformanceCaveat?parameters.failIfMajorPerformanceCaveat:!1,currentRenderList=null,currentRenderState=null;this.domElement=_canvas;this.debug={checkShaderErrors:!0};this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;
this.gammaFactor=2;this.outputEncoding=3E3;this.physicallyCorrectLights=!1;this.toneMapping=0;this.toneMappingExposure=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var _this=this,_isContextLost=!1,_framebuffer=null,_currentActiveCubeFace=0,_currentActiveMipmapLevel=0,_currentRenderTarget=null,_currentFramebuffer=null,_currentMaterialId=-1,_currentCamera=null,_currentArrayCamera=null,_currentViewport=new Vector4,_currentScissor=new Vector4,_currentScissorTest=null,_width=_canvas.width,_height=_canvas.height,
_pixelRatio=1,_opaqueSort=null,_transparentSort=null,_viewport=new Vector4(0,0,_width,_height),_scissor=new Vector4(0,0,_width,_height),_scissorTest=!1,_frustum=new Frustum,_clippingEnabled=!1,_localClippingEnabled=!1,_projScreenMatrix=new Matrix4,_vector3=new Vector3,_emptyScene={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},_gl=_context;try{_context={alpha:_alpha,depth:_depth,stencil:_stencil,antialias:_antialias,premultipliedAlpha:_premultipliedAlpha,preserveDrawingBuffer:_preserveDrawingBuffer,
powerPreference:_powerPreference,failIfMajorPerformanceCaveat:_failIfMajorPerformanceCaveat};_canvas.addEventListener("webglcontextlost",onContextLost,!1);_canvas.addEventListener("webglcontextrestored",onContextRestore,!1);if(null===_gl&&(_alpha=["webgl2","webgl","experimental-webgl"],!0===_this.isWebGL1Renderer&&_alpha.shift(),_gl=getContext(_alpha,_context),null===_gl)){if(getContext(_alpha))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");
}void 0===_gl.getShaderPrecisionFormat&&(_gl.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(error){throw console.error("THREE.WebGLRenderer: "+error.message),error;}var extensions,capabilities,state,info,properties,textures,cubemaps,attributes,geometries,objects,programCache,materials,renderLists,renderStates,clipping,background,morphtargets,bufferRenderer,indexedBufferRenderer,utils,bindingStates;initGLContext();var xr="undefined"!==typeof navigator&&"xr"in
navigator?new WebXRManager(_this,_gl):new WebVRManager(_this);this.xr=xr;var shadowMap=new WebGLShadowMap(_this,objects,capabilities.maxTextureSize);this.shadowMap=shadowMap;this.getContext=function(){return _gl};this.getContextAttributes=function(){return _gl.getContextAttributes()};this.forceContextLoss=function(){var extension=extensions.get("WEBGL_lose_context");extension&&extension.loseContext()};this.forceContextRestore=function(){var extension=extensions.get("WEBGL_lose_context");extension&&
extension.restoreContext()};this.getPixelRatio=function(){return _pixelRatio};this.setPixelRatio=function(value){void 0!==value&&(_pixelRatio=value,this.setSize(_width,_height,!1))};this.getSize=function(target){void 0===target&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),target=new Vector2);return target.set(_width,_height)};this.setSize=function(width,height,updateStyle){xr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):
(_width=width,_height=height,_canvas.width=Math.floor(width*_pixelRatio),_canvas.height=Math.floor(height*_pixelRatio),!1!==updateStyle&&(_canvas.style.width=width+"px",_canvas.style.height=height+"px"),this.setViewport(0,0,width,height))};this.getDrawingBufferSize=function(target){void 0===target&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),target=new Vector2);return target.set(_width*_pixelRatio,_height*_pixelRatio).floor()};this.setDrawingBufferSize=
function(width,height,pixelRatio){_width=width;_height=height;_pixelRatio=pixelRatio;_canvas.width=Math.floor(width*pixelRatio);_canvas.height=Math.floor(height*pixelRatio);this.setViewport(0,0,width,height)};this.getCurrentViewport=function(target){void 0===target&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),target=new Vector4);return target.copy(_currentViewport)};this.getViewport=function(target){return target.copy(_viewport)};this.setViewport=function(x,
y,width,height){x.isVector4?_viewport.set(x.x,x.y,x.z,x.w):_viewport.set(x,y,width,height);state.viewport(_currentViewport.copy(_viewport).multiplyScalar(_pixelRatio).floor())};this.getScissor=function(target){return target.copy(_scissor)};this.setScissor=function(x,y,width,height){x.isVector4?_scissor.set(x.x,x.y,x.z,x.w):_scissor.set(x,y,width,height);state.scissor(_currentScissor.copy(_scissor).multiplyScalar(_pixelRatio).floor())};this.getScissorTest=function(){return _scissorTest};this.setScissorTest=
function(boolean){state.setScissorTest(_scissorTest=boolean)};this.setOpaqueSort=function(method){_opaqueSort=method};this.setTransparentSort=function(method){_transparentSort=method};this.getClearColor=function(){return background.getClearColor()};this.setClearColor=function(){background.setClearColor.apply(background,arguments)};this.getClearAlpha=function(){return background.getClearAlpha()};this.setClearAlpha=function(){background.setClearAlpha.apply(background,arguments)};this.clear=function(color,
depth,stencil){var bits=0;if(void 0===color||color)bits|=16384;if(void 0===depth||depth)bits|=256;if(void 0===stencil||stencil)bits|=1024;_gl.clear(bits)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){_canvas.removeEventListener("webglcontextlost",onContextLost,!1);_canvas.removeEventListener("webglcontextrestored",onContextRestore,!1);renderLists.dispose();renderStates.dispose();
properties.dispose();cubemaps.dispose();objects.dispose();bindingStates.dispose();xr.dispose();animation.stop()};this.renderBufferImmediate=function(object,program){bindingStates.initAttributes();var buffers=properties.get(object);object.hasPositions&&!buffers.position&&(buffers.position=_gl.createBuffer());object.hasNormals&&!buffers.normal&&(buffers.normal=_gl.createBuffer());object.hasUvs&&!buffers.uv&&(buffers.uv=_gl.createBuffer());object.hasColors&&!buffers.color&&(buffers.color=_gl.createBuffer());
program=program.getAttributes();object.hasPositions&&(_gl.bindBuffer(34962,buffers.position),_gl.bufferData(34962,object.positionArray,35048),bindingStates.enableAttribute(program.position),_gl.vertexAttribPointer(program.position,3,5126,!1,0,0));object.hasNormals&&(_gl.bindBuffer(34962,buffers.normal),_gl.bufferData(34962,object.normalArray,35048),bindingStates.enableAttribute(program.normal),_gl.vertexAttribPointer(program.normal,3,5126,!1,0,0));object.hasUvs&&(_gl.bindBuffer(34962,buffers.uv),
_gl.bufferData(34962,object.uvArray,35048),bindingStates.enableAttribute(program.uv),_gl.vertexAttribPointer(program.uv,2,5126,!1,0,0));object.hasColors&&(_gl.bindBuffer(34962,buffers.color),_gl.bufferData(34962,object.colorArray,35048),bindingStates.enableAttribute(program.color),_gl.vertexAttribPointer(program.color,3,5126,!1,0,0));bindingStates.disableUnusedAttributes();_gl.drawArrays(4,0,object.count);object.count=0};this.renderBufferDirect=function(camera,scene,geometry,material,object,group){null===
scene&&(scene=_emptyScene);var frontFaceCW=object.isMesh&&0>object.matrixWorld.determinant();camera=setProgram(camera,scene,material,object);state.setMaterial(material,frontFaceCW);frontFaceCW=geometry.index;scene=geometry.attributes.position;if(null===frontFaceCW){if(void 0===scene||0===scene.count)return}else if(0===frontFaceCW.count)return;var rangeFactor=1;!0===material.wireframe&&(frontFaceCW=geometries.getWireframeAttribute(geometry),rangeFactor=2);(material.morphTargets||material.morphNormals)&&
morphtargets.update(object,geometry,material,camera);bindingStates.setup(object,material,camera,geometry,frontFaceCW);camera=bufferRenderer;if(null!==frontFaceCW){var attribute=attributes.get(frontFaceCW);camera=indexedBufferRenderer;camera.setIndex(attribute)}var rangeStart=geometry.drawRange.start*rangeFactor,groupStart=null!==group?group.start*rangeFactor:0;attribute=Math.max(rangeStart,groupStart);group=Math.max(0,Math.min(null!==frontFaceCW?frontFaceCW.count:scene.count,rangeStart+geometry.drawRange.count*
rangeFactor,groupStart+(null!==group?group.count*rangeFactor:Infinity))-1-attribute+1);0!==group&&(object.isMesh?!0===material.wireframe?(state.setLineWidth(material.wireframeLinewidth*(null===_currentRenderTarget?_pixelRatio:1)),camera.setMode(1)):camera.setMode(4):object.isLine?(material=material.linewidth,void 0===material&&(material=1),state.setLineWidth(material*(null===_currentRenderTarget?_pixelRatio:1)),object.isLineSegments?camera.setMode(1):object.isLineLoop?camera.setMode(2):camera.setMode(3)):
object.isPoints?camera.setMode(0):object.isSprite&&camera.setMode(4),object.isInstancedMesh?camera.renderInstances(attribute,group,object.count):geometry.isInstancedBufferGeometry?camera.renderInstances(attribute,group,Math.min(geometry.instanceCount,geometry._maxInstanceCount)):camera.render(attribute,group))};this.compile=function(scene,camera){currentRenderState=renderStates.get(scene,camera);currentRenderState.init();scene.traverseVisible(function(object){object.isLight&&object.layers.test(camera.layers)&&
(currentRenderState.pushLight(object),object.castShadow&&currentRenderState.pushShadow(object))});currentRenderState.setupLights(camera);var compiled=new WeakMap;scene.traverse(function(object){var material=object.material;if(material)if(Array.isArray(material))for(var i=0;i<material.length;i++){var material2=material[i];!1===compiled.has(material2)&&(initMaterial(material2,scene,object),compiled.set(material2))}else!1===compiled.has(material)&&(initMaterial(material,scene,object),compiled.set(material))})};
var onAnimationFrameCallback=null,animation=new WebGLAnimation;animation.setAnimationLoop(function(time){xr.isPresenting||onAnimationFrameCallback&&onAnimationFrameCallback(time)});"undefined"!==typeof window&&animation.setContext(window);this.setAnimationLoop=function(callback){onAnimationFrameCallback=callback;xr.setAnimationLoop(callback);null===callback?animation.stop():animation.start()};this.render=function(scene,camera,JSCompiler_OptimizeArgumentsArray_p1,JSCompiler_OptimizeArgumentsArray_p2){if(void 0!==
JSCompiler_OptimizeArgumentsArray_p1){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var renderTarget=JSCompiler_OptimizeArgumentsArray_p1}if(void 0!==JSCompiler_OptimizeArgumentsArray_p2){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var forceClear=JSCompiler_OptimizeArgumentsArray_p2}if(void 0!==camera&&!0!==camera.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
else if(!0!==_isContextLost){bindingStates.resetDefaultState();_currentMaterialId=-1;_currentCamera=null;!0===scene.autoUpdate&&scene.updateMatrixWorld();null===camera.parent&&camera.updateMatrixWorld();!0===xr.enabled&&!0===xr.isPresenting&&(camera=xr.getCamera(camera));if(!0===scene.isScene)scene.onBeforeRender(_this,scene,camera,renderTarget||_currentRenderTarget);currentRenderState=renderStates.get(scene,camera);currentRenderState.init();_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,
camera.matrixWorldInverse);_frustum.setFromProjectionMatrix(_projScreenMatrix);_localClippingEnabled=this.localClippingEnabled;_clippingEnabled=clipping.init(this.clippingPlanes,_localClippingEnabled,camera);currentRenderList=renderLists.get(scene,camera);currentRenderList.init();projectObject(scene,camera,0,_this.sortObjects);currentRenderList.finish();!0===_this.sortObjects&&currentRenderList.sort(_opaqueSort,_transparentSort);!0===_clippingEnabled&&clipping.beginShadows();shadowMap.render(currentRenderState.state.shadowsArray,
scene,camera);currentRenderState.setupLights(camera);!0===_clippingEnabled&&clipping.endShadows();!0===this.info.autoReset&&this.info.reset();void 0!==renderTarget&&this.setRenderTarget(renderTarget);background.render(currentRenderList,scene,camera,forceClear);JSCompiler_OptimizeArgumentsArray_p1=currentRenderList.opaque;JSCompiler_OptimizeArgumentsArray_p2=currentRenderList.transparent;0<JSCompiler_OptimizeArgumentsArray_p1.length&&renderObjects(JSCompiler_OptimizeArgumentsArray_p1,scene,camera);
0<JSCompiler_OptimizeArgumentsArray_p2.length&&renderObjects(JSCompiler_OptimizeArgumentsArray_p2,scene,camera);if(!0===scene.isScene)scene.onAfterRender(_this,scene,camera);null!==_currentRenderTarget&&(textures.updateRenderTargetMipmap(_currentRenderTarget),textures.updateMultisampleRenderTarget(_currentRenderTarget));state.buffers.depth.setTest(!0);state.buffers.depth.setMask(!0);state.buffers.color.setMask(!0);state.setPolygonOffset(!1);xr.enabled&&xr.submitFrame&&xr.submitFrame();currentRenderState=
currentRenderList=null}};this.setTexture2D=function(){var warned=!1;return function(texture,slot){texture&&texture.isWebGLRenderTarget&&(warned||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),warned=!0),texture=texture.texture);textures.setTexture2D(texture,slot)}}();this.setFramebuffer=function(value){_framebuffer!==value&&null===_currentRenderTarget&&_gl.bindFramebuffer(36160,value);_framebuffer=value};this.getActiveCubeFace=
function(){return _currentActiveCubeFace};this.getActiveMipmapLevel=function(){return _currentActiveMipmapLevel};this.getRenderList=function(){return currentRenderList};this.setRenderList=function(renderList){currentRenderList=renderList};this.getRenderState=function(){return currentRenderState};this.setRenderState=function(renderState){currentRenderState=renderState};this.getRenderTarget=function(){return _currentRenderTarget};this.setRenderTarget=function(renderTarget,activeCubeFace,activeMipmapLevel){void 0===
activeCubeFace&&(activeCubeFace=0);void 0===activeMipmapLevel&&(activeMipmapLevel=0);_currentRenderTarget=renderTarget;_currentActiveCubeFace=activeCubeFace;_currentActiveMipmapLevel=activeMipmapLevel;renderTarget&&void 0===properties.get(renderTarget).__webglFramebuffer&&textures.setupRenderTarget(renderTarget);var framebuffer=_framebuffer,isCube=!1;renderTarget?(framebuffer=properties.get(renderTarget).__webglFramebuffer,renderTarget.isWebGLCubeRenderTarget?(framebuffer=framebuffer[activeCubeFace],
isCube=!0):framebuffer=renderTarget.isWebGLMultisampleRenderTarget?properties.get(renderTarget).__webglMultisampledFramebuffer:framebuffer,_currentViewport.copy(renderTarget.viewport),_currentScissor.copy(renderTarget.scissor),_currentScissorTest=renderTarget.scissorTest):(_currentViewport.copy(_viewport).multiplyScalar(_pixelRatio).floor(),_currentScissor.copy(_scissor).multiplyScalar(_pixelRatio).floor(),_currentScissorTest=_scissorTest);_currentFramebuffer!==framebuffer&&(_gl.bindFramebuffer(36160,
framebuffer),_currentFramebuffer=framebuffer);state.viewport(_currentViewport);state.scissor(_currentScissor);state.setScissorTest(_currentScissorTest);isCube&&(renderTarget=properties.get(renderTarget.texture),_gl.framebufferTexture2D(36160,36064,34069+activeCubeFace,renderTarget.__webglTexture,activeMipmapLevel))};this.readRenderTargetPixels=function(renderTarget,x,y,width,height,buffer,activeCubeFaceIndex){if(renderTarget&&renderTarget.isWebGLRenderTarget){var framebuffer=properties.get(renderTarget).__webglFramebuffer;
renderTarget.isWebGLCubeRenderTarget&&void 0!==activeCubeFaceIndex&&(framebuffer=framebuffer[activeCubeFaceIndex]);if(framebuffer){activeCubeFaceIndex=!1;framebuffer!==_currentFramebuffer&&(_gl.bindFramebuffer(36160,framebuffer),activeCubeFaceIndex=!0);try{var texture=renderTarget.texture,textureFormat=texture.format,textureType=texture.type;1023!==textureFormat&&utils.convert(textureFormat)!==_gl.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):
1009===textureType||utils.convert(textureType)===_gl.getParameter(35738)||1015===textureType&&(capabilities.isWebGL2||extensions.get("OES_texture_float")||extensions.get("WEBGL_color_buffer_float"))||1016===textureType&&(capabilities.isWebGL2?extensions.get("EXT_color_buffer_float"):extensions.get("EXT_color_buffer_half_float"))?36053===_gl.checkFramebufferStatus(36160)?0<=x&&x<=renderTarget.width-width&&0<=y&&y<=renderTarget.height-height&&_gl.readPixels(x,y,width,height,utils.convert(textureFormat),
utils.convert(textureType),buffer):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{activeCubeFaceIndex&&_gl.bindFramebuffer(36160,_currentFramebuffer)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=
function(position,texture,level){void 0===level&&(level=0);var levelScale=Math.pow(2,-level),width=Math.floor(texture.image.width*levelScale);levelScale=Math.floor(texture.image.height*levelScale);var glFormat=utils.convert(texture.format);textures.setTexture2D(texture,0);_gl.copyTexImage2D(3553,level,glFormat,position.x,position.y,width,levelScale,0);state.unbindTexture()};this.copyTextureToTexture=function(position,srcTexture,dstTexture,level){void 0===level&&(level=0);var width=srcTexture.image.width,
height=srcTexture.image.height,glFormat=utils.convert(dstTexture.format),glType=utils.convert(dstTexture.type);textures.setTexture2D(dstTexture,0);_gl.pixelStorei(37440,dstTexture.flipY);_gl.pixelStorei(37441,dstTexture.premultiplyAlpha);_gl.pixelStorei(3317,dstTexture.unpackAlignment);srcTexture.isDataTexture?_gl.texSubImage2D(3553,level,position.x,position.y,width,height,glFormat,glType,srcTexture.image.data):srcTexture.isCompressedTexture?_gl.compressedTexSubImage2D(3553,level,position.x,position.y,
srcTexture.mipmaps[0].width,srcTexture.mipmaps[0].height,glFormat,srcTexture.mipmaps[0].data):_gl.texSubImage2D(3553,level,position.x,position.y,glFormat,glType,srcTexture.image);0===level&&dstTexture.generateMipmaps&&_gl.generateMipmap(3553);state.unbindTexture()};this.initTexture=function(texture){textures.setTexture2D(texture,0);state.unbindTexture()};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function WebGL1Renderer(parameters){WebGLRenderer.call(this,
parameters)}function InterleavedBuffer(array,stride){this.array=array;this.stride=stride;this.count=void 0!==array?array.length/stride:0;this.usage=35044;this.updateRange={offset:0,count:-1};this.version=0;this.uuid=MathUtils.generateUUID()}function InterleavedBufferAttribute(interleavedBuffer,itemSize,offset,normalized){this.name="";this.data=interleavedBuffer;this.itemSize=itemSize;this.offset=offset;this.normalized=!0===normalized}function SpriteMaterial(parameters){Material.call(this);this.type=
"SpriteMaterial";this.color=new Color(16777215);this.alphaMap=this.map=null;this.rotation=0;this.transparent=this.sizeAttenuation=!0;this.setValues(parameters)}function Sprite(material){Object3D.call(this);this.type="Sprite";if(void 0===_geometry){_geometry=new BufferGeometry;var float32Array=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);float32Array=new InterleavedBuffer(float32Array,5);_geometry.setIndex([0,1,2,0,2,3]);_geometry.setAttribute("position",new InterleavedBufferAttribute(float32Array,
3,0,!1));_geometry.setAttribute("uv",new InterleavedBufferAttribute(float32Array,2,3,!1))}this.geometry=_geometry;this.material=void 0!==material?material:new SpriteMaterial;this.center=new Vector2(.5,.5)}function transformVertex(vertexPosition,mvPosition,center,scale,sin,cos){_alignedPosition.subVectors(vertexPosition,center).addScalar(.5).multiply(scale);void 0!==sin?(_rotatedPosition.x=cos*_alignedPosition.x-sin*_alignedPosition.y,_rotatedPosition.y=sin*_alignedPosition.x+cos*_alignedPosition.y):
_rotatedPosition.copy(_alignedPosition);vertexPosition.copy(mvPosition);vertexPosition.x+=_rotatedPosition.x;vertexPosition.y+=_rotatedPosition.y;vertexPosition.applyMatrix4(_viewWorldMatrix)}function LOD(){Object3D.call(this);this._currentLevel=0;this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}});this.autoUpdate=!0}function SkinnedMesh(geometry,material){geometry&&geometry.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
Mesh.call(this,geometry,material);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new Matrix4;this.bindMatrixInverse=new Matrix4}function Bone(){Object3D.call(this);this.type="Bone"}function Skeleton(bones,boneInverses){void 0===bones&&(bones=[]);void 0===boneInverses&&(boneInverses=[]);this.uuid=MathUtils.generateUUID();this.bones=bones.slice(0);this.boneInverses=boneInverses;this.boneTexture=this.boneMatrices=null;this.boneTextureSize=0;this.frame=-1;this.init()}function InstancedMesh(geometry,
material,count){Mesh.call(this,geometry,material);this.instanceMatrix=new BufferAttribute(new Float32Array(16*count),16);this.instanceColor=null;this.count=count;this.frustumCulled=!1}function LineBasicMaterial(parameters){Material.call(this);this.type="LineBasicMaterial";this.color=new Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.morphTargets=!1;this.setValues(parameters)}function Line(geometry,material,mode){1===mode&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.");
Object3D.call(this);this.type="Line";this.geometry=void 0!==geometry?geometry:new BufferGeometry;this.material=void 0!==material?material:new LineBasicMaterial;this.updateMorphTargets()}function LineSegments(geometry,material){Line.call(this,geometry,material);this.type="LineSegments"}function LineLoop(geometry,material){Line.call(this,geometry,material);this.type="LineLoop"}function PointsMaterial(parameters){Material.call(this);this.type="PointsMaterial";this.color=new Color(16777215);this.alphaMap=
this.map=null;this.size=1;this.sizeAttenuation=!0;this.morphTargets=!1;this.setValues(parameters)}function Points(geometry,material){Object3D.call(this);this.type="Points";this.geometry=void 0!==geometry?geometry:new BufferGeometry;this.material=void 0!==material?material:new PointsMaterial;this.updateMorphTargets()}function testPoint(point,index,localThresholdSq,matrixWorld,raycaster,intersects,object){var rayPointDistanceSq=_ray$2.distanceSqToPoint(point);rayPointDistanceSq<localThresholdSq&&(localThresholdSq=
new Vector3,_ray$2.closestPointToPoint(point,localThresholdSq),localThresholdSq.applyMatrix4(matrixWorld),point=raycaster.ray.origin.distanceTo(localThresholdSq),point<raycaster.near||point>raycaster.far||intersects.push({distance:point,distanceToRay:Math.sqrt(rayPointDistanceSq),point:localThresholdSq,index:index,face:null,object:object}))}function VideoTexture(video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){function updateVideo(){scope.needsUpdate=!0;video.requestVideoFrameCallback(updateVideo)}
Texture.call(this,video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.format=void 0!==format?format:1022;this.minFilter=void 0!==minFilter?minFilter:1006;this.magFilter=void 0!==magFilter?magFilter:1006;this.generateMipmaps=!1;var scope=this;"requestVideoFrameCallback"in video&&video.requestVideoFrameCallback(updateVideo)}function CompressedTexture(mipmaps,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy,encoding){Texture.call(this,null,mapping,wrapS,
wrapT,magFilter,minFilter,format,type,anisotropy,encoding);this.image={width:width,height:height};this.mipmaps=mipmaps;this.generateMipmaps=this.flipY=!1}function CanvasTexture(canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){Texture.call(this,canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.needsUpdate=!0}function DepthTexture(width,height,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy,format){format=void 0!==format?format:1026;if(1026!==
format&&1027!==format)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===type&&1026===format&&(type=1012);void 0===type&&1027===format&&(type=1020);Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.image={width:width,height:height};this.magFilter=void 0!==magFilter?magFilter:1003;this.minFilter=void 0!==minFilter?minFilter:1003;this.generateMipmaps=this.flipY=!1}function Geometry(){Object.defineProperty(this,
"id",{value:_geometryId+=2});this.uuid=MathUtils.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function linkedList(data,
start,end,dim,clockwise){for(var last,sum=0,i=start,j=end-dim;i<end;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;if(clockwise===0<sum)for(clockwise=start;clockwise<end;clockwise+=dim)last=insertNode(clockwise,data[clockwise],data[clockwise+1],last);else for(clockwise=end-dim;clockwise>=start;clockwise-=dim)last=insertNode(clockwise,data[clockwise],data[clockwise+1],last);last&&equals(last,last.next)&&(removeNode(last),last=last.next);return last}function filterPoints(start,end){if(!start)return start;
end||(end=start);do{var again=!1;if(start.steiner||!equals(start,start.next)&&0!==area(start.prev,start,start.next))start=start.next;else{removeNode(start);start=end=start.prev;if(start===start.next)break;again=!0}}while(again||start!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(ear){if(!pass&&invSize){var start=ear,p=start;do null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,invSize)),p.prevZ=p.prev,p=p.nextZ=p.next;while(p!==start);p.prevZ.nextZ=null;p.prevZ=null;
start=p;var i,numMerges,pSize,qSize,inSize=1;do{p=start;var tail=start=null;for(numMerges=0;p;){numMerges++;var q=p;for(i=pSize=0;i<inSize&&(pSize++,q=q.nextZ,q);i++);for(qSize=inSize;0<pSize||0<qSize&&q;)0!==pSize&&(0===qSize||!q||p.z<=q.z)?(i=p,p=p.nextZ,pSize--):(i=q,q=q.nextZ,qSize--),tail?tail.nextZ=i:start=i,i.prevZ=tail,tail=i;p=q}tail.nextZ=null;inSize*=2}while(1<numMerges)}for(start=ear;ear.prev!==ear.next;){p=ear.prev;q=ear.next;if(invSize)tail=isEarHashed(ear,minX,minY,invSize);else a:if(tail=
ear,numMerges=tail.prev,pSize=tail,inSize=tail.next,0<=area(numMerges,pSize,inSize))tail=!1;else{for(i=tail.next.next;i!==tail.prev;){if(pointInTriangle(numMerges.x,numMerges.y,pSize.x,pSize.y,inSize.x,inSize.y,i.x,i.y)&&0<=area(i.prev,i,i.next)){tail=!1;break a}i=i.next}tail=!0}if(tail)triangles.push(p.i/dim),triangles.push(ear.i/dim),triangles.push(q.i/dim),removeNode(ear),start=ear=q.next;else if(ear=q,ear===start){if(!pass)earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);else if(1===
pass){ear=filterPoints(ear);pass=triangles;start=dim;p=ear;do q=p.prev,tail=p.next.next,!equals(q,tail)&&intersects(q,p,p.next,tail)&&locallyInside(q,tail)&&locallyInside(tail,q)&&(pass.push(q.i/start),pass.push(p.i/start),pass.push(tail.i/start),removeNode(p),removeNode(p.next),p=ear=tail),p=p.next;while(p!==ear);ear=filterPoints(p);earcutLinked(ear,triangles,dim,minX,minY,invSize,2)}else if(2===pass)a:{pass=ear;do{for(start=pass.next.next;start!==pass.prev;){if(p=pass.i!==start.i){p=pass;q=start;
if(tail=p.next.i!==q.i&&p.prev.i!==q.i){b:{tail=p;do{if(tail.i!==p.i&&tail.next.i!==p.i&&tail.i!==q.i&&tail.next.i!==q.i&&intersects(tail,tail.next,p,q)){tail=!0;break b}tail=tail.next}while(tail!==p);tail=!1}tail=!tail}if(tail){if(tail=locallyInside(p,q)&&locallyInside(q,p)){tail=p;numMerges=!1;pSize=(p.x+q.x)/2;inSize=(p.y+q.y)/2;do tail.y>inSize!==tail.next.y>inSize&&tail.next.y!==tail.y&&pSize<(tail.next.x-tail.x)*(inSize-tail.y)/(tail.next.y-tail.y)+tail.x&&(numMerges=!numMerges),tail=tail.next;
while(tail!==p);tail=numMerges}tail=tail&&(area(p.prev,p,q.prev)||area(p,q.prev,q))||equals(p,q)&&0<area(p.prev,p,p.next)&&0<area(q.prev,q,q.next)}p=tail}if(p){ear=splitPolygon(pass,start);pass=filterPoints(pass,pass.next);ear=filterPoints(ear,ear.next);earcutLinked(pass,triangles,dim,minX,minY,invSize);earcutLinked(ear,triangles,dim,minX,minY,invSize);break a}start=start.next}pass=pass.next}while(pass!==ear)}break}}}}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,c=ear.next;if(0<=area(a,
ear,c))return!1;var maxTX=a.x>ear.x?a.x>c.x?a.x:c.x:ear.x>c.x?ear.x:c.x,maxTY=a.y>ear.y?a.y>c.y?a.y:c.y:ear.y>c.y?ear.y:c.y,minZ=zOrder(a.x<ear.x?a.x<c.x?a.x:c.x:ear.x<c.x?ear.x:c.x,a.y<ear.y?a.y<c.y?a.y:c.y:ear.y<c.y?ear.y:c.y,minX,minY,invSize);minX=zOrder(maxTX,maxTY,minX,minY,invSize);minY=ear.prevZ;for(invSize=ear.nextZ;minY&&minY.z>=minZ&&invSize&&invSize.z<=minX;){if(minY!==ear.prev&&minY!==ear.next&&pointInTriangle(a.x,a.y,ear.x,ear.y,c.x,c.y,minY.x,minY.y)&&0<=area(minY.prev,minY,minY.next))return!1;
minY=minY.prevZ;if(invSize!==ear.prev&&invSize!==ear.next&&pointInTriangle(a.x,a.y,ear.x,ear.y,c.x,c.y,invSize.x,invSize.y)&&0<=area(invSize.prev,invSize,invSize.next))return!1;invSize=invSize.nextZ}for(;minY&&minY.z>=minZ;){if(minY!==ear.prev&&minY!==ear.next&&pointInTriangle(a.x,a.y,ear.x,ear.y,c.x,c.y,minY.x,minY.y)&&0<=area(minY.prev,minY,minY.next))return!1;minY=minY.prevZ}for(;invSize&&invSize.z<=minX;){if(invSize!==ear.prev&&invSize!==ear.next&&pointInTriangle(a.x,a.y,ear.x,ear.y,c.x,c.y,invSize.x,
invSize.y)&&0<=area(invSize.prev,invSize,invSize.next))return!1;invSize=invSize.nextZ}return!0}function compareX(a,b){return a.x-b.x}function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole.x,hy=hole.y,qx=-Infinity;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}var m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m;outerNode=
m;x=m.x;var my=m.y,tanMin=Infinity;p=m;do{if(hx>=p.x&&p.x>=x&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,x,my,hy<my?qx:hx,hy,p.x,p.y)){var tan=Math.abs(hy-p.y)/(hx-p.x);var JSCompiler_temp;if((JSCompiler_temp=locallyInside(p,hole))&&!(JSCompiler_temp=tan<tanMin)&&(JSCompiler_temp=tan===tanMin)&&!(JSCompiler_temp=p.x>m.x)&&(JSCompiler_temp=p.x===m.x)){JSCompiler_temp=m;var p$jscomp$0=p;JSCompiler_temp=0>area(JSCompiler_temp.prev,JSCompiler_temp,p$jscomp$0.prev)&&0>area(p$jscomp$0.next,JSCompiler_temp,
JSCompiler_temp.next)}JSCompiler_temp&&(m=p,tanMin=tan)}p=p.next}while(p!==outerNode);return m}function zOrder(x,y,minX,minY,invSize){x=32767*(x-minX)*invSize;y=32767*(y-minY)*invSize;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;return(x|x<<1)&1431655765|((y|y<<1)&1431655765)<<1}function getLeftmost(start){var p=start,leftmost=start;do{if(p.x<leftmost.x||p.x===leftmost.x&&p.y<leftmost.y)leftmost=p;p=p.next}while(p!==start);
return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return 0<=(cx-px)*(ay-py)-(ax-px)*(cy-py)&&0<=(ax-px)*(by-py)-(bx-px)*(ay-py)&&0<=(bx-px)*(cy-py)-(cx-px)*(by-py)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){var o1=sign$jscomp$0(area(p1,q1,p2)),o2=sign$jscomp$0(area(p1,q1,q2)),o3=sign$jscomp$0(area(p2,q2,p1)),o4=sign$jscomp$0(area(p2,q2,q1));return o1!==o2&&o3!==o4||0===o1&&
onSegment(p1,p2,q1)||0===o2&&onSegment(p1,q2,q1)||0===o3&&onSegment(p2,p1,q2)||0===o4&&onSegment(p2,q1,q2)?!0:!1}function onSegment(p,q,r){return q.x<=Math.max(p.x,r.x)&&q.x>=Math.min(p.x,r.x)&&q.y<=Math.max(p.y,r.y)&&q.y>=Math.min(p.y,r.y)}function sign$jscomp$0(num){return 0<num?1:0>num?-1:0}function locallyInside(a,b){return 0>area(a.prev,a,a.next)?0<=area(a,b,a.next)&&0<=area(a,a.prev,b):0>area(a,b,a.prev)||0>area(a,a.next,b)}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,
b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2}function insertNode(i,x,y,last){i=new Node(i,x,y);last?(i.next=last.next,i.prev=last,last.next.prev=i,last.next=i):(i.prev=i,i.next=i);return i}function removeNode(p){p.next.prev=p.prev;p.prev.next=p.next;p.prevZ&&(p.prevZ.nextZ=p.nextZ);p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i;this.x=x;this.y=y;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}function removeDupEndPts(points){var l=points.length;2<l&&points[l-1].equals(points[0])&&points.pop()}function addContour(vertices,contour){for(var i=0;i<contour.length;i++)vertices.push(contour[i].x),vertices.push(contour[i].y)}function ParametricBufferGeometry(func,slices,stacks){BufferGeometry.call(this);this.type="ParametricBufferGeometry";this.parameters={func:func,slices:slices,stacks:stacks};var indices=[],vertices=[],normals=[],uvs=[],normal=new Vector3,p0=new Vector3,p1=new Vector3,pu=
new Vector3,pv=new Vector3;3>func.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var sliceCount=slices+1,i=0;i<=stacks;i++)for(var v=i/stacks,j=0;j<=slices;j++){var u=j/slices;func(u,v,p0);vertices.push(p0.x,p0.y,p0.z);0<=u-1E-5?(func(u-1E-5,v,p1),pu.subVectors(p0,p1)):(func(u+1E-5,v,p1),pu.subVectors(p1,p0));0<=v-1E-5?(func(u,v-1E-5,p1),pv.subVectors(p0,p1)):(func(u,v+1E-5,p1),pv.subVectors(p1,p0));normal.crossVectors(pu,pv).normalize();
normals.push(normal.x,normal.y,normal.z);uvs.push(u,v)}for(func=0;func<stacks;func++)for(normal=0;normal<slices;normal++)p0=func*sliceCount+normal+1,p1=(func+1)*sliceCount+normal+1,pu=(func+1)*sliceCount+normal,indices.push(func*sliceCount+normal,p0,pu),indices.push(p0,p1,pu);this.setIndex(indices);this.setAttribute("position",new Float32BufferAttribute(vertices,3));this.setAttribute("normal",new Float32BufferAttribute(normals,3));this.setAttribute("uv",new Float32BufferAttribute(uvs,2))}function ParametricGeometry(func,
slices,stacks){Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:func,slices:slices,stacks:stacks};this.fromBufferGeometry(new ParametricBufferGeometry(func,slices,stacks));this.mergeVertices()}function ShadowMaterial(parameters){Material.call(this);this.type="ShadowMaterial";this.color=new Color(0);this.transparent=!0;this.setValues(parameters)}function RawShaderMaterial(parameters){ShaderMaterial.call(this,parameters);this.type="RawShaderMaterial"}function MeshStandardMaterial(parameters){Material.call(this);
this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new Color(16777215);this.roughness=1;this.metalness=0;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=
this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(parameters)}function MeshPhysicalMaterial(parameters){MeshStandardMaterial.call(this);this.defines={STANDARD:"",PHYSICAL:""};this.type="MeshPhysicalMaterial";this.clearcoat=0;this.clearcoatMap=null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=
null;this.clearcoatNormalScale=new Vector2(1,1);this.clearcoatNormalMap=null;this.reflectivity=.5;Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(ior){this.reflectivity=MathUtils.clamp(2.5*(ior-1)/(ior+1),0,1)}});this.sheen=null;this.transmission=0;this.transmissionMap=null;this.setValues(parameters)}function MeshPhongMaterial(parameters){Material.call(this);this.type="MeshPhongMaterial";this.color=new Color(16777215);this.specular=
new Color(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=
!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(parameters)}function MeshToonMaterial(parameters){Material.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.color=new Color(16777215);this.lightMap=this.gradientMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=
1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(parameters)}function MeshNormalMaterial(parameters){Material.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=
0;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.fog=!1;this.setValues(parameters)}function MeshLambertMaterial(parameters){Material.call(this);this.type="MeshLambertMaterial";this.color=new Color(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=
1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(parameters)}function MeshMatcapMaterial(parameters){Material.call(this);this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new Color(16777215);this.bumpMap=this.map=this.matcap=null;this.bumpScale=
1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(parameters)}function LineDashedMaterial(parameters){LineBasicMaterial.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(parameters)}function Interpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){this.parameterPositions=
parameterPositions;this._cachedIndex=0;this.resultBuffer=void 0!==resultBuffer?resultBuffer:new sampleValues.constructor(sampleSize);this.sampleValues=sampleValues;this.valueSize=sampleSize}function CubicInterpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function LinearInterpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){Interpolant.call(this,
parameterPositions,sampleValues,sampleSize,resultBuffer)}function DiscreteInterpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)}function KeyframeTrack(name,times,values,interpolation){if(void 0===name)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===times||0===times.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+name);this.name=name;this.times=AnimationUtils.convertArray(times,
this.TimeBufferType);this.values=AnimationUtils.convertArray(values,this.ValueBufferType);this.setInterpolation(interpolation||this.DefaultInterpolation)}function BooleanKeyframeTrack(name,times,values){KeyframeTrack.call(this,name,times,values)}function ColorKeyframeTrack(name,times,values,interpolation){KeyframeTrack.call(this,name,times,values,interpolation)}function NumberKeyframeTrack(name,times,values,interpolation){KeyframeTrack.call(this,name,times,values,interpolation)}function QuaternionLinearInterpolant(parameterPositions,
sampleValues,sampleSize,resultBuffer){Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)}function QuaternionKeyframeTrack(name,times,values,interpolation){KeyframeTrack.call(this,name,times,values,interpolation)}function StringKeyframeTrack(name,times,values,interpolation){KeyframeTrack.call(this,name,times,values,interpolation)}function VectorKeyframeTrack(name,times,values,interpolation){KeyframeTrack.call(this,name,times,values,interpolation)}function AnimationClip(name,
duration,tracks,blendMode){this.name=name;this.tracks=tracks;this.duration=void 0!==duration?duration:-1;this.blendMode=void 0!==blendMode?blendMode:2500;this.uuid=MathUtils.generateUUID();0>this.duration&&this.resetDuration()}function getTrackTypeForValueTypeName(typeName){switch(typeName.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return NumberKeyframeTrack;case "vector":case "vector2":case "vector3":case "vector4":return VectorKeyframeTrack;case "color":return ColorKeyframeTrack;
case "quaternion":return QuaternionKeyframeTrack;case "bool":case "boolean":return BooleanKeyframeTrack;case "string":return StringKeyframeTrack}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+typeName);}function parseKeyframeTrack(json){if(void 0===json.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var trackType=getTrackTypeForValueTypeName(json.type);if(void 0===json.times){var times=[],values=[];AnimationUtils.flattenJSON(json.keys,times,values,"value");
json.times=times;json.values=values}return void 0!==trackType.parse?trackType.parse(json):new trackType(json.name,json.times,json.values,json.interpolation)}function LoadingManager(onLoad,onProgress,onError){var scope=this,isLoading=!1,itemsLoaded=0,itemsTotal=0,urlModifier=void 0,handlers=[];this.onStart=void 0;this.onLoad=onLoad;this.onProgress=onProgress;this.onError=onError;this.itemStart=function(url){itemsTotal++;if(!1===isLoading&&void 0!==scope.onStart)scope.onStart(url,itemsLoaded,itemsTotal);
isLoading=!0};this.itemEnd=function(url){itemsLoaded++;if(void 0!==scope.onProgress)scope.onProgress(url,itemsLoaded,itemsTotal);if(itemsLoaded===itemsTotal&&(isLoading=!1,void 0!==scope.onLoad))scope.onLoad()};this.itemError=function(url){if(void 0!==scope.onError)scope.onError(url)};this.resolveURL=function(url){return urlModifier?urlModifier(url):url};this.setURLModifier=function(transform){urlModifier=transform;return this};this.addHandler=function(regex,loader){handlers.push(regex,loader);return this};
this.removeHandler=function(regex){regex=handlers.indexOf(regex);-1!==regex&&handlers.splice(regex,2);return this};this.getHandler=function(file){for(var i=0,l=handlers.length;i<l;i+=2){var regex=handlers[i],loader=handlers[i+1];regex.global&&(regex.lastIndex=0);if(regex.test(file))return loader}return null}}function Loader(manager){this.manager=void 0!==manager?manager:DefaultLoadingManager;this.crossOrigin="anonymous";this.withCredentials=!1;this.resourcePath=this.path="";this.requestHeader={}}
function FileLoader(manager){Loader.call(this,manager)}function AnimationLoader(manager){Loader.call(this,manager)}function CompressedTextureLoader(manager){Loader.call(this,manager)}function ImageLoader(manager){Loader.call(this,manager)}function CubeTextureLoader(manager){Loader.call(this,manager)}function DataTextureLoader(manager){Loader.call(this,manager)}function TextureLoader(manager){Loader.call(this,manager)}function Curve(){this.type="Curve";this.arcLengthDivisions=200}function EllipseCurve(aX,
aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){Curve.call(this);this.type="EllipseCurve";this.aX=aX||0;this.aY=aY||0;this.xRadius=xRadius||1;this.yRadius=yRadius||1;this.aStartAngle=aStartAngle||0;this.aEndAngle=aEndAngle||2*Math.PI;this.aClockwise=aClockwise||!1;this.aRotation=aRotation||0}function ArcCurve(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){EllipseCurve.call(this,aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise);this.type="ArcCurve"}function CubicPoly(){var c0=
0,c1=0,c2=0,c3=0;return{initCatmullRom:function(x0,x1,x2,x3,tension){x0=tension*(x2-x0);x3=tension*(x3-x1);c0=x1;c1=x0;c2=-3*x1+3*x2-2*x0-x3;c3=2*x1-2*x2+x0+x3},initNonuniformCatmullRom:function(x0,x1,x2,x3,dt0,dt1,dt2){x0=((x1-x0)/dt0-(x2-x0)/(dt0+dt1)+(x2-x1)/dt1)*dt1;x3=((x2-x1)/dt1-(x3-x1)/(dt1+dt2)+(x3-x2)/dt2)*dt1;c0=x1;c1=x0;c2=-3*x1+3*x2-2*x0-x3;c3=2*x1-2*x2+x0+x3},calc:function(t){var t2=t*t;return c0+c1*t+c2*t2+c3*t2*t}}}function CatmullRomCurve3(points,closed,curveType,tension){void 0===
points&&(points=[]);void 0===closed&&(closed=!1);void 0===curveType&&(curveType="centripetal");void 0===tension&&(tension=.5);Curve.call(this);this.type="CatmullRomCurve3";this.points=points;this.closed=closed;this.curveType=curveType;this.tension=tension}function CatmullRom(t,p0,p1,p2,p3){p0=.5*(p2-p0);p3=.5*(p3-p1);var t2=t*t;return(2*p1-2*p2+p0+p3)*t*t2+(-3*p1+3*p2-2*p0-p3)*t2+p0*t+p1}function QuadraticBezier(t,p0,p1,p2){var k=1-t;return k*k*p0+2*(1-t)*t*p1+t*t*p2}function CubicBezier(t,p0,p1,
p2,p3){var k=1-t,k$jscomp$0=1-t;return k*k*k*p0+3*k$jscomp$0*k$jscomp$0*t*p1+3*(1-t)*t*t*p2+t*t*t*p3}function CubicBezierCurve(v0,v1,v2,v3){void 0===v0&&(v0=new Vector2);void 0===v1&&(v1=new Vector2);void 0===v2&&(v2=new Vector2);void 0===v3&&(v3=new Vector2);Curve.call(this);this.type="CubicBezierCurve";this.v0=v0;this.v1=v1;this.v2=v2;this.v3=v3}function CubicBezierCurve3(v0,v1,v2,v3){void 0===v0&&(v0=new Vector3);void 0===v1&&(v1=new Vector3);void 0===v2&&(v2=new Vector3);void 0===v3&&(v3=new Vector3);
Curve.call(this);this.type="CubicBezierCurve3";this.v0=v0;this.v1=v1;this.v2=v2;this.v3=v3}function LineCurve(v1,v2){void 0===v1&&(v1=new Vector2);void 0===v2&&(v2=new Vector2);Curve.call(this);this.type="LineCurve";this.v1=v1;this.v2=v2}function LineCurve3(v1,v2){void 0===v1&&(v1=new Vector3);void 0===v2&&(v2=new Vector3);Curve.call(this);this.type="LineCurve3";this.v1=v1;this.v2=v2}function QuadraticBezierCurve(v0,v1,v2){void 0===v0&&(v0=new Vector2);void 0===v1&&(v1=new Vector2);void 0===v2&&(v2=
new Vector2);Curve.call(this);this.type="QuadraticBezierCurve";this.v0=v0;this.v1=v1;this.v2=v2}function QuadraticBezierCurve3(v0,v1,v2){void 0===v0&&(v0=new Vector3);void 0===v1&&(v1=new Vector3);void 0===v2&&(v2=new Vector3);Curve.call(this);this.type="QuadraticBezierCurve3";this.v0=v0;this.v1=v1;this.v2=v2}function SplineCurve(points){void 0===points&&(points=[]);Curve.call(this);this.type="SplineCurve";this.points=points}function CurvePath(){Curve.call(this);this.type="CurvePath";this.curves=
[];this.autoClose=!1}function Path(points){CurvePath.call(this);this.type="Path";this.currentPoint=new Vector2;points&&this.setFromPoints(points)}function Shape(points){Path.call(this,points);this.uuid=MathUtils.generateUUID();this.type="Shape";this.holes=[]}function Light(color,intensity){void 0===intensity&&(intensity=1);Object3D.call(this);this.type="Light";this.color=new Color(color);this.intensity=intensity}function HemisphereLight(skyColor,groundColor,intensity){Light.call(this,skyColor,intensity);
this.type="HemisphereLight";this.position.copy(Object3D.DefaultUp);this.updateMatrix();this.groundColor=new Color(groundColor)}function LightShadow(camera){this.camera=camera;this.normalBias=this.bias=0;this.radius=1;this.mapSize=new Vector2(512,512);this.mapPass=this.map=null;this.matrix=new Matrix4;this.autoUpdate=!0;this.needsUpdate=!1;this._frustum=new Frustum;this._frameExtents=new Vector2(1,1);this._viewportCount=1;this._viewports=[new Vector4(0,0,1,1)]}function SpotLightShadow(){LightShadow.call(this,
new PerspectiveCamera(50,1,.5,500));this.focus=1}function SpotLight(color,intensity,distance,angle,penumbra,decay){Light.call(this,color,intensity);this.type="SpotLight";this.position.copy(Object3D.DefaultUp);this.updateMatrix();this.target=new Object3D;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(power){this.intensity=power/Math.PI}});this.distance=void 0!==distance?distance:0;this.angle=void 0!==angle?angle:Math.PI/3;this.penumbra=void 0!==penumbra?
penumbra:0;this.decay=void 0!==decay?decay:1;this.shadow=new SpotLightShadow}function PointLightShadow(){LightShadow.call(this,new PerspectiveCamera(90,1,.5,500));this._frameExtents=new Vector2(4,2);this._viewportCount=6;this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)];this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,
0)];this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}function PointLight(color,intensity,distance,decay){Light.call(this,color,intensity);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(power){this.intensity=power/(4*Math.PI)}});this.distance=void 0!==distance?distance:0;this.decay=void 0!==decay?decay:1;this.shadow=new PointLightShadow}function OrthographicCamera(left,
right,top,bottom,near,far){Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=void 0!==left?left:-1;this.right=void 0!==right?right:1;this.top=void 0!==top?top:1;this.bottom=void 0!==bottom?bottom:-1;this.near=void 0!==near?near:.1;this.far=void 0!==far?far:2E3;this.updateProjectionMatrix()}function DirectionalLightShadow(){LightShadow.call(this,new OrthographicCamera(-5,5,5,-5,.5,500))}function DirectionalLight(color,intensity){Light.call(this,color,intensity);
this.type="DirectionalLight";this.position.copy(Object3D.DefaultUp);this.updateMatrix();this.target=new Object3D;this.shadow=new DirectionalLightShadow}function AmbientLight(color,intensity){Light.call(this,color,intensity);this.type="AmbientLight"}function RectAreaLight(color,intensity,width,height){Light.call(this,color,intensity);this.type="RectAreaLight";this.width=void 0!==width?width:10;this.height=void 0!==height?height:10}function LightProbe(sh,intensity){Light.call(this,void 0,intensity);
this.type="LightProbe";this.sh=void 0!==sh?sh:new SphericalHarmonics3}function MaterialLoader(manager){Loader.call(this,manager);this.textures={}}function InstancedBufferGeometry(){BufferGeometry.call(this);this.type="InstancedBufferGeometry";this.instanceCount=Infinity}function InstancedBufferAttribute(array,itemSize,normalized,meshPerAttribute){"number"===typeof normalized&&(meshPerAttribute=normalized,normalized=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));
BufferAttribute.call(this,array,itemSize,normalized);this.meshPerAttribute=meshPerAttribute||1}function BufferGeometryLoader(manager){Loader.call(this,manager)}function ImageBitmapLoader(manager){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");Loader.call(this,manager);this.options={premultiplyAlpha:"none"}}function ShapePath(){this.type="ShapePath";
this.color=new Color;this.subPaths=[];this.currentPath=null}function Font(data){this.type="Font";this.data=data}function FontLoader(manager){Loader.call(this,manager)}function AudioLoader(manager){Loader.call(this,manager)}function HemisphereLightProbe(skyColor,groundColor,intensity){LightProbe.call(this,void 0,intensity);skyColor=(new Color).set(skyColor);intensity=(new Color).set(groundColor);groundColor=new Vector3(skyColor.r,skyColor.g,skyColor.b);skyColor=new Vector3(intensity.r,intensity.g,
intensity.b);intensity=Math.sqrt(Math.PI);var c1=intensity*Math.sqrt(.75);this.sh.coefficients[0].copy(groundColor).add(skyColor).multiplyScalar(intensity);this.sh.coefficients[1].copy(groundColor).sub(skyColor).multiplyScalar(c1)}function AmbientLightProbe(color,intensity){LightProbe.call(this,void 0,intensity);color=(new Color).set(color);this.sh.coefficients[0].set(color.r,color.g,color.b).multiplyScalar(2*Math.sqrt(Math.PI))}function StereoCamera(){this.type="StereoCamera";this.aspect=1;this.eyeSep=
.064;this.cameraL=new PerspectiveCamera;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new PerspectiveCamera;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function now$jscomp$0(){return("undefined"===typeof performance?Date:performance).now()}function PropertyMixer(binding,typeName,valueSize){this.binding=binding;this.valueSize=valueSize;switch(typeName){case "quaternion":binding=
this._slerp;typeName=this._slerpAdditive;var setIdentity=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*valueSize);this._workIndex=5;break;case "string":case "bool":typeName=binding=this._select;setIdentity=this._setAdditiveIdentityOther;this.buffer=Array(5*valueSize);break;default:binding=this._lerp,typeName=this._lerpAdditive,setIdentity=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*valueSize)}this._mixBufferRegion=binding;this._mixBufferRegionAdditive=typeName;
this._setIdentity=setIdentity;this._origIndex=3;this._addIndex=4;this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Composite(targetGroup,path,optionalParsedPath){optionalParsedPath=optionalParsedPath||PropertyBinding.parseTrackName(path);this._targetGroup=targetGroup;this._bindings=targetGroup.subscribe_(path,optionalParsedPath)}function PropertyBinding(rootNode,path,parsedPath){this.path=path;this.parsedPath=parsedPath||PropertyBinding.parseTrackName(path);
this.node=PropertyBinding.findNode(rootNode,this.parsedPath.nodeName)||rootNode;this.rootNode=rootNode}function AnimationObjectGroup(){this.uuid=MathUtils.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var indices={};this._indicesByUUID=indices;for(var i=0,n=arguments.length;i!==n;++i)indices[arguments[i].uuid]=i;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var scope=this;this.stats={objects:{get total(){return scope._objects.length},
get inUse(){return this.total-scope.nCachedObjects_}},get bindingsPerObject(){return scope._bindings.length}}}function AnimationMixer(root){this._root=root;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function InstancedInterleavedBuffer(array,stride,meshPerAttribute){InterleavedBuffer.call(this,array,stride);this.meshPerAttribute=meshPerAttribute||1}function GLBufferAttribute(buffer,type,itemSize,elementSize,count){this.buffer=buffer;this.type=type;this.itemSize=itemSize;
this.elementSize=elementSize;this.count=count;this.version=0}function Raycaster(origin,direction,near,far){this.ray=new Ray(origin,direction);this.near=near||0;this.far=far||Infinity;this.camera=null;this.layers=new Layers;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function ascSort(a,b){return a.distance-
b.distance}function _intersectObject(object,raycaster,intersects,recursive){object.layers.test(raycaster.layers)&&object.raycast(raycaster,intersects);if(!0===recursive){object=object.children;recursive=0;for(var l=object.length;recursive<l;recursive++)_intersectObject(object[recursive],raycaster,intersects,!0)}}function ImmediateRenderObject(material){Object3D.call(this);this.material=material;this.render=function(){};this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1;this.uvArray=this.colorArray=
this.normalArray=this.positionArray=null;this.count=0}function getBoneList(object){var boneList=[];object&&object.isBone&&boneList.push(object);for(var i=0;i<object.children.length;i++)boneList.push.apply(boneList,getBoneList(object.children[i]));return boneList}function setPoint(point,pointMap,geometry,camera,x,y,z){_vector$b.set(x,y,z).unproject(camera);point=pointMap[point];if(void 0!==point)for(geometry=geometry.getAttribute("position"),pointMap=0,camera=point.length;pointMap<camera;pointMap++)geometry.setXYZ(point[pointMap],
_vector$b.x,_vector$b.y,_vector$b.z)}function _createRenderTarget(params){params=new WebGLRenderTarget(3*SIZE_MAX,3*SIZE_MAX,params);params.texture.mapping=306;params.texture.name="PMREM.cubeUv";params.scissorTest=!0;return params}function _setViewport(target,x,y,width,height){target.viewport.set(x,y,width,height);target.scissor.set(x,y,width,height)}function _getEquirectShader(){var texelSize=new Vector2(1,1);return new RawShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},
texelSize:{value:texelSize},inputEncoding:{value:ENCODINGS[3E3]},outputEncoding:{value:ENCODINGS[3E3]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t"+_getEncodings()+"\n\n\t\t\t#include \x3ccommon\x3e\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection \x3d normalize( vOutputDirection );\n\t\t\t\tvec2 uv \x3d equirectUv( outputDirection );\n\n\t\t\t\tvec2 f \x3d fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -\x3d f * texelSize;\n\t\t\t\tvec3 tl \x3d envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x +\x3d texelSize.x;\n\t\t\t\tvec3 tr \x3d envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y +\x3d texelSize.y;\n\t\t\t\tvec3 br \x3d envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -\x3d texelSize.x;\n\t\t\t\tvec3 bl \x3d envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm \x3d mix( tl, tr, f.x );\n\t\t\t\tvec3 bm \x3d mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb \x3d mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor \x3d linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function _getCubemapShader(){return new RawShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ENCODINGS[3E3]},outputEncoding:{value:ENCODINGS[3E3]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t"+_getEncodings()+"\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb \x3d envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor \x3d linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv \x3d 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction \x3d vec3( uv, 1.0 );\n\n\t\t\tif ( face \x3d\x3d 0.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face \x3d\x3d 1.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face \x3d\x3d 2.0 ) {\n\n\t\t\t\tdirection.x *\x3d -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face \x3d\x3d 3.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face \x3d\x3d 4.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xy *\x3d -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face \x3d\x3d 5.0 ) {\n\n\t\t\t\tdirection.z *\x3d -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection \x3d getDirection( uv, faceIndex );\n\t\t\tgl_Position \x3d vec4( position, 1.0 );\n\n\t\t}\n\t"}
function _getEncodings(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include \x3cencodings_pars_fragment\x3e\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding \x3d\x3d 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding \x3d\x3d 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding \x3d\x3d 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding \x3d\x3d 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding \x3d\x3d 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding \x3d\x3d 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding \x3d\x3d 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding \x3d\x3d 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding \x3d\x3d 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding \x3d\x3d 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding \x3d\x3d 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding \x3d\x3d 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}
function ClosedSplineCurve3(points){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");CatmullRomCurve3.call(this,points);this.type="catmullrom";this.closed=!0}function SplineCurve3(points){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");CatmullRomCurve3.call(this,points);this.type="catmullrom"}function Spline(points){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");CatmullRomCurve3.call(this,
points);this.type="catmullrom"}Object.assign(EventDispatcher.prototype,{addEventListener:function(type,listener){void 0===this._listeners&&(this._listeners={});var listeners=this._listeners;void 0===listeners[type]&&(listeners[type]=[]);-1===listeners[type].indexOf(listener)&&listeners[type].push(listener)},hasEventListener:function(type,listener){if(void 0===this._listeners)return!1;var listeners=this._listeners;return void 0!==listeners[type]&&-1!==listeners[type].indexOf(listener)},removeEventListener:function(type,
listener){void 0!==this._listeners&&(type=this._listeners[type],void 0!==type&&(listener=type.indexOf(listener),-1!==listener&&type.splice(listener,1)))},dispatchEvent:function(event){if(void 0!==this._listeners){var listenerArray=this._listeners[event.type];if(void 0!==listenerArray){event.target=this;listenerArray=listenerArray.slice(0);for(var i=0,l=listenerArray.length;i<l;i++)listenerArray[i].call(this,event)}}}});for(var _lut=[],i$jscomp$1=0;256>i$jscomp$1;i$jscomp$1++)_lut[i$jscomp$1]=(16>
i$jscomp$1?"0":"")+i$jscomp$1.toString(16);var _seed=1234567,MathUtils={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var d0=4294967295*Math.random()|0,d1=4294967295*Math.random()|0,d2=4294967295*Math.random()|0,d3=4294967295*Math.random()|0;return(_lut[d0&255]+_lut[d0>>8&255]+_lut[d0>>16&255]+_lut[d0>>24&255]+"-"+_lut[d1&255]+_lut[d1>>8&255]+"-"+_lut[d1>>16&15|64]+_lut[d1>>24&255]+"-"+_lut[d2&63|128]+_lut[d2>>8&255]+"-"+_lut[d2>>16&255]+_lut[d2>>24&255]+_lut[d3&255]+_lut[d3>>8&
255]+_lut[d3>>16&255]+_lut[d3>>24&255]).toUpperCase()},clamp:function(value,min,max){return Math.max(min,Math.min(max,value))},euclideanModulo:function(n,m){return(n%m+m)%m},mapLinear:function(x,a1,a2,b1,b2){return b1+(x-a1)*(b2-b1)/(a2-a1)},lerp:function(x,y,t){return(1-t)*x+t*y},smoothstep:function(x,min,max){if(x<=min)return 0;if(x>=max)return 1;x=(x-min)/(max-min);return x*x*(3-2*x)},smootherstep:function(x,min,max){if(x<=min)return 0;if(x>=max)return 1;x=(x-min)/(max-min);return x*x*x*(x*(6*
x-15)+10)},randInt:function(low,high){return low+Math.floor(Math.random()*(high-low+1))},randFloat:function(low,high){return low+Math.random()*(high-low)},randFloatSpread:function(range){return range*(.5-Math.random())},seededRandom:function(s){void 0!==s&&(_seed=s%2147483647);_seed=16807*_seed%2147483647;return(_seed-1)/2147483646},degToRad:function(degrees){return degrees*MathUtils.DEG2RAD},radToDeg:function(radians){return radians*MathUtils.RAD2DEG},isPowerOfTwo:function(value){return 0===(value&
value-1)&&0!==value},ceilPowerOfTwo:function(value){return Math.pow(2,Math.ceil(Math.log(value)/Math.LN2))},floorPowerOfTwo:function(value){return Math.pow(2,Math.floor(Math.log(value)/Math.LN2))},setQuaternionFromProperEuler:function(q,a,b,c,order){var cos=Math.cos,sin=Math.sin,c2=cos(b/2);b=sin(b/2);var c13=cos((a+c)/2),s13=sin((a+c)/2),c1_3=cos((a-c)/2),s1_3=sin((a-c)/2);cos=cos((c-a)/2);a=sin((c-a)/2);switch(order){case "XYX":q.set(c2*s13,b*c1_3,b*s1_3,c2*c13);break;case "YZY":q.set(b*s1_3,c2*
s13,b*c1_3,c2*c13);break;case "ZXZ":q.set(b*c1_3,b*s1_3,c2*s13,c2*c13);break;case "XZX":q.set(c2*s13,b*a,b*cos,c2*c13);break;case "YXY":q.set(b*cos,c2*s13,b*a,c2*c13);break;case "ZYZ":q.set(b*a,b*cos,c2*s13,c2*c13);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+order)}}},Vector2=function(){function Vector2(x,y){void 0===x&&(x=0);void 0===y&&(y=0);Object.defineProperty(this,"isVector2",{value:!0});this.x=x;this.y=y}var _proto=Vector2.prototype;
_proto.set=function(x,y){this.x=x;this.y=y;return this};_proto.setScalar=function(scalar){this.y=this.x=scalar;return this};_proto.setX=function(x){this.x=x;return this};_proto.setY=function(y){this.y=y;return this};_proto.setComponent=function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;default:throw Error("index is out of range: "+index);}return this};_proto.getComponent=function(index){switch(index){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+
index);}};_proto.clone=function(){return new this.constructor(this.x,this.y)};_proto.copy=function(v){this.x=v.x;this.y=v.y;return this};_proto.add=function(v,w){if(void 0!==w)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(v,w);this.x+=v.x;this.y+=v.y;return this};_proto.addScalar=function(s){this.x+=s;this.y+=s;return this};_proto.addVectors=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this};_proto.addScaledVector=
function(v,s){this.x+=v.x*s;this.y+=v.y*s;return this};_proto.sub=function(v,w){if(void 0!==w)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(v,w);this.x-=v.x;this.y-=v.y;return this};_proto.subScalar=function(s){this.x-=s;this.y-=s;return this};_proto.subVectors=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this};_proto.multiply=function(v){this.x*=v.x;this.y*=v.y;return this};_proto.multiplyScalar=function(scalar){this.x*=
scalar;this.y*=scalar;return this};_proto.divide=function(v){this.x/=v.x;this.y/=v.y;return this};_proto.divideScalar=function(scalar){return this.multiplyScalar(1/scalar)};_proto.applyMatrix3=function(m){var x=this.x,y=this.y;m=m.elements;this.x=m[0]*x+m[3]*y+m[6];this.y=m[1]*x+m[4]*y+m[7];return this};_proto.min=function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);return this};_proto.max=function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);return this};_proto.clamp=
function(min,max){this.x=Math.max(min.x,Math.min(max.x,this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));return this};_proto.clampScalar=function(minVal,maxVal){this.x=Math.max(minVal,Math.min(maxVal,this.x));this.y=Math.max(minVal,Math.min(maxVal,this.y));return this};_proto.clampLength=function(min,max){var length=this.length();return this.divideScalar(length||1).multiplyScalar(Math.max(min,Math.min(max,length)))};_proto.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);
return this};_proto.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};_proto.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};_proto.roundToZero=function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this};_proto.negate=function(){this.x=-this.x;this.y=-this.y;return this};_proto.dot=function(v){return this.x*v.x+this.y*v.y};_proto.cross=function(v){return this.x*v.y-
this.y*v.x};_proto.lengthSq=function(){return this.x*this.x+this.y*this.y};_proto.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};_proto.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)};_proto.normalize=function(){return this.divideScalar(this.length()||1)};_proto.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI};_proto.distanceTo=function(v){return Math.sqrt(this.distanceToSquared(v))};_proto.distanceToSquared=function(v){var dx=this.x-v.x;v=this.y-
v.y;return dx*dx+v*v};_proto.manhattanDistanceTo=function(v){return Math.abs(this.x-v.x)+Math.abs(this.y-v.y)};_proto.setLength=function(length){return this.normalize().multiplyScalar(length)};_proto.lerp=function(v,alpha){this.x+=(v.x-this.x)*alpha;this.y+=(v.y-this.y)*alpha;return this};_proto.lerpVectors=function(v1,v2,alpha){this.x=v1.x+(v2.x-v1.x)*alpha;this.y=v1.y+(v2.y-v1.y)*alpha;return this};_proto.equals=function(v){return v.x===this.x&&v.y===this.y};_proto.fromArray=function(array,offset){void 0===
offset&&(offset=0);this.x=array[offset];this.y=array[offset+1];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);array[offset]=this.x;array[offset+1]=this.y;return array};_proto.fromBufferAttribute=function(attribute,index,offset){void 0!==offset&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=attribute.getX(index);this.y=attribute.getY(index);return this};_proto.rotateAround=function(center,angle){var c=
Math.cos(angle);angle=Math.sin(angle);var x=this.x-center.x,y=this.y-center.y;this.x=x*c-y*angle+center.x;this.y=x*angle+y*c+center.y;return this};_proto.random=function(){this.x=Math.random();this.y=Math.random();return this};_createClass(Vector2,[{key:"width",get:function(){return this.x},set:function(value){this.x=value}},{key:"height",get:function(){return this.y},set:function(value){this.y=value}}]);return Vector2}(),Matrix3=function(){function Matrix3(){Object.defineProperty(this,"isMatrix3",
{value:!0});this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var _proto=Matrix3.prototype;_proto.set=function(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this.elements;te[0]=n11;te[1]=n21;te[2]=n31;te[3]=n12;te[4]=n22;te[5]=n32;te[6]=n13;te[7]=n23;te[8]=n33;return this};_proto.identity=function(){this.set(1,0,0,0,1,0,0,0,1);return this};_proto.clone=function(){return(new this.constructor).fromArray(this.elements)};
_proto.copy=function(m){var te=this.elements;m=m.elements;te[0]=m[0];te[1]=m[1];te[2]=m[2];te[3]=m[3];te[4]=m[4];te[5]=m[5];te[6]=m[6];te[7]=m[7];te[8]=m[8];return this};_proto.extractBasis=function(xAxis,yAxis,zAxis){xAxis.setFromMatrix3Column(this,0);yAxis.setFromMatrix3Column(this,1);zAxis.setFromMatrix3Column(this,2);return this};_proto.setFromMatrix4=function(m){m=m.elements;this.set(m[0],m[4],m[8],m[1],m[5],m[9],m[2],m[6],m[10]);return this};_proto.multiply=function(m){return this.multiplyMatrices(this,
m)};_proto.premultiply=function(m){return this.multiplyMatrices(m,this)};_proto.multiplyMatrices=function(a,b){var ae=a.elements,be=b.elements;b=this.elements;a=ae[0];var a12=ae[3],a13=ae[6],a21=ae[1],a22=ae[4],a23=ae[7],a31=ae[2],a32=ae[5];ae=ae[8];var b11=be[0],b12=be[3],b13=be[6],b21=be[1],b22=be[4],b23=be[7],b31=be[2],b32=be[5];be=be[8];b[0]=a*b11+a12*b21+a13*b31;b[3]=a*b12+a12*b22+a13*b32;b[6]=a*b13+a12*b23+a13*be;b[1]=a21*b11+a22*b21+a23*b31;b[4]=a21*b12+a22*b22+a23*b32;b[7]=a21*b13+a22*b23+
a23*be;b[2]=a31*b11+a32*b21+ae*b31;b[5]=a31*b12+a32*b22+ae*b32;b[8]=a31*b13+a32*b23+ae*be;return this};_proto.multiplyScalar=function(s){var te=this.elements;te[0]*=s;te[3]*=s;te[6]*=s;te[1]*=s;te[4]*=s;te[7]*=s;te[2]*=s;te[5]*=s;te[8]*=s;return this};_proto.determinant=function(){var te=this.elements,a=te[0],b=te[1],c=te[2],d=te[3],e=te[4],f=te[5],g=te[6],h=te[7];te=te[8];return a*e*te-a*f*h-b*d*te+b*f*g+c*d*h-c*e*g};_proto.invert=function(){var te=this.elements,n11=te[0],n21=te[1],n31=te[2],n12=
te[3],n22=te[4],n32=te[5],n13=te[6],n23=te[7],n33=te[8],t11=n33*n22-n32*n23,t12=n32*n13-n33*n12,t13=n23*n12-n22*n13,det=n11*t11+n21*t12+n31*t13;if(0===det)return this.set(0,0,0,0,0,0,0,0,0);det=1/det;te[0]=t11*det;te[1]=(n31*n23-n33*n21)*det;te[2]=(n32*n21-n31*n22)*det;te[3]=t12*det;te[4]=(n33*n11-n31*n13)*det;te[5]=(n31*n12-n32*n11)*det;te[6]=t13*det;te[7]=(n21*n13-n23*n11)*det;te[8]=(n22*n11-n21*n12)*det;return this};_proto.transpose=function(){var m=this.elements;var tmp=m[1];m[1]=m[3];m[3]=tmp;
tmp=m[2];m[2]=m[6];m[6]=tmp;tmp=m[5];m[5]=m[7];m[7]=tmp;return this};_proto.getNormalMatrix=function(matrix4){return this.setFromMatrix4(matrix4).copy(this).invert().transpose()};_proto.transposeIntoArray=function(r){var m=this.elements;r[0]=m[0];r[1]=m[3];r[2]=m[6];r[3]=m[1];r[4]=m[4];r[5]=m[7];r[6]=m[2];r[7]=m[5];r[8]=m[8];return this};_proto.setUvTransform=function(tx,ty,sx,sy,rotation,cx,cy){var c=Math.cos(rotation);rotation=Math.sin(rotation);this.set(sx*c,sx*rotation,-sx*(c*cx+rotation*cy)+
cx+tx,-sy*rotation,sy*c,-sy*(-rotation*cx+c*cy)+cy+ty,0,0,1)};_proto.scale=function(sx,sy){var te=this.elements;te[0]*=sx;te[3]*=sx;te[6]*=sx;te[1]*=sy;te[4]*=sy;te[7]*=sy;return this};_proto.rotate=function(theta){var c=Math.cos(theta);theta=Math.sin(theta);var te=this.elements,a11=te[0],a12=te[3],a13=te[6],a21=te[1],a22=te[4],a23=te[7];te[0]=c*a11+theta*a21;te[3]=c*a12+theta*a22;te[6]=c*a13+theta*a23;te[1]=-theta*a11+c*a21;te[4]=-theta*a12+c*a22;te[7]=-theta*a13+c*a23;return this};_proto.translate=
function(tx,ty){var te=this.elements;te[0]+=tx*te[2];te[3]+=tx*te[5];te[6]+=tx*te[8];te[1]+=ty*te[2];te[4]+=ty*te[5];te[7]+=ty*te[8];return this};_proto.equals=function(matrix){var te=this.elements;matrix=matrix.elements;for(var i=0;9>i;i++)if(te[i]!==matrix[i])return!1;return!0};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);for(var i=0;9>i;i++)this.elements[i]=array[i+offset];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=
0);var te=this.elements;array[offset]=te[0];array[offset+1]=te[1];array[offset+2]=te[2];array[offset+3]=te[3];array[offset+4]=te[4];array[offset+5]=te[5];array[offset+6]=te[6];array[offset+7]=te[7];array[offset+8]=te[8];return array};return Matrix3}(),_canvas,ImageUtils={getDataURL:function(image){if(/^data:/i.test(image.src)||"undefined"==typeof HTMLCanvasElement)return image.src;if(!(image instanceof HTMLCanvasElement)){void 0===_canvas&&(_canvas=document.createElementNS("http://www.w3.org/1999/xhtml",
"canvas"));_canvas.width=image.width;_canvas.height=image.height;var context=_canvas.getContext("2d");image instanceof ImageData?context.putImageData(image,0,0):context.drawImage(image,0,0,image.width,image.height);image=_canvas}return 2048<image.width||2048<image.height?image.toDataURL("image/jpeg",.6):image.toDataURL("image/png")}},textureId=0;Texture.DEFAULT_IMAGE=void 0;Texture.DEFAULT_MAPPING=300;Texture.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Texture,isTexture:!0,
updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.name=source.name;this.image=source.image;this.mipmaps=source.mipmaps.slice(0);this.mapping=source.mapping;this.wrapS=source.wrapS;this.wrapT=source.wrapT;this.magFilter=source.magFilter;this.minFilter=source.minFilter;this.anisotropy=source.anisotropy;this.format=source.format;
this.internalFormat=source.internalFormat;this.type=source.type;this.offset.copy(source.offset);this.repeat.copy(source.repeat);this.center.copy(source.center);this.rotation=source.rotation;this.matrixAutoUpdate=source.matrixAutoUpdate;this.matrix.copy(source.matrix);this.generateMipmaps=source.generateMipmaps;this.premultiplyAlpha=source.premultiplyAlpha;this.flipY=source.flipY;this.unpackAlignment=source.unpackAlignment;this.encoding=source.encoding;return this},toJSON:function(meta){var isRootObject=
void 0===meta||"string"===typeof meta;if(!isRootObject&&void 0!==meta.textures[this.uuid])return meta.textures[this.uuid];var output={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,
anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var image=this.image;void 0===image.uuid&&(image.uuid=MathUtils.generateUUID());if(!isRootObject&&void 0===meta.images[image.uuid]){if(Array.isArray(image)){var url=[];for(var i=0,l=image.length;i<l;i++)image[i].isDataTexture?url.push(serializeImage(image[i].image)):url.push(serializeImage(image[i]))}else url=serializeImage(image);meta.images[image.uuid]=
{uuid:image.uuid,url:url}}output.image=image.uuid}isRootObject||(meta.textures[this.uuid]=output);return output},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(uv){if(300!==this.mapping)return uv;uv.applyMatrix3(this.matrix);if(0>uv.x||1<uv.x)switch(this.wrapS){case 1E3:uv.x-=Math.floor(uv.x);break;case 1001:uv.x=0>uv.x?0:1;break;case 1002:uv.x=1===Math.abs(Math.floor(uv.x)%2)?Math.ceil(uv.x)-uv.x:uv.x-Math.floor(uv.x)}if(0>uv.y||1<uv.y)switch(this.wrapT){case 1E3:uv.y-=
Math.floor(uv.y);break;case 1001:uv.y=0>uv.y?0:1;break;case 1002:uv.y=1===Math.abs(Math.floor(uv.y)%2)?Math.ceil(uv.y)-uv.y:uv.y-Math.floor(uv.y)}this.flipY&&(uv.y=1-uv.y);return uv}});Object.defineProperty(Texture.prototype,"needsUpdate",{set:function(value){!0===value&&this.version++}});var Vector4=function(){function Vector4(x,y,z,w){void 0===x&&(x=0);void 0===y&&(y=0);void 0===z&&(z=0);void 0===w&&(w=1);Object.defineProperty(this,"isVector4",{value:!0});this.x=x;this.y=y;this.z=z;this.w=w}var _proto=
Vector4.prototype;_proto.set=function(x,y,z,w){this.x=x;this.y=y;this.z=z;this.w=w;return this};_proto.setScalar=function(scalar){this.w=this.z=this.y=this.x=scalar;return this};_proto.setX=function(x){this.x=x;return this};_proto.setY=function(y){this.y=y;return this};_proto.setZ=function(z){this.z=z;return this};_proto.setW=function(w){this.w=w;return this};_proto.setComponent=function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;case 3:this.w=
value;break;default:throw Error("index is out of range: "+index);}return this};_proto.getComponent=function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+index);}};_proto.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)};_proto.copy=function(v){this.x=v.x;this.y=v.y;this.z=v.z;this.w=void 0!==v.w?v.w:1;return this};_proto.add=function(v,w){if(void 0!==w)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(v,w);this.x+=v.x;this.y+=v.y;this.z+=v.z;this.w+=v.w;return this};_proto.addScalar=function(s){this.x+=s;this.y+=s;this.z+=s;this.w+=s;return this};_proto.addVectors=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this};_proto.addScaledVector=function(v,s){this.x+=v.x*s;this.y+=v.y*s;this.z+=v.z*s;this.w+=v.w*s;return this};_proto.sub=function(v,w){if(void 0!==w)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(v,w);this.x-=v.x;this.y-=v.y;this.z-=v.z;this.w-=v.w;return this};_proto.subScalar=function(s){this.x-=s;this.y-=s;this.z-=s;this.w-=s;return this};_proto.subVectors=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this};_proto.multiplyScalar=function(scalar){this.x*=scalar;this.y*=scalar;this.z*=scalar;this.w*=scalar;return this};_proto.applyMatrix4=function(m){var x=this.x,y=this.y,z=this.z,w=this.w;m=m.elements;this.x=m[0]*x+m[4]*y+m[8]*z+m[12]*w;
this.y=m[1]*x+m[5]*y+m[9]*z+m[13]*w;this.z=m[2]*x+m[6]*y+m[10]*z+m[14]*w;this.w=m[3]*x+m[7]*y+m[11]*z+m[15]*w;return this};_proto.divideScalar=function(scalar){return this.multiplyScalar(1/scalar)};_proto.setAxisAngleFromQuaternion=function(q){this.w=2*Math.acos(q.w);var s=Math.sqrt(1-q.w*q.w);1E-4>s?(this.x=1,this.z=this.y=0):(this.x=q.x/s,this.y=q.y/s,this.z=q.z/s);return this};_proto.setAxisAngleFromRotationMatrix=function(m){m=m.elements;var m11=m[0];var z=m[4];var m13=m[8],m21=m[1],m22=m[5],
m23=m[9];var y=m[2];var x=m[6];var m33=m[10];if(.01>Math.abs(z-m21)&&.01>Math.abs(m13-y)&&.01>Math.abs(m23-x)){if(.1>Math.abs(z+m21)&&.1>Math.abs(m13+y)&&.1>Math.abs(m23+x)&&.1>Math.abs(m11+m22+m33-3))return this.set(1,0,0,0),this;m=Math.PI;m11=(m11+1)/2;m22=(m22+1)/2;m33=(m33+1)/2;z=(z+m21)/4;m13=(m13+y)/4;m23=(m23+x)/4;m11>m22&&m11>m33?.01>m11?(x=0,z=y=.707106781):(x=Math.sqrt(m11),y=z/x,z=m13/x):m22>m33?.01>m22?(x=.707106781,y=0,z=.707106781):(y=Math.sqrt(m22),x=z/y,z=m23/y):.01>m33?(y=x=.707106781,
z=0):(z=Math.sqrt(m33),x=m13/z,y=m23/z);this.set(x,y,z,m);return this}m=Math.sqrt((x-m23)*(x-m23)+(m13-y)*(m13-y)+(m21-z)*(m21-z));.001>Math.abs(m)&&(m=1);this.x=(x-m23)/m;this.y=(m13-y)/m;this.z=(m21-z)/m;this.w=Math.acos((m11+m22+m33-1)/2);return this};_proto.min=function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);this.z=Math.min(this.z,v.z);this.w=Math.min(this.w,v.w);return this};_proto.max=function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);this.z=Math.max(this.z,
v.z);this.w=Math.max(this.w,v.w);return this};_proto.clamp=function(min,max){this.x=Math.max(min.x,Math.min(max.x,this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));this.z=Math.max(min.z,Math.min(max.z,this.z));this.w=Math.max(min.w,Math.min(max.w,this.w));return this};_proto.clampScalar=function(minVal,maxVal){this.x=Math.max(minVal,Math.min(maxVal,this.x));this.y=Math.max(minVal,Math.min(maxVal,this.y));this.z=Math.max(minVal,Math.min(maxVal,this.z));this.w=Math.max(minVal,Math.min(maxVal,this.w));
return this};_proto.clampLength=function(min,max){var length=this.length();return this.divideScalar(length||1).multiplyScalar(Math.max(min,Math.min(max,length)))};_proto.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this};_proto.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this};_proto.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
this.z=Math.round(this.z);this.w=Math.round(this.w);return this};_proto.roundToZero=function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this};_proto.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this};_proto.dot=function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w};_proto.lengthSq=
function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w};_proto.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)};_proto.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)};_proto.normalize=function(){return this.divideScalar(this.length()||1)};_proto.setLength=function(length){return this.normalize().multiplyScalar(length)};_proto.lerp=function(v,alpha){this.x+=(v.x-this.x)*alpha;this.y+=
(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;this.w+=(v.w-this.w)*alpha;return this};_proto.lerpVectors=function(v1,v2,alpha){this.x=v1.x+(v2.x-v1.x)*alpha;this.y=v1.y+(v2.y-v1.y)*alpha;this.z=v1.z+(v2.z-v1.z)*alpha;this.w=v1.w+(v2.w-v1.w)*alpha;return this};_proto.equals=function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);this.x=array[offset];this.y=array[offset+1];this.z=array[offset+2];this.w=array[offset+
3];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);array[offset]=this.x;array[offset+1]=this.y;array[offset+2]=this.z;array[offset+3]=this.w;return array};_proto.fromBufferAttribute=function(attribute,index,offset){void 0!==offset&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");this.x=attribute.getX(index);this.y=attribute.getY(index);this.z=attribute.getZ(index);this.w=attribute.getW(index);return this};
_proto.random=function(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this};_createClass(Vector4,[{key:"width",get:function(){return this.z},set:function(value){this.z=value}},{key:"height",get:function(){return this.w},set:function(value){this.w=value}}]);return Vector4}();WebGLRenderTarget.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:WebGLRenderTarget,isWebGLRenderTarget:!0,setSize:function(width,height){if(this.width!==
width||this.height!==height)this.width=width,this.height=height,this.texture.image.width=width,this.texture.image.height=height,this.dispose();this.viewport.set(0,0,width,height);this.scissor.set(0,0,width,height)},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.width=source.width;this.height=source.height;this.viewport.copy(source.viewport);this.texture=source.texture.clone();this.depthBuffer=source.depthBuffer;this.stencilBuffer=source.stencilBuffer;this.depthTexture=
source.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});WebGLMultisampleRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultisampleRenderTarget,isWebGLMultisampleRenderTarget:!0,copy:function(source){WebGLRenderTarget.prototype.copy.call(this,source);this.samples=source.samples;return this}});var Quaternion=function(){function Quaternion(x,y,z,w){void 0===x&&(x=0);void 0===y&&(y=0);void 0===z&&(z=0);void 0===w&&
(w=1);Object.defineProperty(this,"isQuaternion",{value:!0});this._x=x;this._y=y;this._z=z;this._w=w}Quaternion.slerp=function(qa,qb,qm,t){return qm.copy(qa).slerp(qb,t)};Quaternion.slerpFlat=function(dst,dstOffset,src0,srcOffset0,src1,srcOffset1,t){var x0=src0[srcOffset0+0],y0=src0[srcOffset0+1],z0=src0[srcOffset0+2];src0=src0[srcOffset0+3];srcOffset0=src1[srcOffset1+0];var y1=src1[srcOffset1+1],z1=src1[srcOffset1+2];src1=src1[srcOffset1+3];if(src0!==src1||x0!==srcOffset0||y0!==y1||z0!==z1){srcOffset1=
1-t;var cos=x0*srcOffset0+y0*y1+z0*z1+src0*src1,dir=0<=cos?1:-1,sqrSin=1-cos*cos;sqrSin>Number.EPSILON&&(sqrSin=Math.sqrt(sqrSin),cos=Math.atan2(sqrSin,cos*dir),srcOffset1=Math.sin(srcOffset1*cos)/sqrSin,t=Math.sin(t*cos)/sqrSin);dir*=t;x0=x0*srcOffset1+srcOffset0*dir;y0=y0*srcOffset1+y1*dir;z0=z0*srcOffset1+z1*dir;src0=src0*srcOffset1+src1*dir;srcOffset1===1-t&&(t=1/Math.sqrt(x0*x0+y0*y0+z0*z0+src0*src0),x0*=t,y0*=t,z0*=t,src0*=t)}dst[dstOffset]=x0;dst[dstOffset+1]=y0;dst[dstOffset+2]=z0;dst[dstOffset+
3]=src0};Quaternion.multiplyQuaternionsFlat=function(dst,dstOffset,src0,srcOffset0,src1,srcOffset1){var x0=src0[srcOffset0],y0=src0[srcOffset0+1],z0=src0[srcOffset0+2];src0=src0[srcOffset0+3];srcOffset0=src1[srcOffset1];var y1=src1[srcOffset1+1],z1=src1[srcOffset1+2];src1=src1[srcOffset1+3];dst[dstOffset]=x0*src1+src0*srcOffset0+y0*z1-z0*y1;dst[dstOffset+1]=y0*src1+src0*y1+z0*srcOffset0-x0*z1;dst[dstOffset+2]=z0*src1+src0*z1+x0*y1-y0*srcOffset0;dst[dstOffset+3]=src0*src1-x0*srcOffset0-y0*y1-z0*z1;
return dst};var _proto=Quaternion.prototype;_proto.set=function(x,y,z,w){this._x=x;this._y=y;this._z=z;this._w=w;this._onChangeCallback();return this};_proto.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)};_proto.copy=function(quaternion){this._x=quaternion.x;this._y=quaternion.y;this._z=quaternion.z;this._w=quaternion.w;this._onChangeCallback();return this};_proto.setFromEuler=function(euler,update){if(!euler||!euler.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
var x=euler._x,y=euler._y,z=euler._z;euler=euler._order;var cos=Math.cos,sin=Math.sin,c1=cos(x/2),c2=cos(y/2);cos=cos(z/2);x=sin(x/2);y=sin(y/2);z=sin(z/2);switch(euler){case "XYZ":this._x=x*c2*cos+c1*y*z;this._y=c1*y*cos-x*c2*z;this._z=c1*c2*z+x*y*cos;this._w=c1*c2*cos-x*y*z;break;case "YXZ":this._x=x*c2*cos+c1*y*z;this._y=c1*y*cos-x*c2*z;this._z=c1*c2*z-x*y*cos;this._w=c1*c2*cos+x*y*z;break;case "ZXY":this._x=x*c2*cos-c1*y*z;this._y=c1*y*cos+x*c2*z;this._z=c1*c2*z+x*y*cos;this._w=c1*c2*cos-x*y*
z;break;case "ZYX":this._x=x*c2*cos-c1*y*z;this._y=c1*y*cos+x*c2*z;this._z=c1*c2*z-x*y*cos;this._w=c1*c2*cos+x*y*z;break;case "YZX":this._x=x*c2*cos+c1*y*z;this._y=c1*y*cos+x*c2*z;this._z=c1*c2*z-x*y*cos;this._w=c1*c2*cos-x*y*z;break;case "XZY":this._x=x*c2*cos-c1*y*z;this._y=c1*y*cos-x*c2*z;this._z=c1*c2*z+x*y*cos;this._w=c1*c2*cos+x*y*z;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+euler)}!1!==update&&this._onChangeCallback();return this};_proto.setFromAxisAngle=
function(axis,angle){angle/=2;var s=Math.sin(angle);this._x=axis.x*s;this._y=axis.y*s;this._z=axis.z*s;this._w=Math.cos(angle);this._onChangeCallback();return this};_proto.setFromRotationMatrix=function(m){var te=m.elements,m11=te[0];m=te[4];var m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6];te=te[10];var trace=m11+m22+te;0<trace?(m11=.5/Math.sqrt(trace+1),this._w=.25/m11,this._x=(m32-m23)*m11,this._y=(m13-m31)*m11,this._z=(m21-m)*m11):m11>m22&&m11>te?(m11=2*Math.sqrt(1+m11-m22-te),this._w=
(m32-m23)/m11,this._x=.25*m11,this._y=(m+m21)/m11,this._z=(m13+m31)/m11):m22>te?(m11=2*Math.sqrt(1+m22-m11-te),this._w=(m13-m31)/m11,this._x=(m+m21)/m11,this._y=.25*m11,this._z=(m23+m32)/m11):(m11=2*Math.sqrt(1+te-m11-m22),this._w=(m21-m)/m11,this._x=(m13+m31)/m11,this._y=(m23+m32)/m11,this._z=.25*m11);this._onChangeCallback();return this};_proto.setFromUnitVectors=function(vFrom,vTo){var r=vFrom.dot(vTo)+1;1E-6>r?(r=0,Math.abs(vFrom.x)>Math.abs(vFrom.z)?(this._x=-vFrom.y,this._y=vFrom.x,this._z=
0):(this._x=0,this._y=-vFrom.z,this._z=vFrom.y)):(this._x=vFrom.y*vTo.z-vFrom.z*vTo.y,this._y=vFrom.z*vTo.x-vFrom.x*vTo.z,this._z=vFrom.x*vTo.y-vFrom.y*vTo.x);this._w=r;return this.normalize()};_proto.angleTo=function(q){return 2*Math.acos(Math.abs(MathUtils.clamp(this.dot(q),-1,1)))};_proto.rotateTowards=function(q,step){var angle=this.angleTo(q);if(0===angle)return this;this.slerp(q,Math.min(1,step/angle));return this};_proto.identity=function(){return this.set(0,0,0,1)};_proto.invert=function(){return this.conjugate()};
_proto.conjugate=function(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this};_proto.dot=function(v){return this._x*v._x+this._y*v._y+this._z*v._z+this._w*v._w};_proto.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w};_proto.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)};_proto.normalize=function(){var l=this.length();0===l?(this._z=this._y=this._x=0,this._w=1):(l=1/l,this._x*=l,
this._y*=l,this._z*=l,this._w*=l);this._onChangeCallback();return this};_proto.multiply=function(q,p){return void 0!==p?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(q,p)):this.multiplyQuaternions(this,q)};_proto.premultiply=function(q){return this.multiplyQuaternions(q,this)};_proto.multiplyQuaternions=function(a,b){var qax=a._x,qay=a._y,qaz=a._z;a=a._w;var qbx=b._x,qby=b._y,qbz=b._z;b=b._w;this._x=
qax*b+a*qbx+qay*qbz-qaz*qby;this._y=qay*b+a*qby+qaz*qbx-qax*qbz;this._z=qaz*b+a*qbz+qax*qby-qay*qbx;this._w=a*b-qax*qbx-qay*qby-qaz*qbz;this._onChangeCallback();return this};_proto.slerp=function(qb,t){if(0===t)return this;if(1===t)return this.copy(qb);var x=this._x,y=this._y,z=this._z,w=this._w,cosHalfTheta=w*qb._w+x*qb._x+y*qb._y+z*qb._z;0>cosHalfTheta?(this._w=-qb._w,this._x=-qb._x,this._y=-qb._y,this._z=-qb._z,cosHalfTheta=-cosHalfTheta):this.copy(qb);if(1<=cosHalfTheta)return this._w=w,this._x=
x,this._y=y,this._z=z,this;qb=1-cosHalfTheta*cosHalfTheta;if(qb<=Number.EPSILON)return cosHalfTheta=1-t,this._w=cosHalfTheta*w+t*this._w,this._x=cosHalfTheta*x+t*this._x,this._y=cosHalfTheta*y+t*this._y,this._z=cosHalfTheta*z+t*this._z,this.normalize(),this._onChangeCallback(),this;qb=Math.sqrt(qb);var halfTheta=Math.atan2(qb,cosHalfTheta);cosHalfTheta=Math.sin((1-t)*halfTheta)/qb;t=Math.sin(t*halfTheta)/qb;this._w=w*cosHalfTheta+this._w*t;this._x=x*cosHalfTheta+this._x*t;this._y=y*cosHalfTheta+this._y*
t;this._z=z*cosHalfTheta+this._z*t;this._onChangeCallback();return this};_proto.equals=function(quaternion){return quaternion._x===this._x&&quaternion._y===this._y&&quaternion._z===this._z&&quaternion._w===this._w};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);this._x=array[offset];this._y=array[offset+1];this._z=array[offset+2];this._w=array[offset+3];this._onChangeCallback();return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=
0);array[offset]=this._x;array[offset+1]=this._y;array[offset+2]=this._z;array[offset+3]=this._w;return array};_proto.fromBufferAttribute=function(attribute,index){this._x=attribute.getX(index);this._y=attribute.getY(index);this._z=attribute.getZ(index);this._w=attribute.getW(index);return this};_proto._onChange=function(callback){this._onChangeCallback=callback;return this};_proto._onChangeCallback=function(){};_createClass(Quaternion,[{key:"x",get:function(){return this._x},set:function(value){this._x=
value;this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(value){this._y=value;this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(value){this._z=value;this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(value){this._w=value;this._onChangeCallback()}}]);return Quaternion}(),Vector3=function(){function Vector3(x,y,z){void 0===x&&(x=0);void 0===y&&(y=0);void 0===z&&(z=0);Object.defineProperty(this,"isVector3",{value:!0});
this.x=x;this.y=y;this.z=z}var _proto=Vector3.prototype;_proto.set=function(x,y,z){void 0===z&&(z=this.z);this.x=x;this.y=y;this.z=z;return this};_proto.setScalar=function(scalar){this.z=this.y=this.x=scalar;return this};_proto.setX=function(x){this.x=x;return this};_proto.setY=function(y){this.y=y;return this};_proto.setZ=function(z){this.z=z;return this};_proto.setComponent=function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;default:throw Error("index is out of range: "+
index);}return this};_proto.getComponent=function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+index);}};_proto.clone=function(){return new this.constructor(this.x,this.y,this.z)};_proto.copy=function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this};_proto.add=function(v,w){if(void 0!==w)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(v,
w);this.x+=v.x;this.y+=v.y;this.z+=v.z;return this};_proto.addScalar=function(s){this.x+=s;this.y+=s;this.z+=s;return this};_proto.addVectors=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this};_proto.addScaledVector=function(v,s){this.x+=v.x*s;this.y+=v.y*s;this.z+=v.z*s;return this};_proto.sub=function(v,w){if(void 0!==w)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(v,w);this.x-=v.x;this.y-=v.y;this.z-=
v.z;return this};_proto.subScalar=function(s){this.x-=s;this.y-=s;this.z-=s;return this};_proto.subVectors=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this};_proto.multiply=function(v,w){if(void 0!==w)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(v,w);this.x*=v.x;this.y*=v.y;this.z*=v.z;return this};_proto.multiplyScalar=function(scalar){this.x*=scalar;this.y*=scalar;this.z*=scalar;
return this};_proto.multiplyVectors=function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this};_proto.applyEuler=function(euler){euler&&euler.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(_quaternion.setFromEuler(euler))};_proto.applyAxisAngle=function(axis,angle){return this.applyQuaternion(_quaternion.setFromAxisAngle(axis,angle))};_proto.applyMatrix3=function(m){var x=this.x,y=this.y,
z=this.z;m=m.elements;this.x=m[0]*x+m[3]*y+m[6]*z;this.y=m[1]*x+m[4]*y+m[7]*z;this.z=m[2]*x+m[5]*y+m[8]*z;return this};_proto.applyNormalMatrix=function(m){return this.applyMatrix3(m).normalize()};_proto.applyMatrix4=function(m){var x=this.x,y=this.y,z=this.z;m=m.elements;var w=1/(m[3]*x+m[7]*y+m[11]*z+m[15]);this.x=(m[0]*x+m[4]*y+m[8]*z+m[12])*w;this.y=(m[1]*x+m[5]*y+m[9]*z+m[13])*w;this.z=(m[2]*x+m[6]*y+m[10]*z+m[14])*w;return this};_proto.applyQuaternion=function(q){var x=this.x,y=this.y,z=this.z,
qx=q.x,qy=q.y,qz=q.z;q=q.w;var ix=q*x+qy*z-qz*y,iy=q*y+qz*x-qx*z,iz=q*z+qx*y-qy*x;x=-qx*x-qy*y-qz*z;this.x=ix*q+x*-qx+iy*-qz-iz*-qy;this.y=iy*q+x*-qy+iz*-qx-ix*-qz;this.z=iz*q+x*-qz+ix*-qy-iy*-qx;return this};_proto.project=function(camera){return this.applyMatrix4(camera.matrixWorldInverse).applyMatrix4(camera.projectionMatrix)};_proto.unproject=function(camera){return this.applyMatrix4(camera.projectionMatrixInverse).applyMatrix4(camera.matrixWorld)};_proto.transformDirection=function(m){var x=
this.x,y=this.y,z=this.z;m=m.elements;this.x=m[0]*x+m[4]*y+m[8]*z;this.y=m[1]*x+m[5]*y+m[9]*z;this.z=m[2]*x+m[6]*y+m[10]*z;return this.normalize()};_proto.divide=function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z;return this};_proto.divideScalar=function(scalar){return this.multiplyScalar(1/scalar)};_proto.min=function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);this.z=Math.min(this.z,v.z);return this};_proto.max=function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);this.z=
Math.max(this.z,v.z);return this};_proto.clamp=function(min,max){this.x=Math.max(min.x,Math.min(max.x,this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));this.z=Math.max(min.z,Math.min(max.z,this.z));return this};_proto.clampScalar=function(minVal,maxVal){this.x=Math.max(minVal,Math.min(maxVal,this.x));this.y=Math.max(minVal,Math.min(maxVal,this.y));this.z=Math.max(minVal,Math.min(maxVal,this.z));return this};_proto.clampLength=function(min,max){var length=this.length();return this.divideScalar(length||
1).multiplyScalar(Math.max(min,Math.min(max,length)))};_proto.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this};_proto.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this};_proto.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this};_proto.roundToZero=function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this};_proto.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};_proto.dot=function(v){return this.x*v.x+this.y*v.y+this.z*v.z};_proto.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z};_proto.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};_proto.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)};_proto.normalize=
function(){return this.divideScalar(this.length()||1)};_proto.setLength=function(length){return this.normalize().multiplyScalar(length)};_proto.lerp=function(v,alpha){this.x+=(v.x-this.x)*alpha;this.y+=(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;return this};_proto.lerpVectors=function(v1,v2,alpha){this.x=v1.x+(v2.x-v1.x)*alpha;this.y=v1.y+(v2.y-v1.y)*alpha;this.z=v1.z+(v2.z-v1.z)*alpha;return this};_proto.cross=function(v,w){return void 0!==w?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
this.crossVectors(v,w)):this.crossVectors(this,v)};_proto.crossVectors=function(a,b){var ax=a.x,ay=a.y;a=a.z;var bx=b.x,by=b.y;b=b.z;this.x=ay*b-a*by;this.y=a*bx-ax*b;this.z=ax*by-ay*bx;return this};_proto.projectOnVector=function(v){var denominator=v.lengthSq();if(0===denominator)return this.set(0,0,0);denominator=v.dot(this)/denominator;return this.copy(v).multiplyScalar(denominator)};_proto.projectOnPlane=function(planeNormal){_vector.copy(this).projectOnVector(planeNormal);return this.sub(_vector)};
_proto.reflect=function(normal){return this.sub(_vector.copy(normal).multiplyScalar(2*this.dot(normal)))};_proto.angleTo=function(v){var denominator=Math.sqrt(this.lengthSq()*v.lengthSq());if(0===denominator)return Math.PI/2;v=this.dot(v)/denominator;return Math.acos(MathUtils.clamp(v,-1,1))};_proto.distanceTo=function(v){return Math.sqrt(this.distanceToSquared(v))};_proto.distanceToSquared=function(v){var dx=this.x-v.x,dy=this.y-v.y;v=this.z-v.z;return dx*dx+dy*dy+v*v};_proto.manhattanDistanceTo=
function(v){return Math.abs(this.x-v.x)+Math.abs(this.y-v.y)+Math.abs(this.z-v.z)};_proto.setFromSpherical=function(s){return this.setFromSphericalCoords(s.radius,s.phi,s.theta)};_proto.setFromSphericalCoords=function(radius,phi,theta){var sinPhiRadius=Math.sin(phi)*radius;this.x=sinPhiRadius*Math.sin(theta);this.y=Math.cos(phi)*radius;this.z=sinPhiRadius*Math.cos(theta);return this};_proto.setFromCylindrical=function(c){return this.setFromCylindricalCoords(c.radius,c.theta,c.y)};_proto.setFromCylindricalCoords=
function(radius,theta,y){this.x=radius*Math.sin(theta);this.y=y;this.z=radius*Math.cos(theta);return this};_proto.setFromMatrixPosition=function(m){m=m.elements;this.x=m[12];this.y=m[13];this.z=m[14];return this};_proto.setFromMatrixScale=function(m){var sx=this.setFromMatrixColumn(m,0).length(),sy=this.setFromMatrixColumn(m,1).length();m=this.setFromMatrixColumn(m,2).length();this.x=sx;this.y=sy;this.z=m;return this};_proto.setFromMatrixColumn=function(m,index){return this.fromArray(m.elements,4*
index)};_proto.setFromMatrix3Column=function(m,index){return this.fromArray(m.elements,3*index)};_proto.equals=function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);this.x=array[offset];this.y=array[offset+1];this.z=array[offset+2];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);array[offset]=this.x;array[offset+1]=this.y;array[offset+2]=this.z;return array};_proto.fromBufferAttribute=
function(attribute,index,offset){void 0!==offset&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=attribute.getX(index);this.y=attribute.getY(index);this.z=attribute.getZ(index);return this};_proto.random=function(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this};return Vector3}(),_vector=new Vector3,_quaternion=new Quaternion,Box3=function(){function Box3(min,max){Object.defineProperty(this,"isBox3",{value:!0});this.min=void 0!==
min?min:new Vector3(Infinity,Infinity,Infinity);this.max=void 0!==max?max:new Vector3(-Infinity,-Infinity,-Infinity)}var _proto=Box3.prototype;_proto.set=function(min,max){this.min.copy(min);this.max.copy(max);return this};_proto.setFromArray=function(array){for(var minX=Infinity,minY=Infinity,minZ=Infinity,maxX=-Infinity,maxY=-Infinity,maxZ=-Infinity,i=0,l=array.length;i<l;i+=3){var x=array[i],y=array[i+1],z=array[i+2];x<minX&&(minX=x);y<minY&&(minY=y);z<minZ&&(minZ=z);x>maxX&&(maxX=x);y>maxY&&(maxY=
y);z>maxZ&&(maxZ=z)}this.min.set(minX,minY,minZ);this.max.set(maxX,maxY,maxZ);return this};_proto.setFromBufferAttribute=function(attribute){for(var minX=Infinity,minY=Infinity,minZ=Infinity,maxX=-Infinity,maxY=-Infinity,maxZ=-Infinity,i=0,l=attribute.count;i<l;i++){var x=attribute.getX(i),y=attribute.getY(i),z=attribute.getZ(i);x<minX&&(minX=x);y<minY&&(minY=y);z<minZ&&(minZ=z);x>maxX&&(maxX=x);y>maxY&&(maxY=y);z>maxZ&&(maxZ=z)}this.min.set(minX,minY,minZ);this.max.set(maxX,maxY,maxZ);return this};
_proto.setFromPoints=function(points){this.makeEmpty();for(var i=0,il=points.length;i<il;i++)this.expandByPoint(points[i]);return this};_proto.setFromCenterAndSize=function(center,size){size=_vector$1.copy(size).multiplyScalar(.5);this.min.copy(center).sub(size);this.max.copy(center).add(size);return this};_proto.setFromObject=function(object){this.makeEmpty();return this.expandByObject(object)};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(box){this.min.copy(box.min);
this.max.copy(box.max);return this};_proto.makeEmpty=function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this};_proto.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z};_proto.getCenter=function(target){void 0===target&&(console.warn("THREE.Box3: .getCenter() target is now required"),target=new Vector3);return this.isEmpty()?target.set(0,0,0):target.addVectors(this.min,this.max).multiplyScalar(.5)};_proto.getSize=
function(target){void 0===target&&(console.warn("THREE.Box3: .getSize() target is now required"),target=new Vector3);return this.isEmpty()?target.set(0,0,0):target.subVectors(this.max,this.min)};_proto.expandByPoint=function(point){this.min.min(point);this.max.max(point);return this};_proto.expandByVector=function(vector){this.min.sub(vector);this.max.add(vector);return this};_proto.expandByScalar=function(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this};_proto.expandByObject=
function(object){object.updateWorldMatrix(!1,!1);var geometry=object.geometry;void 0!==geometry&&(null===geometry.boundingBox&&geometry.computeBoundingBox(),_box.copy(geometry.boundingBox),_box.applyMatrix4(object.matrixWorld),this.union(_box));object=object.children;geometry=0;for(var l=object.length;geometry<l;geometry++)this.expandByObject(object[geometry]);return this};_proto.containsPoint=function(point){return point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y||point.z<
this.min.z||point.z>this.max.z?!1:!0};_proto.containsBox=function(box){return this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&box.max.y<=this.max.y&&this.min.z<=box.min.z&&box.max.z<=this.max.z};_proto.getParameter=function(point,target){void 0===target&&(console.warn("THREE.Box3: .getParameter() target is now required"),target=new Vector3);return target.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y),(point.z-this.min.z)/(this.max.z-
this.min.z))};_proto.intersectsBox=function(box){return box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||box.min.y>this.max.y||box.max.z<this.min.z||box.min.z>this.max.z?!1:!0};_proto.intersectsSphere=function(sphere){this.clampPoint(sphere.center,_vector$1);return _vector$1.distanceToSquared(sphere.center)<=sphere.radius*sphere.radius};_proto.intersectsPlane=function(plane){if(0<plane.normal.x){var min=plane.normal.x*this.min.x;var max=plane.normal.x*this.max.x}else min=plane.normal.x*
this.max.x,max=plane.normal.x*this.min.x;0<plane.normal.y?(min+=plane.normal.y*this.min.y,max+=plane.normal.y*this.max.y):(min+=plane.normal.y*this.max.y,max+=plane.normal.y*this.min.y);0<plane.normal.z?(min+=plane.normal.z*this.min.z,max+=plane.normal.z*this.max.z):(min+=plane.normal.z*this.max.z,max+=plane.normal.z*this.min.z);return min<=-plane.constant&&max>=-plane.constant};_proto.intersectsTriangle=function(triangle){if(this.isEmpty())return!1;this.getCenter(_center);_extents.subVectors(this.max,
_center);_v0.subVectors(triangle.a,_center);_v1.subVectors(triangle.b,_center);_v2.subVectors(triangle.c,_center);_f0.subVectors(_v1,_v0);_f1.subVectors(_v2,_v1);_f2.subVectors(_v0,_v2);triangle=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];if(!satForAxes(triangle,_v0,_v1,_v2,_extents))return!1;triangle=[1,0,0,0,1,0,0,0,1];if(!satForAxes(triangle,_v0,_v1,_v2,_extents))return!1;_triangleNormal.crossVectors(_f0,
_f1);triangle=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z];return satForAxes(triangle,_v0,_v1,_v2,_extents)};_proto.clampPoint=function(point,target){void 0===target&&(console.warn("THREE.Box3: .clampPoint() target is now required"),target=new Vector3);return target.copy(point).clamp(this.min,this.max)};_proto.distanceToPoint=function(point){return _vector$1.copy(point).clamp(this.min,this.max).sub(point).length()};_proto.getBoundingSphere=function(target){void 0===target&&console.error("THREE.Box3: .getBoundingSphere() target is now required");
this.getCenter(target.center);target.radius=.5*this.getSize(_vector$1).length();return target};_proto.intersect=function(box){this.min.max(box.min);this.max.min(box.max);this.isEmpty()&&this.makeEmpty();return this};_proto.union=function(box){this.min.min(box.min);this.max.max(box.max);return this};_proto.applyMatrix4=function(matrix){if(this.isEmpty())return this;_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(matrix);_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(matrix);
_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(matrix);_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(matrix);_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(matrix);_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(matrix);_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(matrix);_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(matrix);this.setFromPoints(_points);return this};_proto.translate=function(offset){this.min.add(offset);
this.max.add(offset);return this};_proto.equals=function(box){return box.min.equals(this.min)&&box.max.equals(this.max)};return Box3}(),_points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$1=new Vector3,_box=new Box3,_v0=new Vector3,_v1=new Vector3,_v2=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3,_box$1=new Box3,Sphere=function(){function Sphere(center,
radius){this.center=void 0!==center?center:new Vector3;this.radius=void 0!==radius?radius:-1}var _proto=Sphere.prototype;_proto.set=function(center,radius){this.center.copy(center);this.radius=radius;return this};_proto.setFromPoints=function(points,optionalCenter){var center=this.center;void 0!==optionalCenter?center.copy(optionalCenter):_box$1.setFromPoints(points).getCenter(center);for(var i=optionalCenter=0,il=points.length;i<il;i++)optionalCenter=Math.max(optionalCenter,center.distanceToSquared(points[i]));
this.radius=Math.sqrt(optionalCenter);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(sphere){this.center.copy(sphere.center);this.radius=sphere.radius;return this};_proto.isEmpty=function(){return 0>this.radius};_proto.makeEmpty=function(){this.center.set(0,0,0);this.radius=-1;return this};_proto.containsPoint=function(point){return point.distanceToSquared(this.center)<=this.radius*this.radius};_proto.distanceToPoint=function(point){return point.distanceTo(this.center)-
this.radius};_proto.intersectsSphere=function(sphere){var radiusSum=this.radius+sphere.radius;return sphere.center.distanceToSquared(this.center)<=radiusSum*radiusSum};_proto.intersectsBox=function(box){return box.intersectsSphere(this)};_proto.intersectsPlane=function(plane){return Math.abs(plane.distanceToPoint(this.center))<=this.radius};_proto.clampPoint=function(point,target){var deltaLengthSq=this.center.distanceToSquared(point);void 0===target&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),
target=new Vector3);target.copy(point);deltaLengthSq>this.radius*this.radius&&(target.sub(this.center).normalize(),target.multiplyScalar(this.radius).add(this.center));return target};_proto.getBoundingBox=function(target){void 0===target&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),target=new Box3);if(this.isEmpty())return target.makeEmpty(),target;target.set(this.center,this.center);target.expandByScalar(this.radius);return target};_proto.applyMatrix4=function(matrix){this.center.applyMatrix4(matrix);
this.radius*=matrix.getMaxScaleOnAxis();return this};_proto.translate=function(offset){this.center.add(offset);return this};_proto.equals=function(sphere){return sphere.center.equals(this.center)&&sphere.radius===this.radius};return Sphere}(),_vector$2=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal=new Vector3,Ray=function(){function Ray(origin,direction){this.origin=void 0!==origin?origin:new Vector3;this.direction=void 0!==
direction?direction:new Vector3(0,0,-1)}var _proto=Ray.prototype;_proto.set=function(origin,direction){this.origin.copy(origin);this.direction.copy(direction);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(ray){this.origin.copy(ray.origin);this.direction.copy(ray.direction);return this};_proto.at=function(t,target){void 0===target&&(console.warn("THREE.Ray: .at() target is now required"),target=new Vector3);return target.copy(this.direction).multiplyScalar(t).add(this.origin)};
_proto.lookAt=function(v){this.direction.copy(v).sub(this.origin).normalize();return this};_proto.recast=function(t){this.origin.copy(this.at(t,_vector$2));return this};_proto.closestPointToPoint=function(point,target){void 0===target&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),target=new Vector3);target.subVectors(point,this.origin);point=target.dot(this.direction);return 0>point?target.copy(this.origin):target.copy(this.direction).multiplyScalar(point).add(this.origin)};
_proto.distanceToPoint=function(point){return Math.sqrt(this.distanceSqToPoint(point))};_proto.distanceSqToPoint=function(point){var directionDistance=_vector$2.subVectors(point,this.origin).dot(this.direction);if(0>directionDistance)return this.origin.distanceToSquared(point);_vector$2.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);return _vector$2.distanceToSquared(point)};_proto.distanceSqToSegment=function(v0,v1,optionalPointOnRay,optionalPointOnSegment){_segCenter.copy(v0).add(v1).multiplyScalar(.5);
_segDir.copy(v1).sub(v0).normalize();_diff.copy(this.origin).sub(_segCenter);var segExtent=.5*v0.distanceTo(v1),a01=-this.direction.dot(_segDir),b0=_diff.dot(this.direction),b1=-_diff.dot(_segDir),c=_diff.lengthSq(),det=Math.abs(1-a01*a01);if(0<det){v0=a01*b1-b0;v1=a01*b0-b1;var extDet=segExtent*det;0<=v0?v1>=-extDet?v1<=extDet?(segExtent=1/det,v0*=segExtent,v1*=segExtent,a01=v0*(v0+a01*v1+2*b0)+v1*(a01*v0+v1+2*b1)+c):(v1=segExtent,v0=Math.max(0,-(a01*v1+b0)),a01=-v0*v0+v1*(v1+2*b1)+c):(v1=-segExtent,
v0=Math.max(0,-(a01*v1+b0)),a01=-v0*v0+v1*(v1+2*b1)+c):v1<=-extDet?(v0=Math.max(0,-(-a01*segExtent+b0)),v1=0<v0?-segExtent:Math.min(Math.max(-segExtent,-b1),segExtent),a01=-v0*v0+v1*(v1+2*b1)+c):v1<=extDet?(v0=0,v1=Math.min(Math.max(-segExtent,-b1),segExtent),a01=v1*(v1+2*b1)+c):(v0=Math.max(0,-(a01*segExtent+b0)),v1=0<v0?segExtent:Math.min(Math.max(-segExtent,-b1),segExtent),a01=-v0*v0+v1*(v1+2*b1)+c)}else v1=0<a01?-segExtent:segExtent,v0=Math.max(0,-(a01*v1+b0)),a01=-v0*v0+v1*(v1+2*b1)+c;optionalPointOnRay&&
optionalPointOnRay.copy(this.direction).multiplyScalar(v0).add(this.origin);optionalPointOnSegment&&optionalPointOnSegment.copy(_segDir).multiplyScalar(v1).add(_segCenter);return a01};_proto.intersectSphere=function(sphere,target){_vector$2.subVectors(sphere.center,this.origin);var tca=_vector$2.dot(this.direction),d2=_vector$2.dot(_vector$2)-tca*tca;sphere=sphere.radius*sphere.radius;if(d2>sphere)return null;sphere=Math.sqrt(sphere-d2);d2=tca-sphere;tca+=sphere;return 0>d2&&0>tca?null:0>d2?this.at(tca,
target):this.at(d2,target)};_proto.intersectsSphere=function(sphere){return this.distanceSqToPoint(sphere.center)<=sphere.radius*sphere.radius};_proto.distanceToPlane=function(plane){var denominator=plane.normal.dot(this.direction);if(0===denominator)return 0===plane.distanceToPoint(this.origin)?0:null;plane=-(this.origin.dot(plane.normal)+plane.constant)/denominator;return 0<=plane?plane:null};_proto.intersectPlane=function(plane,target){plane=this.distanceToPlane(plane);return null===plane?null:
this.at(plane,target)};_proto.intersectsPlane=function(plane){var distToPoint=plane.distanceToPoint(this.origin);return 0===distToPoint||0>plane.normal.dot(this.direction)*distToPoint?!0:!1};_proto.intersectBox=function(box,target){var tmax=1/this.direction.x;var tymax=1/this.direction.y;var invdirz=1/this.direction.z,origin=this.origin;if(0<=tmax){var tmin=(box.min.x-origin.x)*tmax;tmax*=box.max.x-origin.x}else tmin=(box.max.x-origin.x)*tmax,tmax*=box.min.x-origin.x;if(0<=tymax){var tymin=(box.min.y-
origin.y)*tymax;tymax*=box.max.y-origin.y}else tymin=(box.max.y-origin.y)*tymax,tymax*=box.min.y-origin.y;if(tmin>tymax||tymin>tmax)return null;if(tymin>tmin||tmin!==tmin)tmin=tymin;if(tymax<tmax||tmax!==tmax)tmax=tymax;0<=invdirz?(tymin=(box.min.z-origin.z)*invdirz,box=(box.max.z-origin.z)*invdirz):(tymin=(box.max.z-origin.z)*invdirz,box=(box.min.z-origin.z)*invdirz);if(tmin>box||tymin>tmax)return null;if(tymin>tmin||tmin!==tmin)tmin=tymin;if(box<tmax||tmax!==tmax)tmax=box;return 0>tmax?null:this.at(0<=
tmin?tmin:tmax,target)};_proto.intersectsBox=function(box){return null!==this.intersectBox(box,_vector$2)};_proto.intersectTriangle=function(a,b,c,backfaceCulling,target){_edge1.subVectors(b,a);_edge2.subVectors(c,a);_normal.crossVectors(_edge1,_edge2);b=this.direction.dot(_normal);if(0<b){if(backfaceCulling)return null;backfaceCulling=1}else if(0>b)backfaceCulling=-1,b=-b;else return null;_diff.subVectors(this.origin,a);a=backfaceCulling*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(0>
a)return null;c=backfaceCulling*this.direction.dot(_edge1.cross(_diff));if(0>c||a+c>b)return null;a=-backfaceCulling*_diff.dot(_normal);return 0>a?null:this.at(a/b,target)};_proto.applyMatrix4=function(matrix4){this.origin.applyMatrix4(matrix4);this.direction.transformDirection(matrix4);return this};_proto.equals=function(ray){return ray.origin.equals(this.origin)&&ray.direction.equals(this.direction)};return Ray}(),Matrix4=function(){function Matrix4(){Object.defineProperty(this,"isMatrix4",{value:!0});
this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var _proto=Matrix4.prototype;_proto.set=function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this.elements;te[0]=n11;te[4]=n12;te[8]=n13;te[12]=n14;te[1]=n21;te[5]=n22;te[9]=n23;te[13]=n24;te[2]=n31;te[6]=n32;te[10]=n33;te[14]=n34;te[3]=n41;te[7]=n42;te[11]=n43;te[15]=n44;return this};_proto.identity=function(){this.set(1,
0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this};_proto.clone=function(){return(new Matrix4).fromArray(this.elements)};_proto.copy=function(m){var te=this.elements;m=m.elements;te[0]=m[0];te[1]=m[1];te[2]=m[2];te[3]=m[3];te[4]=m[4];te[5]=m[5];te[6]=m[6];te[7]=m[7];te[8]=m[8];te[9]=m[9];te[10]=m[10];te[11]=m[11];te[12]=m[12];te[13]=m[13];te[14]=m[14];te[15]=m[15];return this};_proto.copyPosition=function(m){var te=this.elements;m=m.elements;te[12]=m[12];te[13]=m[13];te[14]=m[14];return this};_proto.extractBasis=
function(xAxis,yAxis,zAxis){xAxis.setFromMatrixColumn(this,0);yAxis.setFromMatrixColumn(this,1);zAxis.setFromMatrixColumn(this,2);return this};_proto.makeBasis=function(xAxis,yAxis,zAxis){this.set(xAxis.x,yAxis.x,zAxis.x,0,xAxis.y,yAxis.y,zAxis.y,0,xAxis.z,yAxis.z,zAxis.z,0,0,0,0,1);return this};_proto.extractRotation=function(m){var te=this.elements,me=m.elements,scaleX=1/_v1$1.setFromMatrixColumn(m,0).length(),scaleY=1/_v1$1.setFromMatrixColumn(m,1).length();m=1/_v1$1.setFromMatrixColumn(m,2).length();
te[0]=me[0]*scaleX;te[1]=me[1]*scaleX;te[2]=me[2]*scaleX;te[3]=0;te[4]=me[4]*scaleY;te[5]=me[5]*scaleY;te[6]=me[6]*scaleY;te[7]=0;te[8]=me[8]*m;te[9]=me[9]*m;te[10]=me[10]*m;te[11]=0;te[12]=0;te[13]=0;te[14]=0;te[15]=1;return this};_proto.makeRotationFromEuler=function(euler){euler&&euler.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var te=this.elements,x=euler.x,y=euler.y,z=euler.z,a=Math.cos(x);x=Math.sin(x);var c=
Math.cos(y);y=Math.sin(y);var e=Math.cos(z);z=Math.sin(z);if("XYZ"===euler.order){euler=a*e;var af=a*z,be=x*e,bf=x*z;te[0]=c*e;te[4]=-c*z;te[8]=y;te[1]=af+be*y;te[5]=euler-bf*y;te[9]=-x*c;te[2]=bf-euler*y;te[6]=be+af*y;te[10]=a*c}else"YXZ"===euler.order?(euler=c*e,af=c*z,be=y*e,bf=y*z,te[0]=euler+bf*x,te[4]=be*x-af,te[8]=a*y,te[1]=a*z,te[5]=a*e,te[9]=-x,te[2]=af*x-be,te[6]=bf+euler*x,te[10]=a*c):"ZXY"===euler.order?(euler=c*e,af=c*z,be=y*e,bf=y*z,te[0]=euler-bf*x,te[4]=-a*z,te[8]=be+af*x,te[1]=af+
be*x,te[5]=a*e,te[9]=bf-euler*x,te[2]=-a*y,te[6]=x,te[10]=a*c):"ZYX"===euler.order?(euler=a*e,af=a*z,be=x*e,bf=x*z,te[0]=c*e,te[4]=be*y-af,te[8]=euler*y+bf,te[1]=c*z,te[5]=bf*y+euler,te[9]=af*y-be,te[2]=-y,te[6]=x*c,te[10]=a*c):"YZX"===euler.order?(euler=a*c,af=a*y,be=x*c,bf=x*y,te[0]=c*e,te[4]=bf-euler*z,te[8]=be*z+af,te[1]=z,te[5]=a*e,te[9]=-x*e,te[2]=-y*e,te[6]=af*z+be,te[10]=euler-bf*z):"XZY"===euler.order&&(euler=a*c,af=a*y,be=x*c,bf=x*y,te[0]=c*e,te[4]=-z,te[8]=y*e,te[1]=euler*z+bf,te[5]=a*
e,te[9]=af*z-be,te[2]=be*z-af,te[6]=x*e,te[10]=bf*z+euler);te[3]=0;te[7]=0;te[11]=0;te[12]=0;te[13]=0;te[14]=0;te[15]=1;return this};_proto.makeRotationFromQuaternion=function(q){return this.compose(_zero,q,_one)};_proto.lookAt=function(eye,target,up){var te=this.elements;_z.subVectors(eye,target);0===_z.lengthSq()&&(_z.z=1);_z.normalize();_x$jscomp$0.crossVectors(up,_z);0===_x$jscomp$0.lengthSq()&&(1===Math.abs(up.z)?_z.x+=1E-4:_z.z+=1E-4,_z.normalize(),_x$jscomp$0.crossVectors(up,_z));_x$jscomp$0.normalize();
_y.crossVectors(_z,_x$jscomp$0);te[0]=_x$jscomp$0.x;te[4]=_y.x;te[8]=_z.x;te[1]=_x$jscomp$0.y;te[5]=_y.y;te[9]=_z.y;te[2]=_x$jscomp$0.z;te[6]=_y.z;te[10]=_z.z;return this};_proto.multiply=function(m,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(m,n)):this.multiplyMatrices(this,m)};_proto.premultiply=function(m){return this.multiplyMatrices(m,this)};_proto.multiplyMatrices=function(a,b){var ae=
a.elements,be=b.elements;b=this.elements;a=ae[0];var a12=ae[4],a13=ae[8],a14=ae[12],a21=ae[1],a22=ae[5],a23=ae[9],a24=ae[13],a31=ae[2],a32=ae[6],a33=ae[10],a34=ae[14],a41=ae[3],a42=ae[7],a43=ae[11];ae=ae[15];var b11=be[0],b12=be[4],b13=be[8],b14=be[12],b21=be[1],b22=be[5],b23=be[9],b24=be[13],b31=be[2],b32=be[6],b33=be[10],b34=be[14],b41=be[3],b42=be[7],b43=be[11];be=be[15];b[0]=a*b11+a12*b21+a13*b31+a14*b41;b[4]=a*b12+a12*b22+a13*b32+a14*b42;b[8]=a*b13+a12*b23+a13*b33+a14*b43;b[12]=a*b14+a12*b24+
a13*b34+a14*be;b[1]=a21*b11+a22*b21+a23*b31+a24*b41;b[5]=a21*b12+a22*b22+a23*b32+a24*b42;b[9]=a21*b13+a22*b23+a23*b33+a24*b43;b[13]=a21*b14+a22*b24+a23*b34+a24*be;b[2]=a31*b11+a32*b21+a33*b31+a34*b41;b[6]=a31*b12+a32*b22+a33*b32+a34*b42;b[10]=a31*b13+a32*b23+a33*b33+a34*b43;b[14]=a31*b14+a32*b24+a33*b34+a34*be;b[3]=a41*b11+a42*b21+a43*b31+ae*b41;b[7]=a41*b12+a42*b22+a43*b32+ae*b42;b[11]=a41*b13+a42*b23+a43*b33+ae*b43;b[15]=a41*b14+a42*b24+a43*b34+ae*be;return this};_proto.multiplyScalar=function(s){var te=
this.elements;te[0]*=s;te[4]*=s;te[8]*=s;te[12]*=s;te[1]*=s;te[5]*=s;te[9]*=s;te[13]*=s;te[2]*=s;te[6]*=s;te[10]*=s;te[14]*=s;te[3]*=s;te[7]*=s;te[11]*=s;te[15]*=s;return this};_proto.determinant=function(){var te=this.elements,n11=te[0],n12=te[4],n13=te[8],n14=te[12],n21=te[1],n22=te[5],n23=te[9],n24=te[13],n31=te[2],n32=te[6],n33=te[10],n34=te[14];return te[3]*(+n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34)+te[7]*(+n11*n23*n34-n11*n24*n33+n14*n21*n33-n13*n21*n34+n13*n24*
n31-n14*n23*n31)+te[11]*(+n11*n24*n32-n11*n22*n34-n14*n21*n32+n12*n21*n34+n14*n22*n31-n12*n24*n31)+te[15]*(-n13*n22*n31-n11*n23*n32+n11*n22*n33+n13*n21*n32-n12*n21*n33+n12*n23*n31)};_proto.transpose=function(){var te=this.elements;var tmp=te[1];te[1]=te[4];te[4]=tmp;tmp=te[2];te[2]=te[8];te[8]=tmp;tmp=te[6];te[6]=te[9];te[9]=tmp;tmp=te[3];te[3]=te[12];te[12]=tmp;tmp=te[7];te[7]=te[13];te[13]=tmp;tmp=te[11];te[11]=te[14];te[14]=tmp;return this};_proto.setPosition=function(x,y,z){var te=this.elements;
x.isVector3?(te[12]=x.x,te[13]=x.y,te[14]=x.z):(te[12]=x,te[13]=y,te[14]=z);return this};_proto.invert=function(){var te=this.elements,n11=te[0],n21=te[1],n31=te[2],n41=te[3],n12=te[4],n22=te[5],n32=te[6],n42=te[7],n13=te[8],n23=te[9],n33=te[10],n43=te[11],n14=te[12],n24=te[13],n34=te[14],n44=te[15],t11=n23*n34*n42-n24*n33*n42+n24*n32*n43-n22*n34*n43-n23*n32*n44+n22*n33*n44,t12=n14*n33*n42-n13*n34*n42-n14*n32*n43+n12*n34*n43+n13*n32*n44-n12*n33*n44,t13=n13*n24*n42-n14*n23*n42+n14*n22*n43-n12*n24*
n43-n13*n22*n44+n12*n23*n44,t14=n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34,det=n11*t11+n21*t12+n31*t13+n41*t14;if(0===det)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);det=1/det;te[0]=t11*det;te[1]=(n24*n33*n41-n23*n34*n41-n24*n31*n43+n21*n34*n43+n23*n31*n44-n21*n33*n44)*det;te[2]=(n22*n34*n41-n24*n32*n41+n24*n31*n42-n21*n34*n42-n22*n31*n44+n21*n32*n44)*det;te[3]=(n23*n32*n41-n22*n33*n41-n23*n31*n42+n21*n33*n42+n22*n31*n43-n21*n32*n43)*det;te[4]=t12*det;te[5]=(n13*
n34*n41-n14*n33*n41+n14*n31*n43-n11*n34*n43-n13*n31*n44+n11*n33*n44)*det;te[6]=(n14*n32*n41-n12*n34*n41-n14*n31*n42+n11*n34*n42+n12*n31*n44-n11*n32*n44)*det;te[7]=(n12*n33*n41-n13*n32*n41+n13*n31*n42-n11*n33*n42-n12*n31*n43+n11*n32*n43)*det;te[8]=t13*det;te[9]=(n14*n23*n41-n13*n24*n41-n14*n21*n43+n11*n24*n43+n13*n21*n44-n11*n23*n44)*det;te[10]=(n12*n24*n41-n14*n22*n41+n14*n21*n42-n11*n24*n42-n12*n21*n44+n11*n22*n44)*det;te[11]=(n13*n22*n41-n12*n23*n41-n13*n21*n42+n11*n23*n42+n12*n21*n43-n11*n22*n43)*
det;te[12]=t14*det;te[13]=(n13*n24*n31-n14*n23*n31+n14*n21*n33-n11*n24*n33-n13*n21*n34+n11*n23*n34)*det;te[14]=(n14*n22*n31-n12*n24*n31-n14*n21*n32+n11*n24*n32+n12*n21*n34-n11*n22*n34)*det;te[15]=(n12*n23*n31-n13*n22*n31+n13*n21*n32-n11*n23*n32-n12*n21*n33+n11*n22*n33)*det;return this};_proto.scale=function(v){var te=this.elements,x=v.x,y=v.y;v=v.z;te[0]*=x;te[4]*=y;te[8]*=v;te[1]*=x;te[5]*=y;te[9]*=v;te[2]*=x;te[6]*=y;te[10]*=v;te[3]*=x;te[7]*=y;te[11]*=v;return this};_proto.getMaxScaleOnAxis=function(){var te=
this.elements;return Math.sqrt(Math.max(te[0]*te[0]+te[1]*te[1]+te[2]*te[2],te[4]*te[4]+te[5]*te[5]+te[6]*te[6],te[8]*te[8]+te[9]*te[9]+te[10]*te[10]))};_proto.makeTranslation=function(x,y,z){this.set(1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1);return this};_proto.makeRotationX=function(theta){var c=Math.cos(theta);theta=Math.sin(theta);this.set(1,0,0,0,0,c,-theta,0,0,theta,c,0,0,0,0,1);return this};_proto.makeRotationY=function(theta){var c=Math.cos(theta);theta=Math.sin(theta);this.set(c,0,theta,0,0,1,0,0,
-theta,0,c,0,0,0,0,1);return this};_proto.makeRotationZ=function(theta){var c=Math.cos(theta);theta=Math.sin(theta);this.set(c,-theta,0,0,theta,c,0,0,0,0,1,0,0,0,0,1);return this};_proto.makeRotationAxis=function(axis,angle){var c=Math.cos(angle);angle=Math.sin(angle);var t=1-c,x=axis.x,y=axis.y;axis=axis.z;var tx=t*x,ty=t*y;this.set(tx*x+c,tx*y-angle*axis,tx*axis+angle*y,0,tx*y+angle*axis,ty*y+c,ty*axis-angle*x,0,tx*axis-angle*y,ty*axis+angle*x,t*axis*axis+c,0,0,0,0,1);return this};_proto.makeScale=
function(x,y,z){this.set(x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1);return this};_proto.makeShear=function(x,y,z){this.set(1,y,z,0,x,1,z,0,x,y,1,0,0,0,0,1);return this};_proto.compose=function(position,quaternion,scale){var te=this.elements,x=quaternion._x,y=quaternion._y,z=quaternion._z,w=quaternion._w,x2=x+x,y2=y+y,z2=z+z;quaternion=x*x2;var xy=x*y2;x*=z2;var yy=y*y2;y*=z2;z*=z2;x2*=w;y2*=w;w*=z2;z2=scale.x;var sy=scale.y;scale=scale.z;te[0]=(1-(yy+z))*z2;te[1]=(xy+w)*z2;te[2]=(x-y2)*z2;te[3]=0;te[4]=(xy-
w)*sy;te[5]=(1-(quaternion+z))*sy;te[6]=(y+x2)*sy;te[7]=0;te[8]=(x+y2)*scale;te[9]=(y-x2)*scale;te[10]=(1-(quaternion+yy))*scale;te[11]=0;te[12]=position.x;te[13]=position.y;te[14]=position.z;te[15]=1;return this};_proto.decompose=function(position,quaternion,scale){var te=this.elements,sx=_v1$1.set(te[0],te[1],te[2]).length(),sy=_v1$1.set(te[4],te[5],te[6]).length(),sz=_v1$1.set(te[8],te[9],te[10]).length();0>this.determinant()&&(sx=-sx);position.x=te[12];position.y=te[13];position.z=te[14];_m1.copy(this);
position=1/sx;te=1/sy;var invSZ=1/sz;_m1.elements[0]*=position;_m1.elements[1]*=position;_m1.elements[2]*=position;_m1.elements[4]*=te;_m1.elements[5]*=te;_m1.elements[6]*=te;_m1.elements[8]*=invSZ;_m1.elements[9]*=invSZ;_m1.elements[10]*=invSZ;quaternion.setFromRotationMatrix(_m1);scale.x=sx;scale.y=sy;scale.z=sz;return this};_proto.makePerspective=function(left,right,top,bottom,near,far){void 0===far&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var te=this.elements;te[0]=2*near/(right-left);te[4]=0;te[8]=(right+left)/(right-left);te[12]=0;te[1]=0;te[5]=2*near/(top-bottom);te[9]=(top+bottom)/(top-bottom);te[13]=0;te[2]=0;te[6]=0;te[10]=-(far+near)/(far-near);te[14]=-2*far*near/(far-near);te[3]=0;te[7]=0;te[11]=-1;te[15]=0;return this};_proto.makeOrthographic=function(left,right,top,bottom,near,far){var te=this.elements,w=1/(right-left),h=1/(top-bottom),p=1/(far-near);te[0]=2*w;te[4]=0;te[8]=0;te[12]=-((right+left)*w);te[1]=0;te[5]=2*h;te[9]=
0;te[13]=-((top+bottom)*h);te[2]=0;te[6]=0;te[10]=-2*p;te[14]=-((far+near)*p);te[3]=0;te[7]=0;te[11]=0;te[15]=1;return this};_proto.equals=function(matrix){var te=this.elements;matrix=matrix.elements;for(var i=0;16>i;i++)if(te[i]!==matrix[i])return!1;return!0};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);for(var i=0;16>i;i++)this.elements[i]=array[i+offset];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);var te=this.elements;
array[offset]=te[0];array[offset+1]=te[1];array[offset+2]=te[2];array[offset+3]=te[3];array[offset+4]=te[4];array[offset+5]=te[5];array[offset+6]=te[6];array[offset+7]=te[7];array[offset+8]=te[8];array[offset+9]=te[9];array[offset+10]=te[10];array[offset+11]=te[11];array[offset+12]=te[12];array[offset+13]=te[13];array[offset+14]=te[14];array[offset+15]=te[15];return array};return Matrix4}(),_v1$1=new Vector3,_m1=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x$jscomp$0=new Vector3,
_y=new Vector3,_z=new Vector3,Euler=function(){function Euler(x,y,z,order){void 0===x&&(x=0);void 0===y&&(y=0);void 0===z&&(z=0);void 0===order&&(order=Euler.DefaultOrder);Object.defineProperty(this,"isEuler",{value:!0});this._x=x;this._y=y;this._z=z;this._order=order}var _proto=Euler.prototype;_proto.set=function(x,y,z,order){this._x=x;this._y=y;this._z=z;this._order=order||this._order;this._onChangeCallback();return this};_proto.clone=function(){return new this.constructor(this._x,this._y,this._z,
this._order)};_proto.copy=function(euler){this._x=euler._x;this._y=euler._y;this._z=euler._z;this._order=euler._order;this._onChangeCallback();return this};_proto.setFromRotationMatrix=function(m,order,update){var clamp=MathUtils.clamp,te=m.elements;m=te[0];var m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6];te=te[10];order=order||this._order;switch(order){case "XYZ":this._y=Math.asin(clamp(m13,-1,1));.9999999>Math.abs(m13)?(this._x=Math.atan2(-m23,te),this._z=Math.atan2(-m12,
m)):(this._x=Math.atan2(m32,m22),this._z=0);break;case "YXZ":this._x=Math.asin(-clamp(m23,-1,1));.9999999>Math.abs(m23)?(this._y=Math.atan2(m13,te),this._z=Math.atan2(m21,m22)):(this._y=Math.atan2(-m31,m),this._z=0);break;case "ZXY":this._x=Math.asin(clamp(m32,-1,1));.9999999>Math.abs(m32)?(this._y=Math.atan2(-m31,te),this._z=Math.atan2(-m12,m22)):(this._y=0,this._z=Math.atan2(m21,m));break;case "ZYX":this._y=Math.asin(-clamp(m31,-1,1));.9999999>Math.abs(m31)?(this._x=Math.atan2(m32,te),this._z=Math.atan2(m21,
m)):(this._x=0,this._z=Math.atan2(-m12,m22));break;case "YZX":this._z=Math.asin(clamp(m21,-1,1));.9999999>Math.abs(m21)?(this._x=Math.atan2(-m23,m22),this._y=Math.atan2(-m31,m)):(this._x=0,this._y=Math.atan2(m13,te));break;case "XZY":this._z=Math.asin(-clamp(m12,-1,1));.9999999>Math.abs(m12)?(this._x=Math.atan2(m32,m22),this._y=Math.atan2(m13,m)):(this._x=Math.atan2(-m23,te),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+order)}this._order=
order;!1!==update&&this._onChangeCallback();return this};_proto.setFromQuaternion=function(q,order,update){_matrix.makeRotationFromQuaternion(q);return this.setFromRotationMatrix(_matrix,order,update)};_proto.setFromVector3=function(v,order){return this.set(v.x,v.y,v.z,order||this._order)};_proto.reorder=function(newOrder){_quaternion$1.setFromEuler(this);return this.setFromQuaternion(_quaternion$1,newOrder)};_proto.equals=function(euler){return euler._x===this._x&&euler._y===this._y&&euler._z===
this._z&&euler._order===this._order};_proto.fromArray=function(array){this._x=array[0];this._y=array[1];this._z=array[2];void 0!==array[3]&&(this._order=array[3]);this._onChangeCallback();return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);array[offset]=this._x;array[offset+1]=this._y;array[offset+2]=this._z;array[offset+3]=this._order;return array};_proto.toVector3=function(optionalResult){return optionalResult?optionalResult.set(this._x,this._y,
this._z):new Vector3(this._x,this._y,this._z)};_proto._onChange=function(callback){this._onChangeCallback=callback;return this};_proto._onChangeCallback=function(){};_createClass(Euler,[{key:"x",get:function(){return this._x},set:function(value){this._x=value;this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(value){this._y=value;this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(value){this._z=value;this._onChangeCallback()}},{key:"order",
get:function(){return this._order},set:function(value){this._order=value;this._onChangeCallback()}}]);return Euler}();Euler.DefaultOrder="XYZ";Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");var _matrix=new Matrix4,_quaternion$1=new Quaternion,Layers=function(){function Layers(){this.mask=1}var _proto=Layers.prototype;_proto.set=function(channel){this.mask=1<<channel|0};_proto.enable=function(channel){this.mask=this.mask|1<<channel|0};_proto.enableAll=function(){this.mask=-1};_proto.toggle=
function(channel){this.mask^=1<<channel|0};_proto.disable=function(channel){this.mask&=~(1<<channel|0)};_proto.disableAll=function(){this.mask=0};_proto.test=function(layers){return 0!==(this.mask&layers.mask)};return Layers}(),_object3DId=0,_v1$2=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position=new Vector3,_scale=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent=
{type:"removed"};Object3D.DefaultUp=new Vector3(0,1,0);Object3D.DefaultMatrixAutoUpdate=!0;Object3D.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Object3D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(matrix){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(q){this.quaternion.premultiply(q);return this},setRotationFromAxisAngle:function(axis,
angle){this.quaternion.setFromAxisAngle(axis,angle)},setRotationFromEuler:function(euler){this.quaternion.setFromEuler(euler,!0)},setRotationFromMatrix:function(m){this.quaternion.setFromRotationMatrix(m)},setRotationFromQuaternion:function(q){this.quaternion.copy(q)},rotateOnAxis:function(axis,angle){_q1.setFromAxisAngle(axis,angle);this.quaternion.multiply(_q1);return this},rotateOnWorldAxis:function(axis,angle){_q1.setFromAxisAngle(axis,angle);this.quaternion.premultiply(_q1);return this},rotateX:function(angle){return this.rotateOnAxis(_xAxis,
angle)},rotateY:function(angle){return this.rotateOnAxis(_yAxis,angle)},rotateZ:function(angle){return this.rotateOnAxis(_zAxis,angle)},translateOnAxis:function(axis,distance){_v1$2.copy(axis).applyQuaternion(this.quaternion);this.position.add(_v1$2.multiplyScalar(distance));return this},translateX:function(distance){return this.translateOnAxis(_xAxis,distance)},translateY:function(distance){return this.translateOnAxis(_yAxis,distance)},translateZ:function(distance){return this.translateOnAxis(_zAxis,
distance)},localToWorld:function(vector){return vector.applyMatrix4(this.matrixWorld)},worldToLocal:function(vector){return vector.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())},lookAt:function(x,y,z){x.isVector3?_target.copy(x):_target.set(x,y,z);x=this.parent;this.updateWorldMatrix(!0,!1);_position.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?_m1$1.lookAt(_position,_target,this.up):_m1$1.lookAt(_target,_position,this.up);this.quaternion.setFromRotationMatrix(_m1$1);
x&&(_m1$1.extractRotation(x.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))},add:function(object){if(1<arguments.length){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}if(object===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",object),this;object&&object.isObject3D?(null!==object.parent&&object.parent.remove(object),object.parent=this,this.children.push(object),object.dispatchEvent(_addedEvent)):
console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",object);return this},remove:function(object){if(1<arguments.length){for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}i=this.children.indexOf(object);-1!==i&&(object.parent=null,this.children.splice(i,1),object.dispatchEvent(_removedEvent));return this},clear:function(){for(var i=0;i<this.children.length;i++){var object=this.children[i];object.parent=null;object.dispatchEvent(_removedEvent)}this.children.length=
0;return this},attach:function(object){this.updateWorldMatrix(!0,!1);_m1$1.copy(this.matrixWorld).invert();null!==object.parent&&(object.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(object.parent.matrixWorld));object.applyMatrix4(_m1$1);object.updateWorldMatrix(!1,!1);this.add(object);return this},getObjectById:function(id){return this.getObjectByProperty("id",id)},getObjectByName:function(name){return this.getObjectByProperty("name",name)},getObjectByProperty:function(name,value){if(this[name]===
value)return this;for(var i=0,l=this.children.length;i<l;i++){var object=this.children[i].getObjectByProperty(name,value);if(void 0!==object)return object}},getWorldPosition:function(target){void 0===target&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),target=new Vector3);this.updateWorldMatrix(!0,!1);return target.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(target){void 0===target&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),
target=new Quaternion);this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(_position,target,_scale);return target},getWorldScale:function(target){void 0===target&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),target=new Vector3);this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(_position,_quaternion$2,target);return target},getWorldDirection:function(target){void 0===target&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),target=
new Vector3);this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return target.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(callback){callback(this);for(var children=this.children,i=0,l=children.length;i<l;i++)children[i].traverse(callback)},traverseVisible:function(callback){if(!1!==this.visible){callback(this);for(var children=this.children,i=0,l=children.length;i<l;i++)children[i].traverseVisible(callback)}},traverseAncestors:function(callback){var parent=
this.parent;null!==parent&&(callback(parent),parent.traverseAncestors(callback))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(force){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||force)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,force=!0;for(var children=this.children,
i=0,l=children.length;i<l;i++)children[i].updateMatrixWorld(force)},updateWorldMatrix:function(updateParents,updateChildren){var parent=this.parent;!0===updateParents&&null!==parent&&parent.updateWorldMatrix(!0,!1);this.matrixAutoUpdate&&this.updateMatrix();null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);if(!0===updateChildren)for(updateParents=this.children,updateChildren=0,parent=updateParents.length;updateChildren<parent;updateChildren++)updateParents[updateChildren].updateWorldMatrix(!1,
!0)},toJSON:function(meta){function serialize(library,element){void 0===library[element.uuid]&&(library[element.uuid]=element.toJSON(meta));return element.uuid}function extractFromCache(cache){var values=[],key;for(key in cache){var data=cache[key];delete data.metadata;values.push(data)}return values}var isRootObject=void 0===meta||"string"===typeof meta,output={};isRootObject&&(meta={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},output.metadata={version:4.5,
type:"Object",generator:"Object3D.toJSON"});var object={};object.uuid=this.uuid;object.type=this.type;""!==this.name&&(object.name=this.name);!0===this.castShadow&&(object.castShadow=!0);!0===this.receiveShadow&&(object.receiveShadow=!0);!1===this.visible&&(object.visible=!1);!1===this.frustumCulled&&(object.frustumCulled=!1);0!==this.renderOrder&&(object.renderOrder=this.renderOrder);"{}"!==JSON.stringify(this.userData)&&(object.userData=this.userData);object.layers=this.layers.mask;object.matrix=
this.matrix.toArray();!1===this.matrixAutoUpdate&&(object.matrixAutoUpdate=!1);this.isInstancedMesh&&(object.type="InstancedMesh",object.count=this.count,object.instanceMatrix=this.instanceMatrix.toJSON());if(this.isMesh||this.isLine||this.isPoints){object.geometry=serialize(meta.geometries,this.geometry);var parameters=this.geometry.parameters;if(void 0!==parameters&&void 0!==parameters.shapes)if(parameters=parameters.shapes,Array.isArray(parameters))for(var i=0,l=parameters.length;i<l;i++)serialize(meta.shapes,
parameters[i]);else serialize(meta.shapes,parameters)}this.isSkinnedMesh&&(object.bindMode=this.bindMode,object.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(serialize(meta.skeletons,this.skeleton),object.skeleton=this.skeleton.uuid));if(void 0!==this.material)if(Array.isArray(this.material)){parameters=[];i=0;for(l=this.material.length;i<l;i++)parameters.push(serialize(meta.materials,this.material[i]));object.material=parameters}else object.material=serialize(meta.materials,this.material);
if(0<this.children.length)for(object.children=[],parameters=0;parameters<this.children.length;parameters++)object.children.push(this.children[parameters].toJSON(meta).object);if(0<this.animations.length)for(object.animations=[],parameters=0;parameters<this.animations.length;parameters++)object.animations.push(serialize(meta.animations,this.animations[parameters]));if(isRootObject){isRootObject=extractFromCache(meta.geometries);parameters=extractFromCache(meta.materials);i=extractFromCache(meta.textures);
l=extractFromCache(meta.images);var _shapes=extractFromCache(meta.shapes),skeletons=extractFromCache(meta.skeletons),animations=extractFromCache(meta.animations);0<isRootObject.length&&(output.geometries=isRootObject);0<parameters.length&&(output.materials=parameters);0<i.length&&(output.textures=i);0<l.length&&(output.images=l);0<_shapes.length&&(output.shapes=_shapes);0<skeletons.length&&(output.skeletons=skeletons);0<animations.length&&(output.animations=animations)}output.object=object;return output},
clone:function(recursive){return(new this.constructor).copy(this,recursive)},copy:function(source,recursive){void 0===recursive&&(recursive=!0);this.name=source.name;this.up.copy(source.up);this.position.copy(source.position);this.rotation.order=source.rotation.order;this.quaternion.copy(source.quaternion);this.scale.copy(source.scale);this.matrix.copy(source.matrix);this.matrixWorld.copy(source.matrixWorld);this.matrixAutoUpdate=source.matrixAutoUpdate;this.matrixWorldNeedsUpdate=source.matrixWorldNeedsUpdate;
this.layers.mask=source.layers.mask;this.visible=source.visible;this.castShadow=source.castShadow;this.receiveShadow=source.receiveShadow;this.frustumCulled=source.frustumCulled;this.renderOrder=source.renderOrder;this.userData=JSON.parse(JSON.stringify(source.userData));if(!0===recursive)for(recursive=0;recursive<source.children.length;recursive++)this.add(source.children[recursive].clone());return this}});var _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3,Plane=function(){function Plane(normal,
constant){Object.defineProperty(this,"isPlane",{value:!0});this.normal=void 0!==normal?normal:new Vector3(1,0,0);this.constant=void 0!==constant?constant:0}var _proto=Plane.prototype;_proto.set=function(normal,constant){this.normal.copy(normal);this.constant=constant;return this};_proto.setComponents=function(x,y,z,w){this.normal.set(x,y,z);this.constant=w;return this};_proto.setFromNormalAndCoplanarPoint=function(normal,point){this.normal.copy(normal);this.constant=-point.dot(this.normal);return this};
_proto.setFromCoplanarPoints=function(a,b,c){b=_vector1.subVectors(c,b).cross(_vector2.subVectors(a,b)).normalize();this.setFromNormalAndCoplanarPoint(b,a);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(plane){this.normal.copy(plane.normal);this.constant=plane.constant;return this};_proto.normalize=function(){var inverseNormalLength=1/this.normal.length();this.normal.multiplyScalar(inverseNormalLength);this.constant*=inverseNormalLength;return this};
_proto.negate=function(){this.constant*=-1;this.normal.negate();return this};_proto.distanceToPoint=function(point){return this.normal.dot(point)+this.constant};_proto.distanceToSphere=function(sphere){return this.distanceToPoint(sphere.center)-sphere.radius};_proto.projectPoint=function(point,target){void 0===target&&(console.warn("THREE.Plane: .projectPoint() target is now required"),target=new Vector3);return target.copy(this.normal).multiplyScalar(-this.distanceToPoint(point)).add(point)};_proto.intersectLine=
function(line,target){void 0===target&&(console.warn("THREE.Plane: .intersectLine() target is now required"),target=new Vector3);var direction=line.delta(_vector1),denominator=this.normal.dot(direction);if(0===denominator){if(0===this.distanceToPoint(line.start))return target.copy(line.start)}else if(denominator=-(line.start.dot(this.normal)+this.constant)/denominator,!(0>denominator||1<denominator))return target.copy(direction).multiplyScalar(denominator).add(line.start)};_proto.intersectsLine=function(line){var startSign=
this.distanceToPoint(line.start);line=this.distanceToPoint(line.end);return 0>startSign&&0<line||0>line&&0<startSign};_proto.intersectsBox=function(box){return box.intersectsPlane(this)};_proto.intersectsSphere=function(sphere){return sphere.intersectsPlane(this)};_proto.coplanarPoint=function(target){void 0===target&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),target=new Vector3);return target.copy(this.normal).multiplyScalar(-this.constant)};_proto.applyMatrix4=function(matrix,
optionalNormalMatrix){optionalNormalMatrix=optionalNormalMatrix||_normalMatrix.getNormalMatrix(matrix);matrix=this.coplanarPoint(_vector1).applyMatrix4(matrix);optionalNormalMatrix=this.normal.applyMatrix3(optionalNormalMatrix).normalize();this.constant=-matrix.dot(optionalNormalMatrix);return this};_proto.translate=function(offset){this.constant-=offset.dot(this.normal);return this};_proto.equals=function(plane){return plane.normal.equals(this.normal)&&plane.constant===this.constant};return Plane}(),
_v0$1=new Vector3,_v1$3=new Vector3,_v2$1=new Vector3,_v3=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3,Triangle=function(){function Triangle(a,b,c){this.a=void 0!==a?a:new Vector3;this.b=void 0!==b?b:new Vector3;this.c=void 0!==c?c:new Vector3}Triangle.getNormal=function(a,b,c,target){void 0===target&&(console.warn("THREE.Triangle: .getNormal() target is now required"),target=new Vector3);target.subVectors(c,b);_v0$1.subVectors(a,
b);target.cross(_v0$1);a=target.lengthSq();return 0<a?target.multiplyScalar(1/Math.sqrt(a)):target.set(0,0,0)};Triangle.getBarycoord=function(point,a,b,c,target){_v0$1.subVectors(c,a);_v1$3.subVectors(b,a);_v2$1.subVectors(point,a);point=_v0$1.dot(_v0$1);a=_v0$1.dot(_v1$3);b=_v0$1.dot(_v2$1);var dot11=_v1$3.dot(_v1$3);c=_v1$3.dot(_v2$1);var denom=point*dot11-a*a;void 0===target&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),target=new Vector3);if(0===denom)return target.set(-2,
-1,-1);denom=1/denom;dot11=(dot11*b-a*c)*denom;point=(point*c-a*b)*denom;return target.set(1-dot11-point,point,dot11)};Triangle.containsPoint=function(point,a,b,c){this.getBarycoord(point,a,b,c,_v3);return 0<=_v3.x&&0<=_v3.y&&1>=_v3.x+_v3.y};Triangle.getUV=function(point,p1,p2,p3,uv1,uv2,uv3,target){this.getBarycoord(point,p1,p2,p3,_v3);target.set(0,0);target.addScaledVector(uv1,_v3.x);target.addScaledVector(uv2,_v3.y);target.addScaledVector(uv3,_v3.z);return target};Triangle.isFrontFacing=function(a,
b,c,direction){_v0$1.subVectors(c,b);_v1$3.subVectors(a,b);return 0>_v0$1.cross(_v1$3).dot(direction)?!0:!1};var _proto=Triangle.prototype;_proto.set=function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this};_proto.setFromPointsAndIndices=function(points,i0,i1,i2){this.a.copy(points[i0]);this.b.copy(points[i1]);this.c.copy(points[i2]);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(triangle){this.a.copy(triangle.a);this.b.copy(triangle.b);
this.c.copy(triangle.c);return this};_proto.getArea=function(){_v0$1.subVectors(this.c,this.b);_v1$3.subVectors(this.a,this.b);return.5*_v0$1.cross(_v1$3).length()};_proto.getMidpoint=function(target){void 0===target&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),target=new Vector3);return target.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)};_proto.getNormal=function(target){return Triangle.getNormal(this.a,this.b,this.c,target)};_proto.getPlane=function(target){void 0===
target&&(console.warn("THREE.Triangle: .getPlane() target is now required"),target=new Plane);return target.setFromCoplanarPoints(this.a,this.b,this.c)};_proto.getBarycoord=function(point,target){return Triangle.getBarycoord(point,this.a,this.b,this.c,target)};_proto.getUV=function(point,uv1,uv2,uv3,target){return Triangle.getUV(point,this.a,this.b,this.c,uv1,uv2,uv3,target)};_proto.containsPoint=function(point){return Triangle.containsPoint(point,this.a,this.b,this.c)};_proto.isFrontFacing=function(direction){return Triangle.isFrontFacing(this.a,
this.b,this.c,direction)};_proto.intersectsBox=function(box){return box.intersectsTriangle(this)};_proto.closestPointToPoint=function(p,target){void 0===target&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),target=new Vector3);var a=this.a,b=this.b,c=this.c;_vab.subVectors(b,a);_vac.subVectors(c,a);_vap.subVectors(p,a);var d1=_vab.dot(_vap),d2=_vac.dot(_vap);if(0>=d1&&0>=d2)return target.copy(a);_vbp.subVectors(p,b);var d3=_vab.dot(_vbp),d4=_vac.dot(_vbp);if(0<=d3&&
d4<=d3)return target.copy(b);var w=d1*d4-d3*d2;if(0>=w&&0<=d1&&0>=d3)return b=d1/(d1-d3),target.copy(a).addScaledVector(_vab,b);_vcp.subVectors(p,c);p=_vab.dot(_vcp);var d6=_vac.dot(_vcp);if(0<=d6&&p<=d6)return target.copy(c);d1=p*d2-d1*d6;if(0>=d1&&0<=d2&&0>=d6)return w=d2/(d2-d6),target.copy(a).addScaledVector(_vac,w);d2=d3*d6-p*d4;if(0>=d2&&0<=d4-d3&&0<=p-d6)return _vbc.subVectors(c,b),w=(d4-d3)/(d4-d3+(p-d6)),target.copy(b).addScaledVector(_vbc,w);c=1/(d2+d1+w);b=d1*c;w*=c;return target.copy(a).addScaledVector(_vab,
b).addScaledVector(_vac,w)};_proto.equals=function(triangle){return triangle.a.equals(this.a)&&triangle.b.equals(this.b)&&triangle.c.equals(this.c)};return Triangle}(),_colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,
crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,
floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,
lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,
moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,
sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0},Color=function(){function Color(r,g,b){Object.defineProperty(this,"isColor",{value:!0});return void 0===g&&void 0===b?this.set(r):
this.setRGB(r,g,b)}var _proto=Color.prototype;_proto.set=function(value){value&&value.isColor?this.copy(value):"number"===typeof value?this.setHex(value):"string"===typeof value&&this.setStyle(value);return this};_proto.setScalar=function(scalar){this.b=this.g=this.r=scalar;return this};_proto.setHex=function(hex){hex=Math.floor(hex);this.r=(hex>>16&255)/255;this.g=(hex>>8&255)/255;this.b=(hex&255)/255;return this};_proto.setRGB=function(r,g,b){this.r=r;this.g=g;this.b=b;return this};_proto.setHSL=
function(h,s,l){h=MathUtils.euclideanModulo(h,1);s=MathUtils.clamp(s,0,1);l=MathUtils.clamp(l,0,1);0===s?this.r=this.g=this.b=l:(s=.5>=l?l*(1+s):l+s-l*s,l=2*l-s,this.r=hue2rgb(l,s,h+1/3),this.g=hue2rgb(l,s,h),this.b=hue2rgb(l,s,h-1/3));return this};_proto.setStyle=function(style){function handleAlpha(string){void 0!==string&&1>parseFloat(string)&&console.warn("THREE.Color: Alpha component of "+style+" will be ignored.")}var m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(style)){var components=m[2];
switch(m[1]){case "rgb":case "rgba":if(m=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components))return this.r=Math.min(255,parseInt(m[1],10))/255,this.g=Math.min(255,parseInt(m[2],10))/255,this.b=Math.min(255,parseInt(m[3],10))/255,handleAlpha(m[5]),this;if(m=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components))return this.r=Math.min(100,parseInt(m[1],10))/100,this.g=Math.min(100,parseInt(m[2],10))/100,this.b=Math.min(100,parseInt(m[3],10))/
100,handleAlpha(m[5]),this;break;case "hsl":case "hsla":if(m=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components)){components=parseFloat(m[1])/360;var s=parseInt(m[2],10)/100,l=parseInt(m[3],10)/100;handleAlpha(m[5]);return this.setHSL(components,s,l)}}}else if(m=/^#([A-Fa-f0-9]+)$/.exec(style)){m=m[1];components=m.length;if(3===components)return this.r=parseInt(m.charAt(0)+m.charAt(0),16)/255,this.g=parseInt(m.charAt(1)+m.charAt(1),16)/255,this.b=parseInt(m.charAt(2)+
m.charAt(2),16)/255,this;if(6===components)return this.r=parseInt(m.charAt(0)+m.charAt(1),16)/255,this.g=parseInt(m.charAt(2)+m.charAt(3),16)/255,this.b=parseInt(m.charAt(4)+m.charAt(5),16)/255,this}return style&&0<style.length?this.setColorName(style):this};_proto.setColorName=function(style){var hex=_colorKeywords[style];void 0!==hex?this.setHex(hex):console.warn("THREE.Color: Unknown color "+style);return this};_proto.clone=function(){return new this.constructor(this.r,this.g,this.b)};_proto.copy=
function(color){this.r=color.r;this.g=color.g;this.b=color.b;return this};_proto.copyGammaToLinear=function(color,gammaFactor){void 0===gammaFactor&&(gammaFactor=2);this.r=Math.pow(color.r,gammaFactor);this.g=Math.pow(color.g,gammaFactor);this.b=Math.pow(color.b,gammaFactor);return this};_proto.copyLinearToGamma=function(color,gammaFactor){void 0===gammaFactor&&(gammaFactor=2);gammaFactor=0<gammaFactor?1/gammaFactor:1;this.r=Math.pow(color.r,gammaFactor);this.g=Math.pow(color.g,gammaFactor);this.b=
Math.pow(color.b,gammaFactor);return this};_proto.convertGammaToLinear=function(gammaFactor){this.copyGammaToLinear(this,gammaFactor);return this};_proto.convertLinearToGamma=function(gammaFactor){this.copyLinearToGamma(this,gammaFactor);return this};_proto.copySRGBToLinear=function(color){this.r=SRGBToLinear(color.r);this.g=SRGBToLinear(color.g);this.b=SRGBToLinear(color.b);return this};_proto.copyLinearToSRGB=function(color){this.r=LinearToSRGB(color.r);this.g=LinearToSRGB(color.g);this.b=LinearToSRGB(color.b);
return this};_proto.convertSRGBToLinear=function(){this.copySRGBToLinear(this);return this};_proto.convertLinearToSRGB=function(){this.copyLinearToSRGB(this);return this};_proto.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0};_proto.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)};_proto.getHSL=function(target){void 0===target&&(console.warn("THREE.Color: .getHSL() target is now required"),target={h:0,s:0,l:0});var r=this.r,g=this.g,b=this.b,max=
Math.max(r,g,b),min=Math.min(r,g,b),hue,lightness=(min+max)/2;if(min===max)min=hue=0;else{var delta=max-min;min=.5>=lightness?delta/(max+min):delta/(2-max-min);switch(max){case r:hue=(g-b)/delta+(g<b?6:0);break;case g:hue=(b-r)/delta+2;break;case b:hue=(r-g)/delta+4}hue/=6}target.h=hue;target.s=min;target.l=lightness;return target};_proto.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"};_proto.offsetHSL=function(h,s,l){this.getHSL(_hslA);_hslA.h+=h;_hslA.s+=
s;_hslA.l+=l;this.setHSL(_hslA.h,_hslA.s,_hslA.l);return this};_proto.add=function(color){this.r+=color.r;this.g+=color.g;this.b+=color.b;return this};_proto.addColors=function(color1,color2){this.r=color1.r+color2.r;this.g=color1.g+color2.g;this.b=color1.b+color2.b;return this};_proto.addScalar=function(s){this.r+=s;this.g+=s;this.b+=s;return this};_proto.sub=function(color){this.r=Math.max(0,this.r-color.r);this.g=Math.max(0,this.g-color.g);this.b=Math.max(0,this.b-color.b);return this};_proto.multiply=
function(color){this.r*=color.r;this.g*=color.g;this.b*=color.b;return this};_proto.multiplyScalar=function(s){this.r*=s;this.g*=s;this.b*=s;return this};_proto.lerp=function(color,alpha){this.r+=(color.r-this.r)*alpha;this.g+=(color.g-this.g)*alpha;this.b+=(color.b-this.b)*alpha;return this};_proto.lerpHSL=function(color,alpha){this.getHSL(_hslA);color.getHSL(_hslB);color=MathUtils.lerp(_hslA.h,_hslB.h,alpha);var s=MathUtils.lerp(_hslA.s,_hslB.s,alpha);alpha=MathUtils.lerp(_hslA.l,_hslB.l,alpha);
this.setHSL(color,s,alpha);return this};_proto.equals=function(c){return c.r===this.r&&c.g===this.g&&c.b===this.b};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);this.r=array[offset];this.g=array[offset+1];this.b=array[offset+2];return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);array[offset]=this.r;array[offset+1]=this.g;array[offset+2]=this.b;return array};_proto.fromBufferAttribute=function(attribute,index){this.r=attribute.getX(index);
this.g=attribute.getY(index);this.b=attribute.getZ(index);!0===attribute.normalized&&(this.r/=255,this.g/=255,this.b/=255);return this};_proto.toJSON=function(){return this.getHex()};return Color}();Color.NAMES=_colorKeywords;Color.prototype.r=1;Color.prototype.g=1;Color.prototype.b=1;var Face3=function(){function Face3(a,b,c,normal,color,materialIndex){void 0===materialIndex&&(materialIndex=0);this.a=a;this.b=b;this.c=c;this.normal=normal&&normal.isVector3?normal:new Vector3;this.vertexNormals=Array.isArray(normal)?
normal:[];this.color=color&&color.isColor?color:new Color;this.vertexColors=Array.isArray(color)?color:[];this.materialIndex=materialIndex}var _proto=Face3.prototype;_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(source){this.a=source.a;this.b=source.b;this.c=source.c;this.normal.copy(source.normal);this.color.copy(source.color);this.materialIndex=source.materialIndex;for(var i=0,il=source.vertexNormals.length;i<il;i++)this.vertexNormals[i]=source.vertexNormals[i].clone();
i=0;for(il=source.vertexColors.length;i<il;i++)this.vertexColors[i]=source.vertexColors[i].clone();return this};return Face3}(),materialId=0;Material.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Material,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(values){if(void 0!==values)for(var key in values){var newValue=values[key];if(void 0===newValue)console.warn("THREE.Material: '"+
key+"' parameter is undefined.");else if("shading"===key)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===newValue?!0:!1;else{var currentValue=this[key];void 0===currentValue?console.warn("THREE."+this.type+": '"+key+"' is not a property of this material."):currentValue&&currentValue.isColor?currentValue.set(newValue):currentValue&&currentValue.isVector3&&newValue&&newValue.isVector3?currentValue.copy(newValue):this[key]=newValue}}},
toJSON:function(meta){function extractFromCache(cache){var values=[],key;for(key in cache){var _data=cache[key];delete _data.metadata;values.push(_data)}return values}var isRoot=void 0===meta||"string"===typeof meta;isRoot&&(meta={textures:{},images:{}});var data={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};data.uuid=this.uuid;data.type=this.type;""!==this.name&&(data.name=this.name);this.color&&this.color.isColor&&(data.color=this.color.getHex());void 0!==this.roughness&&
(data.roughness=this.roughness);void 0!==this.metalness&&(data.metalness=this.metalness);this.sheen&&this.sheen.isColor&&(data.sheen=this.sheen.getHex());this.emissive&&this.emissive.isColor&&(data.emissive=this.emissive.getHex());this.emissiveIntensity&&1!==this.emissiveIntensity&&(data.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(data.specular=this.specular.getHex());void 0!==this.shininess&&(data.shininess=this.shininess);void 0!==this.clearcoat&&(data.clearcoat=
this.clearcoat);void 0!==this.clearcoatRoughness&&(data.clearcoatRoughness=this.clearcoatRoughness);this.clearcoatMap&&this.clearcoatMap.isTexture&&(data.clearcoatMap=this.clearcoatMap.toJSON(meta).uuid);this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(data.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(meta).uuid);this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(data.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(meta).uuid,data.clearcoatNormalScale=this.clearcoatNormalScale.toArray());
this.map&&this.map.isTexture&&(data.map=this.map.toJSON(meta).uuid);this.matcap&&this.matcap.isTexture&&(data.matcap=this.matcap.toJSON(meta).uuid);this.alphaMap&&this.alphaMap.isTexture&&(data.alphaMap=this.alphaMap.toJSON(meta).uuid);this.lightMap&&this.lightMap.isTexture&&(data.lightMap=this.lightMap.toJSON(meta).uuid);this.aoMap&&this.aoMap.isTexture&&(data.aoMap=this.aoMap.toJSON(meta).uuid,data.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(data.bumpMap=this.bumpMap.toJSON(meta).uuid,
data.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(data.normalMap=this.normalMap.toJSON(meta).uuid,data.normalMapType=this.normalMapType,data.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(data.displacementMap=this.displacementMap.toJSON(meta).uuid,data.displacementScale=this.displacementScale,data.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(data.roughnessMap=this.roughnessMap.toJSON(meta).uuid);
this.metalnessMap&&this.metalnessMap.isTexture&&(data.metalnessMap=this.metalnessMap.toJSON(meta).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(data.emissiveMap=this.emissiveMap.toJSON(meta).uuid);this.specularMap&&this.specularMap.isTexture&&(data.specularMap=this.specularMap.toJSON(meta).uuid);this.envMap&&this.envMap.isTexture&&(data.envMap=this.envMap.toJSON(meta).uuid,data.reflectivity=this.reflectivity,data.refractionRatio=this.refractionRatio,void 0!==this.combine&&(data.combine=this.combine),
void 0!==this.envMapIntensity&&(data.envMapIntensity=this.envMapIntensity));this.gradientMap&&this.gradientMap.isTexture&&(data.gradientMap=this.gradientMap.toJSON(meta).uuid);void 0!==this.size&&(data.size=this.size);void 0!==this.sizeAttenuation&&(data.sizeAttenuation=this.sizeAttenuation);1!==this.blending&&(data.blending=this.blending);!0===this.flatShading&&(data.flatShading=this.flatShading);0!==this.side&&(data.side=this.side);this.vertexColors&&(data.vertexColors=!0);1>this.opacity&&(data.opacity=
this.opacity);!0===this.transparent&&(data.transparent=this.transparent);data.depthFunc=this.depthFunc;data.depthTest=this.depthTest;data.depthWrite=this.depthWrite;data.stencilWrite=this.stencilWrite;data.stencilWriteMask=this.stencilWriteMask;data.stencilFunc=this.stencilFunc;data.stencilRef=this.stencilRef;data.stencilFuncMask=this.stencilFuncMask;data.stencilFail=this.stencilFail;data.stencilZFail=this.stencilZFail;data.stencilZPass=this.stencilZPass;this.rotation&&0!==this.rotation&&(data.rotation=
this.rotation);!0===this.polygonOffset&&(data.polygonOffset=!0);0!==this.polygonOffsetFactor&&(data.polygonOffsetFactor=this.polygonOffsetFactor);0!==this.polygonOffsetUnits&&(data.polygonOffsetUnits=this.polygonOffsetUnits);this.linewidth&&1!==this.linewidth&&(data.linewidth=this.linewidth);void 0!==this.dashSize&&(data.dashSize=this.dashSize);void 0!==this.gapSize&&(data.gapSize=this.gapSize);void 0!==this.scale&&(data.scale=this.scale);!0===this.dithering&&(data.dithering=!0);0<this.alphaTest&&
(data.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(data.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(data.wireframe=this.wireframe);1<this.wireframeLinewidth&&(data.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(data.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(data.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(data.morphTargets=!0);!0===this.morphNormals&&(data.morphNormals=!0);!0===
this.skinning&&(data.skinning=!0);!1===this.visible&&(data.visible=!1);!1===this.toneMapped&&(data.toneMapped=!1);"{}"!==JSON.stringify(this.userData)&&(data.userData=this.userData);isRoot&&(isRoot=extractFromCache(meta.textures),meta=extractFromCache(meta.images),0<isRoot.length&&(data.textures=isRoot),0<meta.length&&(data.images=meta));return data},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.name=source.name;this.fog=source.fog;this.blending=source.blending;
this.side=source.side;this.flatShading=source.flatShading;this.vertexColors=source.vertexColors;this.opacity=source.opacity;this.transparent=source.transparent;this.blendSrc=source.blendSrc;this.blendDst=source.blendDst;this.blendEquation=source.blendEquation;this.blendSrcAlpha=source.blendSrcAlpha;this.blendDstAlpha=source.blendDstAlpha;this.blendEquationAlpha=source.blendEquationAlpha;this.depthFunc=source.depthFunc;this.depthTest=source.depthTest;this.depthWrite=source.depthWrite;this.stencilWriteMask=
source.stencilWriteMask;this.stencilFunc=source.stencilFunc;this.stencilRef=source.stencilRef;this.stencilFuncMask=source.stencilFuncMask;this.stencilFail=source.stencilFail;this.stencilZFail=source.stencilZFail;this.stencilZPass=source.stencilZPass;this.stencilWrite=source.stencilWrite;var srcPlanes=source.clippingPlanes,dstPlanes=null;if(null!==srcPlanes){var n=srcPlanes.length;dstPlanes=Array(n);for(var i=0;i!==n;++i)dstPlanes[i]=srcPlanes[i].clone()}this.clippingPlanes=dstPlanes;this.clipIntersection=
source.clipIntersection;this.clipShadows=source.clipShadows;this.shadowSide=source.shadowSide;this.colorWrite=source.colorWrite;this.precision=source.precision;this.polygonOffset=source.polygonOffset;this.polygonOffsetFactor=source.polygonOffsetFactor;this.polygonOffsetUnits=source.polygonOffsetUnits;this.dithering=source.dithering;this.alphaTest=source.alphaTest;this.premultipliedAlpha=source.premultipliedAlpha;this.visible=source.visible;this.toneMapped=source.toneMapped;this.userData=JSON.parse(JSON.stringify(source.userData));
return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(Material.prototype,"needsUpdate",{set:function(value){!0===value&&this.version++}});MeshBasicMaterial.prototype=Object.create(Material.prototype);MeshBasicMaterial.prototype.constructor=MeshBasicMaterial;MeshBasicMaterial.prototype.isMeshBasicMaterial=!0;MeshBasicMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.lightMap=
source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;
this.skinning=source.skinning;this.morphTargets=source.morphTargets;return this};var _vector$3=new Vector3,_vector2$1=new Vector2;Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function(value){!0===value&&this.version++}});Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(value){this.usage=value;return this},copy:function(source){this.name=source.name;this.array=new source.array.constructor(source.array);this.itemSize=
source.itemSize;this.count=source.count;this.normalized=source.normalized;this.usage=source.usage;return this},copyAt:function(index1,attribute,index2){index1*=this.itemSize;index2*=attribute.itemSize;for(var i=0,l=this.itemSize;i<l;i++)this.array[index1+i]=attribute.array[index2+i];return this},copyArray:function(array){this.array.set(array);return this},copyColorsArray:function(colors){for(var array=this.array,offset=0,i=0,l=colors.length;i<l;i++){var color=colors[i];void 0===color&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",
i),color=new Color);array[offset++]=color.r;array[offset++]=color.g;array[offset++]=color.b}return this},copyVector2sArray:function(vectors){for(var array=this.array,offset=0,i=0,l=vectors.length;i<l;i++){var vector=vectors[i];void 0===vector&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),vector=new Vector2);array[offset++]=vector.x;array[offset++]=vector.y}return this},copyVector3sArray:function(vectors){for(var array=this.array,offset=0,i=0,l=vectors.length;i<
l;i++){var vector=vectors[i];void 0===vector&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),vector=new Vector3);array[offset++]=vector.x;array[offset++]=vector.y;array[offset++]=vector.z}return this},copyVector4sArray:function(vectors){for(var array=this.array,offset=0,i=0,l=vectors.length;i<l;i++){var vector=vectors[i];void 0===vector&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),vector=new Vector4);array[offset++]=vector.x;
array[offset++]=vector.y;array[offset++]=vector.z;array[offset++]=vector.w}return this},applyMatrix3:function(m){if(2===this.itemSize)for(var i=0,l=this.count;i<l;i++)_vector2$1.fromBufferAttribute(this,i),_vector2$1.applyMatrix3(m),this.setXY(i,_vector2$1.x,_vector2$1.y);else if(3===this.itemSize)for(i=0,l=this.count;i<l;i++)_vector$3.fromBufferAttribute(this,i),_vector$3.applyMatrix3(m),this.setXYZ(i,_vector$3.x,_vector$3.y,_vector$3.z);return this},applyMatrix4:function(m){for(var i=0,l=this.count;i<
l;i++)_vector$3.x=this.getX(i),_vector$3.y=this.getY(i),_vector$3.z=this.getZ(i),_vector$3.applyMatrix4(m),this.setXYZ(i,_vector$3.x,_vector$3.y,_vector$3.z);return this},applyNormalMatrix:function(m){for(var i=0,l=this.count;i<l;i++)_vector$3.x=this.getX(i),_vector$3.y=this.getY(i),_vector$3.z=this.getZ(i),_vector$3.applyNormalMatrix(m),this.setXYZ(i,_vector$3.x,_vector$3.y,_vector$3.z);return this},transformDirection:function(m){for(var i=0,l=this.count;i<l;i++)_vector$3.x=this.getX(i),_vector$3.y=
this.getY(i),_vector$3.z=this.getZ(i),_vector$3.transformDirection(m),this.setXYZ(i,_vector$3.x,_vector$3.y,_vector$3.z);return this},set:function(value,offset){void 0===offset&&(offset=0);this.array.set(value,offset);return this},getX:function(index){return this.array[index*this.itemSize]},setX:function(index,x){this.array[index*this.itemSize]=x;return this},getY:function(index){return this.array[index*this.itemSize+1]},setY:function(index,y){this.array[index*this.itemSize+1]=y;return this},getZ:function(index){return this.array[index*
this.itemSize+2]},setZ:function(index,z){this.array[index*this.itemSize+2]=z;return this},getW:function(index){return this.array[index*this.itemSize+3]},setW:function(index,w){this.array[index*this.itemSize+3]=w;return this},setXY:function(index,x,y){index*=this.itemSize;this.array[index+0]=x;this.array[index+1]=y;return this},setXYZ:function(index,x,y,z){index*=this.itemSize;this.array[index+0]=x;this.array[index+1]=y;this.array[index+2]=z;return this},setXYZW:function(index,x,y,z,w){index*=this.itemSize;
this.array[index+0]=x;this.array[index+1]=y;this.array[index+2]=z;this.array[index+3]=w;return this},onUpload:function(callback){this.onUploadCallback=callback;return this},clone:function(){return(new this.constructor(this.array,this.itemSize)).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int8BufferAttribute.prototype.constructor=
Int8BufferAttribute;Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute;Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute;Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int16BufferAttribute.prototype.constructor=Int16BufferAttribute;Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype);
Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute;Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int32BufferAttribute.prototype.constructor=Int32BufferAttribute;Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute;Float16BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Float16BufferAttribute.prototype.constructor=Float16BufferAttribute;Float16BufferAttribute.prototype.isFloat16BufferAttribute=
!0;Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Float32BufferAttribute.prototype.constructor=Float32BufferAttribute;Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Float64BufferAttribute.prototype.constructor=Float64BufferAttribute;var DirectGeometry=function(){function DirectGeometry(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=
this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}var _proto=DirectGeometry.prototype;_proto.computeGroups=function(geometry){var groups=[],materialIndex=void 0,faces=geometry.faces;for(geometry=0;geometry<faces.length;geometry++){var face=faces[geometry];if(face.materialIndex!==materialIndex){materialIndex=face.materialIndex;void 0!==group&&(group.count=3*geometry-group.start,groups.push(group));var group={start:3*
geometry,materialIndex:materialIndex}}}void 0!==group&&(group.count=3*geometry-group.start,groups.push(group));this.groups=groups};_proto.fromGeometry=function(geometry){var faces=geometry.faces,vertices=geometry.vertices,faceVertexUvs=geometry.faceVertexUvs,hasFaceVertexUv=faceVertexUvs[0]&&0<faceVertexUvs[0].length,hasFaceVertexUv2=faceVertexUvs[1]&&0<faceVertexUvs[1].length,morphTargets=geometry.morphTargets,morphTargetsLength=morphTargets.length;if(0<morphTargetsLength){var morphTargetsPosition=
[];for(var i=0;i<morphTargetsLength;i++)morphTargetsPosition[i]={name:morphTargets[i].name,data:[]};this.morphTargets.position=morphTargetsPosition}i=geometry.morphNormals;var morphNormalsLength=i.length;if(0<morphNormalsLength){var morphTargetsNormal=[];for(var _i=0;_i<morphNormalsLength;_i++)morphTargetsNormal[_i]={name:i[_i].name,data:[]};this.morphTargets.normal=morphTargetsNormal}_i=geometry.skinIndices;var skinWeights=geometry.skinWeights,hasSkinIndices=_i.length===vertices.length,hasSkinWeights=
skinWeights.length===vertices.length;0<vertices.length&&0===faces.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var _i2=0;_i2<faces.length;_i2++){var face=faces[_i2];this.vertices.push(vertices[face.a],vertices[face.b],vertices[face.c]);var vertexNormals=face.vertexNormals;3===vertexNormals.length?this.normals.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]):(vertexNormals=face.normal,this.normals.push(vertexNormals,vertexNormals,vertexNormals));
vertexNormals=face.vertexColors;3===vertexNormals.length?this.colors.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]):(vertexNormals=face.color,this.colors.push(vertexNormals,vertexNormals,vertexNormals));!0===hasFaceVertexUv&&(vertexNormals=faceVertexUvs[0][_i2],void 0!==vertexNormals?this.uvs.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",_i2),this.uvs.push(new Vector2,new Vector2,new Vector2)));!0===hasFaceVertexUv2&&
(vertexNormals=faceVertexUvs[1][_i2],void 0!==vertexNormals?this.uvs2.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",_i2),this.uvs2.push(new Vector2,new Vector2,new Vector2)));for(vertexNormals=0;vertexNormals<morphTargetsLength;vertexNormals++){var morphTarget=morphTargets[vertexNormals].vertices;morphTargetsPosition[vertexNormals].data.push(morphTarget[face.a],morphTarget[face.b],morphTarget[face.c])}for(vertexNormals=
0;vertexNormals<morphNormalsLength;vertexNormals++)morphTarget=i[vertexNormals].vertexNormals[_i2],morphTargetsNormal[vertexNormals].data.push(morphTarget.a,morphTarget.b,morphTarget.c);hasSkinIndices&&this.skinIndices.push(_i[face.a],_i[face.b],_i[face.c]);hasSkinWeights&&this.skinWeights.push(skinWeights[face.a],skinWeights[face.b],skinWeights[face.c])}this.computeGroups(geometry);this.verticesNeedUpdate=geometry.verticesNeedUpdate;this.normalsNeedUpdate=geometry.normalsNeedUpdate;this.colorsNeedUpdate=
geometry.colorsNeedUpdate;this.uvsNeedUpdate=geometry.uvsNeedUpdate;this.groupsNeedUpdate=geometry.groupsNeedUpdate;null!==geometry.boundingSphere&&(this.boundingSphere=geometry.boundingSphere.clone());null!==geometry.boundingBox&&(this.boundingBox=geometry.boundingBox.clone());return this};return DirectGeometry}(),TYPED_ARRAYS={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,
Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array},_bufferGeometryId=1,_m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$4=new Vector3;BufferGeometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(index){Array.isArray(index)?this.index=new (65535<arrayMax(index)?Uint32BufferAttribute:
Uint16BufferAttribute)(index,1):this.index=index;return this},getAttribute:function(name){return this.attributes[name]},setAttribute:function(name,attribute){this.attributes[name]=attribute;return this},deleteAttribute:function(name){delete this.attributes[name];return this},hasAttribute:function(name){return void 0!==this.attributes[name]},addGroup:function(start,count,materialIndex){void 0===materialIndex&&(materialIndex=0);this.groups.push({start:start,count:count,materialIndex:materialIndex})},
clearGroups:function(){this.groups=[]},setDrawRange:function(start,count){this.drawRange.start=start;this.drawRange.count=count},applyMatrix4:function(matrix){var position=this.attributes.position;void 0!==position&&(position.applyMatrix4(matrix),position.needsUpdate=!0);position=this.attributes.normal;if(void 0!==position){var normalMatrix=(new Matrix3).getNormalMatrix(matrix);position.applyNormalMatrix(normalMatrix);position.needsUpdate=!0}position=this.attributes.tangent;void 0!==position&&(position.transformDirection(matrix),
position.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(angle){_m1$2.makeRotationX(angle);this.applyMatrix4(_m1$2);return this},rotateY:function(angle){_m1$2.makeRotationY(angle);this.applyMatrix4(_m1$2);return this},rotateZ:function(angle){_m1$2.makeRotationZ(angle);this.applyMatrix4(_m1$2);return this},translate:function(x,y,z){_m1$2.makeTranslation(x,y,z);this.applyMatrix4(_m1$2);return this},
scale:function(x,y,z){_m1$2.makeScale(x,y,z);this.applyMatrix4(_m1$2);return this},lookAt:function(vector){_obj.lookAt(vector);_obj.updateMatrix();this.applyMatrix4(_obj.matrix);return this},center:function(){this.computeBoundingBox();this.boundingBox.getCenter(_offset).negate();this.translate(_offset.x,_offset.y,_offset.z);return this},setFromObject:function(object){var geometry=object.geometry;if(object.isPoints||object.isLine){object=new Float32BufferAttribute(3*geometry.vertices.length,3);var colors=
new Float32BufferAttribute(3*geometry.colors.length,3);this.setAttribute("position",object.copyVector3sArray(geometry.vertices));this.setAttribute("color",colors.copyColorsArray(geometry.colors));geometry.lineDistances&&geometry.lineDistances.length===geometry.vertices.length&&(object=new Float32BufferAttribute(geometry.lineDistances.length,1),this.setAttribute("lineDistance",object.copyArray(geometry.lineDistances)));null!==geometry.boundingSphere&&(this.boundingSphere=geometry.boundingSphere.clone());
null!==geometry.boundingBox&&(this.boundingBox=geometry.boundingBox.clone())}else object.isMesh&&geometry&&geometry.isGeometry&&this.fromGeometry(geometry);return this},setFromPoints:function(points){for(var position=[],i=0,l=points.length;i<l;i++){var point=points[i];position.push(point.x,point.y,point.z||0)}this.setAttribute("position",new Float32BufferAttribute(position,3));return this},updateFromObject:function(object){var geometry=object.geometry;if(object.isMesh){var direct=geometry.__directGeometry;
!0===geometry.elementsNeedUpdate&&(direct=void 0,geometry.elementsNeedUpdate=!1);if(void 0===direct)return this.fromGeometry(geometry);direct.verticesNeedUpdate=geometry.verticesNeedUpdate;direct.normalsNeedUpdate=geometry.normalsNeedUpdate;direct.colorsNeedUpdate=geometry.colorsNeedUpdate;direct.uvsNeedUpdate=geometry.uvsNeedUpdate;direct.groupsNeedUpdate=geometry.groupsNeedUpdate;geometry.verticesNeedUpdate=!1;geometry.normalsNeedUpdate=!1;geometry.colorsNeedUpdate=!1;geometry.uvsNeedUpdate=!1;
geometry.groupsNeedUpdate=!1;geometry=direct}!0===geometry.verticesNeedUpdate&&(direct=this.attributes.position,void 0!==direct&&(direct.copyVector3sArray(geometry.vertices),direct.needsUpdate=!0),geometry.verticesNeedUpdate=!1);!0===geometry.normalsNeedUpdate&&(direct=this.attributes.normal,void 0!==direct&&(direct.copyVector3sArray(geometry.normals),direct.needsUpdate=!0),geometry.normalsNeedUpdate=!1);!0===geometry.colorsNeedUpdate&&(direct=this.attributes.color,void 0!==direct&&(direct.copyColorsArray(geometry.colors),
direct.needsUpdate=!0),geometry.colorsNeedUpdate=!1);geometry.uvsNeedUpdate&&(direct=this.attributes.uv,void 0!==direct&&(direct.copyVector2sArray(geometry.uvs),direct.needsUpdate=!0),geometry.uvsNeedUpdate=!1);geometry.lineDistancesNeedUpdate&&(direct=this.attributes.lineDistance,void 0!==direct&&(direct.copyArray(geometry.lineDistances),direct.needsUpdate=!0),geometry.lineDistancesNeedUpdate=!1);geometry.groupsNeedUpdate&&(geometry.computeGroups(object.geometry),this.groups=geometry.groups,geometry.groupsNeedUpdate=
!1);return this},fromGeometry:function(geometry){geometry.__directGeometry=(new DirectGeometry).fromGeometry(geometry);return this.fromDirectGeometry(geometry.__directGeometry)},fromDirectGeometry:function(geometry){var positions=new Float32Array(3*geometry.vertices.length);this.setAttribute("position",(new BufferAttribute(positions,3)).copyVector3sArray(geometry.vertices));0<geometry.normals.length&&(positions=new Float32Array(3*geometry.normals.length),this.setAttribute("normal",(new BufferAttribute(positions,
3)).copyVector3sArray(geometry.normals)));0<geometry.colors.length&&(positions=new Float32Array(3*geometry.colors.length),this.setAttribute("color",(new BufferAttribute(positions,3)).copyColorsArray(geometry.colors)));0<geometry.uvs.length&&(positions=new Float32Array(2*geometry.uvs.length),this.setAttribute("uv",(new BufferAttribute(positions,2)).copyVector2sArray(geometry.uvs)));0<geometry.uvs2.length&&(positions=new Float32Array(2*geometry.uvs2.length),this.setAttribute("uv2",(new BufferAttribute(positions,
2)).copyVector2sArray(geometry.uvs2)));this.groups=geometry.groups;for(var name in geometry.morphTargets){positions=[];for(var morphTargets=geometry.morphTargets[name],i=0,l=morphTargets.length;i<l;i++){var morphTarget=morphTargets[i],attribute=new Float32BufferAttribute(3*morphTarget.data.length,3);attribute.name=morphTarget.name;positions.push(attribute.copyVector3sArray(morphTarget.data))}this.morphAttributes[name]=positions}0<geometry.skinIndices.length&&(name=new Float32BufferAttribute(4*geometry.skinIndices.length,
4),this.setAttribute("skinIndex",name.copyVector4sArray(geometry.skinIndices)));0<geometry.skinWeights.length&&(name=new Float32BufferAttribute(4*geometry.skinWeights.length,4),this.setAttribute("skinWeight",name.copyVector4sArray(geometry.skinWeights)));null!==geometry.boundingSphere&&(this.boundingSphere=geometry.boundingSphere.clone());null!==geometry.boundingBox&&(this.boundingBox=geometry.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=
new Box3);var position=this.attributes.position,morphAttributesPosition=this.morphAttributes.position;if(position&&position.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-Infinity,-Infinity,-Infinity),new Vector3(Infinity,Infinity,Infinity));else{if(void 0!==position){if(this.boundingBox.setFromBufferAttribute(position),morphAttributesPosition){position=
0;for(var il=morphAttributesPosition.length;position<il;position++)_box$2.setFromBufferAttribute(morphAttributesPosition[position]),this.morphTargetsRelative?(_vector$4.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$4),_vector$4.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$4)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||
isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);var position=this.attributes.position,morphAttributesPosition=this.morphAttributes.position;if(position&&position.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',
this),this.boundingSphere.set(new Vector3,Infinity);else if(position){var center=this.boundingSphere.center;_box$2.setFromBufferAttribute(position);if(morphAttributesPosition)for(var i=0,il=morphAttributesPosition.length;i<il;i++)_boxMorphTargets.setFromBufferAttribute(morphAttributesPosition[i]),this.morphTargetsRelative?(_vector$4.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$4),_vector$4.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$4)):(_box$2.expandByPoint(_boxMorphTargets.min),
_box$2.expandByPoint(_boxMorphTargets.max));_box$2.getCenter(center);il=i=0;for(var _il=position.count;il<_il;il++)_vector$4.fromBufferAttribute(position,il),i=Math.max(i,center.distanceToSquared(_vector$4));if(morphAttributesPosition)for(il=0,_il=morphAttributesPosition.length;il<_il;il++)for(var _morphAttribute=morphAttributesPosition[il],morphTargetsRelative=this.morphTargetsRelative,j=0,jl=_morphAttribute.count;j<jl;j++)_vector$4.fromBufferAttribute(_morphAttribute,j),morphTargetsRelative&&(_offset.fromBufferAttribute(position,
j),_vector$4.add(_offset)),i=Math.max(i,center.distanceToSquared(_vector$4));this.boundingSphere.radius=Math.sqrt(i);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var index=this.index,positionAttribute=this.getAttribute("position");if(void 0!==positionAttribute){var normalAttribute=this.getAttribute("normal");
if(void 0===normalAttribute)normalAttribute=new BufferAttribute(new Float32Array(3*positionAttribute.count),3),this.setAttribute("normal",normalAttribute);else for(var i=0,il=normalAttribute.count;i<il;i++)normalAttribute.setXYZ(i,0,0,0);i=new Vector3;il=new Vector3;var pC=new Vector3,nA=new Vector3,nB=new Vector3,nC=new Vector3,cb=new Vector3,ab=new Vector3;if(index)for(var _i3=0,_il3=index.count;_i3<_il3;_i3+=3){var vA=index.getX(_i3+0),vB=index.getX(_i3+1),vC=index.getX(_i3+2);i.fromBufferAttribute(positionAttribute,
vA);il.fromBufferAttribute(positionAttribute,vB);pC.fromBufferAttribute(positionAttribute,vC);cb.subVectors(pC,il);ab.subVectors(i,il);cb.cross(ab);nA.fromBufferAttribute(normalAttribute,vA);nB.fromBufferAttribute(normalAttribute,vB);nC.fromBufferAttribute(normalAttribute,vC);nA.add(cb);nB.add(cb);nC.add(cb);normalAttribute.setXYZ(vA,nA.x,nA.y,nA.z);normalAttribute.setXYZ(vB,nB.x,nB.y,nB.z);normalAttribute.setXYZ(vC,nC.x,nC.y,nC.z)}else for(index=0,nA=positionAttribute.count;index<nA;index+=3)i.fromBufferAttribute(positionAttribute,
index+0),il.fromBufferAttribute(positionAttribute,index+1),pC.fromBufferAttribute(positionAttribute,index+2),cb.subVectors(pC,il),ab.subVectors(i,il),cb.cross(ab),normalAttribute.setXYZ(index+0,cb.x,cb.y,cb.z),normalAttribute.setXYZ(index+1,cb.x,cb.y,cb.z),normalAttribute.setXYZ(index+2,cb.x,cb.y,cb.z);this.normalizeNormals();normalAttribute.needsUpdate=!0}},merge:function(geometry,offset){if(geometry&&geometry.isBufferGeometry){void 0===offset&&(offset=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset\x3d0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
var attributes=this.attributes,key;for(key in attributes)if(void 0!==geometry.attributes[key]){var attributeArray1=attributes[key].array,attribute2=geometry.attributes[key],attributeArray2=attribute2.array,attributeOffset=attribute2.itemSize*offset;attribute2=Math.min(attributeArray2.length,attributeArray1.length-attributeOffset);for(var i=0;i<attribute2;i++,attributeOffset++)attributeArray1[attributeOffset]=attributeArray2[i]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",
geometry)},normalizeNormals:function(){for(var normals=this.attributes.normal,i=0,il=normals.count;i<il;i++)_vector$4.fromBufferAttribute(normals,i),_vector$4.normalize(),normals.setXYZ(i,_vector$4.x,_vector$4.y,_vector$4.z)},toNonIndexed:function(){function convertBufferAttribute(attribute,indices){var array=attribute.array,itemSize=attribute.itemSize;attribute=attribute.normalized;for(var array2=new array.constructor(indices.length*itemSize),index,index2=0,i=0,l=indices.length;i<l;i++){index=indices[i]*
itemSize;for(var j=0;j<itemSize;j++)array2[index2++]=array[index++]}return new BufferAttribute(array2,itemSize,attribute)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var geometry2=new BufferGeometry,indices$jscomp$0=this.index.array,attributes=this.attributes;for(name in attributes){var newAttribute=convertBufferAttribute(attributes[name],indices$jscomp$0);geometry2.setAttribute(name,newAttribute)}attributes=this.morphAttributes;
for(var _name in attributes){var name=[];newAttribute=attributes[_name];for(var i$jscomp$0=0,il=newAttribute.length;i$jscomp$0<il;i$jscomp$0++){var _newAttribute=convertBufferAttribute(newAttribute[i$jscomp$0],indices$jscomp$0);name.push(_newAttribute)}geometry2.morphAttributes[_name]=name}geometry2.morphTargetsRelative=this.morphTargetsRelative;indices$jscomp$0=this.groups;_name=0;for(attributes=indices$jscomp$0.length;_name<attributes;_name++)name=indices$jscomp$0[_name],geometry2.addGroup(name.start,
name.count,name.materialIndex);return geometry2},toJSON:function(){var data={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};data.uuid=this.uuid;data.type=this.type;""!==this.name&&(data.name=this.name);0<Object.keys(this.userData).length&&(data.userData=this.userData);if(void 0!==this.parameters){var parameters=this.parameters;for(key in parameters)void 0!==parameters[key]&&(data[key]=parameters[key]);return data}data.data={attributes:{}};var key=this.index;null!==
key&&(data.data.index={type:key.array.constructor.name,array:Array.prototype.slice.call(key.array)});key=this.attributes;for(var _key in key){var attribute=key[_key],attributeData=attribute.toJSON(data.data);""!==attribute.name&&(attributeData.name=attribute.name);data.data.attributes[_key]=attributeData}_key={};key=!1;for(parameters in this.morphAttributes){attribute=this.morphAttributes[parameters];attributeData=[];for(var i=0,il=attribute.length;i<il;i++){var _attribute6=attribute[i],_attributeData=
_attribute6.toJSON(data.data);""!==_attribute6.name&&(_attributeData.name=_attribute6.name);attributeData.push(_attributeData)}0<attributeData.length&&(_key[parameters]=attributeData,key=!0)}key&&(data.data.morphAttributes=_key,data.data.morphTargetsRelative=this.morphTargetsRelative);parameters=this.groups;0<parameters.length&&(data.data.groups=JSON.parse(JSON.stringify(parameters)));parameters=this.boundingSphere;null!==parameters&&(data.data.boundingSphere={center:parameters.center.toArray(),radius:parameters.radius});
return data},clone:function(){return(new BufferGeometry).copy(this)},copy:function(source){this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;var data={};this.name=source.name;var index=source.index;null!==index&&this.setIndex(index.clone(data));index=source.attributes;for(var name in index)this.setAttribute(name,index[name].clone(data));name=source.morphAttributes;for(var _name2 in name){index=[];for(var morphAttribute=name[_name2],
i=0,l=morphAttribute.length;i<l;i++)index.push(morphAttribute[i].clone(data));this.morphAttributes[_name2]=index}this.morphTargetsRelative=source.morphTargetsRelative;data=source.groups;_name2=0;for(name=data.length;_name2<name;_name2++)index=data[_name2],this.addGroup(index.start,index.count,index.materialIndex);data=source.boundingBox;null!==data&&(this.boundingBox=data.clone());data=source.boundingSphere;null!==data&&(this.boundingSphere=data.clone());this.drawRange.start=source.drawRange.start;
this.drawRange.count=source.drawRange.count;this.userData=source.userData;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_tempA=new Vector3,_tempB=new Vector3,_tempC=new Vector3,_morphA=new Vector3,_morphB=new Vector3,_morphC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;Mesh.prototype=
Object.assign(Object.create(Object3D.prototype),{constructor:Mesh,isMesh:!0,copy:function(source){Object3D.prototype.copy.call(this,source);void 0!==source.morphTargetInfluences&&(this.morphTargetInfluences=source.morphTargetInfluences.slice());void 0!==source.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},source.morphTargetDictionary));this.material=source.material;this.geometry=source.geometry;return this},updateMorphTargets:function(){var geometry=this.geometry;if(geometry.isBufferGeometry){geometry=
geometry.morphAttributes;var keys=Object.keys(geometry);if(0<keys.length&&(geometry=geometry[keys[0]],void 0!==geometry)){this.morphTargetInfluences=[];this.morphTargetDictionary={};keys=0;for(var ml=geometry.length;keys<ml;keys++){var name=geometry[keys].name||String(keys);this.morphTargetInfluences.push(0);this.morphTargetDictionary[name]=keys}}}else geometry=geometry.morphTargets,void 0!==geometry&&0<geometry.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},
raycast:function(raycaster,intersects){var geometry=this.geometry,material=this.material,matrixWorld=this.matrixWorld;if(void 0!==material&&(null===geometry.boundingSphere&&geometry.computeBoundingSphere(),_sphere.copy(geometry.boundingSphere),_sphere.applyMatrix4(matrixWorld),!1!==raycaster.ray.intersectsSphere(_sphere)&&(_inverseMatrix.copy(matrixWorld).invert(),_ray.copy(raycaster.ray).applyMatrix4(_inverseMatrix),null===geometry.boundingBox||!1!==_ray.intersectsBox(geometry.boundingBox))))if(geometry.isBufferGeometry){var index=
geometry.index,position=geometry.attributes.position;matrixWorld=geometry.morphAttributes.position;var morphTargetsRelative=geometry.morphTargetsRelative,uv=geometry.attributes.uv,uv2=geometry.attributes.uv2,groups=geometry.groups,drawRange=geometry.drawRange;if(null!==index)if(Array.isArray(material))for(var i=0,il=groups.length;i<il;i++)for(var group=groups[i],groupMaterial=material[group.materialIndex],j=Math.max(group.start,drawRange.start),jl=Math.min(group.start+group.count,drawRange.start+
drawRange.count);j<jl;j+=3){geometry=index.getX(j);var b=index.getX(j+1),c=index.getX(j+2);if(geometry=checkBufferGeometryIntersection(this,groupMaterial,raycaster,_ray,position,matrixWorld,morphTargetsRelative,uv,uv2,geometry,b,c))geometry.faceIndex=Math.floor(j/3),geometry.face.materialIndex=group.materialIndex,intersects.push(geometry)}else for(groups=Math.max(0,drawRange.start),drawRange=Math.min(index.count,drawRange.start+drawRange.count);groups<drawRange;groups+=3){if(geometry=index.getX(groups),
i=index.getX(groups+1),il=index.getX(groups+2),geometry=checkBufferGeometryIntersection(this,material,raycaster,_ray,position,matrixWorld,morphTargetsRelative,uv,uv2,geometry,i,il))geometry.faceIndex=Math.floor(groups/3),intersects.push(geometry)}else if(void 0!==position)if(Array.isArray(material))for(index=0,i=groups.length;index<i;index++)for(il=groups[index],group=material[il.materialIndex],groupMaterial=Math.max(il.start,drawRange.start),j=Math.min(il.start+il.count,drawRange.start+drawRange.count);groupMaterial<
j;groupMaterial+=3){if(geometry=checkBufferGeometryIntersection(this,group,raycaster,_ray,position,matrixWorld,morphTargetsRelative,uv,uv2,groupMaterial,groupMaterial+1,groupMaterial+2))geometry.faceIndex=Math.floor(groupMaterial/3),geometry.face.materialIndex=il.materialIndex,intersects.push(geometry)}else for(groups=Math.max(0,drawRange.start),drawRange=Math.min(position.count,drawRange.start+drawRange.count);groups<drawRange;groups+=3)if(geometry=checkBufferGeometryIntersection(this,material,raycaster,
_ray,position,matrixWorld,morphTargetsRelative,uv,uv2,groups,groups+1,groups+2))geometry.faceIndex=Math.floor(groups/3),intersects.push(geometry)}else if(geometry.isGeometry)for(matrixWorld=Array.isArray(material),morphTargetsRelative=geometry.vertices,uv=geometry.faces,geometry=geometry.faceVertexUvs[0],0<geometry.length&&(position=geometry),uv2=0,drawRange=uv.length;uv2<drawRange;uv2++)if(groups=uv[uv2],geometry=matrixWorld?material[groups.materialIndex]:material,void 0!==geometry&&(index=morphTargetsRelative[groups.a],
i=morphTargetsRelative[groups.b],il=morphTargetsRelative[groups.c],geometry=checkIntersection(this,geometry,raycaster,_ray,index,i,il,_intersectionPoint)))position&&position[uv2]&&(group=position[uv2],_uvA.copy(group[0]),_uvB.copy(group[1]),_uvC.copy(group[2]),geometry.uv=Triangle.getUV(_intersectionPoint,index,i,il,_uvA,_uvB,_uvC,new Vector2)),geometry.face=groups,geometry.faceIndex=uv2,intersects.push(geometry)}});var BoxBufferGeometry=function(_BufferGeometry){function BoxBufferGeometry(width$jscomp$0,
height$jscomp$0,depth$jscomp$0,widthSegments,heightSegments,depthSegments){function buildPlane(u,v,w,udir,vdir,width,height,depth,gridX,gridY,materialIndex){var segmentWidth=width/gridX,segmentHeight=height/gridY,widthHalf=width/2,heightHalf=height/2,depthHalf=depth/2;height=gridX+1;for(var gridY1=gridY+1,groupCount=width=0,vector=new Vector3,iy=0;iy<gridY1;iy++)for(var y=iy*segmentHeight-heightHalf,ix=0;ix<height;ix++)vector[u]=(ix*segmentWidth-widthHalf)*udir,vector[v]=y*vdir,vector[w]=depthHalf,
vertices.push(vector.x,vector.y,vector.z),vector[u]=0,vector[v]=0,vector[w]=0<depth?1:-1,normals.push(vector.x,vector.y,vector.z),uvs.push(ix/gridX),uvs.push(1-iy/gridY),width+=1;for(u=0;u<gridY;u++)for(v=0;v<gridX;v++)w=numberOfVertices+v+height*(u+1),udir=numberOfVertices+(v+1)+height*(u+1),vdir=numberOfVertices+(v+1)+height*u,indices.push(numberOfVertices+v+height*u,w,vdir),indices.push(w,udir,vdir),groupCount+=6;scope.addGroup(groupStart,groupCount,materialIndex);groupStart+=groupCount;numberOfVertices+=
width}void 0===width$jscomp$0&&(width$jscomp$0=1);void 0===height$jscomp$0&&(height$jscomp$0=1);void 0===depth$jscomp$0&&(depth$jscomp$0=1);void 0===widthSegments&&(widthSegments=1);void 0===heightSegments&&(heightSegments=1);void 0===depthSegments&&(depthSegments=1);var _this=_BufferGeometry.call(this)||this;_this.type="BoxBufferGeometry";_this.parameters={width:width$jscomp$0,height:height$jscomp$0,depth:depth$jscomp$0,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments};
var scope=_assertThisInitialized(_this);widthSegments=Math.floor(widthSegments);heightSegments=Math.floor(heightSegments);depthSegments=Math.floor(depthSegments);var indices=[],vertices=[],normals=[],uvs=[],numberOfVertices=0,groupStart=0;buildPlane("z","y","x",-1,-1,depth$jscomp$0,height$jscomp$0,width$jscomp$0,depthSegments,heightSegments,0);buildPlane("z","y","x",1,-1,depth$jscomp$0,height$jscomp$0,-width$jscomp$0,depthSegments,heightSegments,1);buildPlane("x","z","y",1,1,width$jscomp$0,depth$jscomp$0,
height$jscomp$0,widthSegments,depthSegments,2);buildPlane("x","z","y",1,-1,width$jscomp$0,depth$jscomp$0,-height$jscomp$0,widthSegments,depthSegments,3);buildPlane("x","y","z",1,-1,width$jscomp$0,height$jscomp$0,depth$jscomp$0,widthSegments,heightSegments,4);buildPlane("x","y","z",-1,-1,width$jscomp$0,height$jscomp$0,-depth$jscomp$0,widthSegments,heightSegments,5);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,
3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(BoxBufferGeometry,_BufferGeometry);return BoxBufferGeometry}(BufferGeometry),UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};ShaderMaterial.prototype=Object.create(Material.prototype);ShaderMaterial.prototype.constructor=ShaderMaterial;ShaderMaterial.prototype.isShaderMaterial=!0;ShaderMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.fragmentShader=source.fragmentShader;
this.vertexShader=source.vertexShader;this.uniforms=cloneUniforms(source.uniforms);this.defines=Object.assign({},source.defines);this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.lights=source.lights;this.clipping=source.clipping;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;this.extensions=Object.assign({},source.extensions);this.glslVersion=source.glslVersion;return this};ShaderMaterial.prototype.toJSON=
function(meta){var data=Material.prototype.toJSON.call(this,meta);data.glslVersion=this.glslVersion;data.uniforms={};for(var name in this.uniforms){var value=this.uniforms[name].value;data.uniforms[name]=value&&value.isTexture?{type:"t",value:value.toJSON(meta).uuid}:value&&value.isColor?{type:"c",value:value.getHex()}:value&&value.isVector2?{type:"v2",value:value.toArray()}:value&&value.isVector3?{type:"v3",value:value.toArray()}:value&&value.isVector4?{type:"v4",value:value.toArray()}:value&&value.isMatrix3?
{type:"m3",value:value.toArray()}:value&&value.isMatrix4?{type:"m4",value:value.toArray()}:{value:value}}0<Object.keys(this.defines).length&&(data.defines=this.defines);data.vertexShader=this.vertexShader;data.fragmentShader=this.fragmentShader;meta={};for(var key in this.extensions)!0===this.extensions[key]&&(meta[key]=!0);0<Object.keys(meta).length&&(data.extensions=meta);return data};Camera.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Camera,isCamera:!0,copy:function(source,
recursive){Object3D.prototype.copy.call(this,source,recursive);this.matrixWorldInverse.copy(source.matrixWorldInverse);this.projectionMatrix.copy(source.projectionMatrix);this.projectionMatrixInverse.copy(source.projectionMatrixInverse);return this},getWorldDirection:function(target){void 0===target&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),target=new Vector3);this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return target.set(-e[8],-e[9],-e[10]).normalize()},
updateMatrixWorld:function(force){Object3D.prototype.updateMatrixWorld.call(this,force);this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(updateParents,updateChildren){Object3D.prototype.updateWorldMatrix.call(this,updateParents,updateChildren);this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}});PerspectiveCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:PerspectiveCamera,
isPerspectiveCamera:!0,copy:function(source,recursive){Camera.prototype.copy.call(this,source,recursive);this.fov=source.fov;this.zoom=source.zoom;this.near=source.near;this.far=source.far;this.focus=source.focus;this.aspect=source.aspect;this.view=null===source.view?null:Object.assign({},source.view);this.filmGauge=source.filmGauge;this.filmOffset=source.filmOffset;return this},setFocalLength:function(focalLength){focalLength=.5*this.getFilmHeight()/focalLength;this.fov=2*MathUtils.RAD2DEG*Math.atan(focalLength);
this.updateProjectionMatrix()},getFocalLength:function(){var vExtentSlope=Math.tan(.5*MathUtils.DEG2RAD*this.fov);return.5*this.getFilmHeight()/vExtentSlope},getEffectiveFOV:function(){return 2*MathUtils.RAD2DEG*Math.atan(Math.tan(.5*MathUtils.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(fullWidth,fullHeight,x,y,width,height){this.aspect=fullWidth/
fullHeight;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=fullWidth;this.view.fullHeight=fullHeight;this.view.offsetX=x;this.view.offsetY=y;this.view.width=width;this.view.height=height;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var near=this.near,top=near*Math.tan(.5*MathUtils.DEG2RAD*
this.fov)/this.zoom,height=2*top,width=this.aspect*height,left=-.5*width,view=this.view;if(null!==this.view&&this.view.enabled){var fullWidth=view.fullWidth,fullHeight=view.fullHeight;left+=view.offsetX*width/fullWidth;top-=view.offsetY*height/fullHeight;width*=view.width/fullWidth;height*=view.height/fullHeight}view=this.filmOffset;0!==view&&(left+=near*view/this.getFilmWidth());this.projectionMatrix.makePerspective(left,left+width,top,top-height,near,this.far);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},
toJSON:function(meta){meta=Object3D.prototype.toJSON.call(this,meta);meta.object.fov=this.fov;meta.object.zoom=this.zoom;meta.object.near=this.near;meta.object.far=this.far;meta.object.focus=this.focus;meta.object.aspect=this.aspect;null!==this.view&&(meta.object.view=Object.assign({},this.view));meta.object.filmGauge=this.filmGauge;meta.object.filmOffset=this.filmOffset;return meta}});CubeCamera.prototype=Object.create(Object3D.prototype);CubeCamera.prototype.constructor=CubeCamera;CubeTexture.prototype=
Object.create(Texture.prototype);CubeTexture.prototype.constructor=CubeTexture;CubeTexture.prototype.isCubeTexture=!0;Object.defineProperty(CubeTexture.prototype,"images",{get:function(){return this.image},set:function(value){this.image=value}});WebGLCubeRenderTarget.prototype=Object.create(WebGLRenderTarget.prototype);WebGLCubeRenderTarget.prototype.constructor=WebGLCubeRenderTarget;WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget=!0;WebGLCubeRenderTarget.prototype.fromEquirectangularTexture=
function(renderer,texture){this.texture.type=texture.type;this.texture.format=1023;this.texture.encoding=texture.encoding;this.texture.generateMipmaps=texture.generateMipmaps;this.texture.minFilter=texture.minFilter;this.texture.magFilter=texture.magFilter;var geometry=new BoxBufferGeometry(5,5,5),material=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t\t\t\t#include \x3cbegin_vertex\x3e\n\t\t\t\t#include \x3cproject_vertex\x3e\n\n\t\t\t}\n\t\t",
fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include \x3ccommon\x3e\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction \x3d normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV \x3d equirectUv( direction );\n\n\t\t\t\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:1,blending:0});material.uniforms.tEquirect.value=texture;geometry=new Mesh(geometry,material);material=texture.minFilter;1008===texture.minFilter&&(texture.minFilter=
1006);(new CubeCamera(1,10,this)).update(renderer,geometry);texture.minFilter=material;geometry.geometry.dispose();geometry.material.dispose();return this};WebGLCubeRenderTarget.prototype.clear=function(renderer,color,depth,stencil){for(var currentRenderTarget=renderer.getRenderTarget(),i=0;6>i;i++)renderer.setRenderTarget(this,i),renderer.clear(color,depth,stencil);renderer.setRenderTarget(currentRenderTarget)};DataTexture.prototype=Object.create(Texture.prototype);DataTexture.prototype.constructor=
DataTexture;DataTexture.prototype.isDataTexture=!0;var _sphere$1=new Sphere,_vector$5=new Vector3,Frustum=function(){function Frustum(p0,p1,p2,p3,p4,p5){this.planes=[void 0!==p0?p0:new Plane,void 0!==p1?p1:new Plane,void 0!==p2?p2:new Plane,void 0!==p3?p3:new Plane,void 0!==p4?p4:new Plane,void 0!==p5?p5:new Plane]}var _proto=Frustum.prototype;_proto.set=function(p0,p1,p2,p3,p4,p5){var planes=this.planes;planes[0].copy(p0);planes[1].copy(p1);planes[2].copy(p2);planes[3].copy(p3);planes[4].copy(p4);
planes[5].copy(p5);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(frustum){for(var planes=this.planes,i=0;6>i;i++)planes[i].copy(frustum.planes[i]);return this};_proto.setFromProjectionMatrix=function(m){var planes=this.planes,me=m.elements;m=me[0];var me1=me[1],me2=me[2],me3=me[3],me4=me[4],me5=me[5],me6=me[6],me7=me[7],me8=me[8],me9=me[9],me10=me[10],me11=me[11],me12=me[12],me13=me[13],me14=me[14];me=me[15];planes[0].setComponents(me3-m,me7-me4,
me11-me8,me-me12).normalize();planes[1].setComponents(me3+m,me7+me4,me11+me8,me+me12).normalize();planes[2].setComponents(me3+me1,me7+me5,me11+me9,me+me13).normalize();planes[3].setComponents(me3-me1,me7-me5,me11-me9,me-me13).normalize();planes[4].setComponents(me3-me2,me7-me6,me11-me10,me-me14).normalize();planes[5].setComponents(me3+me2,me7+me6,me11+me10,me+me14).normalize();return this};_proto.intersectsObject=function(object){var geometry=object.geometry;null===geometry.boundingSphere&&geometry.computeBoundingSphere();
_sphere$1.copy(geometry.boundingSphere).applyMatrix4(object.matrixWorld);return this.intersectsSphere(_sphere$1)};_proto.intersectsSprite=function(sprite){_sphere$1.center.set(0,0,0);_sphere$1.radius=.7071067811865476;_sphere$1.applyMatrix4(sprite.matrixWorld);return this.intersectsSphere(_sphere$1)};_proto.intersectsSphere=function(sphere){var planes=this.planes,center=sphere.center;sphere=-sphere.radius;for(var i=0;6>i;i++)if(planes[i].distanceToPoint(center)<sphere)return!1;return!0};_proto.intersectsBox=
function(box){for(var planes=this.planes,i=0;6>i;i++){var plane=planes[i];_vector$5.x=0<plane.normal.x?box.max.x:box.min.x;_vector$5.y=0<plane.normal.y?box.max.y:box.min.y;_vector$5.z=0<plane.normal.z?box.max.z:box.min.z;if(0>plane.distanceToPoint(_vector$5))return!1}return!0};_proto.containsPoint=function(point){for(var planes=this.planes,i=0;6>i;i++)if(0>planes[i].distanceToPoint(point))return!1;return!0};return Frustum}(),PlaneBufferGeometry=function(_BufferGeometry){function PlaneBufferGeometry(width,
height,widthSegments,heightSegments){void 0===width&&(width=1);void 0===height&&(height=1);void 0===widthSegments&&(widthSegments=1);void 0===heightSegments&&(heightSegments=1);var _this=_BufferGeometry.call(this)||this;_this.type="PlaneBufferGeometry";_this.parameters={width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};var width_half=width/2,height_half=height/2;widthSegments=Math.floor(widthSegments);heightSegments=Math.floor(heightSegments);var gridX1=widthSegments+
1,gridY1=heightSegments+1,segment_width=width/widthSegments,segment_height=height/heightSegments;height=[];width=[];for(var normals=[],uvs=[],iy=0;iy<gridY1;iy++)for(var y=iy*segment_height-height_half,ix=0;ix<gridX1;ix++)width.push(ix*segment_width-width_half,-y,0),normals.push(0,0,1),uvs.push(ix/widthSegments),uvs.push(1-iy/heightSegments);for(width_half=0;width_half<heightSegments;width_half++)for(height_half=0;height_half<widthSegments;height_half++)gridY1=height_half+gridX1*(width_half+1),segment_width=
height_half+1+gridX1*(width_half+1),segment_height=height_half+1+gridX1*width_half,height.push(height_half+gridX1*width_half,gridY1,segment_height),height.push(gridY1,segment_width,segment_height);_this.setIndex(height);_this.setAttribute("position",new Float32BufferAttribute(width,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(PlaneBufferGeometry,_BufferGeometry);return PlaneBufferGeometry}(BufferGeometry),
ShaderChunk={alphamap_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *\x3d texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment:"\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a \x3c ALPHATEST ) discard;\n\n#endif\n",aomap_fragment:"\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion \x3d ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *\x3d ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD )\n\n\t\tfloat dotNV \x3d saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *\x3d computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",
aomap_pars_fragment:"\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex:"\nvec3 transformed \x3d vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal \x3d vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent \x3d vec3( tangent.xyz );\n\n#endif\n",bsdfs:'\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via \'environmentBRDF\' from "Physically Based Shading on Mobile"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 \x3d vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 \x3d vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r \x3d roughness * c0 + c1;\n\n\tfloat a004 \x3d min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t// but who must be converted to luminous irradiance for surface lighting calculation\n\tfloat distanceFalloff \x3d 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance \x3e 0.0 ) {\n\n\t\tdistanceFalloff *\x3d pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance \x3e 0.0 \x26\x26 decayExponent \x3e 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel \x3d pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel \x3d exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\n\t// See F_Schlick\n\tfloat fresnel \x3d exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr \x3d max( vec3( 1.0 - roughness ), F0 ) - F0;\n\n\treturn Fr * fresnel + F0;\n\n}\n\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term (normalized) \x3d G(l)G(v) / 4(nl)(nv)\n\t// also see #12151\n\n\tfloat a2 \x3d pow2( alpha );\n\n\tfloat gl \x3d dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv \x3d dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 \x3d pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv \x3d dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl \x3d dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 \x3d pow2( alpha );\n\n\tfloat denom \x3d pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha \x3d 0 with dotNH \x3d 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha \x3d pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir \x3d normalize( incidentLight.direction + viewDir );\n\n\tfloat dotNL \x3d saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotLH \x3d saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F \x3d F_Schlick( specularColor, dotLH );\n\n\tfloat G \x3d G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D \x3d D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE \x3d 64.0;\n\tconst float LUT_SCALE \x3d ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS \x3d 0.5 / LUT_SIZE;\n\n\tfloat dotNV \x3d saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv \x3d vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv \x3d uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l \x3d length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x \x3d dot( v1, v2 );\n\n\tfloat y \x3d abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a \x3d 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b \x3d 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v \x3d a / b;\n\n\tfloat theta_sintheta \x3d ( x \x3e 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 \x3d rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 \x3d rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal \x3d cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) \x3c 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 \x3d normalize( V - N * dot( V, N ) );\n\tT2 \x3d - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat \x3d mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] \x3d mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] \x3d mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] \x3d mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] \x3d mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] \x3d normalize( coords[ 0 ] );\n\tcoords[ 1 ] \x3d normalize( coords[ 1 ] );\n\tcoords[ 2 ] \x3d normalize( coords[ 2 ] );\n\tcoords[ 3 ] \x3d normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor \x3d vec3( 0.0 );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result \x3d LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len \x3d length( vectorFormFactor );\n\tfloat z \x3d vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE \x3d 64.0;\n\tconst float LUT_SCALE \x3d ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS \x3d 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv \x3d vec2( z * 0.5 + 0.5, len );\n\tuv \x3d uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale \x3d texture2D( ltc_2, uv ).w;\n\n\tfloat result \x3d len * scale;\n*/\n\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\n\tvec2 brdf \x3d integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} // validated\n\n// Fdez-Agera\'s "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"\n// Approximates multiscattering in order to preserve energy.\n// http://www.jcgt.org/published/0008/01/03/\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV \x3d saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F \x3d F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf \x3d integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss \x3d F * brdf.x + brdf.y;\n\n\tfloat Ess \x3d brdf.x + brdf.y;\n\tfloat Ems \x3d 1.0 - Ess;\n\n\tvec3 Favg \x3d specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21\n\tvec3 Fms \x3d FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter +\x3d FssEss;\n\tmultiScatter +\x3d Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir \x3d normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL \x3d saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV \x3d saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH \x3d saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH \x3d saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F \x3d F_Schlick( specularColor, dotLH );\n\n\tfloat G \x3d G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D \x3d D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n\n#if defined( USE_SHEEN )\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L94\nfloat D_Charlie(float roughness, float NoH) {\n\t// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"\n\tfloat invAlpha \x3d 1.0 / roughness;\n\tfloat cos2h \x3d NoH * NoH;\n\tfloat sin2h \x3d max(1.0 - cos2h, 0.0078125); // 2^(-14/2), so sin2h^2 \x3e 0 in fp16\n\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L136\nfloat V_Neubelt(float NoV, float NoL) {\n\t// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\n\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\n\tvec3 N \x3d geometry.normal;\n\tvec3 V \x3d geometry.viewDir;\n\n\tvec3 H \x3d normalize( V + L );\n\tfloat dotNH \x3d saturate( dot( N, H ) );\n\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n\n}\n\n#endif\n',
bumpmap_pars_fragment:"\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx \x3d dFdx( vUv );\n\t\tvec2 dSTdy \x3d dFdy( vUv );\n\n\t\tfloat Hll \x3d bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx \x3d bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy \x3d bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX \x3d vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY \x3d vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN \x3d surf_norm;\t\t// normalized\n\n\t\tvec3 R1 \x3d cross( vSigmaY, vN );\n\t\tvec3 R2 \x3d cross( vN, vSigmaX );\n\n\t\tfloat fDet \x3d dot( vSigmaX, R1 );\n\n\t\tfDet *\x3d ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad \x3d sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",
clipping_planes_fragment:"\n#if NUM_CLIPPING_PLANES \x3e 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane \x3d clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) discard;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\n\t\tbool clipped \x3d true;\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tclipped \x3d ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) \x26\x26 clipped;\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",
clipping_planes_pars_fragment:"\n#if NUM_CLIPPING_PLANES \x3e 0\n\n\tvarying vec3 vClipPosition;\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex:"\n#if NUM_CLIPPING_PLANES \x3e 0\n\n\tvarying vec3 vClipPosition;\n\n#endif\n",clipping_planes_vertex:"\n#if NUM_CLIPPING_PLANES \x3e 0\n\n\tvClipPosition \x3d - mvPosition.xyz;\n\n#endif\n",color_fragment:"\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *\x3d vColor;\n\n#endif\n",color_pars_fragment:"\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",
color_pars_vertex:"\n#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex:"\n#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvColor \x3d vec3( 1.0 );\n\n#endif\n\n#ifdef USE_COLOR\n\n\tvColor.xyz *\x3d color.xyz;\n\n#endif\n\n#ifdef USE_INSTANCING_COLOR\n\n\tvColor.xyz *\x3d instanceColor.xyz;\n\n#endif\n",common:"\n#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n\n#ifndef saturate\n// \x3ctonemapping_pars_fragment\x3e may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 \x3d x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a \x3d 12.9898, b \x3d 78.233, c \x3d 43758.5453;\n\thighp float dt \x3d dot( uv.xy, vec2( a,b ) ), sn \x3d mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent \x3d max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t// dir can be either a direction vector or a normal vector\n\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance \x3d dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] \x3d vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] \x3d vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] \x3d vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights \x3d vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n\treturn m[ 2 ][ 3 ] \x3d\x3d - 1.0;\n\n}\n\nvec2 equirectUv( in vec3 dir ) {\n\n\t// dir is assumed to be unit length\n\n\tfloat u \x3d atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tfloat v \x3d asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\treturn vec2( u, v );\n\n}\n",
cube_uv_reflection_fragment:"\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\n\t// These shader functions convert between the UV coordinates of a single face of\n\t// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n\t// sampling a textureCube (not generally normalized ).\n\n\tfloat getFace( vec3 direction ) {\n\n\t\tvec3 absDirection \x3d abs( direction );\n\n\t\tfloat face \x3d - 1.0;\n\n\t\tif ( absDirection.x \x3e absDirection.z ) {\n\n\t\t\tif ( absDirection.x \x3e absDirection.y )\n\n\t\t\t\tface \x3d direction.x \x3e 0.0 ? 0.0 : 3.0;\n\n\t\t\telse\n\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\n\t\t} else {\n\n\t\t\tif ( absDirection.z \x3e absDirection.y )\n\n\t\t\t\tface \x3d direction.z \x3e 0.0 ? 2.0 : 5.0;\n\n\t\t\telse\n\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\n\t\t}\n\n\t\treturn face;\n\n\t}\n\n\t// RH coordinate system; PMREM face-indexing convention\n\tvec2 getUV( vec3 direction, float face ) {\n\n\t\tvec2 uv;\n\n\t\tif ( face \x3d\x3d 0.0 ) {\n\n\t\t\tuv \x3d vec2( direction.z, direction.y ) / abs( direction.x ); // pos x\n\n\t\t} else if ( face \x3d\x3d 1.0 ) {\n\n\t\t\tuv \x3d vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y\n\n\t\t} else if ( face \x3d\x3d 2.0 ) {\n\n\t\t\tuv \x3d vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z\n\n\t\t} else if ( face \x3d\x3d 3.0 ) {\n\n\t\t\tuv \x3d vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x\n\n\t\t} else if ( face \x3d\x3d 4.0 ) {\n\n\t\t\tuv \x3d vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y\n\n\t\t} else {\n\n\t\t\tuv \x3d vec2( direction.x, direction.y ) / abs( direction.z ); // neg z\n\n\t\t}\n\n\t\treturn 0.5 * ( uv + 1.0 );\n\n\t}\n\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\n\t\tfloat face \x3d getFace( direction );\n\n\t\tfloat filterInt \x3d max( cubeUV_minMipLevel - mipInt, 0.0 );\n\n\t\tmipInt \x3d max( mipInt, cubeUV_minMipLevel );\n\n\t\tfloat faceSize \x3d exp2( mipInt );\n\n\t\tfloat texelSize \x3d 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\n\t\tvec2 uv \x3d getUV( direction, face ) * ( faceSize - 1.0 );\n\n\t\tvec2 f \x3d fract( uv );\n\n\t\tuv +\x3d 0.5 - f;\n\n\t\tif ( face \x3e 2.0 ) {\n\n\t\t\tuv.y +\x3d faceSize;\n\n\t\t\tface -\x3d 3.0;\n\n\t\t}\n\n\t\tuv.x +\x3d face * faceSize;\n\n\t\tif ( mipInt \x3c cubeUV_maxMipLevel ) {\n\n\t\t\tuv.y +\x3d 2.0 * cubeUV_maxTileSize;\n\n\t\t}\n\n\t\tuv.y +\x3d filterInt * 2.0 * cubeUV_minTileSize;\n\n\t\tuv.x +\x3d 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\n\t\tuv *\x3d texelSize;\n\n\t\tvec3 tl \x3d envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x +\x3d texelSize;\n\n\t\tvec3 tr \x3d envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.y +\x3d texelSize;\n\n\t\tvec3 br \x3d envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x -\x3d texelSize;\n\n\t\tvec3 bl \x3d envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tvec3 tm \x3d mix( tl, tr, f.x );\n\n\t\tvec3 bm \x3d mix( bl, br, f.x );\n\n\t\treturn mix( tm, bm, f.y );\n\n\t}\n\n\t// These defines must match with PMREMGenerator\n\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\n\tfloat roughnessToMip( float roughness ) {\n\n\t\tfloat mip \x3d 0.0;\n\n\t\tif ( roughness \x3e\x3d r1 ) {\n\n\t\t\tmip \x3d ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\n\t\t} else if ( roughness \x3e\x3d r4 ) {\n\n\t\t\tmip \x3d ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\n\t\t} else if ( roughness \x3e\x3d r5 ) {\n\n\t\t\tmip \x3d ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\n\t\t} else if ( roughness \x3e\x3d r6 ) {\n\n\t\t\tmip \x3d ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\n\t\t} else {\n\n\t\t\tmip \x3d - 2.0 * log2( 1.16 * roughness ); // 1.16 \x3d 1.79^0.25\n\t\t}\n\n\t\treturn mip;\n\n\t}\n\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\n\t\tfloat mip \x3d clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\n\t\tfloat mipF \x3d fract( mip );\n\n\t\tfloat mipInt \x3d floor( mip );\n\n\t\tvec3 color0 \x3d bilinearCubeUV( envMap, sampleDir, mipInt );\n\n\t\tif ( mipF \x3d\x3d 0.0 ) {\n\n\t\t\treturn vec4( color0, 1.0 );\n\n\t\t} else {\n\n\t\t\tvec3 color1 \x3d bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\n\t\t}\n\n\t}\n\n#endif\n",
defaultnormal_vertex:"\nvec3 transformedNormal \x3d objectNormal;\n\n#ifdef USE_INSTANCING\n\n\t// this is in lieu of a per-instance normal-matrix\n\t// shear transforms in the instance matrix are not supported\n\n\tmat3 m \x3d mat3( instanceMatrix );\n\n\ttransformedNormal /\x3d vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\n\ttransformedNormal \x3d m * transformedNormal;\n\n#endif\n\ntransformedNormal \x3d normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal \x3d - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent \x3d ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent \x3d - transformedTangent;\n\n\t#endif\n\n#endif\n",
displacementmap_pars_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed +\x3d normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor \x3d texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb \x3d emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *\x3d emissiveColor.rgb;\n\n#endif\n",
emissivemap_pars_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment:"\ngl_FragColor \x3d linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent \x3d max( max( value.r, value.g ), value.b );\n\tfloat fExp \x3d clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n\t// return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB \x3d max( value.r, max( value.g, value.b ) );\n\tfloat M \x3d clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM \x3d ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB \x3d max( value.r, max( value.g, value.b ) );\n\tfloat D \x3d max( maxRange / maxRGB, 1.0 );\n\t// NOTE: The implementation with min causes the shader to not compile on\n\t// a common Alcatel A502DL in Chrome 78/Android 8.1. Some research suggests \n\t// that the chipset is Mediatek MT6739 w/ IMG PowerVR GE8100 GPU.\n\t// D \x3d min( floor( D ) / 255.0, 1.0 );\n\tD \x3d clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM \x3d mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp \x3d cLogLuvM * value.rgb;\n\tXp_Y_XYZp \x3d max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy \x3d Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le \x3d 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w \x3d fract( Le );\n\tvResult.z \x3d ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM \x3d mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le \x3d value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y \x3d exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z \x3d Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x \x3d value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB \x3d cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",
envmap_fragment:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToFrag \x3d normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec \x3d reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec \x3d refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec \x3d vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor \x3d textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor \x3d textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#else\n\n\t\tvec4 envColor \x3d vec4( 0.0 );\n\n\t#endif\n\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\tenvColor \x3d envMapTexelToLinear( envColor );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight \x3d mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight \x3d mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight +\x3d envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",
envmap_common_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n",envmap_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",
envmap_pars_vertex:"\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_physical_pars_fragment:"\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\n\tvec3 getLightProbeIndirectIrradiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal \x3d inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec \x3d vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor \x3d textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor \x3d textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb \x3d envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor \x3d vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// Trowbridge-Reitz distribution to Mip level, following the logic of http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\n\t\tfloat maxMIPLevelScalar \x3d float( maxMIPLevel );\n\n\t\tfloat sigma \x3d PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel \x3d maxMIPLevelScalar + log2( sigma );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance( /*const in SpecularLightProbe specularLightProbe,*/ const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec \x3d reflect( -viewDir, normal );\n\n\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\treflectVec \x3d normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec \x3d refract( -viewDir, normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec \x3d inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel \x3d getSpecularMIPLevel( roughness, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec \x3d vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor \x3d textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor \x3d textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb \x3d envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",
envmap_vertex:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition \x3d worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToVertex \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex \x3d normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect \x3d reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect \x3d refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",
fog_vertex:"\n#ifdef USE_FOG\n\n\tfogDepth \x3d - mvPosition.z;\n\n#endif\n",fog_pars_vertex:"\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment:"\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor \x3d 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\n\t#else\n\n\t\tfloat fogFactor \x3d smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb \x3d mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment:"\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",
gradientmap_pars_fragment:"\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t// dotNL will be from -1.0 to 1.0\n\tfloat dotNL \x3d dot( normal, lightDirection );\n\tvec2 coord \x3d vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x \x3c 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n",lightmap_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel\x3d texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse +\x3d PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n",
lightmap_pars_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex:"\nvec3 diffuse \x3d vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position \x3d mvPosition.xyz;\ngeometry.normal \x3d normalize( transformedNormal );\ngeometry.viewDir \x3d ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position \x3d geometry.position;\nbackGeometry.normal \x3d -geometry.normal;\nbackGeometry.viewDir \x3d geometry.viewDir;\n\nvLightFront \x3d vec3( 0.0 );\nvIndirectFront \x3d vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack \x3d vec3( 0.0 );\n\tvIndirectBack \x3d vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\nvIndirectFront +\x3d getAmbientLightIrradiance( ambientLightColor );\n\nvIndirectFront +\x3d getLightProbeIrradiance( lightProbe, geometry );\n\n#ifdef DOUBLE_SIDED\n\n\tvIndirectBack +\x3d getAmbientLightIrradiance( ambientLightColor );\n\n\tvIndirectBack +\x3d getLightProbeIrradiance( lightProbe, backGeometry );\n\n#endif\n\n#if NUM_POINT_LIGHTS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL \x3d dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse \x3d PI * directLight.color;\n\n\t\tvLightFront +\x3d saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack +\x3d saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_SPOT_LIGHTS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL \x3d dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse \x3d PI * directLight.color;\n\n\t\tvLightFront +\x3d saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack +\x3d saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n/*\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\tfor ( int i \x3d 0; i \x3c NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\t// TODO (abelnation): implement\n\n\t}\n\n#endif\n*/\n\n#if NUM_DIR_LIGHTS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL \x3d dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse \x3d PI * directLight.color;\n\n\t\tvLightFront +\x3d saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack +\x3d saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_HEMI_LIGHTS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n",
lights_pars_begin:"\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\n\n// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\n\t// normal is assumed to have unit length\n\n\tfloat x \x3d normal.x, y \x3d normal.y, z \x3d normal.z;\n\n\t// band 0\n\tvec3 result \x3d shCoefficients[ 0 ] * 0.886227;\n\n\t// band 1\n\tresult +\x3d shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult +\x3d shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult +\x3d shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\n\t// band 2\n\tresult +\x3d shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult +\x3d shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult +\x3d shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult +\x3d shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult +\x3d shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\n\tvec3 worldNormal \x3d inverseTransformDirection( geometry.normal, viewMatrix );\n\n\tvec3 irradiance \x3d shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance \x3d ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *\x3d PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS \x3e 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color \x3d directionalLight.color;\n\t\tdirectLight.direction \x3d directionalLight.direction;\n\t\tdirectLight.visible \x3d true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS \x3e 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector \x3d pointLight.position - geometry.position;\n\t\tdirectLight.direction \x3d normalize( lVector );\n\n\t\tfloat lightDistance \x3d length( lVector );\n\n\t\tdirectLight.color \x3d pointLight.color;\n\t\tdirectLight.color *\x3d punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible \x3d ( directLight.color !\x3d vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS \x3e 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector \x3d spotLight.position - geometry.position;\n\t\tdirectLight.direction \x3d normalize( lVector );\n\n\t\tfloat lightDistance \x3d length( lVector );\n\t\tfloat angleCos \x3d dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos \x3e spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect \x3d smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color \x3d spotLight.color;\n\t\t\tdirectLight.color *\x3d spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible \x3d true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color \x3d vec3( 0.0 );\n\t\t\tdirectLight.visible \x3d false;\n\n\t\t}\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS \x3e 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL \x3d dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight \x3d 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance \x3d mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *\x3d PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",
lights_toon_fragment:"\nToonMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\n",lights_toon_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct ToonMaterial {\n\n\tvec3 diffuseColor;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance \x3d getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *\x3d PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n",
lights_phong_fragment:"\nBlinnPhongMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularColor \x3d specular;\nmaterial.specularShininess \x3d shininess;\nmaterial.specularStrength \x3d specularStrength;\n",lights_phong_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL \x3d saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *\x3d PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",
lights_physical_fragment:"\nPhysicalMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy \x3d max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness \x3d max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.specularRoughness \x3d max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness +\x3d geometryRoughness;\nmaterial.specularRoughness \x3d min( material.specularRoughness, 1.0 );\n\n#ifdef REFLECTIVITY\n\n\tmaterial.specularColor \x3d mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor \x3d mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\n#endif\n\n#ifdef CLEARCOAT\n\n\tmaterial.clearcoat \x3d clearcoat;\n\tmaterial.clearcoatRoughness \x3d clearcoatRoughness;\n\n\t#ifdef USE_CLEARCOATMAP\n\n\t\tmaterial.clearcoat *\x3d texture2D( clearcoatMap, vUv ).x;\n\n\t#endif\n\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\t\tmaterial.clearcoatRoughness *\x3d texture2D( clearcoatRoughnessMap, vUv ).y;\n\n\t#endif\n\n\tmaterial.clearcoat \x3d saturate( material.clearcoat ); // Burley clearcoat model\n\tmaterial.clearcoatRoughness \x3d max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness +\x3d geometryRoughness;\n\tmaterial.clearcoatRoughness \x3d min( material.clearcoatRoughness, 1.0 );\n\n#endif\n\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor \x3d sheen;\n\n#endif\n",
lights_physical_pars_fragment:"\nstruct PhysicalMaterial {\n\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal \x3d geometry.normal;\n\t\tvec3 viewDir \x3d geometry.viewDir;\n\t\tvec3 position \x3d geometry.position;\n\t\tvec3 lightPos \x3d rectAreaLight.position;\n\t\tvec3 halfWidth \x3d rectAreaLight.halfWidth;\n\t\tvec3 halfHeight \x3d rectAreaLight.halfHeight;\n\t\tvec3 lightColor \x3d rectAreaLight.color;\n\t\tfloat roughness \x3d material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] \x3d lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction\n\t\trectCoords[ 1 ] \x3d lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] \x3d lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] \x3d lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv \x3d LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 \x3d texture2D( ltc_1, uv );\n\t\tvec4 t2 \x3d texture2D( ltc_2, uv );\n\n\t\tmat3 mInv \x3d mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel \x3d ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular +\x3d lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse +\x3d lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL \x3d saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *\x3d PI; // punctual light\n\n\t#endif\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNL \x3d saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance \x3d ccDotNL * directLight.color;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tccIrradiance *\x3d PI; // punctual light\n\n\t\t#endif\n\n\t\tfloat clearcoatDHR \x3d material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t\treflectedLight.directSpecular +\x3d ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t#else\n\n\t\tfloat clearcoatDHR \x3d 0.0;\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular +\x3d ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular +\x3d ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\n\treflectedLight.directDiffuse +\x3d ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNV \x3d saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular +\x3d clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t\tfloat ccDotNL \x3d ccDotNV;\n\t\tfloat clearcoatDHR \x3d material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t#else\n\n\t\tfloat clearcoatDHR \x3d 0.0;\n\n\t#endif\n\n\tfloat clearcoatInv \x3d 1.0 - clearcoatDHR;\n\n\t// Both indirect specular and indirect diffuse light accumulate here\n\n\tvec3 singleScattering \x3d vec3( 0.0 );\n\tvec3 multiScattering \x3d vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance \x3d irradiance * RECIPROCAL_PI;\n\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\tvec3 diffuse \x3d material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular +\x3d clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular +\x3d multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse +\x3d diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",
lights_fragment_begin:"\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. \x3c---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position \x3d - vViewPosition;\ngeometry.normal \x3d normal;\ngeometry.viewDir \x3d ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal \x3d clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight \x3d pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow \x3d pointLightShadows[ i ];\n\t\tdirectLight.color *\x3d all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight \x3d spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow \x3d spotLightShadows[ i ];\n\t\tdirectLight.color *\x3d all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight \x3d directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow \x3d directionalLightShadows[ i ];\n\t\tdirectLight.color *\x3d all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight \x3d rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance \x3d vec3( 0.0 );\n\n\tvec3 irradiance \x3d getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance +\x3d getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS \x3e 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance \x3d vec3( 0.0 );\n\tvec3 clearcoatRadiance \x3d vec3( 0.0 );\n\n#endif\n",
lights_fragment_maps:"\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel\x3d texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance \x3d lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *\x3d PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance +\x3d lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD ) \x26\x26 defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance +\x3d getLightProbeIndirectIrradiance( /*lightProbe,*/ geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) \x26\x26 defined( RE_IndirectSpecular )\n\n\tradiance +\x3d getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\n\t#ifdef CLEARCOAT\n\n\t\tclearcoatRadiance +\x3d getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\n\t#endif\n\n#endif\n",
lights_fragment_end:"\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment:"\n#if defined( USE_LOGDEPTHBUF ) \x26\x26 defined( USE_LOGDEPTHBUF_EXT )\n\n\t// Doing a strict comparison with \x3d\x3d 1.0 can cause noise artifacts\n\t// on some platforms. See issue #17623.\n\tgl_FragDepthEXT \x3d vIsPerspective \x3d\x3d 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",
logdepthbuf_pars_fragment:"\n#if defined( USE_LOGDEPTHBUF ) \x26\x26 defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n",logdepthbuf_pars_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth \x3d 1.0 + gl_Position.w;\n\t\tvIsPerspective \x3d float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z \x3d log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *\x3d gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n",
map_fragment:"\n#ifdef USE_MAP\n\n\tvec4 texelColor \x3d texture2D( map, vUv );\n\n\ttexelColor \x3d mapTexelToLinear( texelColor );\n\tdiffuseColor *\x3d texelColor;\n\n#endif\n",map_pars_fragment:"\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv \x3d ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel \x3d texture2D( map, uv );\n\tdiffuseColor *\x3d mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *\x3d texture2D( alphaMap, uv ).g;\n\n#endif\n",
map_particle_pars_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",metalnessmap_fragment:"\nfloat metalnessFactor \x3d metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness \x3d texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *\x3d texelMetalness.b;\n\n#endif\n",
metalnessmap_pars_fragment:"\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex:"\n#ifdef USE_MORPHNORMALS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal \x3d sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\tobjectNormal *\x3d morphTargetBaseInfluence;\n\tobjectNormal +\x3d morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal +\x3d morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal +\x3d morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal +\x3d morphNormal3 * morphTargetInfluences[ 3 ];\n\n#endif\n",
morphtarget_pars_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifndef USE_MORPHNORMALS\n\n\t\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\t\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position \x3d sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\ttransformed *\x3d morphTargetBaseInfluence;\n\ttransformed +\x3d morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed +\x3d morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed +\x3d morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed +\x3d morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\t\ttransformed +\x3d morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed +\x3d morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed +\x3d morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed +\x3d morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",
normal_fragment_begin:"\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n\n\tvec3 fdx \x3d vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy \x3d vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal \x3d normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal \x3d normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal \x3d normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent \x3d normalize( vTangent );\n\t\tvec3 bitangent \x3d normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent \x3d tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent \x3d bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN \x3d mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n\n// non perturbed normal for clearcoat among others\n\nvec3 geometryNormal \x3d normal;\n\n",
normal_fragment_maps:"\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal \x3d texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal \x3d - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal \x3d normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\tnormal \x3d normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN \x3d texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *\x3d normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal \x3d normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal \x3d perturbNormal2Arb( -vViewPosition, normal, mapN );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal \x3d perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",
normalmap_pars_fragment:"\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) \x26\x26 ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 \x3d vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 \x3d vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 \x3d dFdx( vUv.st );\n\t\tvec2 st1 \x3d dFdy( vUv.st );\n\n\t\tfloat scale \x3d sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\tvec3 S \x3d normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T \x3d normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N \x3d normalize( surf_norm );\n\n\t\tmat3 tsn \x3d mat3( S, T, N );\n\n\t\tmapN.xy *\x3d ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",
clearcoat_normal_fragment_begin:"\n#ifdef CLEARCOAT\n\n\tvec3 clearcoatNormal \x3d geometryNormal;\n\n#endif\n",clearcoat_normal_fragment_maps:"\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN \x3d texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *\x3d clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal \x3d normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal \x3d perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\n\t#endif\n\n#endif\n",
clearcoat_pars_fragment:"\n\n#ifdef USE_CLEARCOATMAP\n\n\tuniform sampler2D clearcoatMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\tuniform sampler2D clearcoatRoughnessMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n",packing:"\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale \x3d 256. / 255.; // fraction -\x3e 0..1 (including 1)\nconst float UnpackDownscale \x3d 255. / 256.; // 0..1 -\x3e fraction (excluding 1)\n\nconst vec3 PackFactors \x3d vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors \x3d UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 \x3d 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r \x3d vec4( fract( v * PackFactors ), v );\n\tr.yzw -\x3d r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r \x3d vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\n\n// NOTE: viewZ/eyeZ is \x3c 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
premultiplied_alpha_fragment:"\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *\x3d gl_FragColor.a;\n\n#endif\n",project_vertex:"\nvec4 mvPosition \x3d vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition \x3d instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition \x3d modelViewMatrix * mvPosition;\n\ngl_Position \x3d projectionMatrix * mvPosition;\n",dithering_fragment:"\n#ifdef DITHERING\n\n\tgl_FragColor.rgb \x3d dithering( gl_FragColor.rgb );\n\n#endif\n",
dithering_pars_fragment:"\n#ifdef DITHERING\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position \x3d rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB \x3d vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB \x3d mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",
roughnessmap_fragment:"\nfloat roughnessFactor \x3d roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness \x3d texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *\x3d texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment:"\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion \x3d 1.0;\n\n\t\tvec2 distribution \x3d texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow \x3d step( compare , distribution.x ); // Hard Shadow\n\n\t\tif (hard_shadow !\x3d 1.0 ) {\n\n\t\t\tfloat distance \x3d compare - distribution.x ;\n\t\t\tfloat variance \x3d max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability \x3d variance / (variance + distance * distance ); // Chebeyshevs inequality\n\t\t\tsoftness_probability \x3d clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n\t\t\tocclusion \x3d clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow \x3d 1.0;\n\n\t\tshadowCoord.xyz /\x3d shadowCoord.w;\n\t\tshadowCoord.z +\x3d shadowBias;\n\n\t\t// if ( something \x26\x26 something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec \x3d bvec4 ( shadowCoord.x \x3e\x3d 0.0, shadowCoord.x \x3c\x3d 1.0, shadowCoord.y \x3e\x3d 0.0, shadowCoord.y \x3c\x3d 1.0 );\n\t\tbool inFrustum \x3d all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec \x3d bvec2( inFrustum, shadowCoord.z \x3c\x3d 1.0 );\n\n\t\tbool frustumTest \x3d all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 \x3d - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 \x3d - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 \x3d + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 \x3d + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 \x3d dx0 / 2.0;\n\t\t\tfloat dy2 \x3d dy0 / 2.0;\n\t\t\tfloat dx3 \x3d dx1 / 2.0;\n\t\t\tfloat dy3 \x3d dy1 / 2.0;\n\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx \x3d texelSize.x;\n\t\t\tfloat dy \x3d texelSize.y;\n\n\t\t\tvec2 uv \x3d shadowCoord.xy;\n\t\t\tvec2 f \x3d fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -\x3d f * texelSize;\n\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow \x3d VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow \x3d texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//\ty Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV \x3d abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube \x3d 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *\x3d scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *\x3d scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim\t\t:\x3d ( 4 , 2 )\n\t\t//\t# #\t\tcenter :\x3d ( 1 , 1 )\n\n\t\tvec2 planar \x3d v.xy;\n\n\t\tfloat almostATexel \x3d 1.5 * texelSizeY;\n\t\tfloat almostOne \x3d 1.0 - almostATexel;\n\n\t\tif ( absV.z \x3e\x3d almostOne ) {\n\n\t\t\tif ( v.z \x3e 0.0 )\n\t\t\t\tplanar.x \x3d 4.0 - v.x;\n\n\t\t} else if ( absV.x \x3e\x3d almostOne ) {\n\n\t\t\tfloat signX \x3d sign( v.x );\n\t\t\tplanar.x \x3d v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y \x3e\x3d almostOne ) {\n\n\t\t\tfloat signY \x3d sign( v.y );\n\t\t\tplanar.x \x3d v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y \x3d v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale :\x3d 0.5 / dim\n\t\t// translate :\x3d ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize \x3d vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition \x3d shadowCoord.xyz;\n\n\t\t// dp \x3d normalized distance from light to fragment position\n\t\tfloat dp \x3d ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp +\x3d shadowBias;\n\n\t\t// bd3D \x3d base direction 3D\n\t\tvec3 bd3D \x3d normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset \x3d vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",
shadowmap_pars_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n",
shadowmap_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0 || NUM_SPOT_LIGHT_SHADOWS \x3e 0 || NUM_POINT_LIGHT_SHADOWS \x3e 0\n\n\t\t// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.\n\t\tvec3 shadowWorldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\n\t#endif\n\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] \x3d directionalShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] \x3d spotShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] \x3d pointShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n",
shadowmask_pars_fragment:"\nfloat getShadowMask() {\n\n\tfloat shadow \x3d 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\n\tDirectionalLightShadow directionalLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight \x3d directionalLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\n\tSpotLightShadow spotLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight \x3d spotLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\n\tPointLightShadow pointLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight \x3d pointLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS \x3e 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n",
skinbase_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX \x3d getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY \x3d getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ \x3d getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW \x3d getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex:"\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j \x3d i * 4.0;\n\t\t\tfloat x \x3d mod( j, float( boneTextureSize ) );\n\t\t\tfloat y \x3d floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx \x3d 1.0 / float( boneTextureSize );\n\t\t\tfloat dy \x3d 1.0 / float( boneTextureSize );\n\n\t\t\ty \x3d dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 \x3d texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 \x3d texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 \x3d texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 \x3d texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone \x3d mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone \x3d boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",
skinning_vertex:"\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex \x3d bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned \x3d vec4( 0.0 );\n\tskinned +\x3d boneMatX * skinVertex * skinWeight.x;\n\tskinned +\x3d boneMatY * skinVertex * skinWeight.y;\n\tskinned +\x3d boneMatZ * skinVertex * skinWeight.z;\n\tskinned +\x3d boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed \x3d ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix \x3d mat4( 0.0 );\n\tskinMatrix +\x3d skinWeight.x * boneMatX;\n\tskinMatrix +\x3d skinWeight.y * boneMatY;\n\tskinMatrix +\x3d skinWeight.z * boneMatZ;\n\tskinMatrix +\x3d skinWeight.w * boneMatW;\n\tskinMatrix \x3d bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal \x3d vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent \x3d vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",
specularmap_fragment:"\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular \x3d texture2D( specularMap, vUv );\n\tspecularStrength \x3d texelSpecular.r;\n\n#else\n\n\tspecularStrength \x3d 1.0;\n\n#endif\n",specularmap_pars_fragment:"\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment:"\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb \x3d toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment:"\n#ifndef saturate\n// \x3ccommon\x3e may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *\x3d toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvec3 RRTAndODTFit( vec3 v ) {\n\n\tvec3 a \x3d v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b \x3d v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n\n}\n\n// this implementation of ACES is modified to accommodate a brighter viewing environment.\n// the scale factor of 1/0.6 is subjective. see discussion in #19621.\n\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\t// sRGB \x3d\x3e XYZ \x3d\x3e D65_2_D60 \x3d\x3e AP1 \x3d\x3e RRT_SAT\n\tconst mat3 ACESInputMat \x3d mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ), // transposed from source\n\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\n\t// ODT_SAT \x3d\x3e XYZ \x3d\x3e D60_2_D65 \x3d\x3e sRGB\n\tconst mat3 ACESOutputMat \x3d mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ), // transposed from source\n\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\n\tcolor *\x3d toneMappingExposure / 0.6;\n\n\tcolor \x3d ACESInputMat * color;\n\n\t// Apply RRT and ODT\n\tcolor \x3d RRTAndODTFit( color );\n\n\tcolor \x3d ACESOutputMat * color;\n\n\t// Clamp to [0, 1]\n\treturn saturate( color );\n\n}\n\nvec3 CustomToneMapping( vec3 color ) { return color; }\n",
transmissionmap_fragment:"\n#ifdef USE_TRANSMISSIONMAP\n\n\ttotalTransmission *\x3d texture2D( transmissionMap, vUv ).r;\n\n#endif\n",transmissionmap_pars_fragment:"\n#ifdef USE_TRANSMISSIONMAP\n\n\tuniform sampler2D transmissionMap;\n\n#endif\n",uv_pars_fragment:"\n#if ( defined( USE_UV ) \x26\x26 ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex:"\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n",
uv_vertex:"\n#ifdef USE_UV\n\n\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n",uv2_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 \x3d ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n",worldpos_vertex:"\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition \x3d vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition \x3d instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition \x3d modelMatrix * worldPosition;\n\n#endif\n",
background_frag:"\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor \x3d texture2D( t2D, vUv );\n\n\tgl_FragColor \x3d mapTexelToLinear( texColor );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\n}\n",background_vert:"\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position \x3d vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag:"\n#include \x3cenvmap_common_pars_fragment\x3e\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include \x3ccube_uv_reflection_fragment\x3e\n\nvoid main() {\n\n\tvec3 vReflect \x3d vWorldDirection;\n\t#include \x3cenvmap_fragment\x3e\n\n\tgl_FragColor \x3d envColor;\n\tgl_FragColor.a *\x3d opacity;\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\n}\n",
cube_vert:"\nvarying vec3 vWorldDirection;\n\n#include \x3ccommon\x3e\n\nvoid main() {\n\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\n\tgl_Position.z \x3d gl_Position.w; // set z to camera.far\n\n}\n",depth_frag:"\n#if DEPTH_PACKING \x3d\x3d 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\n\t\tdiffuseColor.a \x3d opacity;\n\n\t#endif\n\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ \x3d 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\n\t\tgl_FragColor \x3d vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t#elif DEPTH_PACKING \x3d\x3d 3201\n\n\t\tgl_FragColor \x3d packDepthToRGBA( fragCoordZ );\n\n\t#endif\n\n}\n",
depth_vert:"\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\n\t#include \x3cskinbase_vertex\x3e\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\n\t#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\tvHighPrecisionZW \x3d gl_Position.zw;\n\n}\n",
distanceRGBA_frag:"\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main () {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\n\tfloat dist \x3d length( vWorldPosition - referencePosition );\n\tdist \x3d ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist \x3d saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor \x3d packDepthToRGBA( dist );\n\n}\n",
distanceRGBA_vert:"\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\n\t#include \x3cskinbase_vertex\x3e\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\n\t#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\tvWorldPosition \x3d worldPosition.xyz;\n\n}\n",
equirect_frag:"\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include \x3ccommon\x3e\n\nvoid main() {\n\n\tvec3 direction \x3d normalize( vWorldDirection );\n\n\tvec2 sampleUV \x3d equirectUv( direction );\n\n\tvec4 texColor \x3d texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor \x3d mapTexelToLinear( texColor );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\n}\n",equirect_vert:"\nvarying vec3 vWorldDirection;\n\n#include \x3ccommon\x3e\n\nvoid main() {\n\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\n}\n",
linedashed_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tif ( mod( vLineDistance, totalSize ) \x3e dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\n\toutgoingLight \x3d diffuseColor.rgb; // simple shader\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\n}\n",
linedashed_vert:"\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\tvLineDistance \x3d scale * lineDistance;\n\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
meshbasic_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cuv2_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel\x3d texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse +\x3d lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse +\x3d vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include \x3caomap_fragment\x3e\n\n\treflectedLight.indirectDiffuse *\x3d diffuseColor.rgb;\n\n\tvec3 outgoingLight \x3d reflectedLight.indirectDiffuse;\n\n\t#include \x3cenvmap_fragment\x3e\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n\n}\n",
meshbasic_vert:"\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cuv2_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cuv2_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\n\t#ifdef USE_ENVMAP\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n\t#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
meshlambert_frag:"\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cuv2_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cshadowmask_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\n\t// accumulation\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse +\x3d ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse +\x3d vIndirectFront;\n\n\t#endif\n\n\t#include \x3clightmap_fragment\x3e\n\n\treflectedLight.indirectDiffuse *\x3d BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse \x3d ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse \x3d vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *\x3d BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\n\t#include \x3caomap_fragment\x3e\n\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include \x3cenvmap_fragment\x3e\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}\n",
meshlambert_vert:"\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cuv2_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cuv2_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3clights_lambert_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}\n",
meshmatcap_frag:"\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\n\tvec3 viewDir \x3d normalize( vViewPosition );\n\tvec3 x \x3d normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y \x3d cross( viewDir, x );\n\tvec2 uv \x3d vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor \x3d texture2D( matcap, uv );\n\t\tmatcapColor \x3d matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor \x3d vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight \x3d diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n\n}\n",
meshmatcap_vert:"\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal \x3d normalize( transformedNormal );\n\n\t#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n\tvViewPosition \x3d - mvPosition.xyz;\n\n}\n",
meshtoon_frag:"\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cuv2_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cgradientmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clights_toon_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\n\t// accumulation\n\t#include \x3clights_toon_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\n\t// modulation\n\t#include \x3caomap_fragment\x3e\n\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n\n}\n",
meshtoon_vert:"\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cuv2_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cuv2_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal \x3d normalize( transformedNormal );\n\n#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\tvViewPosition \x3d - mvPosition.xyz;\n\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
meshphong_frag:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cuv2_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clights_phong_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\n\t// accumulation\n\t#include \x3clights_phong_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\n\t// modulation\n\t#include \x3caomap_fragment\x3e\n\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include \x3cenvmap_fragment\x3e\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n\n}\n",
meshphong_vert:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cuv2_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cuv2_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal \x3d normalize( transformedNormal );\n\n#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\tvViewPosition \x3d - mvPosition.xyz;\n\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
meshphysical_frag:"\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cuv2_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3ctransmissionmap_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_physical_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clights_physical_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cclearcoat_pars_fragment\x3e\n#include \x3croughnessmap_pars_fragment\x3e\n#include \x3cmetalnessmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission \x3d transmission;\n\t#endif\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3croughnessmap_fragment\x3e\n\t#include \x3cmetalnessmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cclearcoat_normal_fragment_begin\x3e\n\t#include \x3cclearcoat_normal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3ctransmissionmap_fragment\x3e\n\n\t// accumulation\n\t#include \x3clights_physical_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\n\t// modulation\n\t#include \x3caomap_fragment\x3e\n\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *\x3d mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n\n}\n",
meshphysical_vert:"\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cuv2_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cuv2_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal \x3d normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent \x3d normalize( transformedTangent );\n\t\tvBitangent \x3d normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n\tvViewPosition \x3d - mvPosition.xyz;\n\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
normal_frag:"\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\n\tgl_FragColor \x3d vec4( packNormalToRGB( normal ), opacity );\n\n}\n",
normal_vert:"\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal \x3d normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent \x3d normalize( transformedTangent );\n\t\tvBitangent \x3d normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition \x3d - mvPosition.xyz;\n\n#endif\n\n}\n",
points_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cmap_particle_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_particle_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\n\toutgoingLight \x3d diffuseColor.rgb;\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\n}\n",
points_vert:"\nuniform float size;\nuniform float scale;\n\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\n\tgl_PointSize \x3d size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *\x3d ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
shadow_frag:"\nuniform vec3 color;\nuniform float opacity;\n\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cshadowmask_pars_fragment\x3e\n\nvoid main() {\n\n\tgl_FragColor \x3d vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\n}\n",
shadow_vert:"\n#include \x3ccommon\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n",
sprite_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\n\nvoid main() {\n\n\t#include \x3cclipping_planes_fragment\x3e\n\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\n\toutgoingLight \x3d diffuseColor.rgb;\n\n\tgl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );\n\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3cencodings_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\n}\n",
sprite_vert:"\nuniform float rotation;\nuniform vec2 center;\n\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n\nvoid main() {\n\n\t#include \x3cuv_vertex\x3e\n\n\tvec4 mvPosition \x3d modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x \x3d length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y \x3d length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *\x3d - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition \x3d ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x \x3d cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y \x3d sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy +\x3d rotatedPosition;\n\n\tgl_Position \x3d projectionMatrix * mvPosition;\n\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\n}\n"},
UniformsLib={common:{diffuse:{value:new Color(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},
bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],
properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],
properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(15658734)},
opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(15658734)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,
fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,
UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,
UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),
vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,
UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.normal_vert,fragmentShader:ShaderChunk.normal_frag},
sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},cube:{uniforms:mergeUniforms([UniformsLib.envmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,
fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical=
{uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Color(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};DataTexture2DArray.prototype=Object.create(Texture.prototype);DataTexture2DArray.prototype.constructor=
DataTexture2DArray;DataTexture2DArray.prototype.isDataTexture2DArray=!0;DataTexture3D.prototype=Object.create(Texture.prototype);DataTexture3D.prototype.constructor=DataTexture3D;DataTexture3D.prototype.isDataTexture3D=!0;var emptyTexture=new Texture,emptyTexture2dArray=new DataTexture2DArray,emptyTexture3d=new DataTexture3D,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);PureArrayUniform.prototype.updateCache=
function(data){var cache=this.cache;data instanceof Float32Array&&cache.length!==data.length&&(this.cache=new Float32Array(data.length));copyArray(cache,data)};StructuredUniform.prototype.setValue=function(gl,value,textures){for(var seq=this.seq,i=0,n=seq.length;i!==n;++i){var u=seq[i];u.setValue(gl,value[u.id],textures)}};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g;WebGLUniforms.prototype.setValue=function(gl,name,value,textures){name=this.map[name];void 0!==name&&name.setValue(gl,value,textures)};
WebGLUniforms.prototype.setOptional=function(gl,object,name){object=object[name];void 0!==object&&this.setValue(gl,name,object)};WebGLUniforms.upload=function(gl,seq,values,textures){for(var i=0,n=seq.length;i!==n;++i){var u=seq[i],v=values[u.id];!1!==v.needsUpdate&&u.setValue(gl,v.value,textures)}};WebGLUniforms.seqWithValue=function(seq,values){for(var r=[],i=0,n=seq.length;i!==n;++i){var u=seq[i];u.id in values&&r.push(u)}return r};var programIdCount=0,includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm,
deprecatedUnrollLoopPattern=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,nextVersion=0;MeshDepthMaterial.prototype=Object.create(Material.prototype);MeshDepthMaterial.prototype.constructor=MeshDepthMaterial;MeshDepthMaterial.prototype.isMeshDepthMaterial=!0;MeshDepthMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,
source);this.depthPacking=source.depthPacking;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.map=source.map;this.alphaMap=source.alphaMap;this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;return this};MeshDistanceMaterial.prototype=Object.create(Material.prototype);MeshDistanceMaterial.prototype.constructor=
MeshDistanceMaterial;MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0;MeshDistanceMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.referencePosition.copy(source.referencePosition);this.nearDistance=source.nearDistance;this.farDistance=source.farDistance;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.map=source.map;this.alphaMap=source.alphaMap;this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;
this.displacementBias=source.displacementBias;return this};Group.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Group,isGroup:!0});ArrayCamera.prototype=Object.assign(Object.create(PerspectiveCamera.prototype),{constructor:ArrayCamera,isArrayCamera:!0});var cameraLPos=new Vector3,cameraRPos=new Vector3;Object.assign(WebVRManager.prototype,EventDispatcher.prototype);Object.assign(WebXRController.prototype,{constructor:WebXRController,getHandSpace:function(){if(null===this._hand&&
(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var i=0;i<=window.XRHand.LITTLE_PHALANX_TIP;i++){var joint=new Group;joint.matrixAutoUpdate=!1;joint.visible=!1;this._hand.joints.push(joint);this._hand.add(joint)}return this._hand},getTargetRaySpace:function(){null===this._targetRay&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1);return this._targetRay},
getGripSpace:function(){null===this._grip&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1);return this._grip},dispatchEvent:function(event){null!==this._targetRay&&this._targetRay.dispatchEvent(event);null!==this._grip&&this._grip.dispatchEvent(event);null!==this._hand&&this._hand.dispatchEvent(event);return this},disconnect:function(inputSource){this.dispatchEvent({type:"disconnected",data:inputSource});null!==this._targetRay&&(this._targetRay.visible=!1);null!==this._grip&&
(this._grip.visible=!1);null!==this._hand&&(this._hand.visible=!1);return this},update:function(inputSource,frame,referenceSpace){var inputPose=null,gripPose=null,handPose=null,targetRay=this._targetRay,grip=this._grip,hand=this._hand;if(inputSource&&"visible-blurred"!==frame.session.visibilityState)if(hand&&inputSource.hand){handPose=!0;for(var i=0;i<=window.XRHand.LITTLE_PHALANX_TIP;i++)if(inputSource.hand[i]){var jointPose=frame.getJointPose(inputSource.hand[i],referenceSpace),joint=hand.joints[i];
null!==jointPose&&(joint.matrix.fromArray(jointPose.transform.matrix),joint.matrix.decompose(joint.position,joint.rotation,joint.scale),joint.jointRadius=jointPose.radius);joint.visible=null!==jointPose;jointPose=hand.joints[window.XRHand.INDEX_PHALANX_TIP].position.distanceTo(hand.joints[window.XRHand.THUMB_PHALANX_TIP].position);hand.inputState.pinching&&.025<jointPose?(hand.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:inputSource.handedness,target:this})):!hand.inputState.pinching&&
.015>=jointPose&&(hand.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:inputSource.handedness,target:this}))}}else null!==targetRay&&(inputPose=frame.getPose(inputSource.targetRaySpace,referenceSpace),null!==inputPose&&(targetRay.matrix.fromArray(inputPose.transform.matrix),targetRay.matrix.decompose(targetRay.position,targetRay.rotation,targetRay.scale))),null!==grip&&inputSource.gripSpace&&(gripPose=frame.getPose(inputSource.gripSpace,referenceSpace),null!==gripPose&&(grip.matrix.fromArray(gripPose.transform.matrix),
grip.matrix.decompose(grip.position,grip.rotation,grip.scale)));null!==targetRay&&(targetRay.visible=null!==inputPose);null!==grip&&(grip.visible=null!==gripPose);null!==hand&&(hand.visible=null!==handPose);return this}});Object.assign(WebXRManager.prototype,EventDispatcher.prototype);WebGL1Renderer.prototype=Object.assign(Object.create(WebGLRenderer.prototype),{constructor:WebGL1Renderer,isWebGL1Renderer:!0});var FogExp2=function(){function FogExp2(color,density){Object.defineProperty(this,"isFogExp2",
{value:!0});this.name="";this.color=new Color(color);this.density=void 0!==density?density:2.5E-4}var _proto=FogExp2.prototype;_proto.clone=function(){return new FogExp2(this.color,this.density)};_proto.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};return FogExp2}(),Fog=function(){function Fog(color,near,far){Object.defineProperty(this,"isFog",{value:!0});this.name="";this.color=new Color(color);this.near=void 0!==near?near:1;this.far=void 0!==far?far:1E3}
var _proto=Fog.prototype;_proto.clone=function(){return new Fog(this.color,this.near,this.far)};_proto.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};return Fog}(),Scene=function(_Object3D){function Scene(){var _this=_Object3D.call(this)||this;Object.defineProperty(_assertThisInitialized(_this),"isScene",{value:!0});_this.type="Scene";_this.background=null;_this.environment=null;_this.fog=null;_this.overrideMaterial=null;_this.autoUpdate=!0;"undefined"!==
typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:_assertThisInitialized(_this)}));return _this}_inheritsLoose(Scene,_Object3D);var _proto=Scene.prototype;_proto.copy=function(source,recursive){_Object3D.prototype.copy.call(this,source,recursive);null!==source.background&&(this.background=source.background.clone());null!==source.environment&&(this.environment=source.environment.clone());null!==source.fog&&(this.fog=source.fog.clone());null!==source.overrideMaterial&&
(this.overrideMaterial=source.overrideMaterial.clone());this.autoUpdate=source.autoUpdate;this.matrixAutoUpdate=source.matrixAutoUpdate;return this};_proto.toJSON=function(meta){var data=_Object3D.prototype.toJSON.call(this,meta);null!==this.background&&(data.object.background=this.background.toJSON(meta));null!==this.environment&&(data.object.environment=this.environment.toJSON(meta));null!==this.fog&&(data.object.fog=this.fog.toJSON());return data};return Scene}(Object3D);Object.defineProperty(InterleavedBuffer.prototype,
"needsUpdate",{set:function(value){!0===value&&this.version++}});Object.assign(InterleavedBuffer.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(value){this.usage=value;return this},copy:function(source){this.array=new source.array.constructor(source.array);this.count=source.count;this.stride=source.stride;this.usage=source.usage;return this},copyAt:function(index1,attribute,index2){index1*=this.stride;index2*=attribute.stride;for(var i=0,l=this.stride;i<l;i++)this.array[index1+
i]=attribute.array[index2+i];return this},set:function(value,offset){void 0===offset&&(offset=0);this.array.set(value,offset);return this},clone:function(data){void 0===data.arrayBuffers&&(data.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=MathUtils.generateUUID());void 0===data.arrayBuffers[this.array.buffer._uuid]&&(data.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);data=new this.array.constructor(data.arrayBuffers[this.array.buffer._uuid]);data=
new InterleavedBuffer(data,this.stride);data.setUsage(this.usage);return data},onUpload:function(callback){this.onUploadCallback=callback;return this},toJSON:function(data){void 0===data.arrayBuffers&&(data.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=MathUtils.generateUUID());void 0===data.arrayBuffers[this.array.buffer._uuid]&&(data.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer)));return{uuid:this.uuid,buffer:this.array.buffer._uuid,
type:this.array.constructor.name,stride:this.stride}}});var _vector$6=new Vector3;Object.defineProperties(InterleavedBufferAttribute.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(value){this.data.needsUpdate=value}}});Object.assign(InterleavedBufferAttribute.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(m){for(var i=0,l=this.data.count;i<l;i++)_vector$6.x=this.getX(i),_vector$6.y=this.getY(i),_vector$6.z=
this.getZ(i),_vector$6.applyMatrix4(m),this.setXYZ(i,_vector$6.x,_vector$6.y,_vector$6.z);return this},setX:function(index,x){this.data.array[index*this.data.stride+this.offset]=x;return this},setY:function(index,y){this.data.array[index*this.data.stride+this.offset+1]=y;return this},setZ:function(index,z){this.data.array[index*this.data.stride+this.offset+2]=z;return this},setW:function(index,w){this.data.array[index*this.data.stride+this.offset+3]=w;return this},getX:function(index){return this.data.array[index*
this.data.stride+this.offset]},getY:function(index){return this.data.array[index*this.data.stride+this.offset+1]},getZ:function(index){return this.data.array[index*this.data.stride+this.offset+2]},getW:function(index){return this.data.array[index*this.data.stride+this.offset+3]},setXY:function(index,x,y){index=index*this.data.stride+this.offset;this.data.array[index+0]=x;this.data.array[index+1]=y;return this},setXYZ:function(index,x,y,z){index=index*this.data.stride+this.offset;this.data.array[index+
0]=x;this.data.array[index+1]=y;this.data.array[index+2]=z;return this},setXYZW:function(index,x,y,z,w){index=index*this.data.stride+this.offset;this.data.array[index+0]=x;this.data.array[index+1]=y;this.data.array[index+2]=z;this.data.array[index+3]=w;return this},clone:function(data){if(void 0===data){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");data=[];for(var i=0;i<this.count;i++)for(var index=i*this.data.stride+
this.offset,j=0;j<this.itemSize;j++)data.push(this.data.array[index+j]);return new BufferAttribute(new this.array.constructor(data),this.itemSize,this.normalized)}void 0===data.interleavedBuffers&&(data.interleavedBuffers={});void 0===data.interleavedBuffers[this.data.uuid]&&(data.interleavedBuffers[this.data.uuid]=this.data.clone(data));return new InterleavedBufferAttribute(data.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(data){if(void 0===data){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");
data=[];for(var i=0;i<this.count;i++)for(var index=i*this.data.stride+this.offset,j=0;j<this.itemSize;j++)data.push(this.data.array[index+j]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:data,normalized:this.normalized}}void 0===data.interleavedBuffers&&(data.interleavedBuffers={});void 0===data.interleavedBuffers[this.data.uuid]&&(data.interleavedBuffers[this.data.uuid]=this.data.toJSON(data));return{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,
offset:this.offset,normalized:this.normalized}}});SpriteMaterial.prototype=Object.create(Material.prototype);SpriteMaterial.prototype.constructor=SpriteMaterial;SpriteMaterial.prototype.isSpriteMaterial=!0;SpriteMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.alphaMap=source.alphaMap;this.rotation=source.rotation;this.sizeAttenuation=source.sizeAttenuation;return this};var _geometry,_intersectPoint=new Vector3,
_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2;Sprite.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Sprite,isSprite:!0,raycast:function(raycaster,intersects){null===raycaster.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');
_worldScale.setFromMatrixScale(this.matrixWorld);_viewWorldMatrix.copy(raycaster.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(raycaster.camera.matrixWorldInverse,this.matrixWorld);_mvPosition.setFromMatrixPosition(this.modelViewMatrix);raycaster.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&_worldScale.multiplyScalar(-_mvPosition.z);var rotation=this.material.rotation;if(0!==rotation){var cos=Math.cos(rotation);var sin=Math.sin(rotation)}rotation=this.center;transformVertex(_vA$1.set(-.5,
-.5,0),_mvPosition,rotation,_worldScale,sin,cos);transformVertex(_vB$1.set(.5,-.5,0),_mvPosition,rotation,_worldScale,sin,cos);transformVertex(_vC$1.set(.5,.5,0),_mvPosition,rotation,_worldScale,sin,cos);_uvA$1.set(0,0);_uvB$1.set(1,0);_uvC$1.set(1,1);var intersect=raycaster.ray.intersectTriangle(_vA$1,_vB$1,_vC$1,!1,_intersectPoint);if(null===intersect&&(transformVertex(_vB$1.set(-.5,.5,0),_mvPosition,rotation,_worldScale,sin,cos),_uvB$1.set(0,1),intersect=raycaster.ray.intersectTriangle(_vA$1,_vC$1,
_vB$1,!1,_intersectPoint),null===intersect))return;sin=raycaster.ray.origin.distanceTo(_intersectPoint);sin<raycaster.near||sin>raycaster.far||intersects.push({distance:sin,point:_intersectPoint.clone(),uv:Triangle.getUV(_intersectPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),face:null,object:this})},copy:function(source){Object3D.prototype.copy.call(this,source);void 0!==source.center&&this.center.copy(source.center);this.material=source.material;return this}});var _v1$4=new Vector3,
_v2$2=new Vector3;LOD.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:LOD,isLOD:!0,copy:function(source){Object3D.prototype.copy.call(this,source,!1);for(var levels=source.levels,i=0,l=levels.length;i<l;i++){var level=levels[i];this.addLevel(level.object.clone(),level.distance)}this.autoUpdate=source.autoUpdate;return this},addLevel:function(object,distance){void 0===distance&&(distance=0);distance=Math.abs(distance);var levels=this.levels,l;for(l=0;l<levels.length&&!(distance<
levels[l].distance);l++);levels.splice(l,0,{distance:distance,object:object});this.add(object);return this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(distance){var levels=this.levels;if(0<levels.length){var l;var i=1;for(l=levels.length;i<l&&!(distance<levels[i].distance);i++);return levels[i-1].object}return null},raycast:function(raycaster,intersects){if(0<this.levels.length){_v1$4.setFromMatrixPosition(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(_v1$4);
this.getObjectForDistance(distance).raycast(raycaster,intersects)}},update:function(camera){var levels=this.levels;if(1<levels.length){_v1$4.setFromMatrixPosition(camera.matrixWorld);_v2$2.setFromMatrixPosition(this.matrixWorld);camera=_v1$4.distanceTo(_v2$2)/camera.zoom;levels[0].object.visible=!0;var l;var i=1;for(l=levels.length;i<l;i++)if(camera>=levels[i].distance)levels[i-1].object.visible=!1,levels[i].object.visible=!0;else break;for(this._currentLevel=i-1;i<l;i++)levels[i].object.visible=
!1}},toJSON:function(meta){meta=Object3D.prototype.toJSON.call(this,meta);!1===this.autoUpdate&&(meta.object.autoUpdate=!1);meta.object.levels=[];for(var levels=this.levels,i=0,l=levels.length;i<l;i++){var level=levels[i];meta.object.levels.push({object:level.object.uuid,distance:level.distance})}return meta}});SkinnedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:SkinnedMesh,isSkinnedMesh:!0,copy:function(source){Mesh.prototype.copy.call(this,source);this.bindMode=source.bindMode;
this.bindMatrix.copy(source.bindMatrix);this.bindMatrixInverse.copy(source.bindMatrixInverse);this.skeleton=source.skeleton;return this},bind:function(skeleton,bindMatrix){this.skeleton=skeleton;void 0===bindMatrix&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),bindMatrix=this.matrixWorld);this.bindMatrix.copy(bindMatrix);this.bindMatrixInverse.copy(bindMatrix).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var vector=new Vector4,skinWeight=this.geometry.attributes.skinWeight,
i=0,l=skinWeight.count;i<l;i++){vector.x=skinWeight.getX(i);vector.y=skinWeight.getY(i);vector.z=skinWeight.getZ(i);vector.w=skinWeight.getW(i);var scale=1/vector.manhattanLength();Infinity!==scale?vector.multiplyScalar(scale):vector.set(1,0,0,0);skinWeight.setXYZW(i,vector.x,vector.y,vector.z,vector.w)}},updateMatrixWorld:function(force){Mesh.prototype.updateMatrixWorld.call(this,force);"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():
console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){var basePosition=new Vector3,skinIndex=new Vector4,skinWeight=new Vector4,vector=new Vector3,matrix=new Matrix4;return function(index,target){var skeleton=this.skeleton,geometry=this.geometry;skinIndex.fromBufferAttribute(geometry.attributes.skinIndex,index);skinWeight.fromBufferAttribute(geometry.attributes.skinWeight,index);basePosition.fromBufferAttribute(geometry.attributes.position,index).applyMatrix4(this.bindMatrix);
target.set(0,0,0);for(index=0;4>index;index++)if(geometry=skinWeight.getComponent(index),0!==geometry){var boneIndex=skinIndex.getComponent(index);matrix.multiplyMatrices(skeleton.bones[boneIndex].matrixWorld,skeleton.boneInverses[boneIndex]);target.addScaledVector(vector.copy(basePosition).applyMatrix4(matrix),geometry)}return target.applyMatrix4(this.bindMatrixInverse)}}()});Bone.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Bone,isBone:!0});var _offsetMatrix=new Matrix4,
_identityMatrix=new Matrix4;Object.assign(Skeleton.prototype,{init:function(){var bones=this.bones,boneInverses=this.boneInverses;this.boneMatrices=new Float32Array(16*bones.length);if(0===boneInverses.length)this.calculateInverses();else if(bones.length!==boneInverses.length)for(console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[],bones=0,boneInverses=this.bones.length;bones<boneInverses;bones++)this.boneInverses.push(new Matrix4)},
calculateInverses:function(){for(var i=this.boneInverses.length=0,il=this.bones.length;i<il;i++){var inverse=new Matrix4;this.bones[i]&&inverse.copy(this.bones[i].matrixWorld).invert();this.boneInverses.push(inverse)}},pose:function(){for(var i=0,il=this.bones.length;i<il;i++){var bone=this.bones[i];bone&&bone.matrixWorld.copy(this.boneInverses[i]).invert()}i=0;for(il=this.bones.length;i<il;i++)if(bone=this.bones[i])bone.parent&&bone.parent.isBone?(bone.matrix.copy(bone.parent.matrixWorld).invert(),
bone.matrix.multiply(bone.matrixWorld)):bone.matrix.copy(bone.matrixWorld),bone.matrix.decompose(bone.position,bone.quaternion,bone.scale)},update:function(){for(var bones=this.bones,boneInverses=this.boneInverses,boneMatrices=this.boneMatrices,boneTexture=this.boneTexture,i=0,il=bones.length;i<il;i++)_offsetMatrix.multiplyMatrices(bones[i]?bones[i].matrixWorld:_identityMatrix,boneInverses[i]),_offsetMatrix.toArray(boneMatrices,16*i);null!==boneTexture&&(boneTexture.needsUpdate=!0)},clone:function(){return new Skeleton(this.bones,
this.boneInverses)},getBoneByName:function(name){for(var i=0,il=this.bones.length;i<il;i++){var bone=this.bones[i];if(bone.name===name)return bone}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(json,bones){this.uuid=json.uuid;for(var i=0,l=json.bones.length;i<l;i++){var uuid=json.bones[i],bone=bones[uuid];void 0===bone&&(console.warn("THREE.Skeleton: No bone found with UUID:",uuid),bone=new Bone);this.bones.push(bone);this.boneInverses.push((new Matrix4).fromArray(json.boneInverses[i]))}this.init();
return this},toJSON:function(){var data={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};data.uuid=this.uuid;for(var bones=this.bones,boneInverses=this.boneInverses,i=0,l=bones.length;i<l;i++)data.bones.push(bones[i].uuid),data.boneInverses.push(boneInverses[i].toArray());return data}});var _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_mesh=new Mesh;InstancedMesh.prototype=Object.assign(Object.create(Mesh.prototype),
{constructor:InstancedMesh,isInstancedMesh:!0,copy:function(source){Mesh.prototype.copy.call(this,source);this.instanceMatrix.copy(source.instanceMatrix);this.count=source.count;return this},getColorAt:function(index,color){color.fromArray(this.instanceColor.array,3*index)},getMatrixAt:function(index,matrix){matrix.fromArray(this.instanceMatrix.array,16*index)},raycast:function(raycaster,intersects){var matrixWorld=this.matrixWorld,raycastTimes=this.count;_mesh.geometry=this.geometry;_mesh.material=
this.material;if(void 0!==_mesh.material)for(var instanceId=0;instanceId<raycastTimes;instanceId++){this.getMatrixAt(instanceId,_instanceLocalMatrix);_instanceWorldMatrix.multiplyMatrices(matrixWorld,_instanceLocalMatrix);_mesh.matrixWorld=_instanceWorldMatrix;_mesh.raycast(raycaster,_instanceIntersects);for(var i=0,l=_instanceIntersects.length;i<l;i++){var intersect=_instanceIntersects[i];intersect.instanceId=instanceId;intersect.object=this;intersects.push(intersect)}_instanceIntersects.length=
0}},setColorAt:function(index,color){null===this.instanceColor&&(this.instanceColor=new BufferAttribute(new Float32Array(3*this.count),3));color.toArray(this.instanceColor.array,3*index)},setMatrixAt:function(index,matrix){matrix.toArray(this.instanceMatrix.array,16*index)},updateMorphTargets:function(){}});LineBasicMaterial.prototype=Object.create(Material.prototype);LineBasicMaterial.prototype.constructor=LineBasicMaterial;LineBasicMaterial.prototype.isLineBasicMaterial=!0;LineBasicMaterial.prototype.copy=
function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.linewidth=source.linewidth;this.linecap=source.linecap;this.linejoin=source.linejoin;this.morphTargets=source.morphTargets;return this};var _start=new Vector3,_end=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$2=new Sphere;Line.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Line,isLine:!0,copy:function(source){Object3D.prototype.copy.call(this,source);this.material=
source.material;this.geometry=source.geometry;return this},computeLineDistances:function(){var geometry=this.geometry;if(geometry.isBufferGeometry)if(null===geometry.index){for(var positionAttribute=geometry.attributes.position,lineDistances=[0],i=1,l=positionAttribute.count;i<l;i++)_start.fromBufferAttribute(positionAttribute,i-1),_end.fromBufferAttribute(positionAttribute,i),lineDistances[i]=lineDistances[i-1],lineDistances[i]+=_start.distanceTo(_end);geometry.setAttribute("lineDistance",new Float32BufferAttribute(lineDistances,
1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(geometry.isGeometry)for(positionAttribute=geometry.vertices,geometry=geometry.lineDistances,geometry[0]=0,lineDistances=1,i=positionAttribute.length;lineDistances<i;lineDistances++)geometry[lineDistances]=geometry[lineDistances-1],geometry[lineDistances]+=positionAttribute[lineDistances-1].distanceTo(positionAttribute[lineDistances]);return this},raycast:function(raycaster,
intersects){var geometry=this.geometry,matrixWorld=this.matrixWorld,threshold=raycaster.params.Line.threshold;null===geometry.boundingSphere&&geometry.computeBoundingSphere();_sphere$2.copy(geometry.boundingSphere);_sphere$2.applyMatrix4(matrixWorld);_sphere$2.radius+=threshold;if(!1!==raycaster.ray.intersectsSphere(_sphere$2)){_inverseMatrix$1.copy(matrixWorld).invert();_ray$1.copy(raycaster.ray).applyMatrix4(_inverseMatrix$1);matrixWorld=threshold/((this.scale.x+this.scale.y+this.scale.z)/3);matrixWorld*=
matrixWorld;var vStart=new Vector3,vEnd=new Vector3;threshold=new Vector3;var interRay=new Vector3,step=this.isLineSegments?2:1;if(geometry.isBufferGeometry){var index=geometry.index;geometry=geometry.attributes.position;if(null!==index){index=index.array;for(var i=0,l=index.length-1;i<l;i+=step){var b=index[i+1];vStart.fromBufferAttribute(geometry,index[i]);vEnd.fromBufferAttribute(geometry,b);_ray$1.distanceSqToSegment(vStart,vEnd,interRay,threshold)>matrixWorld||(interRay.applyMatrix4(this.matrixWorld),
b=raycaster.ray.origin.distanceTo(interRay),b<raycaster.near||b>raycaster.far||intersects.push({distance:b,point:threshold.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}else for(index=0,i=geometry.count-1;index<i;index+=step)vStart.fromBufferAttribute(geometry,index),vEnd.fromBufferAttribute(geometry,index+1),_ray$1.distanceSqToSegment(vStart,vEnd,interRay,threshold)>matrixWorld||(interRay.applyMatrix4(this.matrixWorld),l=raycaster.ray.origin.distanceTo(interRay),
l<raycaster.near||l>raycaster.far||intersects.push({distance:l,point:threshold.clone().applyMatrix4(this.matrixWorld),index:index,face:null,faceIndex:null,object:this}))}else if(geometry.isGeometry)for(vStart=geometry.vertices,vEnd=vStart.length,geometry=0;geometry<vEnd-1;geometry+=step)_ray$1.distanceSqToSegment(vStart[geometry],vStart[geometry+1],interRay,threshold)>matrixWorld||(interRay.applyMatrix4(this.matrixWorld),index=raycaster.ray.origin.distanceTo(interRay),index<raycaster.near||index>
raycaster.far||intersects.push({distance:index,point:threshold.clone().applyMatrix4(this.matrixWorld),index:geometry,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var geometry=this.geometry;if(geometry.isBufferGeometry){geometry=geometry.morphAttributes;var keys=Object.keys(geometry);if(0<keys.length&&(geometry=geometry[keys[0]],void 0!==geometry)){this.morphTargetInfluences=[];this.morphTargetDictionary={};keys=0;for(var ml=geometry.length;keys<ml;keys++){var name=geometry[keys].name||
String(keys);this.morphTargetInfluences.push(0);this.morphTargetDictionary[name]=keys}}}else geometry=geometry.morphTargets,void 0!==geometry&&0<geometry.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});var _start$1=new Vector3,_end$1=new Vector3;LineSegments.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineSegments,isLineSegments:!0,computeLineDistances:function(){var geometry=this.geometry;if(geometry.isBufferGeometry)if(null===
geometry.index){for(var positionAttribute=geometry.attributes.position,lineDistances=[],i=0,l=positionAttribute.count;i<l;i+=2)_start$1.fromBufferAttribute(positionAttribute,i),_end$1.fromBufferAttribute(positionAttribute,i+1),lineDistances[i]=0===i?0:lineDistances[i-1],lineDistances[i+1]=lineDistances[i]+_start$1.distanceTo(_end$1);geometry.setAttribute("lineDistance",new Float32BufferAttribute(lineDistances,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
else if(geometry.isGeometry)for(positionAttribute=geometry.vertices,geometry=geometry.lineDistances,lineDistances=0,i=positionAttribute.length;lineDistances<i;lineDistances+=2)_start$1.copy(positionAttribute[lineDistances]),_end$1.copy(positionAttribute[lineDistances+1]),geometry[lineDistances]=0===lineDistances?0:geometry[lineDistances-1],geometry[lineDistances+1]=geometry[lineDistances]+_start$1.distanceTo(_end$1);return this}});LineLoop.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineLoop,
isLineLoop:!0});PointsMaterial.prototype=Object.create(Material.prototype);PointsMaterial.prototype.constructor=PointsMaterial;PointsMaterial.prototype.isPointsMaterial=!0;PointsMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.alphaMap=source.alphaMap;this.size=source.size;this.sizeAttenuation=source.sizeAttenuation;this.morphTargets=source.morphTargets;return this};var _inverseMatrix$2=new Matrix4,_ray$2=new Ray,
_sphere$3=new Sphere,_position$1=new Vector3;Points.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Points,isPoints:!0,copy:function(source){Object3D.prototype.copy.call(this,source);this.material=source.material;this.geometry=source.geometry;return this},raycast:function(raycaster,intersects){var geometry=this.geometry,matrixWorld=this.matrixWorld,threshold=raycaster.params.Points.threshold;null===geometry.boundingSphere&&geometry.computeBoundingSphere();_sphere$3.copy(geometry.boundingSphere);
_sphere$3.applyMatrix4(matrixWorld);_sphere$3.radius+=threshold;if(!1!==raycaster.ray.intersectsSphere(_sphere$3))if(_inverseMatrix$2.copy(matrixWorld).invert(),_ray$2.copy(raycaster.ray).applyMatrix4(_inverseMatrix$2),threshold/=(this.scale.x+this.scale.y+this.scale.z)/3,threshold*=threshold,geometry.isBufferGeometry){var index=geometry.index;geometry=geometry.attributes.position;if(null!==index){index=index.array;for(var i=0,il=index.length;i<il;i++){var a=index[i];_position$1.fromBufferAttribute(geometry,
a);testPoint(_position$1,a,threshold,matrixWorld,raycaster,intersects,this)}}else for(index=0,i=geometry.count;index<i;index++)_position$1.fromBufferAttribute(geometry,index),testPoint(_position$1,index,threshold,matrixWorld,raycaster,intersects,this)}else for(geometry=geometry.vertices,index=0,i=geometry.length;index<i;index++)testPoint(geometry[index],index,threshold,matrixWorld,raycaster,intersects,this)},updateMorphTargets:function(){var geometry=this.geometry;if(geometry.isBufferGeometry){geometry=
geometry.morphAttributes;var keys=Object.keys(geometry);if(0<keys.length&&(geometry=geometry[keys[0]],void 0!==geometry)){this.morphTargetInfluences=[];this.morphTargetDictionary={};keys=0;for(var ml=geometry.length;keys<ml;keys++){var name=geometry[keys].name||String(keys);this.morphTargetInfluences.push(0);this.morphTargetDictionary[name]=keys}}}else geometry=geometry.morphTargets,void 0!==geometry&&0<geometry.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});
VideoTexture.prototype=Object.assign(Object.create(Texture.prototype),{constructor:VideoTexture,clone:function(){return(new this.constructor(this.image)).copy(this)},isVideoTexture:!0,update:function(){var video=this.image;!1==="requestVideoFrameCallback"in video&&video.readyState>=video.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});CompressedTexture.prototype=Object.create(Texture.prototype);CompressedTexture.prototype.constructor=CompressedTexture;CompressedTexture.prototype.isCompressedTexture=!0;
CanvasTexture.prototype=Object.create(Texture.prototype);CanvasTexture.prototype.constructor=CanvasTexture;CanvasTexture.prototype.isCanvasTexture=!0;DepthTexture.prototype=Object.create(Texture.prototype);DepthTexture.prototype.constructor=DepthTexture;DepthTexture.prototype.isDepthTexture=!0;var _geometryId=0,_m1$3=new Matrix4,_obj$1=new Object3D,_offset$1=new Vector3;Geometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Geometry,isGeometry:!0,applyMatrix4:function(matrix){for(var normalMatrix=
(new Matrix3).getNormalMatrix(matrix),i=0,il=this.vertices.length;i<il;i++)this.vertices[i].applyMatrix4(matrix);matrix=0;for(i=this.faces.length;matrix<i;matrix++){il=this.faces[matrix];il.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=il.vertexNormals.length;j<jl;j++)il.vertexNormals[j].applyMatrix3(normalMatrix).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;
return this},rotateX:function(angle){_m1$3.makeRotationX(angle);this.applyMatrix4(_m1$3);return this},rotateY:function(angle){_m1$3.makeRotationY(angle);this.applyMatrix4(_m1$3);return this},rotateZ:function(angle){_m1$3.makeRotationZ(angle);this.applyMatrix4(_m1$3);return this},translate:function(x,y,z){_m1$3.makeTranslation(x,y,z);this.applyMatrix4(_m1$3);return this},scale:function(x,y,z){_m1$3.makeScale(x,y,z);this.applyMatrix4(_m1$3);return this},lookAt:function(vector){_obj$1.lookAt(vector);
_obj$1.updateMatrix();this.applyMatrix4(_obj$1.matrix);return this},fromBufferGeometry:function(geometry){function addFace(a,b,c,materialIndex){var vertexColors=void 0===color?[]:[scope.colors[a].clone(),scope.colors[b].clone(),scope.colors[c].clone()],vertexNormals=void 0===normal?[]:[(new Vector3).fromBufferAttribute(normal,a),(new Vector3).fromBufferAttribute(normal,b),(new Vector3).fromBufferAttribute(normal,c)];materialIndex=new Face3(a,b,c,vertexNormals,vertexColors,materialIndex);scope.faces.push(materialIndex);
void 0!==uv&&scope.faceVertexUvs[0].push([(new Vector2).fromBufferAttribute(uv,a),(new Vector2).fromBufferAttribute(uv,b),(new Vector2).fromBufferAttribute(uv,c)]);void 0!==uv2&&scope.faceVertexUvs[1].push([(new Vector2).fromBufferAttribute(uv2,a),(new Vector2).fromBufferAttribute(uv2,b),(new Vector2).fromBufferAttribute(uv2,c)])}var scope=this,index=null!==geometry.index?geometry.index:void 0,attributes=geometry.attributes;if(void 0===attributes.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),
this;var position=attributes.position,normal=attributes.normal,color=attributes.color,uv=attributes.uv,uv2=attributes.uv2;void 0!==uv2&&(this.faceVertexUvs[1]=[]);for(attributes=0;attributes<position.count;attributes++)scope.vertices.push((new Vector3).fromBufferAttribute(position,attributes)),void 0!==color&&scope.colors.push((new Color).fromBufferAttribute(color,attributes));attributes=geometry.groups;if(0<attributes.length)for(position=0;position<attributes.length;position++){var group=attributes[position],
start=group.start,j=start;for(start+=group.count;j<start;j+=3)void 0!==index?addFace(index.getX(j),index.getX(j+1),index.getX(j+2),group.materialIndex):addFace(j,j+1,j+2,group.materialIndex)}else if(void 0!==index)for(attributes=0;attributes<index.count;attributes+=3)addFace(index.getX(attributes),index.getX(attributes+1),index.getX(attributes+2));else for(index=0;index<position.count;index+=3)addFace(index,index+1,index+2);this.computeFaceNormals();null!==geometry.boundingBox&&(this.boundingBox=
geometry.boundingBox.clone());null!==geometry.boundingSphere&&(this.boundingSphere=geometry.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();this.boundingBox.getCenter(_offset$1).negate();this.translate(_offset$1.x,_offset$1.y,_offset$1.z);return this},normalize:function(){this.computeBoundingSphere();var center=this.boundingSphere.center,radius=this.boundingSphere.radius;radius=0===radius?1:1/radius;var matrix=new Matrix4;matrix.set(radius,0,0,-radius*center.x,0,radius,
0,-radius*center.y,0,0,radius,-radius*center.z,0,0,0,1);this.applyMatrix4(matrix);return this},computeFaceNormals:function(){for(var cb=new Vector3,ab=new Vector3,f=0,fl=this.faces.length;f<fl;f++){var face=this.faces[f],vA=this.vertices[face.a],vB=this.vertices[face.b];cb.subVectors(this.vertices[face.c],vB);ab.subVectors(vA,vB);cb.cross(ab);cb.normalize();face.normal.copy(cb)}},computeVertexNormals:function(areaWeighted){void 0===areaWeighted&&(areaWeighted=!0);for(var vertices=Array(this.vertices.length),
v=0,vl=this.vertices.length;v<vl;v++)vertices[v]=new Vector3;if(areaWeighted){areaWeighted=new Vector3;v=new Vector3;vl=0;for(var fl=this.faces.length;vl<fl;vl++){var face=this.faces[vl],vA=this.vertices[face.a],vB=this.vertices[face.b];areaWeighted.subVectors(this.vertices[face.c],vB);v.subVectors(vA,vB);areaWeighted.cross(v);vertices[face.a].add(areaWeighted);vertices[face.b].add(areaWeighted);vertices[face.c].add(areaWeighted)}}else for(this.computeFaceNormals(),areaWeighted=0,v=this.faces.length;areaWeighted<
v;areaWeighted++)vl=this.faces[areaWeighted],vertices[vl.a].add(vl.normal),vertices[vl.b].add(vl.normal),vertices[vl.c].add(vl.normal);areaWeighted=0;for(v=this.vertices.length;areaWeighted<v;areaWeighted++)vertices[areaWeighted].normalize();areaWeighted=0;for(v=this.faces.length;areaWeighted<v;areaWeighted++)vl=this.faces[areaWeighted],fl=vl.vertexNormals,3===fl.length?(fl[0].copy(vertices[vl.a]),fl[1].copy(vertices[vl.b]),fl[2].copy(vertices[vl.c])):(fl[0]=vertices[vl.a].clone(),fl[1]=vertices[vl.b].clone(),
fl[2]=vertices[vl.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var f=0,fl=this.faces.length;f<fl;f++){var face=this.faces[f],vertexNormals=face.vertexNormals;3===vertexNormals.length?(vertexNormals[0].copy(face.normal),vertexNormals[1].copy(face.normal),vertexNormals[2].copy(face.normal)):(vertexNormals[0]=face.normal.clone(),vertexNormals[1]=face.normal.clone(),vertexNormals[2]=face.normal.clone())}0<this.faces.length&&
(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var f=0,fl=this.faces.length;f<fl;f++){var face=this.faces[f];face.__originalFaceNormal?face.__originalFaceNormal.copy(face.normal):face.__originalFaceNormal=face.normal.clone();face.__originalVertexNormals||(face.__originalVertexNormals=[]);for(var i=0,il=face.vertexNormals.length;i<il;i++)face.__originalVertexNormals[i]?face.__originalVertexNormals[i].copy(face.vertexNormals[i]):face.__originalVertexNormals[i]=face.vertexNormals[i].clone()}f=
new Geometry;f.faces=this.faces;fl=0;for(face=this.morphTargets.length;fl<face;fl++){if(!this.morphNormals[fl]){this.morphNormals[fl]={};this.morphNormals[fl].faceNormals=[];this.morphNormals[fl].vertexNormals=[];i=this.morphNormals[fl].faceNormals;il=this.morphNormals[fl].vertexNormals;for(var _f3=0,_fl3=this.faces.length;_f3<_fl3;_f3++){var faceNormal=new Vector3,vertexNormals={a:new Vector3,b:new Vector3,c:new Vector3};i.push(faceNormal);il.push(vertexNormals)}}i=this.morphNormals[fl];f.vertices=
this.morphTargets[fl].vertices;f.computeFaceNormals();f.computeVertexNormals();il=0;for(_f3=this.faces.length;il<_f3;il++)_fl3=this.faces[il],faceNormal=i.vertexNormals[il],i.faceNormals[il].copy(_fl3.normal),faceNormal.a.copy(_fl3.vertexNormals[0]),faceNormal.b.copy(_fl3.vertexNormals[1]),faceNormal.c.copy(_fl3.vertexNormals[2])}f=0;for(fl=this.faces.length;f<fl;f++)face=this.faces[f],face.normal=face.__originalFaceNormal,face.vertexNormals=face.__originalVertexNormals},computeBoundingBox:function(){null===
this.boundingBox&&(this.boundingBox=new Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);this.boundingSphere.setFromPoints(this.vertices)},merge:function(geometry,matrix,materialIndexOffset){void 0===materialIndexOffset&&(materialIndexOffset=0);if(geometry&&geometry.isGeometry){var normalMatrix,vertexOffset=this.vertices.length,vertices1=this.vertices,vertices2=geometry.vertices,faces1=this.faces,faces2=
geometry.faces,colors1=this.colors,colors2=geometry.colors;void 0!==matrix&&(normalMatrix=(new Matrix3).getNormalMatrix(matrix));for(var i=0,il=vertices2.length;i<il;i++){var vertexCopy=vertices2[i].clone();void 0!==matrix&&vertexCopy.applyMatrix4(matrix);vertices1.push(vertexCopy)}matrix=0;for(vertices1=colors2.length;matrix<vertices1;matrix++)colors1.push(colors2[matrix].clone());colors1=0;for(colors2=faces2.length;colors1<colors2;colors1++){matrix=faces2[colors1];il=matrix.vertexNormals;vertices1=
matrix.vertexColors;vertices2=new Face3(matrix.a+vertexOffset,matrix.b+vertexOffset,matrix.c+vertexOffset);vertices2.normal.copy(matrix.normal);void 0!==normalMatrix&&vertices2.normal.applyMatrix3(normalMatrix).normalize();vertexCopy=0;for(var jl=il.length;vertexCopy<jl;vertexCopy++)i=il[vertexCopy].clone(),void 0!==normalMatrix&&i.applyMatrix3(normalMatrix).normalize(),vertices2.vertexNormals.push(i);vertices2.color.copy(matrix.color);il=0;for(vertexCopy=vertices1.length;il<vertexCopy;il++)i=vertices1[il],
vertices2.vertexColors.push(i.clone());vertices2.materialIndex=matrix.materialIndex+materialIndexOffset;faces1.push(vertices2)}materialIndexOffset=0;for(normalMatrix=geometry.faceVertexUvs.length;materialIndexOffset<normalMatrix;materialIndexOffset++)for(vertexOffset=geometry.faceVertexUvs[materialIndexOffset],void 0===this.faceVertexUvs[materialIndexOffset]&&(this.faceVertexUvs[materialIndexOffset]=[]),faces1=0,faces2=vertexOffset.length;faces1<faces2;faces1++){colors1=vertexOffset[faces1];colors2=
[];matrix=0;for(vertices1=colors1.length;matrix<vertices1;matrix++)colors2.push(colors1[matrix].clone());this.faceVertexUvs[materialIndexOffset].push(colors2)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",geometry)},mergeMesh:function(mesh){mesh&&mesh.isMesh?(mesh.matrixAutoUpdate&&mesh.updateMatrix(),this.merge(mesh.geometry,mesh.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",mesh)},mergeVertices:function(precisionPoints){void 0===
precisionPoints&&(precisionPoints=4);var verticesMap={},unique=[],changes=[];precisionPoints=Math.pow(10,precisionPoints);for(var i=0,il=this.vertices.length;i<il;i++){var v=this.vertices[i];v=Math.round(v.x*precisionPoints)+"_"+Math.round(v.y*precisionPoints)+"_"+Math.round(v.z*precisionPoints);void 0===verticesMap[v]?(verticesMap[v]=i,unique.push(this.vertices[i]),changes[i]=unique.length-1):changes[i]=changes[verticesMap[v]]}verticesMap=[];precisionPoints=0;for(i=this.faces.length;precisionPoints<
i;precisionPoints++)for(il=this.faces[precisionPoints],il.a=changes[il.a],il.b=changes[il.b],il.c=changes[il.c],il=[il.a,il.b,il.c],v=0;3>v;v++)if(il[v]===il[(v+1)%3]){verticesMap.push(precisionPoints);break}for(changes=verticesMap.length-1;0<=changes;changes--)for(precisionPoints=verticesMap[changes],this.faces.splice(precisionPoints,1),i=0,il=this.faceVertexUvs.length;i<il;i++)this.faceVertexUvs[i].splice(precisionPoints,1);changes=this.vertices.length-unique.length;this.vertices=unique;return changes},
setFromPoints:function(points){this.vertices=[];for(var i=0,l=points.length;i<l;i++){var point=points[i];this.vertices.push(new Vector3(point.x,point.y,point.z||0))}return this},sortFacesByMaterialIndex:function(){for(var faces=this.faces,length=faces.length,i=0;i<length;i++)faces[i]._id=i;faces.sort(function(a,b){return a.materialIndex-b.materialIndex});i=this.faceVertexUvs[0];var uvs2=this.faceVertexUvs[1],newUvs1,newUvs2;i&&i.length===length&&(newUvs1=[]);uvs2&&uvs2.length===length&&(newUvs2=[]);
for(var _i11=0;_i11<length;_i11++){var id=faces[_i11]._id;newUvs1&&newUvs1.push(i[id]);newUvs2&&newUvs2.push(uvs2[id])}newUvs1&&(this.faceVertexUvs[0]=newUvs1);newUvs2&&(this.faceVertexUvs[1]=newUvs2)},toJSON:function(){function setBit(value,position,enabled){return enabled?value|1<<position:value&~(1<<position)}function getNormalIndex(normal){var hash=normal.x.toString()+normal.y.toString()+normal.z.toString();if(void 0!==normalsHash[hash])return normalsHash[hash];normalsHash[hash]=normals.length/
3;normals.push(normal.x,normal.y,normal.z);return normalsHash[hash]}function getColorIndex(color){var hash=color.r.toString()+color.g.toString()+color.b.toString();if(void 0!==colorsHash[hash])return colorsHash[hash];colorsHash[hash]=colors.length;colors.push(color.getHex());return colorsHash[hash]}function getUvIndex(uv){var hash=uv.x.toString()+uv.y.toString();if(void 0!==uvsHash[hash])return uvsHash[hash];uvsHash[hash]=uvs.length/2;uvs.push(uv.x,uv.y);return uvsHash[hash]}var data={metadata:{version:4.5,
type:"Geometry",generator:"Geometry.toJSON"}};data.uuid=this.uuid;data.type=this.type;""!==this.name&&(data.name=this.name);if(void 0!==this.parameters){var parameters=this.parameters,key;for(key in parameters)void 0!==parameters[key]&&(data[key]=parameters[key]);return data}parameters=[];for(key=0;key<this.vertices.length;key++){var vertex=this.vertices[key];parameters.push(vertex.x,vertex.y,vertex.z)}key=[];var normals=[],normalsHash={},colors=[],colorsHash={},uvs=[],uvsHash={};for(vertex=0;vertex<
this.faces.length;vertex++){var face=this.faces[vertex],hasFaceVertexUv=void 0!==this.faceVertexUvs[0][vertex],hasFaceNormal=0<face.normal.length(),hasFaceVertexNormal=0<face.vertexNormals.length,hasFaceColor=1!==face.color.r||1!==face.color.g||1!==face.color.b,hasFaceVertexColor=0<face.vertexColors.length,faceType=0;faceType=setBit(faceType,0,0);faceType=setBit(faceType,1,!0);faceType=setBit(faceType,2,!1);faceType=setBit(faceType,3,hasFaceVertexUv);faceType=setBit(faceType,4,hasFaceNormal);faceType=
setBit(faceType,5,hasFaceVertexNormal);faceType=setBit(faceType,6,hasFaceColor);faceType=setBit(faceType,7,hasFaceVertexColor);key.push(faceType);key.push(face.a,face.b,face.c);key.push(face.materialIndex);hasFaceVertexUv&&(hasFaceVertexUv=this.faceVertexUvs[0][vertex],key.push(getUvIndex(hasFaceVertexUv[0]),getUvIndex(hasFaceVertexUv[1]),getUvIndex(hasFaceVertexUv[2])));hasFaceNormal&&key.push(getNormalIndex(face.normal));hasFaceVertexNormal&&(hasFaceNormal=face.vertexNormals,key.push(getNormalIndex(hasFaceNormal[0]),
getNormalIndex(hasFaceNormal[1]),getNormalIndex(hasFaceNormal[2])));hasFaceColor&&key.push(getColorIndex(face.color));hasFaceVertexColor&&(face=face.vertexColors,key.push(getColorIndex(face[0]),getColorIndex(face[1]),getColorIndex(face[2])))}data.data={};data.data.vertices=parameters;data.data.normals=normals;0<colors.length&&(data.data.colors=colors);0<uvs.length&&(data.data.uvs=[uvs]);data.data.faces=key;return data},clone:function(){return(new Geometry).copy(this)},copy:function(source){this.vertices=
[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=source.name;for(var vertices=source.vertices,i=0,il=vertices.length;i<il;i++)this.vertices.push(vertices[i].clone());vertices=source.colors;i=0;for(il=vertices.length;i<il;i++)this.colors.push(vertices[i].clone());vertices=source.faces;i=0;for(il=vertices.length;i<il;i++)this.faces.push(vertices[i].clone());
vertices=0;for(i=source.faceVertexUvs.length;vertices<i;vertices++){il=source.faceVertexUvs[vertices];void 0===this.faceVertexUvs[vertices]&&(this.faceVertexUvs[vertices]=[]);for(var j=0,jl=il.length;j<jl;j++){for(var uvs=il[j],uvsCopy=[],k=0,kl=uvs.length;k<kl;k++)uvsCopy.push(uvs[k].clone());this.faceVertexUvs[vertices].push(uvsCopy)}}vertices=source.morphTargets;i=0;for(il=vertices.length;i<il;i++){j={};j.name=vertices[i].name;if(void 0!==vertices[i].vertices)for(j.vertices=[],jl=0,uvs=vertices[i].vertices.length;jl<
uvs;jl++)j.vertices.push(vertices[i].vertices[jl].clone());if(void 0!==vertices[i].normals)for(j.normals=[],jl=0,uvs=vertices[i].normals.length;jl<uvs;jl++)j.normals.push(vertices[i].normals[jl].clone());this.morphTargets.push(j)}vertices=source.morphNormals;i=0;for(il=vertices.length;i<il;i++){j={};if(void 0!==vertices[i].vertexNormals)for(j.vertexNormals=[],jl=0,uvs=vertices[i].vertexNormals.length;jl<uvs;jl++)uvsCopy=vertices[i].vertexNormals[jl],k={},k.a=uvsCopy.a.clone(),k.b=uvsCopy.b.clone(),
k.c=uvsCopy.c.clone(),j.vertexNormals.push(k);if(void 0!==vertices[i].faceNormals)for(j.faceNormals=[],jl=0,uvs=vertices[i].faceNormals.length;jl<uvs;jl++)j.faceNormals.push(vertices[i].faceNormals[jl].clone());this.morphNormals.push(j)}vertices=source.skinWeights;i=0;for(il=vertices.length;i<il;i++)this.skinWeights.push(vertices[i].clone());vertices=source.skinIndices;i=0;for(il=vertices.length;i<il;i++)this.skinIndices.push(vertices[i].clone());vertices=source.lineDistances;i=0;for(il=vertices.length;i<
il;i++)this.lineDistances.push(vertices[i]);vertices=source.boundingBox;null!==vertices&&(this.boundingBox=vertices.clone());vertices=source.boundingSphere;null!==vertices&&(this.boundingSphere=vertices.clone());this.elementsNeedUpdate=source.elementsNeedUpdate;this.verticesNeedUpdate=source.verticesNeedUpdate;this.uvsNeedUpdate=source.uvsNeedUpdate;this.normalsNeedUpdate=source.normalsNeedUpdate;this.colorsNeedUpdate=source.colorsNeedUpdate;this.lineDistancesNeedUpdate=source.lineDistancesNeedUpdate;
this.groupsNeedUpdate=source.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var BoxGeometry=function(_Geometry){function BoxGeometry(width,height,depth,widthSegments,heightSegments,depthSegments){var _this=_Geometry.call(this)||this;_this.type="BoxGeometry";_this.parameters={width:width,height:height,depth:depth,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments};_this.fromBufferGeometry(new BoxBufferGeometry(width,height,
depth,widthSegments,heightSegments,depthSegments));_this.mergeVertices();return _this}_inheritsLoose(BoxGeometry,_Geometry);return BoxGeometry}(Geometry),CircleBufferGeometry=function(_BufferGeometry){function CircleBufferGeometry(radius,segments,thetaStart,thetaLength){void 0===radius&&(radius=1);void 0===segments&&(segments=8);void 0===thetaStart&&(thetaStart=0);void 0===thetaLength&&(thetaLength=2*Math.PI);var _this=_BufferGeometry.call(this)||this;_this.type="CircleBufferGeometry";_this.parameters=
{radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};segments=Math.max(3,segments);var indices=[],vertices=[],normals=[],uvs=[],vertex=new Vector3,uv=new Vector2;vertices.push(0,0,0);normals.push(0,0,1);uvs.push(.5,.5);for(var s=0,i=3;s<=segments;s++,i+=3){var segment=thetaStart+s/segments*thetaLength;vertex.x=radius*Math.cos(segment);vertex.y=radius*Math.sin(segment);vertices.push(vertex.x,vertex.y,vertex.z);normals.push(0,0,1);uv.x=(vertices[i]/radius+1)/2;uv.y=(vertices[i+
1]/radius+1)/2;uvs.push(uv.x,uv.y)}for(radius=1;radius<=segments;radius++)indices.push(radius,radius+1,0);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(CircleBufferGeometry,_BufferGeometry);return CircleBufferGeometry}(BufferGeometry),CircleGeometry=function(_Geometry){function CircleGeometry(radius,
segments,thetaStart,thetaLength){var _this=_Geometry.call(this)||this;_this.type="CircleGeometry";_this.parameters={radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};_this.fromBufferGeometry(new CircleBufferGeometry(radius,segments,thetaStart,thetaLength));_this.mergeVertices();return _this}_inheritsLoose(CircleGeometry,_Geometry);return CircleGeometry}(Geometry),CylinderBufferGeometry=function(_BufferGeometry){function CylinderBufferGeometry(radiusTop,radiusBottom,height,
radialSegments,heightSegments,openEnded,thetaStart,thetaLength){function generateCap(top){for(var centerIndexStart=index,uv=new Vector2,vertex=new Vector3,groupCount=0,radius=!0===top?radiusTop:radiusBottom,sign=!0===top?1:-1,x=1;x<=radialSegments;x++)vertices.push(0,halfHeight*sign,0),normals.push(0,sign,0),uvs.push(.5,.5),index++;x=index;for(var _x2=0;_x2<=radialSegments;_x2++){var theta=_x2/radialSegments*thetaLength+thetaStart,cosTheta=Math.cos(theta);theta=Math.sin(theta);vertex.x=radius*theta;
vertex.y=halfHeight*sign;vertex.z=radius*cosTheta;vertices.push(vertex.x,vertex.y,vertex.z);normals.push(0,sign,0);uv.x=.5*cosTheta+.5;uv.y=.5*theta*sign+.5;uvs.push(uv.x,uv.y);index++}for(uv=0;uv<radialSegments;uv++)vertex=centerIndexStart+uv,radius=x+uv,!0===top?indices.push(radius,radius+1,vertex):indices.push(radius+1,radius,vertex),groupCount+=3;scope.addGroup(groupStart,groupCount,!0===top?1:2);groupStart+=groupCount}void 0===radiusTop&&(radiusTop=1);void 0===radiusBottom&&(radiusBottom=1);
void 0===height&&(height=1);void 0===radialSegments&&(radialSegments=8);void 0===heightSegments&&(heightSegments=1);void 0===openEnded&&(openEnded=!1);void 0===thetaStart&&(thetaStart=0);void 0===thetaLength&&(thetaLength=2*Math.PI);var _this=_BufferGeometry.call(this)||this;_this.type="CylinderBufferGeometry";_this.parameters={radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};
var scope=_assertThisInitialized(_this);radialSegments=Math.floor(radialSegments);heightSegments=Math.floor(heightSegments);var indices=[],vertices=[],normals=[],uvs=[],index=0,indexArray=[],halfHeight=height/2,groupStart=0;(function(){for(var normal=new Vector3,vertex=new Vector3,groupCount=0,slope=(radiusBottom-radiusTop)/height,y=0;y<=heightSegments;y++){for(var indexRow=[],v=y/heightSegments,radius=v*(radiusBottom-radiusTop)+radiusTop,x=0;x<=radialSegments;x++){var u=x/radialSegments,theta=u*
thetaLength+thetaStart,sinTheta=Math.sin(theta);theta=Math.cos(theta);vertex.x=radius*sinTheta;vertex.y=-v*height+halfHeight;vertex.z=radius*theta;vertices.push(vertex.x,vertex.y,vertex.z);normal.set(sinTheta,slope,theta).normalize();normals.push(normal.x,normal.y,normal.z);uvs.push(u,1-v);indexRow.push(index++)}indexArray.push(indexRow)}for(normal=0;normal<radialSegments;normal++)for(vertex=0;vertex<heightSegments;vertex++)slope=indexArray[vertex+1][normal],y=indexArray[vertex+1][normal+1],indexRow=
indexArray[vertex][normal+1],indices.push(indexArray[vertex][normal],slope,indexRow),indices.push(slope,y,indexRow),groupCount+=6;scope.addGroup(groupStart,groupCount,0);groupStart+=groupCount})();!1===openEnded&&(0<radiusTop&&generateCap(!0),0<radiusBottom&&generateCap(!1));_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}
_inheritsLoose(CylinderBufferGeometry,_BufferGeometry);return CylinderBufferGeometry}(BufferGeometry),CylinderGeometry=function(_Geometry){function CylinderGeometry(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){var _this=_Geometry.call(this)||this;_this.type="CylinderGeometry";_this.parameters={radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,
thetaLength:thetaLength};_this.fromBufferGeometry(new CylinderBufferGeometry(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength));_this.mergeVertices();return _this}_inheritsLoose(CylinderGeometry,_Geometry);return CylinderGeometry}(Geometry),ConeGeometry=function(_CylinderGeometry){function ConeGeometry(radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){var _this=_CylinderGeometry.call(this,0,radius,height,radialSegments,heightSegments,
openEnded,thetaStart,thetaLength)||this;_this.type="ConeGeometry";_this.parameters={radius:radius,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};return _this}_inheritsLoose(ConeGeometry,_CylinderGeometry);return ConeGeometry}(CylinderGeometry),ConeBufferGeometry=function(_CylinderBufferGeomet){function ConeBufferGeometry(radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){void 0===
radius&&(radius=1);void 0===height&&(height=1);void 0===radialSegments&&(radialSegments=8);void 0===heightSegments&&(heightSegments=1);void 0===openEnded&&(openEnded=!1);void 0===thetaStart&&(thetaStart=0);void 0===thetaLength&&(thetaLength=2*Math.PI);var _this=_CylinderBufferGeomet.call(this,0,radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength)||this;_this.type="ConeBufferGeometry";_this.parameters={radius:radius,height:height,radialSegments:radialSegments,heightSegments:heightSegments,
openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};return _this}_inheritsLoose(ConeBufferGeometry,_CylinderBufferGeomet);return ConeBufferGeometry}(CylinderBufferGeometry),PolyhedronBufferGeometry=function(_BufferGeometry){function PolyhedronBufferGeometry(vertices,indices,radius$jscomp$0,detail$jscomp$0){function pushVertex(vertex){vertexBuffer.push(vertex.x,vertex.y,vertex.z)}function getVertexByIndex(index,vertex){index*=3;vertex.x=vertices[index+0];vertex.y=vertices[index+1];vertex.z=
vertices[index+2]}function correctUV(uv,stride,vector,azimuth){0>azimuth&&1===uv.x&&(uvBuffer[stride]=uv.x-1);0===vector.x&&0===vector.z&&(uvBuffer[stride]=azimuth/2/Math.PI+.5)}void 0===radius$jscomp$0&&(radius$jscomp$0=1);void 0===detail$jscomp$0&&(detail$jscomp$0=0);var _this=_BufferGeometry.call(this)||this;_this.type="PolyhedronBufferGeometry";_this.parameters={vertices:vertices,indices:indices,radius:radius$jscomp$0,detail:detail$jscomp$0};var vertexBuffer=[],uvBuffer=[];(function(detail){for(var a=
new Vector3,b=new Vector3,c=new Vector3,i=0;i<indices.length;i+=3){getVertexByIndex(indices[i+0],a);getVertexByIndex(indices[i+1],b);getVertexByIndex(indices[i+2],c);for(var a$jscomp$0=a,b$jscomp$0=b,c$jscomp$0=c,cols=detail+1,v=[],i$jscomp$0=0;i$jscomp$0<=cols;i$jscomp$0++){v[i$jscomp$0]=[];for(var aj=a$jscomp$0.clone().lerp(c$jscomp$0,i$jscomp$0/cols),bj=b$jscomp$0.clone().lerp(c$jscomp$0,i$jscomp$0/cols),rows=cols-i$jscomp$0,j=0;j<=rows;j++)v[i$jscomp$0][j]=0===j&&i$jscomp$0===cols?aj:aj.clone().lerp(bj,
j/rows)}for(a$jscomp$0=0;a$jscomp$0<cols;a$jscomp$0++)for(b$jscomp$0=0;b$jscomp$0<2*(cols-a$jscomp$0)-1;b$jscomp$0++)c$jscomp$0=Math.floor(b$jscomp$0/2),0===b$jscomp$0%2?(pushVertex(v[a$jscomp$0][c$jscomp$0+1]),pushVertex(v[a$jscomp$0+1][c$jscomp$0]),pushVertex(v[a$jscomp$0][c$jscomp$0])):(pushVertex(v[a$jscomp$0][c$jscomp$0+1]),pushVertex(v[a$jscomp$0+1][c$jscomp$0+1]),pushVertex(v[a$jscomp$0+1][c$jscomp$0]))}})(detail$jscomp$0);(function(radius){for(var vertex=new Vector3,i=0;i<vertexBuffer.length;i+=
3)vertex.x=vertexBuffer[i+0],vertex.y=vertexBuffer[i+1],vertex.z=vertexBuffer[i+2],vertex.normalize().multiplyScalar(radius),vertexBuffer[i+0]=vertex.x,vertexBuffer[i+1]=vertex.y,vertexBuffer[i+2]=vertex.z})(radius$jscomp$0);(function(){for(var vertex=new Vector3,i=0;i<vertexBuffer.length;i+=3)vertex.x=vertexBuffer[i+0],vertex.y=vertexBuffer[i+1],vertex.z=vertexBuffer[i+2],uvBuffer.push(Math.atan2(vertex.z,-vertex.x)/2/Math.PI+.5,1-(Math.atan2(-vertex.y,Math.sqrt(vertex.x*vertex.x+vertex.z*vertex.z))/
Math.PI+.5));vertex=new Vector3;i=new Vector3;for(var c=new Vector3,centroid=new Vector3,uvA=new Vector2,uvB=new Vector2,uvC=new Vector2,i$jscomp$0=0,j=0;i$jscomp$0<vertexBuffer.length;i$jscomp$0+=9,j+=6){vertex.set(vertexBuffer[i$jscomp$0+0],vertexBuffer[i$jscomp$0+1],vertexBuffer[i$jscomp$0+2]);i.set(vertexBuffer[i$jscomp$0+3],vertexBuffer[i$jscomp$0+4],vertexBuffer[i$jscomp$0+5]);c.set(vertexBuffer[i$jscomp$0+6],vertexBuffer[i$jscomp$0+7],vertexBuffer[i$jscomp$0+8]);uvA.set(uvBuffer[j+0],uvBuffer[j+
1]);uvB.set(uvBuffer[j+2],uvBuffer[j+3]);uvC.set(uvBuffer[j+4],uvBuffer[j+5]);centroid.copy(vertex).add(i).add(c).divideScalar(3);var azi=Math.atan2(centroid.z,-centroid.x);correctUV(uvA,j+0,vertex,azi);correctUV(uvB,j+2,i,azi);correctUV(uvC,j+4,c,azi)}for(vertex=0;vertex<uvBuffer.length;vertex+=6)i=uvBuffer[vertex+0],c=uvBuffer[vertex+2],centroid=uvBuffer[vertex+4],uvA=Math.min(i,c,centroid),.9<Math.max(i,c,centroid)&&.1>uvA&&(.2>i&&(uvBuffer[vertex+0]+=1),.2>c&&(uvBuffer[vertex+2]+=1),.2>centroid&&
(uvBuffer[vertex+4]+=1))})();_this.setAttribute("position",new Float32BufferAttribute(vertexBuffer,3));_this.setAttribute("normal",new Float32BufferAttribute(vertexBuffer.slice(),3));_this.setAttribute("uv",new Float32BufferAttribute(uvBuffer,2));0===detail$jscomp$0?_this.computeVertexNormals():_this.normalizeNormals();return _this}_inheritsLoose(PolyhedronBufferGeometry,_BufferGeometry);return PolyhedronBufferGeometry}(BufferGeometry),DodecahedronBufferGeometry=function(_PolyhedronBufferGeom){function DodecahedronBufferGeometry(radius,
detail){void 0===radius&&(radius=1);void 0===detail&&(detail=0);var _this=(1+Math.sqrt(5))/2;var r=1/_this;_this=_PolyhedronBufferGeom.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-_this,0,-r,_this,0,r,-_this,0,r,_this,-r,-_this,0,-r,_this,0,r,-_this,0,r,_this,0,-_this,0,-r,_this,0,-r,-_this,0,r,_this,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,
18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],radius,detail)||this;_this.type="DodecahedronBufferGeometry";_this.parameters={radius:radius,detail:detail};return _this}_inheritsLoose(DodecahedronBufferGeometry,_PolyhedronBufferGeom);return DodecahedronBufferGeometry}(PolyhedronBufferGeometry),DodecahedronGeometry=function(_Geometry){function DodecahedronGeometry(radius,detail){var _this=_Geometry.call(this)||this;_this.type="DodecahedronGeometry";
_this.parameters={radius:radius,detail:detail};_this.fromBufferGeometry(new DodecahedronBufferGeometry(radius,detail));_this.mergeVertices();return _this}_inheritsLoose(DodecahedronGeometry,_Geometry);return DodecahedronGeometry}(Geometry),_v0$2=new Vector3,_v1$5=new Vector3,_normal$1=new Vector3,_triangle=new Triangle,EdgesGeometry=function(_BufferGeometry){function EdgesGeometry(geometry,thresholdAngle){var _this=_BufferGeometry.call(this)||this;_this.type="EdgesGeometry";_this.parameters={thresholdAngle:thresholdAngle};
thresholdAngle=void 0!==thresholdAngle?thresholdAngle:1;geometry.isGeometry&&(geometry=(new BufferGeometry).fromGeometry(geometry));var precision=Math.pow(10,4),thresholdDot=Math.cos(MathUtils.DEG2RAD*thresholdAngle),indexAttr=geometry.getIndex();geometry=geometry.getAttribute("position");var indexCount=indexAttr?indexAttr.count:geometry.count,indexArr=[0,0,0],vertKeys=["a","b","c"],hashes=Array(3);thresholdAngle={};for(var vertices=[],i=0;i<indexCount;i+=3){indexAttr?(indexArr[0]=indexAttr.getX(i),
indexArr[1]=indexAttr.getX(i+1),indexArr[2]=indexAttr.getX(i+2)):(indexArr[0]=i,indexArr[1]=i+1,indexArr[2]=i+2);var a=_triangle.a,b=_triangle.b,c=_triangle.c;a.fromBufferAttribute(geometry,indexArr[0]);b.fromBufferAttribute(geometry,indexArr[1]);c.fromBufferAttribute(geometry,indexArr[2]);_triangle.getNormal(_normal$1);hashes[0]=Math.round(a.x*precision)+","+Math.round(a.y*precision)+","+Math.round(a.z*precision);hashes[1]=Math.round(b.x*precision)+","+Math.round(b.y*precision)+","+Math.round(b.z*
precision);hashes[2]=Math.round(c.x*precision)+","+Math.round(c.y*precision)+","+Math.round(c.z*precision);if(hashes[0]!==hashes[1]&&hashes[1]!==hashes[2]&&hashes[2]!==hashes[0])for(a=0;3>a;a++){b=(a+1)%3;var vecHash0=hashes[a],vecHash1=hashes[b];c=_triangle[vertKeys[a]];var v1=_triangle[vertKeys[b]],hash=vecHash0+"_"+vecHash1;vecHash0=vecHash1+"_"+vecHash0;vecHash0 in thresholdAngle&&thresholdAngle[vecHash0]?(_normal$1.dot(thresholdAngle[vecHash0].normal)<=thresholdDot&&(vertices.push(c.x,c.y,c.z),
vertices.push(v1.x,v1.y,v1.z)),thresholdAngle[vecHash0]=null):hash in thresholdAngle||(thresholdAngle[hash]={index0:indexArr[a],index1:indexArr[b],normal:_normal$1.clone()})}}for(var key in thresholdAngle)thresholdAngle[key]&&(precision=thresholdAngle[key],thresholdDot=precision.index1,_v0$2.fromBufferAttribute(geometry,precision.index0),_v1$5.fromBufferAttribute(geometry,thresholdDot),vertices.push(_v0$2.x,_v0$2.y,_v0$2.z),vertices.push(_v1$5.x,_v1$5.y,_v1$5.z));_this.setAttribute("position",new Float32BufferAttribute(vertices,
3));return _this}_inheritsLoose(EdgesGeometry,_BufferGeometry);return EdgesGeometry}(BufferGeometry),Earcut={triangulate:function(data,holeIndices,dim$jscomp$0){dim$jscomp$0=dim$jscomp$0||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim$jscomp$0:data.length,outerNode=linkedList(data,0,outerLen,dim$jscomp$0,!0),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;var maxX;if(hasHoles){var dim=dim$jscomp$0;hasHoles=[];var len;var x=0;for(len=
holeIndices.length;x<len;x++){var start=holeIndices[x]*dim;var end=x<len-1?holeIndices[x+1]*dim:data.length;start=linkedList(data,start,end,dim,!1);start===start.next&&(start.steiner=!0);hasHoles.push(getLeftmost(start))}hasHoles.sort(compareX);for(x=0;x<hasHoles.length;x++){dim=hasHoles[x];holeIndices=outerNode;if(holeIndices=findHoleBridge(dim,holeIndices))dim=splitPolygon(holeIndices,dim),filterPoints(holeIndices,holeIndices.next),filterPoints(dim,dim.next);outerNode=filterPoints(outerNode,outerNode.next)}}if(data.length>
80*dim$jscomp$0){var minX=maxX=data[0];var minY=hasHoles=data[1];for(dim=dim$jscomp$0;dim<outerLen;dim+=dim$jscomp$0)x=data[dim],holeIndices=data[dim+1],x<minX&&(minX=x),holeIndices<minY&&(minY=holeIndices),x>maxX&&(maxX=x),holeIndices>hasHoles&&(hasHoles=holeIndices);maxX=Math.max(maxX-minX,hasHoles-minY);maxX=0!==maxX?1/maxX:0}earcutLinked(outerNode,triangles,dim$jscomp$0,minX,minY,maxX);return triangles}},ShapeUtils={area:function(contour){for(var n=contour.length,a=0,p=n-1,q=0;q<n;p=q++)a+=contour[p].x*
contour[q].y-contour[q].x*contour[p].y;return.5*a},isClockWise:function(pts){return 0>ShapeUtils.area(pts)},triangulateShape:function(contour,holes){var vertices=[],holeIndices=[],faces=[];removeDupEndPts(contour);addContour(vertices,contour);contour=contour.length;holes.forEach(removeDupEndPts);for(var i=0;i<holes.length;i++)holeIndices.push(contour),contour+=holes[i].length,addContour(vertices,holes[i]);holes=Earcut.triangulate(vertices,holeIndices);for(vertices=0;vertices<holes.length;vertices+=
3)faces.push(holes.slice(vertices,vertices+3));return faces}},ExtrudeBufferGeometry=function(_BufferGeometry){function ExtrudeBufferGeometry(shapes,options){function addShape(shape){function scalePt2(pt,vec,size){vec||console.error("THREE.ExtrudeGeometry: vec does not exist");return vec.clone().multiplyScalar(size).add(pt)}function getBevelVec(inPt,inPrev,inNext){var v_trans_y=inPt.x-inPrev.x;var shrink_by=inPt.y-inPrev.y;var v_trans_x=inNext.x-inPt.x;var v_next_y=inNext.y-inPt.y,v_prev_lensq=v_trans_y*
v_trans_y+shrink_by*shrink_by;if(Math.abs(v_trans_y*v_next_y-shrink_by*v_trans_x)>Number.EPSILON){var v_prev_len=Math.sqrt(v_prev_lensq),v_next_len=Math.sqrt(v_trans_x*v_trans_x+v_next_y*v_next_y);v_prev_lensq=inPrev.x-shrink_by/v_prev_len;inPrev=inPrev.y+v_trans_y/v_prev_len;v_next_y=((inNext.x-v_next_y/v_next_len-v_prev_lensq)*v_next_y-(inNext.y+v_trans_x/v_next_len-inPrev)*v_trans_x)/(v_trans_y*v_next_y-shrink_by*v_trans_x);v_trans_x=v_prev_lensq+v_trans_y*v_next_y-inPt.x;v_trans_y=inPrev+shrink_by*
v_next_y-inPt.y;shrink_by=v_trans_x*v_trans_x+v_trans_y*v_trans_y;if(2>=shrink_by)return new Vector2(v_trans_x,v_trans_y);shrink_by=Math.sqrt(shrink_by/2)}else inPt=!1,v_trans_y>Number.EPSILON?v_trans_x>Number.EPSILON&&(inPt=!0):v_trans_y<-Number.EPSILON?v_trans_x<-Number.EPSILON&&(inPt=!0):Math.sign(shrink_by)===Math.sign(v_next_y)&&(inPt=!0),inPt?(v_trans_x=-shrink_by,shrink_by=Math.sqrt(v_prev_lensq)):(v_trans_x=v_trans_y,v_trans_y=shrink_by,shrink_by=Math.sqrt(v_prev_lensq/2));return new Vector2(v_trans_x/
shrink_by,v_trans_y/shrink_by)}function sidewalls(contour,layeroffset){for(var i=contour.length;0<=--i;){var _j2=i,_k2=i-1;0>_k2&&(_k2=contour.length-1);for(var _s=0,sl=steps+2*bevelSegments;_s<sl;_s++){var slen1=vlen*_s,slen2=vlen*(_s+1),b=layeroffset+_k2+slen1,c=layeroffset+_k2+slen2;slen2=layeroffset+_j2+slen2;addVertex(layeroffset+_j2+slen1);addVertex(b);addVertex(slen2);addVertex(b);addVertex(c);addVertex(slen2);slen1=verticesArray.length/3;slen1=uvgen.generateSideWallUV(scope,verticesArray,
slen1-6,slen1-3,slen1-2,slen1-1);addUV(slen1[0]);addUV(slen1[1]);addUV(slen1[3]);addUV(slen1[1]);addUV(slen1[2]);addUV(slen1[3])}}}function v(x,y,z){placeholder.push(x);placeholder.push(y);placeholder.push(z)}function f3(a,b,c){addVertex(a);addVertex(b);addVertex(c);a=verticesArray.length/3;a=uvgen.generateTopUV(scope,verticesArray,a-3,a-2,a-1);addUV(a[0]);addUV(a[1]);addUV(a[2])}function addVertex(index){verticesArray.push(placeholder[3*index]);verticesArray.push(placeholder[3*index+1]);verticesArray.push(placeholder[3*
index+2])}function addUV(vector2){uvArray.push(vector2.x);uvArray.push(vector2.y)}var placeholder=[],curveSegments=void 0!==options.curveSegments?options.curveSegments:12,steps=void 0!==options.steps?options.steps:1,depth=void 0!==options.depth?options.depth:100,bevelEnabled=void 0!==options.bevelEnabled?options.bevelEnabled:!0,bevelThickness=void 0!==options.bevelThickness?options.bevelThickness:6,bevelSize=void 0!==options.bevelSize?options.bevelSize:bevelThickness-2,bevelOffset=void 0!==options.bevelOffset?
options.bevelOffset:0,bevelSegments=void 0!==options.bevelSegments?options.bevelSegments:3,extrudePath=options.extrudePath,uvgen=void 0!==options.UVGenerator?options.UVGenerator:WorldUVGenerator;void 0!==options.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),depth=options.amount);var extrudeByPath=!1;if(extrudePath){var extrudePts=extrudePath.getSpacedPoints(steps);extrudeByPath=!0;bevelEnabled=!1;var splineTube=extrudePath.computeFrenetFrames(steps,!1);var binormal=
new Vector3;var normal=new Vector3;var position2=new Vector3}bevelEnabled||(bevelOffset=bevelSize=bevelThickness=bevelSegments=0);shape=shape.extractPoints(curveSegments);extrudePath=shape.shape;var holes=shape.holes;if(!ShapeUtils.isClockWise(extrudePath))for(extrudePath=extrudePath.reverse(),shape=0,curveSegments=holes.length;shape<curveSegments;shape++){var ahole=holes[shape];ShapeUtils.isClockWise(ahole)&&(holes[shape]=ahole.reverse())}var faces=ShapeUtils.triangulateShape(extrudePath,holes),
contour$jscomp$0=extrudePath;shape=0;for(curveSegments=holes.length;shape<curveSegments;shape++)extrudePath=extrudePath.concat(holes[shape]);var vlen=extrudePath.length,flen=faces.length;shape=[];curveSegments=0;ahole=contour$jscomp$0.length;for(var j=ahole-1,k=curveSegments+1;curveSegments<ahole;curveSegments++,j++,k++)j===ahole&&(j=0),k===ahole&&(k=0),shape[curveSegments]=getBevelVec(contour$jscomp$0[curveSegments],contour$jscomp$0[j],contour$jscomp$0[k]);curveSegments=[];ahole=shape.concat();k=
0;for(var _hl2=holes.length;k<_hl2;k++){var _ahole2=holes[k];j=[];for(var _i2=0,_il=_ahole2.length,_j=_il-1,_k=_i2+1;_i2<_il;_i2++,_j++,_k++)_j===_il&&(_j=0),_k===_il&&(_k=0),j[_i2]=getBevelVec(_ahole2[_i2],_ahole2[_j],_ahole2[_k]);curveSegments.push(j);ahole=ahole.concat(j)}for(k=0;k<bevelSegments;k++){j=k/bevelSegments;_hl2=bevelThickness*Math.cos(j*Math.PI/2);_ahole2=bevelSize*Math.sin(j*Math.PI/2)+bevelOffset;j=0;for(_i2=contour$jscomp$0.length;j<_i2;j++)_il=scalePt2(contour$jscomp$0[j],shape[j],
_ahole2),v(_il.x,_il.y,-_hl2);_i2=0;for(_il=holes.length;_i2<_il;_i2++){_j=holes[_i2];j=curveSegments[_i2];_k=0;for(var _il3=_j.length;_k<_il3;_k++){var _vert=scalePt2(_j[_k],j[_k],_ahole2);v(_vert.x,_vert.y,-_hl2)}}}j=bevelSize+bevelOffset;for(k=0;k<vlen;k++)_hl2=bevelEnabled?scalePt2(extrudePath[k],ahole[k],j):extrudePath[k],extrudeByPath?(normal.copy(splineTube.normals[0]).multiplyScalar(_hl2.x),binormal.copy(splineTube.binormals[0]).multiplyScalar(_hl2.y),position2.copy(extrudePts[0]).add(normal).add(binormal),
v(position2.x,position2.y,position2.z)):v(_hl2.x,_hl2.y,0);for(k=1;k<=steps;k++)for(_hl2=0;_hl2<vlen;_hl2++)_ahole2=bevelEnabled?scalePt2(extrudePath[_hl2],ahole[_hl2],j):extrudePath[_hl2],extrudeByPath?(normal.copy(splineTube.normals[k]).multiplyScalar(_ahole2.x),binormal.copy(splineTube.binormals[k]).multiplyScalar(_ahole2.y),position2.copy(extrudePts[k]).add(normal).add(binormal),v(position2.x,position2.y,position2.z)):v(_ahole2.x,_ahole2.y,depth/steps*k);for(splineTube=bevelSegments-1;0<=splineTube;splineTube--){normal=
splineTube/bevelSegments;binormal=bevelThickness*Math.cos(normal*Math.PI/2);normal=bevelSize*Math.sin(normal*Math.PI/2)+bevelOffset;position2=0;for(extrudePath=contour$jscomp$0.length;position2<extrudePath;position2++)ahole=scalePt2(contour$jscomp$0[position2],shape[position2],normal),v(ahole.x,ahole.y,depth+binormal);position2=0;for(extrudePath=holes.length;position2<extrudePath;position2++)for(ahole=holes[position2],j=curveSegments[position2],k=0,_hl2=ahole.length;k<_hl2;k++)_ahole2=scalePt2(ahole[k],
j[k],normal),extrudeByPath?v(_ahole2.x,_ahole2.y+extrudePts[steps-1].y,extrudePts[steps-1].x+binormal):v(_ahole2.x,_ahole2.y,depth+binormal)}(function(){var start=verticesArray.length/3;if(bevelEnabled){for(var offset=0*vlen,_i9=0;_i9<flen;_i9++){var face=faces[_i9];f3(face[2]+offset,face[1]+offset,face[0]+offset)}offset=vlen*(steps+2*bevelSegments);for(_i9=0;_i9<flen;_i9++)face=faces[_i9],f3(face[0]+offset,face[1]+offset,face[2]+offset)}else{for(offset=0;offset<flen;offset++)_i9=faces[offset],f3(_i9[2],
_i9[1],_i9[0]);for(offset=0;offset<flen;offset++)_i9=faces[offset],f3(_i9[0]+vlen*steps,_i9[1]+vlen*steps,_i9[2]+vlen*steps)}scope.addGroup(start,verticesArray.length/3-start,0)})();(function(){var start=verticesArray.length/3,layeroffset=0;sidewalls(contour$jscomp$0,layeroffset);layeroffset+=contour$jscomp$0.length;for(var _h5=0,_hl5=holes.length;_h5<_hl5;_h5++){var _ahole5=holes[_h5];sidewalls(_ahole5,layeroffset);layeroffset+=_ahole5.length}scope.addGroup(start,verticesArray.length/3-start,1)})()}
var _this=_BufferGeometry.call(this)||this;_this.type="ExtrudeBufferGeometry";_this.parameters={shapes:shapes,options:options};shapes=Array.isArray(shapes)?shapes:[shapes];for(var scope=_assertThisInitialized(_this),verticesArray=[],uvArray=[],i$jscomp$0=0,l=shapes.length;i$jscomp$0<l;i$jscomp$0++)addShape(shapes[i$jscomp$0]);_this.setAttribute("position",new Float32BufferAttribute(verticesArray,3));_this.setAttribute("uv",new Float32BufferAttribute(uvArray,2));_this.computeVertexNormals();return _this}
_inheritsLoose(ExtrudeBufferGeometry,_BufferGeometry);ExtrudeBufferGeometry.prototype.toJSON=function(){var data=BufferGeometry.prototype.toJSON.call(this),shapes=this.parameters.shapes,options=this.parameters.options;data.shapes=[];if(Array.isArray(shapes))for(var i=0,l=shapes.length;i<l;i++)data.shapes.push(shapes[i].uuid);else data.shapes.push(shapes.uuid);void 0!==options.extrudePath&&(data.options.extrudePath=options.extrudePath.toJSON());return data};return ExtrudeBufferGeometry}(BufferGeometry),
WorldUVGenerator={generateTopUV:function(geometry,vertices,indexA,indexB,indexC){geometry=vertices[3*indexB];indexB=vertices[3*indexB+1];var c_x=vertices[3*indexC];indexC=vertices[3*indexC+1];return[new Vector2(vertices[3*indexA],vertices[3*indexA+1]),new Vector2(geometry,indexB),new Vector2(c_x,indexC)]},generateSideWallUV:function(geometry,vertices,indexA,indexB,indexC,indexD){geometry=vertices[3*indexA];var a_y=vertices[3*indexA+1];indexA=vertices[3*indexA+2];var b_x=vertices[3*indexB],b_y=vertices[3*
indexB+1];indexB=vertices[3*indexB+2];var c_x=vertices[3*indexC],c_y=vertices[3*indexC+1];indexC=vertices[3*indexC+2];var d_x=vertices[3*indexD],d_y=vertices[3*indexD+1];vertices=vertices[3*indexD+2];return.01>Math.abs(a_y-b_y)?[new Vector2(geometry,1-indexA),new Vector2(b_x,1-indexB),new Vector2(c_x,1-indexC),new Vector2(d_x,1-vertices)]:[new Vector2(a_y,1-indexA),new Vector2(b_y,1-indexB),new Vector2(c_y,1-indexC),new Vector2(d_y,1-vertices)]}},ExtrudeGeometry=function(_Geometry){function ExtrudeGeometry(shapes,
options){var _this=_Geometry.call(this)||this;_this.type="ExtrudeGeometry";_this.parameters={shapes:shapes,options:options};_this.fromBufferGeometry(new ExtrudeBufferGeometry(shapes,options));_this.mergeVertices();return _this}_inheritsLoose(ExtrudeGeometry,_Geometry);ExtrudeGeometry.prototype.toJSON=function(){var data=_Geometry.prototype.toJSON.call(this),shapes=this.parameters.shapes,options=this.parameters.options;data.shapes=[];if(Array.isArray(shapes))for(var i=0,l=shapes.length;i<l;i++)data.shapes.push(shapes[i].uuid);
else data.shapes.push(shapes.uuid);void 0!==options.extrudePath&&(data.options.extrudePath=options.extrudePath.toJSON());return data};return ExtrudeGeometry}(Geometry),IcosahedronBufferGeometry=function(_PolyhedronBufferGeom){function IcosahedronBufferGeometry(radius,detail){void 0===radius&&(radius=1);void 0===detail&&(detail=0);var _this=(1+Math.sqrt(5))/2;_this=_PolyhedronBufferGeom.call(this,[-1,_this,0,1,_this,0,-1,-_this,0,1,-_this,0,0,-1,_this,0,1,_this,0,-1,-_this,0,1,-_this,_this,0,-1,_this,
0,1,-_this,0,-1,-_this,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],radius,detail)||this;_this.type="IcosahedronBufferGeometry";_this.parameters={radius:radius,detail:detail};return _this}_inheritsLoose(IcosahedronBufferGeometry,_PolyhedronBufferGeom);return IcosahedronBufferGeometry}(PolyhedronBufferGeometry),IcosahedronGeometry=function(_Geometry){function IcosahedronGeometry(radius,detail){var _this=_Geometry.call(this)||
this;_this.type="IcosahedronGeometry";_this.parameters={radius:radius,detail:detail};_this.fromBufferGeometry(new IcosahedronBufferGeometry(radius,detail));_this.mergeVertices();return _this}_inheritsLoose(IcosahedronGeometry,_Geometry);return IcosahedronGeometry}(Geometry),LatheBufferGeometry=function(_BufferGeometry){function LatheBufferGeometry(points,segments,phiStart,phiLength){void 0===segments&&(segments=12);void 0===phiStart&&(phiStart=0);void 0===phiLength&&(phiLength=2*Math.PI);var _this=
_BufferGeometry.call(this)||this;_this.type="LatheBufferGeometry";_this.parameters={points:points,segments:segments,phiStart:phiStart,phiLength:phiLength};segments=Math.floor(segments);phiLength=MathUtils.clamp(phiLength,0,2*Math.PI);for(var indices=[],vertices=[],uvs=[],inverseSegments=1/segments,vertex=new Vector3,uv=new Vector2,i=0;i<=segments;i++){var phi=phiStart+i*inverseSegments*phiLength,sin=Math.sin(phi);phi=Math.cos(phi);for(var j=0;j<=points.length-1;j++)vertex.x=points[j].x*sin,vertex.y=
points[j].y,vertex.z=points[j].x*phi,vertices.push(vertex.x,vertex.y,vertex.z),uv.x=i/segments,uv.y=j/(points.length-1),uvs.push(uv.x,uv.y)}for(phiStart=0;phiStart<segments;phiStart++)for(inverseSegments=0;inverseSegments<points.length-1;inverseSegments++)vertex=inverseSegments+phiStart*points.length,uv=vertex+points.length,i=vertex+points.length+1,sin=vertex+1,indices.push(vertex,uv,sin),indices.push(uv,i,sin);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,
3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));_this.computeVertexNormals();if(phiLength===2*Math.PI)for(phiLength=_this.attributes.normal.array,indices=new Vector3,vertices=new Vector3,uvs=new Vector3,segments=segments*points.length*3,inverseSegments=phiStart=0;phiStart<points.length;phiStart++,inverseSegments+=3)indices.x=phiLength[inverseSegments+0],indices.y=phiLength[inverseSegments+1],indices.z=phiLength[inverseSegments+2],vertices.x=phiLength[segments+inverseSegments+0],vertices.y=
phiLength[segments+inverseSegments+1],vertices.z=phiLength[segments+inverseSegments+2],uvs.addVectors(indices,vertices).normalize(),phiLength[inverseSegments+0]=phiLength[segments+inverseSegments+0]=uvs.x,phiLength[inverseSegments+1]=phiLength[segments+inverseSegments+1]=uvs.y,phiLength[inverseSegments+2]=phiLength[segments+inverseSegments+2]=uvs.z;return _this}_inheritsLoose(LatheBufferGeometry,_BufferGeometry);return LatheBufferGeometry}(BufferGeometry),LatheGeometry=function(_Geometry){function LatheGeometry(points,
segments,phiStart,phiLength){var _this=_Geometry.call(this)||this;_this.type="LatheGeometry";_this.parameters={points:points,segments:segments,phiStart:phiStart,phiLength:phiLength};_this.fromBufferGeometry(new LatheBufferGeometry(points,segments,phiStart,phiLength));_this.mergeVertices();return _this}_inheritsLoose(LatheGeometry,_Geometry);return LatheGeometry}(Geometry),OctahedronBufferGeometry=function(_PolyhedronBufferGeom){function OctahedronBufferGeometry(radius,detail){void 0===radius&&(radius=
1);void 0===detail&&(detail=0);var _this=_PolyhedronBufferGeom.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],radius,detail)||this;_this.type="OctahedronBufferGeometry";_this.parameters={radius:radius,detail:detail};return _this}_inheritsLoose(OctahedronBufferGeometry,_PolyhedronBufferGeom);return OctahedronBufferGeometry}(PolyhedronBufferGeometry),OctahedronGeometry=function(_Geometry){function OctahedronGeometry(radius,detail){var _this=_Geometry.call(this)||
this;_this.type="OctahedronGeometry";_this.parameters={radius:radius,detail:detail};_this.fromBufferGeometry(new OctahedronBufferGeometry(radius,detail));_this.mergeVertices();return _this}_inheritsLoose(OctahedronGeometry,_Geometry);return OctahedronGeometry}(Geometry);ParametricBufferGeometry.prototype=Object.create(BufferGeometry.prototype);ParametricBufferGeometry.prototype.constructor=ParametricBufferGeometry;ParametricGeometry.prototype=Object.create(Geometry.prototype);ParametricGeometry.prototype.constructor=
ParametricGeometry;var PlaneGeometry=function(_Geometry){function PlaneGeometry(width,height,widthSegments,heightSegments){var _this=_Geometry.call(this)||this;_this.type="PlaneGeometry";_this.parameters={width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};_this.fromBufferGeometry(new PlaneBufferGeometry(width,height,widthSegments,heightSegments));_this.mergeVertices();return _this}_inheritsLoose(PlaneGeometry,_Geometry);return PlaneGeometry}(Geometry),PolyhedronGeometry=
function(_Geometry){function PolyhedronGeometry(vertices,indices,radius,detail){var _this=_Geometry.call(this)||this;_this.type="PolyhedronGeometry";_this.parameters={vertices:vertices,indices:indices,radius:radius,detail:detail};_this.fromBufferGeometry(new PolyhedronBufferGeometry(vertices,indices,radius,detail));_this.mergeVertices();return _this}_inheritsLoose(PolyhedronGeometry,_Geometry);return PolyhedronGeometry}(Geometry),RingBufferGeometry=function(_BufferGeometry){function RingBufferGeometry(innerRadius,
outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){void 0===innerRadius&&(innerRadius=.5);void 0===outerRadius&&(outerRadius=1);void 0===thetaSegments&&(thetaSegments=8);void 0===phiSegments&&(phiSegments=1);void 0===thetaStart&&(thetaStart=0);void 0===thetaLength&&(thetaLength=2*Math.PI);var _this=_BufferGeometry.call(this)||this;_this.type="RingBufferGeometry";_this.parameters={innerRadius:innerRadius,outerRadius:outerRadius,thetaSegments:thetaSegments,phiSegments:phiSegments,thetaStart:thetaStart,
thetaLength:thetaLength};thetaSegments=Math.max(3,thetaSegments);phiSegments=Math.max(1,phiSegments);var indices=[],vertices=[],normals=[],uvs=[],radius=innerRadius;innerRadius=(outerRadius-innerRadius)/phiSegments;for(var vertex=new Vector3,uv=new Vector2,j=0;j<=phiSegments;j++){for(var i=0;i<=thetaSegments;i++){var segment=thetaStart+i/thetaSegments*thetaLength;vertex.x=radius*Math.cos(segment);vertex.y=radius*Math.sin(segment);vertices.push(vertex.x,vertex.y,vertex.z);normals.push(0,0,1);uv.x=
(vertex.x/outerRadius+1)/2;uv.y=(vertex.y/outerRadius+1)/2;uvs.push(uv.x,uv.y)}radius+=innerRadius}for(outerRadius=0;outerRadius<phiSegments;outerRadius++)for(thetaStart=outerRadius*(thetaSegments+1),thetaLength=0;thetaLength<thetaSegments;thetaLength++)radius=thetaLength+thetaStart,innerRadius=radius+thetaSegments+1,vertex=radius+thetaSegments+2,uv=radius+1,indices.push(radius,innerRadius,uv),indices.push(innerRadius,vertex,uv);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,
3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(RingBufferGeometry,_BufferGeometry);return RingBufferGeometry}(BufferGeometry),RingGeometry=function(_Geometry){function RingGeometry(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){var _this=_Geometry.call(this)||this;_this.type="RingGeometry";_this.parameters={innerRadius:innerRadius,outerRadius:outerRadius,thetaSegments:thetaSegments,
phiSegments:phiSegments,thetaStart:thetaStart,thetaLength:thetaLength};_this.fromBufferGeometry(new RingBufferGeometry(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength));_this.mergeVertices();return _this}_inheritsLoose(RingGeometry,_Geometry);return RingGeometry}(Geometry),ShapeBufferGeometry=function(_BufferGeometry){function ShapeBufferGeometry(shapes,curveSegments){function addShape(shape){var indexOffset=vertices.length/3,points=shape.extractPoints(curveSegments);shape=
points.shape;var shapeHoles=points.holes;!1===ShapeUtils.isClockWise(shape)&&(shape=shape.reverse());points=0;for(var l=shapeHoles.length;points<l;points++){var shapeHole=shapeHoles[points];!0===ShapeUtils.isClockWise(shapeHole)&&(shapeHoles[points]=shapeHole.reverse())}points=ShapeUtils.triangulateShape(shape,shapeHoles);l=0;for(shapeHole=shapeHoles.length;l<shapeHole;l++)shape=shape.concat(shapeHoles[l]);shapeHoles=0;for(l=shape.length;shapeHoles<l;shapeHoles++)shapeHole=shape[shapeHoles],vertices.push(shapeHole.x,
shapeHole.y,0),normals.push(0,0,1),uvs.push(shapeHole.x,shapeHole.y);shape=0;for(shapeHoles=points.length;shape<shapeHoles;shape++)l=points[shape],indices.push(l[0]+indexOffset,l[1]+indexOffset,l[2]+indexOffset),groupCount+=3}void 0===curveSegments&&(curveSegments=12);var _this=_BufferGeometry.call(this)||this;_this.type="ShapeBufferGeometry";_this.parameters={shapes:shapes,curveSegments:curveSegments};var indices=[],vertices=[],normals=[],uvs=[],groupStart=0,groupCount=0;if(!1===Array.isArray(shapes))addShape(shapes);
else for(var i=0;i<shapes.length;i++)addShape(shapes[i]),_this.addGroup(groupStart,groupCount,i),groupStart+=groupCount,groupCount=0;_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(ShapeBufferGeometry,_BufferGeometry);ShapeBufferGeometry.prototype.toJSON=function(){var data=BufferGeometry.prototype.toJSON.call(this),
shapes=this.parameters.shapes;data.shapes=[];if(Array.isArray(shapes))for(var i=0,l=shapes.length;i<l;i++)data.shapes.push(shapes[i].uuid);else data.shapes.push(shapes.uuid);return data};return ShapeBufferGeometry}(BufferGeometry),ShapeGeometry=function(_Geometry){function ShapeGeometry(shapes,curveSegments){var _this=_Geometry.call(this)||this;_this.type="ShapeGeometry";"object"===typeof curveSegments&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),curveSegments=curveSegments.curveSegments);
_this.parameters={shapes:shapes,curveSegments:curveSegments};_this.fromBufferGeometry(new ShapeBufferGeometry(shapes,curveSegments));_this.mergeVertices();return _this}_inheritsLoose(ShapeGeometry,_Geometry);ShapeGeometry.prototype.toJSON=function(){var data=Geometry.prototype.toJSON.call(this),shapes=this.parameters.shapes;data.shapes=[];if(Array.isArray(shapes))for(var i=0,l=shapes.length;i<l;i++)data.shapes.push(shapes[i].uuid);else data.shapes.push(shapes.uuid);return data};return ShapeGeometry}(Geometry),
SphereBufferGeometry=function(_BufferGeometry){function SphereBufferGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){void 0===radius&&(radius=1);void 0===widthSegments&&(widthSegments=8);void 0===heightSegments&&(heightSegments=6);void 0===phiStart&&(phiStart=0);void 0===phiLength&&(phiLength=2*Math.PI);void 0===thetaStart&&(thetaStart=0);void 0===thetaLength&&(thetaLength=Math.PI);var _this=_BufferGeometry.call(this)||this;_this.type="SphereBufferGeometry";
_this.parameters={radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};widthSegments=Math.max(3,Math.floor(widthSegments));heightSegments=Math.max(2,Math.floor(heightSegments));for(var thetaEnd=Math.min(thetaStart+thetaLength,Math.PI),index=0,grid=[],vertex=new Vector3,normal=new Vector3,indices=[],vertices=[],normals=[],uvs=[],iy=0;iy<=heightSegments;iy++){var verticesRow=[],v=iy/heightSegments,
uOffset=0;0==iy&&0==thetaStart?uOffset=.5/widthSegments:iy==heightSegments&&thetaEnd==Math.PI&&(uOffset=-.5/widthSegments);for(var ix=0;ix<=widthSegments;ix++){var u=ix/widthSegments;vertex.x=-radius*Math.cos(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);vertex.y=radius*Math.cos(thetaStart+v*thetaLength);vertex.z=radius*Math.sin(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);vertices.push(vertex.x,vertex.y,vertex.z);normal.copy(vertex).normalize();normals.push(normal.x,normal.y,
normal.z);uvs.push(u+uOffset,1-v);verticesRow.push(index++)}grid.push(verticesRow)}for(radius=0;radius<heightSegments;radius++)for(phiStart=0;phiStart<widthSegments;phiStart++)phiLength=grid[radius][phiStart+1],thetaLength=grid[radius][phiStart],index=grid[radius+1][phiStart],vertex=grid[radius+1][phiStart+1],(0!==radius||0<thetaStart)&&indices.push(phiLength,thetaLength,vertex),(radius!==heightSegments-1||thetaEnd<Math.PI)&&indices.push(thetaLength,index,vertex);_this.setIndex(indices);_this.setAttribute("position",
new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(SphereBufferGeometry,_BufferGeometry);return SphereBufferGeometry}(BufferGeometry),SphereGeometry=function(_Geometry){function SphereGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){var _this=_Geometry.call(this)||this;_this.type="SphereGeometry";_this.parameters={radius:radius,
widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};_this.fromBufferGeometry(new SphereBufferGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength));_this.mergeVertices();return _this}_inheritsLoose(SphereGeometry,_Geometry);return SphereGeometry}(Geometry),TetrahedronBufferGeometry=function(_PolyhedronBufferGeom){function TetrahedronBufferGeometry(radius,detail){void 0===radius&&
(radius=1);void 0===detail&&(detail=0);var _this=_PolyhedronBufferGeom.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],radius,detail)||this;_this.type="TetrahedronBufferGeometry";_this.parameters={radius:radius,detail:detail};return _this}_inheritsLoose(TetrahedronBufferGeometry,_PolyhedronBufferGeom);return TetrahedronBufferGeometry}(PolyhedronBufferGeometry),TetrahedronGeometry=function(_Geometry){function TetrahedronGeometry(radius,detail){var _this=_Geometry.call(this)||this;
_this.type="TetrahedronGeometry";_this.parameters={radius:radius,detail:detail};_this.fromBufferGeometry(new TetrahedronBufferGeometry(radius,detail));_this.mergeVertices();return _this}_inheritsLoose(TetrahedronGeometry,_Geometry);return TetrahedronGeometry}(Geometry),TextBufferGeometry=function(_ExtrudeBufferGeometr){function TextBufferGeometry(text,parameters){void 0===parameters&&(parameters={});var font=parameters.font;if(!font||!font.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),
new BufferGeometry;text=font.generateShapes(text,parameters.size);parameters.depth=void 0!==parameters.height?parameters.height:50;void 0===parameters.bevelThickness&&(parameters.bevelThickness=10);void 0===parameters.bevelSize&&(parameters.bevelSize=8);void 0===parameters.bevelEnabled&&(parameters.bevelEnabled=!1);parameters=_ExtrudeBufferGeometr.call(this,text,parameters)||this;parameters.type="TextBufferGeometry";return parameters}_inheritsLoose(TextBufferGeometry,_ExtrudeBufferGeometr);return TextBufferGeometry}(ExtrudeBufferGeometry),
TextGeometry=function(_Geometry){function TextGeometry(text,parameters){var _this=_Geometry.call(this)||this;_this.type="TextGeometry";_this.parameters={text:text,parameters:parameters};_this.fromBufferGeometry(new TextBufferGeometry(text,parameters));_this.mergeVertices();return _this}_inheritsLoose(TextGeometry,_Geometry);return TextGeometry}(Geometry),TorusBufferGeometry=function(_BufferGeometry){function TorusBufferGeometry(radius,tube,radialSegments,tubularSegments,arc){void 0===radius&&(radius=
1);void 0===tube&&(tube=.4);void 0===radialSegments&&(radialSegments=8);void 0===tubularSegments&&(tubularSegments=6);void 0===arc&&(arc=2*Math.PI);var _this=_BufferGeometry.call(this)||this;_this.type="TorusBufferGeometry";_this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc};radialSegments=Math.floor(radialSegments);tubularSegments=Math.floor(tubularSegments);for(var indices=[],vertices=[],normals=[],uvs=[],center=new Vector3,vertex=new Vector3,
normal=new Vector3,j=0;j<=radialSegments;j++)for(var i=0;i<=tubularSegments;i++){var u=i/tubularSegments*arc,v=j/radialSegments*Math.PI*2;vertex.x=(radius+tube*Math.cos(v))*Math.cos(u);vertex.y=(radius+tube*Math.cos(v))*Math.sin(u);vertex.z=tube*Math.sin(v);vertices.push(vertex.x,vertex.y,vertex.z);center.x=radius*Math.cos(u);center.y=radius*Math.sin(u);normal.subVectors(vertex,center).normalize();normals.push(normal.x,normal.y,normal.z);uvs.push(i/tubularSegments);uvs.push(j/radialSegments)}for(radius=
1;radius<=radialSegments;radius++)for(tube=1;tube<=tubularSegments;tube++)arc=(tubularSegments+1)*(radius-1)+tube-1,center=(tubularSegments+1)*(radius-1)+tube,vertex=(tubularSegments+1)*radius+tube,indices.push((tubularSegments+1)*radius+tube-1,arc,vertex),indices.push(arc,center,vertex);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,
2));return _this}_inheritsLoose(TorusBufferGeometry,_BufferGeometry);return TorusBufferGeometry}(BufferGeometry),TorusGeometry=function(_Geometry){function TorusGeometry(radius,tube,radialSegments,tubularSegments,arc){var _this=_Geometry.call(this)||this;_this.type="TorusGeometry";_this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc};_this.fromBufferGeometry(new TorusBufferGeometry(radius,tube,radialSegments,tubularSegments,arc));_this.mergeVertices();
return _this}_inheritsLoose(TorusGeometry,_Geometry);return TorusGeometry}(Geometry),TorusKnotBufferGeometry=function(_BufferGeometry){function TorusKnotBufferGeometry(radius$jscomp$0,tube,tubularSegments,radialSegments,p$jscomp$0,q$jscomp$0){function calculatePositionOnCurve(u,p,q,radius,position){var su=Math.sin(u);p=q/p*u;q=Math.cos(p);position.x=radius*(2+q)*.5*Math.cos(u);position.y=radius*(2+q)*su*.5;position.z=radius*Math.sin(p)*.5}void 0===radius$jscomp$0&&(radius$jscomp$0=1);void 0===tube&&
(tube=.4);void 0===tubularSegments&&(tubularSegments=64);void 0===radialSegments&&(radialSegments=8);void 0===p$jscomp$0&&(p$jscomp$0=2);void 0===q$jscomp$0&&(q$jscomp$0=3);var _this=_BufferGeometry.call(this)||this;_this.type="TorusKnotBufferGeometry";_this.parameters={radius:radius$jscomp$0,tube:tube,tubularSegments:tubularSegments,radialSegments:radialSegments,p:p$jscomp$0,q:q$jscomp$0};tubularSegments=Math.floor(tubularSegments);radialSegments=Math.floor(radialSegments);for(var indices=[],vertices=
[],normals=[],uvs=[],vertex=new Vector3,normal=new Vector3,P1=new Vector3,P2=new Vector3,B=new Vector3,T=new Vector3,N=new Vector3,i=0;i<=tubularSegments;++i){var u$jscomp$0=i/tubularSegments*p$jscomp$0*Math.PI*2;calculatePositionOnCurve(u$jscomp$0,p$jscomp$0,q$jscomp$0,radius$jscomp$0,P1);calculatePositionOnCurve(u$jscomp$0+.01,p$jscomp$0,q$jscomp$0,radius$jscomp$0,P2);T.subVectors(P2,P1);N.addVectors(P2,P1);B.crossVectors(T,N);N.crossVectors(B,T);B.normalize();N.normalize();for(u$jscomp$0=0;u$jscomp$0<=
radialSegments;++u$jscomp$0){var v=u$jscomp$0/radialSegments*Math.PI*2,cx=-tube*Math.cos(v);v=tube*Math.sin(v);vertex.x=P1.x+(cx*N.x+v*B.x);vertex.y=P1.y+(cx*N.y+v*B.y);vertex.z=P1.z+(cx*N.z+v*B.z);vertices.push(vertex.x,vertex.y,vertex.z);normal.subVectors(vertex,P1).normalize();normals.push(normal.x,normal.y,normal.z);uvs.push(i/tubularSegments);uvs.push(u$jscomp$0/radialSegments)}}for(radius$jscomp$0=1;radius$jscomp$0<=tubularSegments;radius$jscomp$0++)for(tube=1;tube<=radialSegments;tube++)p$jscomp$0=
(radialSegments+1)*radius$jscomp$0+(tube-1),q$jscomp$0=(radialSegments+1)*radius$jscomp$0+tube,vertex=(radialSegments+1)*(radius$jscomp$0-1)+tube,indices.push((radialSegments+1)*(radius$jscomp$0-1)+(tube-1),p$jscomp$0,vertex),indices.push(p$jscomp$0,q$jscomp$0,vertex);_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}
_inheritsLoose(TorusKnotBufferGeometry,_BufferGeometry);return TorusKnotBufferGeometry}(BufferGeometry),TorusKnotGeometry=function(_Geometry){function TorusKnotGeometry(radius,tube,tubularSegments,radialSegments,p,q,heightScale){var _this=_Geometry.call(this)||this;_this.type="TorusKnotGeometry";_this.parameters={radius:radius,tube:tube,tubularSegments:tubularSegments,radialSegments:radialSegments,p:p,q:q};void 0!==heightScale&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");
_this.fromBufferGeometry(new TorusKnotBufferGeometry(radius,tube,tubularSegments,radialSegments,p,q));_this.mergeVertices();return _this}_inheritsLoose(TorusKnotGeometry,_Geometry);return TorusKnotGeometry}(Geometry),TubeBufferGeometry=function(_BufferGeometry){function TubeBufferGeometry(path,tubularSegments,radius,radialSegments,closed){function generateSegment(i){P=path.getPointAt(i/tubularSegments,P);var N=frames.normals[i];i=frames.binormals[i];for(var j=0;j<=radialSegments;j++){var v=j/radialSegments*
Math.PI*2,sin=Math.sin(v);v=-Math.cos(v);normal.x=v*N.x+sin*i.x;normal.y=v*N.y+sin*i.y;normal.z=v*N.z+sin*i.z;normal.normalize();normals.push(normal.x,normal.y,normal.z);vertex.x=P.x+radius*normal.x;vertex.y=P.y+radius*normal.y;vertex.z=P.z+radius*normal.z;vertices.push(vertex.x,vertex.y,vertex.z)}}void 0===tubularSegments&&(tubularSegments=64);void 0===radius&&(radius=1);void 0===radialSegments&&(radialSegments=8);void 0===closed&&(closed=!1);var _this=_BufferGeometry.call(this)||this;_this.type=
"TubeBufferGeometry";_this.parameters={path:path,tubularSegments:tubularSegments,radius:radius,radialSegments:radialSegments,closed:closed};var frames=path.computeFrenetFrames(tubularSegments,closed);_this.tangents=frames.tangents;_this.normals=frames.normals;_this.binormals=frames.binormals;var vertex=new Vector3,normal=new Vector3,uv=new Vector2,P=new Vector3,vertices=[],normals=[],uvs=[],indices=[];(function(){for(var i=0;i<tubularSegments;i++)generateSegment(i);generateSegment(!1===closed?tubularSegments:
0);for(i=0;i<=tubularSegments;i++)for(var j=0;j<=radialSegments;j++)uv.x=i/tubularSegments,uv.y=j/radialSegments,uvs.push(uv.x,uv.y);for(i=1;i<=tubularSegments;i++)for(j=1;j<=radialSegments;j++){var b=(radialSegments+1)*i+(j-1),c=(radialSegments+1)*i+j,d=(radialSegments+1)*(i-1)+j;indices.push((radialSegments+1)*(i-1)+(j-1),b,d);indices.push(b,c,d)}})();_this.setIndex(indices);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));_this.setAttribute("normal",new Float32BufferAttribute(normals,
3));_this.setAttribute("uv",new Float32BufferAttribute(uvs,2));return _this}_inheritsLoose(TubeBufferGeometry,_BufferGeometry);TubeBufferGeometry.prototype.toJSON=function(){var data=BufferGeometry.prototype.toJSON.call(this);data.path=this.parameters.path.toJSON();return data};return TubeBufferGeometry}(BufferGeometry),TubeGeometry=function(_Geometry){function TubeGeometry(path,tubularSegments,radius,radialSegments,closed,taper){var _this=_Geometry.call(this)||this;_this.type="TubeGeometry";_this.parameters=
{path:path,tubularSegments:tubularSegments,radius:radius,radialSegments:radialSegments,closed:closed};void 0!==taper&&console.warn("THREE.TubeGeometry: taper has been removed.");path=new TubeBufferGeometry(path,tubularSegments,radius,radialSegments,closed);_this.tangents=path.tangents;_this.normals=path.normals;_this.binormals=path.binormals;_this.fromBufferGeometry(path);_this.mergeVertices();return _this}_inheritsLoose(TubeGeometry,_Geometry);return TubeGeometry}(Geometry),WireframeGeometry=function(_BufferGeometry){function WireframeGeometry(geometry){var _this=
_BufferGeometry.call(this)||this;_this.type="WireframeGeometry";var vertices=[],edge=[0,0],edges={},keys=["a","b","c"];if(geometry&&geometry.isGeometry){for(var faces=geometry.faces,i=0,l=faces.length;i<l;i++)for(var face=faces[i],j=0;3>j;j++){var edge1=face[keys[j]],edge2=face[keys[(j+1)%3]];edge[0]=Math.min(edge1,edge2);edge[1]=Math.max(edge1,edge2);edge1=edge[0]+","+edge[1];void 0===edges[edge1]&&(edges[edge1]={index1:edge[0],index2:edge[1]})}for(var _key in edges)edge=edges[_key],faces=geometry.vertices[edge.index1],
vertices.push(faces.x,faces.y,faces.z),faces=geometry.vertices[edge.index2],vertices.push(faces.x,faces.y,faces.z)}else if(geometry&&geometry.isBufferGeometry)if(_key=new Vector3,null!==geometry.index){keys=geometry.attributes.position;i=geometry.index;geometry=geometry.groups;0===geometry.length&&(geometry=[{start:0,count:i.count,materialIndex:0}]);l=0;for(face=geometry.length;l<face;++l)for(edge1=geometry[l],j=edge2=edge1.start,edge1=edge2+edge1.count;j<edge1;j+=3)for(edge2=0;3>edge2;edge2++){var _edge=
i.getX(j+edge2),_edge2=i.getX(j+(edge2+1)%3);edge[0]=Math.min(_edge,_edge2);edge[1]=Math.max(_edge,_edge2);_edge=edge[0]+","+edge[1];void 0===edges[_edge]&&(edges[_edge]={index1:edge[0],index2:edge[1]})}for(faces in edges)edge=edges[faces],_key.fromBufferAttribute(keys,edge.index1),vertices.push(_key.x,_key.y,_key.z),_key.fromBufferAttribute(keys,edge.index2),vertices.push(_key.x,_key.y,_key.z)}else for(edges=geometry.attributes.position,edge=0,faces=edges.count/3;edge<faces;edge++)for(geometry=0;3>
geometry;geometry++)_key.fromBufferAttribute(edges,3*edge+geometry),vertices.push(_key.x,_key.y,_key.z),_key.fromBufferAttribute(edges,3*edge+(geometry+1)%3),vertices.push(_key.x,_key.y,_key.z);_this.setAttribute("position",new Float32BufferAttribute(vertices,3));return _this}_inheritsLoose(WireframeGeometry,_BufferGeometry);return WireframeGeometry}(BufferGeometry),Geometries=Object.freeze({__proto__:null,BoxGeometry:BoxGeometry,BoxBufferGeometry:BoxBufferGeometry,CircleGeometry:CircleGeometry,CircleBufferGeometry:CircleBufferGeometry,
ConeGeometry:ConeGeometry,ConeBufferGeometry:ConeBufferGeometry,CylinderGeometry:CylinderGeometry,CylinderBufferGeometry:CylinderBufferGeometry,DodecahedronGeometry:DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronBufferGeometry,EdgesGeometry:EdgesGeometry,ExtrudeGeometry:ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeBufferGeometry,IcosahedronGeometry:IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronBufferGeometry,LatheGeometry:LatheGeometry,LatheBufferGeometry:LatheBufferGeometry,
OctahedronGeometry:OctahedronGeometry,OctahedronBufferGeometry:OctahedronBufferGeometry,ParametricGeometry:ParametricGeometry,ParametricBufferGeometry:ParametricBufferGeometry,PlaneGeometry:PlaneGeometry,PlaneBufferGeometry:PlaneBufferGeometry,PolyhedronGeometry:PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronBufferGeometry,RingGeometry:RingGeometry,RingBufferGeometry:RingBufferGeometry,ShapeGeometry:ShapeGeometry,ShapeBufferGeometry:ShapeBufferGeometry,SphereGeometry:SphereGeometry,SphereBufferGeometry:SphereBufferGeometry,
TetrahedronGeometry:TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronBufferGeometry,TextGeometry:TextGeometry,TextBufferGeometry:TextBufferGeometry,TorusGeometry:TorusGeometry,TorusBufferGeometry:TorusBufferGeometry,TorusKnotGeometry:TorusKnotGeometry,TorusKnotBufferGeometry:TorusKnotBufferGeometry,TubeGeometry:TubeGeometry,TubeBufferGeometry:TubeBufferGeometry,WireframeGeometry:WireframeGeometry});ShadowMaterial.prototype=Object.create(Material.prototype);ShadowMaterial.prototype.constructor=
ShadowMaterial;ShadowMaterial.prototype.isShadowMaterial=!0;ShadowMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);return this};RawShaderMaterial.prototype=Object.create(ShaderMaterial.prototype);RawShaderMaterial.prototype.constructor=RawShaderMaterial;RawShaderMaterial.prototype.isRawShaderMaterial=!0;MeshStandardMaterial.prototype=Object.create(Material.prototype);MeshStandardMaterial.prototype.constructor=MeshStandardMaterial;MeshStandardMaterial.prototype.isMeshStandardMaterial=
!0;MeshStandardMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.defines={STANDARD:""};this.color.copy(source.color);this.roughness=source.roughness;this.metalness=source.metalness;this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;
this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalMapType=source.normalMapType;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.roughnessMap=source.roughnessMap;this.metalnessMap=source.metalnessMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.envMapIntensity=source.envMapIntensity;this.refractionRatio=
source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;this.vertexTangents=source.vertexTangents;return this};MeshPhysicalMaterial.prototype=Object.create(MeshStandardMaterial.prototype);MeshPhysicalMaterial.prototype.constructor=MeshPhysicalMaterial;
MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0;MeshPhysicalMaterial.prototype.copy=function(source){MeshStandardMaterial.prototype.copy.call(this,source);this.defines={STANDARD:"",PHYSICAL:""};this.clearcoat=source.clearcoat;this.clearcoatMap=source.clearcoatMap;this.clearcoatRoughness=source.clearcoatRoughness;this.clearcoatRoughnessMap=source.clearcoatRoughnessMap;this.clearcoatNormalMap=source.clearcoatNormalMap;this.clearcoatNormalScale.copy(source.clearcoatNormalScale);this.reflectivity=
source.reflectivity;this.sheen=source.sheen?(this.sheen||new Color).copy(source.sheen):null;this.transmission=source.transmission;this.transmissionMap=source.transmissionMap;return this};MeshPhongMaterial.prototype=Object.create(Material.prototype);MeshPhongMaterial.prototype.constructor=MeshPhongMaterial;MeshPhongMaterial.prototype.isMeshPhongMaterial=!0;MeshPhongMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.specular.copy(source.specular);
this.shininess=source.shininess;this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalMapType=source.normalMapType;this.normalScale.copy(source.normalScale);this.displacementMap=
source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=
source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};MeshToonMaterial.prototype=Object.create(Material.prototype);MeshToonMaterial.prototype.constructor=MeshToonMaterial;MeshToonMaterial.prototype.isMeshToonMaterial=!0;MeshToonMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.gradientMap=source.gradientMap;this.lightMap=source.lightMap;this.lightMapIntensity=
source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalMapType=source.normalMapType;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;
this.alphaMap=source.alphaMap;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};MeshNormalMaterial.prototype=Object.create(Material.prototype);MeshNormalMaterial.prototype.constructor=MeshNormalMaterial;MeshNormalMaterial.prototype.isMeshNormalMaterial=!0;
MeshNormalMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalMapType=source.normalMapType;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.skinning=
source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};MeshLambertMaterial.prototype=Object.create(Material.prototype);MeshLambertMaterial.prototype.constructor=MeshLambertMaterial;MeshLambertMaterial.prototype.isMeshLambertMaterial=!0;MeshLambertMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;
this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;
this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};MeshMatcapMaterial.prototype=Object.create(Material.prototype);MeshMatcapMaterial.prototype.constructor=MeshMatcapMaterial;MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0;MeshMatcapMaterial.prototype.copy=function(source){Material.prototype.copy.call(this,source);this.defines={MATCAP:""};this.color.copy(source.color);this.matcap=
source.matcap;this.map=source.map;this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalMapType=source.normalMapType;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.alphaMap=source.alphaMap;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};LineDashedMaterial.prototype=
Object.create(LineBasicMaterial.prototype);LineDashedMaterial.prototype.constructor=LineDashedMaterial;LineDashedMaterial.prototype.isLineDashedMaterial=!0;LineDashedMaterial.prototype.copy=function(source){LineBasicMaterial.prototype.copy.call(this,source);this.scale=source.scale;this.dashSize=source.dashSize;this.gapSize=source.gapSize;return this};var Materials=Object.freeze({__proto__:null,ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,
PointsMaterial:PointsMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshToonMaterial:MeshToonMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshMatcapMaterial:MeshMatcapMaterial,LineDashedMaterial:LineDashedMaterial,LineBasicMaterial:LineBasicMaterial,Material:Material}),
AnimationUtils={arraySlice:function(array,from,to){return AnimationUtils.isTypedArray(array)?new array.constructor(array.subarray(from,void 0!==to?to:array.length)):array.slice(from,to)},convertArray:function(array,type,forceClone){return!array||!forceClone&&array.constructor===type?array:"number"===typeof type.BYTES_PER_ELEMENT?new type(array):Array.prototype.slice.call(array)},isTypedArray:function(object){return ArrayBuffer.isView(object)&&!(object instanceof DataView)},getKeyframeOrder:function(times){for(var n=
times.length,result=Array(n),i$jscomp$0=0;i$jscomp$0!==n;++i$jscomp$0)result[i$jscomp$0]=i$jscomp$0;result.sort(function(i,j){return times[i]-times[j]});return result},sortedArray:function(values,stride,order){for(var nValues=values.length,result=new values.constructor(nValues),i=0,dstOffset=0;dstOffset!==nValues;++i)for(var srcOffset=order[i]*stride,j=0;j!==stride;++j)result[dstOffset++]=values[srcOffset+j];return result},flattenJSON:function(jsonKeys,times,values,valuePropertyName){for(var i=1,
key=jsonKeys[0];void 0!==key&&void 0===key[valuePropertyName];)key=jsonKeys[i++];if(void 0!==key){var value=key[valuePropertyName];if(void 0!==value)if(Array.isArray(value)){do value=key[valuePropertyName],void 0!==value&&(times.push(key.time),values.push.apply(values,value)),key=jsonKeys[i++];while(void 0!==key)}else if(void 0!==value.toArray){do value=key[valuePropertyName],void 0!==value&&(times.push(key.time),value.toArray(values,values.length)),key=jsonKeys[i++];while(void 0!==key)}else{do value=
key[valuePropertyName],void 0!==value&&(times.push(key.time),values.push(value)),key=jsonKeys[i++];while(void 0!==key)}}},subclip:function(sourceClip,name,startFrame,endFrame,fps){void 0===fps&&(fps=30);sourceClip=sourceClip.clone();sourceClip.name=name;name=[];for(var i=0;i<sourceClip.tracks.length;++i){for(var track=sourceClip.tracks[i],valueSize=track.getValueSize(),times=[],values=[],j=0;j<track.times.length;++j){var frame=track.times[j]*fps;if(!(frame<startFrame||frame>=endFrame))for(times.push(track.times[j]),
frame=0;frame<valueSize;++frame)values.push(track.values[j*valueSize+frame])}0!==times.length&&(track.times=AnimationUtils.convertArray(times,track.times.constructor),track.values=AnimationUtils.convertArray(values,track.values.constructor),name.push(track))}sourceClip.tracks=name;startFrame=Infinity;for(endFrame=0;endFrame<sourceClip.tracks.length;++endFrame)startFrame>sourceClip.tracks[endFrame].times[0]&&(startFrame=sourceClip.tracks[endFrame].times[0]);for(endFrame=0;endFrame<sourceClip.tracks.length;++endFrame)sourceClip.tracks[endFrame].shift(-1*
startFrame);sourceClip.resetDuration();return sourceClip},makeClipAdditive:function(targetClip,referenceFrame,referenceClip,fps){void 0===referenceFrame&&(referenceFrame=0);void 0===referenceClip&&(referenceClip=targetClip);void 0===fps&&(fps=30);0>=fps&&(fps=30);var numTracks=referenceClip.tracks.length,referenceTime=referenceFrame/fps;referenceFrame=function(i){var referenceTrack=referenceClip.tracks[i],referenceTrackType=referenceTrack.ValueTypeName;if("bool"===referenceTrackType||"string"===referenceTrackType)return"continue";
i=targetClip.tracks.find(function(track){return track.name===referenceTrack.name&&track.ValueTypeName===referenceTrackType});if(void 0===i)return"continue";var referenceOffset=0,referenceValueSize=referenceTrack.getValueSize();referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(referenceOffset=referenceValueSize/3);var targetOffset=0,targetValueSize=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(targetOffset=targetValueSize/3);var lastIndex=
referenceTrack.times.length-1,referenceValue=void 0;referenceTime<=referenceTrack.times[0]?referenceValue=AnimationUtils.arraySlice(referenceTrack.values,referenceOffset,referenceValueSize-referenceOffset):referenceTime>=referenceTrack.times[lastIndex]?(referenceValue=lastIndex*referenceValueSize+referenceOffset,referenceValue=AnimationUtils.arraySlice(referenceTrack.values,referenceValue,referenceValue+referenceValueSize-referenceOffset)):(referenceValue=referenceTrack.createInterpolant(),lastIndex=
referenceOffset,referenceOffset=referenceValueSize-referenceOffset,referenceValue.evaluate(referenceTime),referenceValue=AnimationUtils.arraySlice(referenceValue.resultBuffer,lastIndex,referenceOffset));"quaternion"===referenceTrackType&&(new Quaternion).fromArray(referenceValue).normalize().conjugate().toArray(referenceValue);referenceOffset=i.times.length;for(referenceValueSize=0;referenceValueSize<referenceOffset;++referenceValueSize)if(lastIndex=referenceValueSize*targetValueSize+targetOffset,
"quaternion"===referenceTrackType)Quaternion.multiplyQuaternionsFlat(i.values,lastIndex,referenceValue,0,i.values,lastIndex);else for(var valueEnd=targetValueSize-2*targetOffset,k=0;k<valueEnd;++k)i.values[lastIndex+k]-=referenceValue[k]};for(fps=0;fps<numTracks;++fps)referenceFrame(fps);targetClip.blendMode=2501;return targetClip}};Object.assign(Interpolant.prototype,{evaluate:function(t){var pp=this.parameterPositions,i1=this._cachedIndex,t1=pp[i1],t0=pp[i1-1];a:{b:{c:{d:if(!(t<t1)){for(var giveUpAt=
i1+2;;){if(void 0===t1){if(t<t0)break d;this._cachedIndex=i1=pp.length;return this.afterEnd_(i1-1,t,t0)}if(i1===giveUpAt)break;t0=t1;t1=pp[++i1];if(t<t1)break b}t1=pp.length;break c}if(t>=t0)break a;else{giveUpAt=pp[1];t<giveUpAt&&(i1=2,t0=giveUpAt);for(giveUpAt=i1-2;;){if(void 0===t0)return this._cachedIndex=0,this.beforeStart_(0,t,t1);if(i1===giveUpAt)break;t1=t0;t0=pp[--i1-1];if(t>=t0)break b}t1=i1;i1=0}}for(;i1<t1;)t0=i1+t1>>>1,t<pp[t0]?t1=t0:i1=t0+1;t1=pp[i1];t0=pp[i1-1];if(void 0===t0)return this._cachedIndex=
0,this.beforeStart_(0,t,t1);if(void 0===t1)return this._cachedIndex=i1=pp.length,this.afterEnd_(i1-1,t0,t)}this._cachedIndex=i1;this.intervalChanged_(i1,t0,t1)}return this.interpolate_(i1,t0,t,t1)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(index){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize;index*=stride;for(var i=0;i!==stride;++i)result[i]=values[index+i];return result},interpolate_:function(){throw Error("call to abstract method");
},intervalChanged_:function(){}});Object.assign(Interpolant.prototype,{beforeStart_:Interpolant.prototype.copySampleValue_,afterEnd_:Interpolant.prototype.copySampleValue_});CubicInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:CubicInterpolant,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(i1,t0,t1){var pp=this.parameterPositions,iPrev=i1-2,iNext=i1+1,tPrev=pp[iPrev],tNext=pp[iNext];if(void 0===tPrev)switch(this.getSettings_().endingStart){case 2401:iPrev=
i1;tPrev=2*t0-t1;break;case 2402:iPrev=pp.length-2;tPrev=t0+pp[iPrev]-pp[iPrev+1];break;default:iPrev=i1,tPrev=t1}if(void 0===tNext)switch(this.getSettings_().endingEnd){case 2401:iNext=i1;tNext=2*t1-t0;break;case 2402:iNext=1;tNext=t1+pp[1]-pp[0];break;default:iNext=i1-1,tNext=t0}i1=.5*(t1-t0);pp=this.valueSize;this._weightPrev=i1/(t0-tPrev);this._weightNext=i1/(tNext-t1);this._offsetPrev=iPrev*pp;this._offsetNext=iNext*pp},interpolate_:function(i1,t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,
stride=this.valueSize;i1*=stride;var o0=i1-stride,oP=this._offsetPrev,oN=this._offsetNext,wP=this._weightPrev,wN=this._weightNext,p=(t-t0)/(t1-t0);t=p*p;t1=t*p;t0=-wP*t1+2*wP*t-wP*p;wP=(1+wP)*t1+(-1.5-2*wP)*t+(-.5+wP)*p+1;p=(-1-wN)*t1+(1.5+wN)*t+.5*p;wN=wN*t1-wN*t;for(t=0;t!==stride;++t)result[t]=t0*values[oP+t]+wP*values[o0+t]+p*values[i1+t]+wN*values[oN+t];return result}});LinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:LinearInterpolant,interpolate_:function(i1,
t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize;i1*=stride;var offset0=i1-stride;t0=(t-t0)/(t1-t0);t=1-t0;for(t1=0;t1!==stride;++t1)result[t1]=values[offset0+t1]*t+values[i1+t1]*t0;return result}});DiscreteInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:DiscreteInterpolant,interpolate_:function(i1){return this.copySampleValue_(i1-1)}});Object.assign(KeyframeTrack,{toJSON:function(track){var trackType=track.constructor;if(void 0!==
trackType.toJSON)trackType=trackType.toJSON(track);else{trackType={name:track.name,times:AnimationUtils.convertArray(track.times,Array),values:AnimationUtils.convertArray(track.values,Array)};var interpolation=track.getInterpolation();interpolation!==track.DefaultInterpolation&&(trackType.interpolation=interpolation)}trackType.type=track.ValueTypeName;return trackType}});Object.assign(KeyframeTrack.prototype,{constructor:KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,
InterpolantFactoryMethodDiscrete:function(result){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodLinear:function(result){return new LinearInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodSmooth:function(result){return new CubicInterpolant(this.times,this.values,this.getValueSize(),result)},setInterpolation:function(interpolation){switch(interpolation){case 2300:var factoryMethod=this.InterpolantFactoryMethodDiscrete;
break;case 2301:factoryMethod=this.InterpolantFactoryMethodLinear;break;case 2302:factoryMethod=this.InterpolantFactoryMethodSmooth}if(void 0===factoryMethod){factoryMethod="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(interpolation!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(factoryMethod);console.warn("THREE.KeyframeTrack:",factoryMethod);return this}this.createInterpolant=
factoryMethod;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(timeOffset){if(0!==timeOffset)for(var times=this.times,i=0,n=times.length;i!==n;++i)times[i]+=timeOffset;return this},scale:function(timeScale){if(1!==timeScale)for(var times=
this.times,i=0,n=times.length;i!==n;++i)times[i]*=timeScale;return this},trim:function(startTime,endTime){for(var times=this.times,nKeys=times.length,from=0,to=nKeys-1;from!==nKeys&&times[from]<startTime;)++from;for(;-1!==to&&times[to]>endTime;)--to;++to;if(0!==from||to!==nKeys)from>=to&&(to=Math.max(to,1),from=to-1),startTime=this.getValueSize(),this.times=AnimationUtils.arraySlice(times,from,to),this.values=AnimationUtils.arraySlice(this.values,from*startTime,to*startTime);return this},validate:function(){var valid=
!0,valueSize=this.getValueSize();0!==valueSize-Math.floor(valueSize)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),valid=!1);var times=this.times;valueSize=this.values;var nKeys=times.length;0===nKeys&&(console.error("THREE.KeyframeTrack: Track is empty.",this),valid=!1);for(var prevTime=null,i=0;i!==nKeys;i++){var currTime=times[i];if("number"===typeof currTime&&isNaN(currTime)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,i,currTime);valid=!1;
break}if(null!==prevTime&&prevTime>currTime){console.error("THREE.KeyframeTrack: Out of order keys.",this,i,currTime,prevTime);valid=!1;break}prevTime=currTime}if(void 0!==valueSize&&AnimationUtils.isTypedArray(valueSize))for(times=0,nKeys=valueSize.length;times!==nKeys;++times)if(prevTime=valueSize[times],isNaN(prevTime)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,times,prevTime);valid=!1;break}return valid},optimize:function(){for(var times=AnimationUtils.arraySlice(this.times),
values=AnimationUtils.arraySlice(this.values),stride=this.getValueSize(),smoothInterpolation=2302===this.getInterpolation(),lastIndex=times.length-1,writeIndex=1,i=1;i<lastIndex;++i){var keep=!1,time=times[i];if(time!==times[i+1]&&(1!==i||time!==time[0]))if(smoothInterpolation)keep=!0;else{time=i*stride;for(var offsetP=time-stride,offsetN=time+stride,j=0;j!==stride;++j){var value=values[time+j];if(value!==values[offsetP+j]||value!==values[offsetN+j]){keep=!0;break}}}if(keep){if(i!==writeIndex)for(times[writeIndex]=
times[i],keep=i*stride,time=writeIndex*stride,offsetP=0;offsetP!==stride;++offsetP)values[time+offsetP]=values[keep+offsetP];++writeIndex}}if(0<lastIndex){times[writeIndex]=times[lastIndex];smoothInterpolation=lastIndex*stride;lastIndex=writeIndex*stride;for(i=0;i!==stride;++i)values[lastIndex+i]=values[smoothInterpolation+i];++writeIndex}writeIndex!==times.length?(this.times=AnimationUtils.arraySlice(times,0,writeIndex),this.values=AnimationUtils.arraySlice(values,0,writeIndex*stride)):(this.times=
times,this.values=values);return this},clone:function(){var times=AnimationUtils.arraySlice(this.times,0),values=AnimationUtils.arraySlice(this.values,0);times=new this.constructor(this.name,times,values);times.createInterpolant=this.createInterpolant;return times}});BooleanKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});
ColorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:ColorKeyframeTrack,ValueTypeName:"color"});NumberKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:NumberKeyframeTrack,ValueTypeName:"number"});QuaternionLinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:QuaternionLinearInterpolant,interpolate_:function(i1,t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,stride=
this.valueSize;t0=(t-t0)/(t1-t0);i1*=stride;for(t=i1+stride;i1!==t;i1+=4)Quaternion.slerpFlat(result,0,values,i1-stride,values,i1,t0);return result}});QuaternionKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(result){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodSmooth:void 0});
StringKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});VectorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:VectorKeyframeTrack,ValueTypeName:"vector"});Object.assign(AnimationClip,{parse:function(json){for(var tracks=[],jsonTracks=json.tracks,frameTime=
1/(json.fps||1),i=0,n=jsonTracks.length;i!==n;++i)tracks.push(parseKeyframeTrack(jsonTracks[i]).scale(frameTime));tracks=new AnimationClip(json.name,json.duration,tracks,json.blendMode);tracks.uuid=json.uuid;return tracks},toJSON:function(clip){var tracks=[],clipTracks=clip.tracks;clip={name:clip.name,duration:clip.duration,tracks:tracks,uuid:clip.uuid,blendMode:clip.blendMode};for(var i=0,n=clipTracks.length;i!==n;++i)tracks.push(KeyframeTrack.toJSON(clipTracks[i]));return clip},CreateFromMorphTargetSequence:function(name,
morphTargetSequence,fps,noLoop){for(var numMorphTargets=morphTargetSequence.length,tracks=[],i=0;i<numMorphTargets;i++){var times=[],values=[];times.push((i+numMorphTargets-1)%numMorphTargets,i,(i+1)%numMorphTargets);values.push(0,1,0);var order=AnimationUtils.getKeyframeOrder(times);times=AnimationUtils.sortedArray(times,1,order);values=AnimationUtils.sortedArray(values,1,order);noLoop||0!==times[0]||(times.push(numMorphTargets),values.push(values[0]));tracks.push((new NumberKeyframeTrack(".morphTargetInfluences["+
morphTargetSequence[i].name+"]",times,values)).scale(1/fps))}return new AnimationClip(name,-1,tracks)},findByName:function(objectOrClipArray,name){var clipArray=objectOrClipArray;Array.isArray(objectOrClipArray)||(clipArray=objectOrClipArray.geometry&&objectOrClipArray.geometry.animations||objectOrClipArray.animations);for(objectOrClipArray=0;objectOrClipArray<clipArray.length;objectOrClipArray++)if(clipArray[objectOrClipArray].name===name)return clipArray[objectOrClipArray];return null},CreateClipsFromMorphTargetSequences:function(morphTargets,
fps,noLoop){for(var animationToMorphTargets={},pattern=/^([\w-]*?)([\d]+)$/,i=0,il=morphTargets.length;i<il;i++){var morphTarget=morphTargets[i],parts=morphTarget.name.match(pattern);if(parts&&1<parts.length){parts=parts[1];var animationMorphTargets=animationToMorphTargets[parts];animationMorphTargets||(animationToMorphTargets[parts]=animationMorphTargets=[]);animationMorphTargets.push(morphTarget)}}morphTargets=[];for(var _name in animationToMorphTargets)morphTargets.push(AnimationClip.CreateFromMorphTargetSequence(_name,
animationToMorphTargets[_name],fps,noLoop));return morphTargets},parseAnimation:function(animation,bones){if(!animation)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var addNonemptyTrack=function(trackType,trackName,animationKeys,propertyName,destTracks){if(0!==animationKeys.length){var times=[],values=[];AnimationUtils.flattenJSON(animationKeys,times,values,propertyName);0!==times.length&&destTracks.push(new trackType(trackName,times,values))}},tracks=[],clipName=
animation.name||"default",fps=animation.fps||30,blendMode=animation.blendMode,duration=animation.length||-1;animation=animation.hierarchy||[];for(var h=0;h<animation.length;h++){var animationKeys=animation[h].keys;if(animationKeys&&0!==animationKeys.length)if(animationKeys[0].morphTargets){duration={};var k=void 0;for(k=0;k<animationKeys.length;k++)if(animationKeys[k].morphTargets)for(var m=0;m<animationKeys[k].morphTargets.length;m++)duration[animationKeys[k].morphTargets[m]]=-1;for(var morphTargetName in duration){m=
[];for(var values$jscomp$0=[],_m=0;_m!==animationKeys[k].morphTargets.length;++_m){var animationKey=animationKeys[k];m.push(animationKey.time);values$jscomp$0.push(animationKey.morphTarget===morphTargetName?1:0)}tracks.push(new NumberKeyframeTrack(".morphTargetInfluence["+morphTargetName+"]",m,values$jscomp$0))}duration=duration.length*(fps||1)}else k=".bones["+bones[h].name+"]",addNonemptyTrack(VectorKeyframeTrack,k+".position",animationKeys,"pos",tracks),addNonemptyTrack(QuaternionKeyframeTrack,
k+".quaternion",animationKeys,"rot",tracks),addNonemptyTrack(VectorKeyframeTrack,k+".scale",animationKeys,"scl",tracks)}return 0===tracks.length?null:new AnimationClip(clipName,duration,tracks,blendMode)}});Object.assign(AnimationClip.prototype,{resetDuration:function(){for(var duration=0,i=0,n=this.tracks.length;i!==n;++i){var track=this.tracks[i];duration=Math.max(duration,track.times[track.times.length-1])}this.duration=duration;return this},trim:function(){for(var i=0;i<this.tracks.length;i++)this.tracks[i].trim(0,
this.duration);return this},validate:function(){for(var valid=!0,i=0;i<this.tracks.length;i++)valid=valid&&this.tracks[i].validate();return valid},optimize:function(){for(var i=0;i<this.tracks.length;i++)this.tracks[i].optimize();return this},clone:function(){for(var tracks=[],i=0;i<this.tracks.length;i++)tracks.push(this.tracks[i].clone());return new AnimationClip(this.name,this.duration,tracks,this.blendMode)},toJSON:function(){return AnimationClip.toJSON(this)}});var Cache={enabled:!1,files:{},
add:function(key,file){!1!==this.enabled&&(this.files[key]=file)},get:function(key){if(!1!==this.enabled)return this.files[key]},remove:function(key){delete this.files[key]},clear:function(){this.files={}}},DefaultLoadingManager=new LoadingManager;Object.assign(Loader.prototype,{load:function(){},loadAsync:function(url,onProgress){var scope=this;return new Promise(function(resolve,reject){scope.load(url,resolve,onProgress,reject)})},parse:function(){},setCrossOrigin:function(crossOrigin){this.crossOrigin=
crossOrigin;return this},setWithCredentials:function(value){this.withCredentials=value;return this},setPath:function(path){this.path=path;return this},setResourcePath:function(resourcePath){this.resourcePath=resourcePath;return this},setRequestHeader:function(requestHeader){this.requestHeader=requestHeader;return this}});var loading={};FileLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FileLoader,load:function(url,onLoad,onProgress,onError){void 0===url&&(url="");void 0!==
this.path&&(url=this.path+url);url=this.manager.resolveURL(url);var scope=this,cached=Cache.get(url);if(void 0!==cached)return scope.manager.itemStart(url),setTimeout(function(){onLoad&&onLoad(cached);scope.manager.itemEnd(url)},0),cached;if(void 0!==loading[url])loading[url].push({onLoad:onLoad,onProgress:onProgress,onError:onError});else{var dataUriRegexResult=url.match(/^data:(.*?)(;base64)?,(.*)$/);if(dataUriRegexResult){onProgress=dataUriRegexResult[1];var isBase64=!!dataUriRegexResult[2];dataUriRegexResult=
dataUriRegexResult[3];dataUriRegexResult=decodeURIComponent(dataUriRegexResult);isBase64&&(dataUriRegexResult=atob(dataUriRegexResult));try{var responseType=(this.responseType||"").toLowerCase();switch(responseType){case "arraybuffer":case "blob":var view=new Uint8Array(dataUriRegexResult.length);for(isBase64=0;isBase64<dataUriRegexResult.length;isBase64++)view[isBase64]=dataUriRegexResult.charCodeAt(isBase64);var response$jscomp$0="blob"===responseType?new Blob([view.buffer],{type:onProgress}):view.buffer;
break;case "document":response$jscomp$0=(new DOMParser).parseFromString(dataUriRegexResult,onProgress);break;case "json":response$jscomp$0=JSON.parse(dataUriRegexResult);break;default:response$jscomp$0=dataUriRegexResult}setTimeout(function(){onLoad&&onLoad(response$jscomp$0);scope.manager.itemEnd(url)},0)}catch(error){setTimeout(function(){onError&&onError(error);scope.manager.itemError(url);scope.manager.itemEnd(url)},0)}}else{loading[url]=[];loading[url].push({onLoad:onLoad,onProgress:onProgress,
onError:onError});var request=new XMLHttpRequest;request.open("GET",url,!0);request.addEventListener("load",function(event){var response=this.response,callbacks=loading[url];delete loading[url];if(200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");Cache.add(url,response);event=0;for(var il=callbacks.length;event<il;event++){var callback=callbacks[event];if(callback.onLoad)callback.onLoad(response)}}else{response=0;for(il=callbacks.length;response<
il;response++)if(callback=callbacks[response],callback.onError)callback.onError(event);scope.manager.itemError(url)}scope.manager.itemEnd(url)},!1);request.addEventListener("progress",function(event){for(var callbacks=loading[url],_i3=0,il=callbacks.length;_i3<il;_i3++){var callback=callbacks[_i3];if(callback.onProgress)callback.onProgress(event)}},!1);request.addEventListener("error",function(event){var callbacks=loading[url];delete loading[url];for(var _i4=0,il=callbacks.length;_i4<il;_i4++){var callback=
callbacks[_i4];if(callback.onError)callback.onError(event)}scope.manager.itemError(url);scope.manager.itemEnd(url)},!1);request.addEventListener("abort",function(event){var callbacks=loading[url];delete loading[url];for(var _i5=0,il=callbacks.length;_i5<il;_i5++){var callback=callbacks[_i5];if(callback.onError)callback.onError(event)}scope.manager.itemError(url);scope.manager.itemEnd(url)},!1);void 0!==this.responseType&&(request.responseType=this.responseType);void 0!==this.withCredentials&&(request.withCredentials=
this.withCredentials);request.overrideMimeType&&request.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(isBase64 in this.requestHeader)request.setRequestHeader(isBase64,this.requestHeader[isBase64]);request.send(null)}scope.manager.itemStart(url);return request}},setResponseType:function(value){this.responseType=value;return this},setMimeType:function(value){this.mimeType=value;return this}});AnimationLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AnimationLoader,
load:function(url,onLoad,onProgress,onError){var scope=this,loader=new FileLoader(scope.manager);loader.setPath(scope.path);loader.setRequestHeader(scope.requestHeader);loader.setWithCredentials(scope.withCredentials);loader.load(url,function(text){try{onLoad(scope.parse(JSON.parse(text)))}catch(e$159){onError?onError(e$159):console.error(e$159),scope.manager.itemError(url)}},onProgress,onError)},parse:function(json){for(var animations=[],i=0;i<json.length;i++){var clip=AnimationClip.parse(json[i]);
animations.push(clip)}return animations}});CompressedTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CompressedTextureLoader,load:function(url,onLoad,onProgress,onError){function loadTexture(i){loader.load(url[i],function(buffer){buffer=scope.parse(buffer,!0);images[i]={width:buffer.width,height:buffer.height,format:buffer.format,mipmaps:buffer.mipmaps};loaded+=1;6===loaded&&(1===buffer.mipmapCount&&(texture.minFilter=1006),texture.format=buffer.format,texture.needsUpdate=
!0,onLoad&&onLoad(texture))},onProgress,onError)}var scope=this,images=[],texture=new CompressedTexture;texture.image=images;var loader=new FileLoader(this.manager);loader.setPath(this.path);loader.setResponseType("arraybuffer");loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(scope.withCredentials);var loaded=0;if(Array.isArray(url))for(var i$jscomp$0=0,il=url.length;i$jscomp$0<il;++i$jscomp$0)loadTexture(i$jscomp$0);else loader.load(url,function(buffer){buffer=scope.parse(buffer,
!0);if(buffer.isCubemap)for(var faces=buffer.mipmaps.length/buffer.mipmapCount,f=0;f<faces;f++){images[f]={mipmaps:[]};for(var _i=0;_i<buffer.mipmapCount;_i++)images[f].mipmaps.push(buffer.mipmaps[f*buffer.mipmapCount+_i]),images[f].format=buffer.format,images[f].width=buffer.width,images[f].height=buffer.height}else texture.image.width=buffer.width,texture.image.height=buffer.height,texture.mipmaps=buffer.mipmaps;1===buffer.mipmapCount&&(texture.minFilter=1006);texture.format=buffer.format;texture.needsUpdate=
!0;onLoad&&onLoad(texture)},onProgress,onError);return texture}});ImageLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageLoader,load:function(url,onLoad,onProgress,onError){function onImageLoad(){image.removeEventListener("load",onImageLoad,!1);image.removeEventListener("error",onImageError,!1);Cache.add(url,this);onLoad&&onLoad(this);scope.manager.itemEnd(url)}function onImageError(event){image.removeEventListener("load",onImageLoad,!1);image.removeEventListener("error",
onImageError,!1);onError&&onError(event);scope.manager.itemError(url);scope.manager.itemEnd(url)}void 0!==this.path&&(url=this.path+url);url=this.manager.resolveURL(url);var scope=this,cached=Cache.get(url);if(void 0!==cached)return scope.manager.itemStart(url),setTimeout(function(){onLoad&&onLoad(cached);scope.manager.itemEnd(url)},0),cached;var image=document.createElementNS("http://www.w3.org/1999/xhtml","img");image.addEventListener("load",onImageLoad,!1);image.addEventListener("error",onImageError,
!1);"data:"!==url.substr(0,5)&&void 0!==this.crossOrigin&&(image.crossOrigin=this.crossOrigin);scope.manager.itemStart(url);image.src=url;return image}});CubeTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CubeTextureLoader,load:function(urls,onLoad,onProgress,onError){function loadTexture(i){loader.load(urls[i],function(image){texture.images[i]=image;loaded++;6===loaded&&(texture.needsUpdate=!0,onLoad&&onLoad(texture))},void 0,onError)}var texture=new CubeTexture,
loader=new ImageLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setPath(this.path);var loaded=0;for(onProgress=0;onProgress<urls.length;++onProgress)loadTexture(onProgress);return texture}});DataTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:DataTextureLoader,load:function(url,onLoad,onProgress,onError){var scope=this,texture=new DataTexture,loader=new FileLoader(this.manager);loader.setResponseType("arraybuffer");loader.setRequestHeader(this.requestHeader);
loader.setPath(this.path);loader.setWithCredentials(scope.withCredentials);loader.load(url,function(buffer){if(buffer=scope.parse(buffer))void 0!==buffer.image?texture.image=buffer.image:void 0!==buffer.data&&(texture.image.width=buffer.width,texture.image.height=buffer.height,texture.image.data=buffer.data),texture.wrapS=void 0!==buffer.wrapS?buffer.wrapS:1001,texture.wrapT=void 0!==buffer.wrapT?buffer.wrapT:1001,texture.magFilter=void 0!==buffer.magFilter?buffer.magFilter:1006,texture.minFilter=
void 0!==buffer.minFilter?buffer.minFilter:1006,texture.anisotropy=void 0!==buffer.anisotropy?buffer.anisotropy:1,void 0!==buffer.format&&(texture.format=buffer.format),void 0!==buffer.type&&(texture.type=buffer.type),void 0!==buffer.mipmaps&&(texture.mipmaps=buffer.mipmaps,texture.minFilter=1008),1===buffer.mipmapCount&&(texture.minFilter=1006),texture.needsUpdate=!0,onLoad&&onLoad(texture,buffer)},onProgress,onError);return texture}});TextureLoader.prototype=Object.assign(Object.create(Loader.prototype),
{constructor:TextureLoader,load:function(url,onLoad,onProgress,onError){var texture=new Texture,loader=new ImageLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setPath(this.path);loader.load(url,function(image){texture.image=image;image=0<url.search(/\.jpe?g($|\?)/i)||0===url.search(/^data:image\/jpeg/);texture.format=image?1022:1023;texture.needsUpdate=!0;void 0!==onLoad&&onLoad(texture)},onProgress,onError);return texture}});Object.assign(Curve.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");
return null},getPointAt:function(u,optionalTarget){u=this.getUtoTmapping(u);return this.getPoint(u,optionalTarget)},getPoints:function(divisions){void 0===divisions&&(divisions=5);for(var points=[],d=0;d<=divisions;d++)points.push(this.getPoint(d/divisions));return points},getSpacedPoints:function(divisions){void 0===divisions&&(divisions=5);for(var points=[],d=0;d<=divisions;d++)points.push(this.getPointAt(d/divisions));return points},getLength:function(){var lengths=this.getLengths();return lengths[lengths.length-
1]},getLengths:function(divisions){void 0===divisions&&(divisions=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===divisions+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var cache=[],last=this.getPoint(0),sum=0;cache.push(0);for(var p=1;p<=divisions;p++){var current=this.getPoint(p/divisions);sum+=current.distanceTo(last);cache.push(sum);last=current}return this.cacheArcLengths=cache},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},
getUtoTmapping:function(u,distance){var arcLengths=this.getLengths(),il=arcLengths.length;distance=distance?distance:u*arcLengths[il-1];for(var low=0,high=il-1,comparison;low<=high;)if(u=Math.floor(low+(high-low)/2),comparison=arcLengths[u]-distance,0>comparison)low=u+1;else if(0<comparison)high=u-1;else{high=u;break}u=high;if(arcLengths[u]===distance)return u/(il-1);low=arcLengths[u];return(u+(distance-low)/(arcLengths[u+1]-low))/(il-1)},getTangent:function(t,optionalTarget){var t1=t-1E-4;t+=1E-4;
0>t1&&(t1=0);1<t&&(t=1);t1=this.getPoint(t1);t=this.getPoint(t);optionalTarget=optionalTarget||(t1.isVector2?new Vector2:new Vector3);optionalTarget.copy(t).sub(t1).normalize();return optionalTarget},getTangentAt:function(u,optionalTarget){u=this.getUtoTmapping(u);return this.getTangent(u,optionalTarget)},computeFrenetFrames:function(segments,closed){for(var normal=new Vector3,tangents=[],normals=[],binormals=[],vec=new Vector3,mat=new Matrix4,i=0;i<=segments;i++)tangents[i]=this.getTangentAt(i/segments,
new Vector3),tangents[i].normalize();normals[0]=new Vector3;binormals[0]=new Vector3;i=Number.MAX_VALUE;var tx=Math.abs(tangents[0].x),ty=Math.abs(tangents[0].y),tz=Math.abs(tangents[0].z);tx<=i&&(i=tx,normal.set(1,0,0));ty<=i&&(i=ty,normal.set(0,1,0));tz<=i&&normal.set(0,0,1);vec.crossVectors(tangents[0],normal).normalize();normals[0].crossVectors(tangents[0],vec);binormals[0].crossVectors(tangents[0],normals[0]);for(normal=1;normal<=segments;normal++)normals[normal]=normals[normal-1].clone(),binormals[normal]=
binormals[normal-1].clone(),vec.crossVectors(tangents[normal-1],tangents[normal]),vec.length()>Number.EPSILON&&(vec.normalize(),i=Math.acos(MathUtils.clamp(tangents[normal-1].dot(tangents[normal]),-1,1)),normals[normal].applyMatrix4(mat.makeRotationAxis(vec,i))),binormals[normal].crossVectors(tangents[normal],normals[normal]);if(!0===closed)for(closed=Math.acos(MathUtils.clamp(normals[0].dot(normals[segments]),-1,1)),closed/=segments,0<tangents[0].dot(vec.crossVectors(normals[0],normals[segments]))&&
(closed=-closed),vec=1;vec<=segments;vec++)normals[vec].applyMatrix4(mat.makeRotationAxis(tangents[vec],closed*vec)),binormals[vec].crossVectors(tangents[vec],normals[vec]);return{tangents:tangents,normals:normals,binormals:binormals}},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.arcLengthDivisions=source.arcLengthDivisions;return this},toJSON:function(){var data={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};data.arcLengthDivisions=this.arcLengthDivisions;
data.type=this.type;return data},fromJSON:function(json){this.arcLengthDivisions=json.arcLengthDivisions;return this}});EllipseCurve.prototype=Object.create(Curve.prototype);EllipseCurve.prototype.constructor=EllipseCurve;EllipseCurve.prototype.isEllipseCurve=!0;EllipseCurve.prototype.getPoint=function(t,optionalTarget){optionalTarget=optionalTarget||new Vector2;for(var twoPi=2*Math.PI,deltaAngle=this.aEndAngle-this.aStartAngle,samePoints=Math.abs(deltaAngle)<Number.EPSILON;0>deltaAngle;)deltaAngle+=
twoPi;for(;deltaAngle>twoPi;)deltaAngle-=twoPi;deltaAngle<Number.EPSILON&&(deltaAngle=samePoints?0:twoPi);!0!==this.aClockwise||samePoints||(deltaAngle=deltaAngle===twoPi?-twoPi:deltaAngle-twoPi);twoPi=this.aStartAngle+t*deltaAngle;t=this.aX+this.xRadius*Math.cos(twoPi);var y=this.aY+this.yRadius*Math.sin(twoPi);0!==this.aRotation&&(twoPi=Math.cos(this.aRotation),deltaAngle=Math.sin(this.aRotation),samePoints=t-this.aX,y-=this.aY,t=samePoints*twoPi-y*deltaAngle+this.aX,y=samePoints*deltaAngle+y*twoPi+
this.aY);return optionalTarget.set(t,y)};EllipseCurve.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.aX=source.aX;this.aY=source.aY;this.xRadius=source.xRadius;this.yRadius=source.yRadius;this.aStartAngle=source.aStartAngle;this.aEndAngle=source.aEndAngle;this.aClockwise=source.aClockwise;this.aRotation=source.aRotation;return this};EllipseCurve.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.aX=this.aX;data.aY=this.aY;data.xRadius=this.xRadius;
data.yRadius=this.yRadius;data.aStartAngle=this.aStartAngle;data.aEndAngle=this.aEndAngle;data.aClockwise=this.aClockwise;data.aRotation=this.aRotation;return data};EllipseCurve.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.aX=json.aX;this.aY=json.aY;this.xRadius=json.xRadius;this.yRadius=json.yRadius;this.aStartAngle=json.aStartAngle;this.aEndAngle=json.aEndAngle;this.aClockwise=json.aClockwise;this.aRotation=json.aRotation;return this};ArcCurve.prototype=Object.create(EllipseCurve.prototype);
ArcCurve.prototype.constructor=ArcCurve;ArcCurve.prototype.isArcCurve=!0;var tmp$jscomp$0=new Vector3,px$jscomp$0=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;CatmullRomCurve3.prototype=Object.create(Curve.prototype);CatmullRomCurve3.prototype.constructor=CatmullRomCurve3;CatmullRomCurve3.prototype.isCatmullRomCurve3=!0;CatmullRomCurve3.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&(optionalTarget=new Vector3);var points=this.points,l=points.length;t*=l-(this.closed?0:
1);var intPoint=Math.floor(t);t-=intPoint;this.closed?intPoint+=0<intPoint?0:(Math.floor(Math.abs(intPoint)/l)+1)*l:0===t&&intPoint===l-1&&(intPoint=l-2,t=1);if(this.closed||0<intPoint)var p0=points[(intPoint-1)%l];else tmp$jscomp$0.subVectors(points[0],points[1]).add(points[0]),p0=tmp$jscomp$0;var p1=points[intPoint%l],p2=points[(intPoint+1)%l];this.closed||intPoint+2<l?points=points[(intPoint+2)%l]:(tmp$jscomp$0.subVectors(points[l-1],points[l-2]).add(points[l-1]),points=tmp$jscomp$0);if("centripetal"===
this.curveType||"chordal"===this.curveType){var pow="chordal"===this.curveType?.5:.25;l=Math.pow(p0.distanceToSquared(p1),pow);intPoint=Math.pow(p1.distanceToSquared(p2),pow);pow=Math.pow(p2.distanceToSquared(points),pow);1E-4>intPoint&&(intPoint=1);1E-4>l&&(l=intPoint);1E-4>pow&&(pow=intPoint);px$jscomp$0.initNonuniformCatmullRom(p0.x,p1.x,p2.x,points.x,l,intPoint,pow);py.initNonuniformCatmullRom(p0.y,p1.y,p2.y,points.y,l,intPoint,pow);pz.initNonuniformCatmullRom(p0.z,p1.z,p2.z,points.z,l,intPoint,
pow)}else"catmullrom"===this.curveType&&(px$jscomp$0.initCatmullRom(p0.x,p1.x,p2.x,points.x,this.tension),py.initCatmullRom(p0.y,p1.y,p2.y,points.y,this.tension),pz.initCatmullRom(p0.z,p1.z,p2.z,points.z,this.tension));optionalTarget.set(px$jscomp$0.calc(t),py.calc(t),pz.calc(t));return optionalTarget};CatmullRomCurve3.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.points=[];for(var i=0,l=source.points.length;i<l;i++)this.points.push(source.points[i].clone());this.closed=
source.closed;this.curveType=source.curveType;this.tension=source.tension;return this};CatmullRomCurve3.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.points=[];for(var i=0,l=this.points.length;i<l;i++)data.points.push(this.points[i].toArray());data.closed=this.closed;data.curveType=this.curveType;data.tension=this.tension;return data};CatmullRomCurve3.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.points=[];for(var i=0,l=json.points.length;i<
l;i++){var point=json.points[i];this.points.push((new Vector3).fromArray(point))}this.closed=json.closed;this.curveType=json.curveType;this.tension=json.tension;return this};CubicBezierCurve.prototype=Object.create(Curve.prototype);CubicBezierCurve.prototype.constructor=CubicBezierCurve;CubicBezierCurve.prototype.isCubicBezierCurve=!0;CubicBezierCurve.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&(optionalTarget=new Vector2);var v0=this.v0,v1=this.v1,v2=this.v2,v3=this.v3;
optionalTarget.set(CubicBezier(t,v0.x,v1.x,v2.x,v3.x),CubicBezier(t,v0.y,v1.y,v2.y,v3.y));return optionalTarget};CubicBezierCurve.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v0.copy(source.v0);this.v1.copy(source.v1);this.v2.copy(source.v2);this.v3.copy(source.v3);return this};CubicBezierCurve.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.v0=this.v0.toArray();data.v1=this.v1.toArray();data.v2=this.v2.toArray();data.v3=this.v3.toArray();
return data};CubicBezierCurve.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v0.fromArray(json.v0);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);this.v3.fromArray(json.v3);return this};CubicBezierCurve3.prototype=Object.create(Curve.prototype);CubicBezierCurve3.prototype.constructor=CubicBezierCurve3;CubicBezierCurve3.prototype.isCubicBezierCurve3=!0;CubicBezierCurve3.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&(optionalTarget=new Vector3);
var v0=this.v0,v1=this.v1,v2=this.v2,v3=this.v3;optionalTarget.set(CubicBezier(t,v0.x,v1.x,v2.x,v3.x),CubicBezier(t,v0.y,v1.y,v2.y,v3.y),CubicBezier(t,v0.z,v1.z,v2.z,v3.z));return optionalTarget};CubicBezierCurve3.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v0.copy(source.v0);this.v1.copy(source.v1);this.v2.copy(source.v2);this.v3.copy(source.v3);return this};CubicBezierCurve3.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.v0=this.v0.toArray();
data.v1=this.v1.toArray();data.v2=this.v2.toArray();data.v3=this.v3.toArray();return data};CubicBezierCurve3.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v0.fromArray(json.v0);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);this.v3.fromArray(json.v3);return this};LineCurve.prototype=Object.create(Curve.prototype);LineCurve.prototype.constructor=LineCurve;LineCurve.prototype.isLineCurve=!0;LineCurve.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&
(optionalTarget=new Vector2);1===t?optionalTarget.copy(this.v2):(optionalTarget.copy(this.v2).sub(this.v1),optionalTarget.multiplyScalar(t).add(this.v1));return optionalTarget};LineCurve.prototype.getPointAt=function(u,optionalTarget){return this.getPoint(u,optionalTarget)};LineCurve.prototype.getTangent=function(t,optionalTarget){t=optionalTarget||new Vector2;t.copy(this.v2).sub(this.v1).normalize();return t};LineCurve.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v1.copy(source.v1);
this.v2.copy(source.v2);return this};LineCurve.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.v1=this.v1.toArray();data.v2=this.v2.toArray();return data};LineCurve.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);return this};LineCurve3.prototype=Object.create(Curve.prototype);LineCurve3.prototype.constructor=LineCurve3;LineCurve3.prototype.isLineCurve3=!0;LineCurve3.prototype.getPoint=function(t,
optionalTarget){void 0===optionalTarget&&(optionalTarget=new Vector3);1===t?optionalTarget.copy(this.v2):(optionalTarget.copy(this.v2).sub(this.v1),optionalTarget.multiplyScalar(t).add(this.v1));return optionalTarget};LineCurve3.prototype.getPointAt=function(u,optionalTarget){return this.getPoint(u,optionalTarget)};LineCurve3.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v1.copy(source.v1);this.v2.copy(source.v2);return this};LineCurve3.prototype.toJSON=function(){var data=
Curve.prototype.toJSON.call(this);data.v1=this.v1.toArray();data.v2=this.v2.toArray();return data};LineCurve3.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);return this};QuadraticBezierCurve.prototype=Object.create(Curve.prototype);QuadraticBezierCurve.prototype.constructor=QuadraticBezierCurve;QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0;QuadraticBezierCurve.prototype.getPoint=function(t,optionalTarget){void 0===
optionalTarget&&(optionalTarget=new Vector2);var v0=this.v0,v1=this.v1,v2=this.v2;optionalTarget.set(QuadraticBezier(t,v0.x,v1.x,v2.x),QuadraticBezier(t,v0.y,v1.y,v2.y));return optionalTarget};QuadraticBezierCurve.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v0.copy(source.v0);this.v1.copy(source.v1);this.v2.copy(source.v2);return this};QuadraticBezierCurve.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.v0=this.v0.toArray();data.v1=this.v1.toArray();
data.v2=this.v2.toArray();return data};QuadraticBezierCurve.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v0.fromArray(json.v0);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);return this};QuadraticBezierCurve3.prototype=Object.create(Curve.prototype);QuadraticBezierCurve3.prototype.constructor=QuadraticBezierCurve3;QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0;QuadraticBezierCurve3.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&
(optionalTarget=new Vector3);var v0=this.v0,v1=this.v1,v2=this.v2;optionalTarget.set(QuadraticBezier(t,v0.x,v1.x,v2.x),QuadraticBezier(t,v0.y,v1.y,v2.y),QuadraticBezier(t,v0.z,v1.z,v2.z));return optionalTarget};QuadraticBezierCurve3.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.v0.copy(source.v0);this.v1.copy(source.v1);this.v2.copy(source.v2);return this};QuadraticBezierCurve3.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.v0=this.v0.toArray();
data.v1=this.v1.toArray();data.v2=this.v2.toArray();return data};QuadraticBezierCurve3.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.v0.fromArray(json.v0);this.v1.fromArray(json.v1);this.v2.fromArray(json.v2);return this};SplineCurve.prototype=Object.create(Curve.prototype);SplineCurve.prototype.constructor=SplineCurve;SplineCurve.prototype.isSplineCurve=!0;SplineCurve.prototype.getPoint=function(t,optionalTarget){void 0===optionalTarget&&(optionalTarget=new Vector2);
var points=this.points,p=(points.length-1)*t;t=Math.floor(p);p-=t;var p0=points[0===t?t:t-1],p1=points[t],p2=points[t>points.length-2?points.length-1:t+1];points=points[t>points.length-3?points.length-1:t+2];optionalTarget.set(CatmullRom(p,p0.x,p1.x,p2.x,points.x),CatmullRom(p,p0.y,p1.y,p2.y,points.y));return optionalTarget};SplineCurve.prototype.copy=function(source){Curve.prototype.copy.call(this,source);this.points=[];for(var i=0,l=source.points.length;i<l;i++)this.points.push(source.points[i].clone());
return this};SplineCurve.prototype.toJSON=function(){var data=Curve.prototype.toJSON.call(this);data.points=[];for(var i=0,l=this.points.length;i<l;i++)data.points.push(this.points[i].toArray());return data};SplineCurve.prototype.fromJSON=function(json){Curve.prototype.fromJSON.call(this,json);this.points=[];for(var i=0,l=json.points.length;i<l;i++){var point=json.points[i];this.points.push((new Vector2).fromArray(point))}return this};var Curves=Object.freeze({__proto__:null,ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,
CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve});CurvePath.prototype=Object.assign(Object.create(Curve.prototype),{constructor:CurvePath,add:function(curve){this.curves.push(curve)},closePath:function(){var startPoint=this.curves[0].getPoint(0),endPoint=this.curves[this.curves.length-1].getPoint(1);
startPoint.equals(endPoint)||this.curves.push(new LineCurve(endPoint,startPoint))},getPoint:function(t){var d=t*this.getLength(),curveLengths=this.getCurveLengths();for(t=0;t<curveLengths.length;){if(curveLengths[t]>=d)return d=curveLengths[t]-d,t=this.curves[t],curveLengths=t.getLength(),t.getPointAt(0===curveLengths?0:1-d/curveLengths);t++}return null},getLength:function(){var lens=this.getCurveLengths();return lens[lens.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=
null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var lengths=[],sums=0,i=0,l=this.curves.length;i<l;i++)sums+=this.curves[i].getLength(),lengths.push(sums);return this.cacheLengths=lengths},getSpacedPoints:function(divisions){void 0===divisions&&(divisions=40);for(var points=[],i=0;i<=divisions;i++)points.push(this.getPoint(i/divisions));this.autoClose&&points.push(points[0]);return points},getPoints:function(divisions){void 0===
divisions&&(divisions=12);for(var points=[],last,i=0,curves=this.curves;i<curves.length;i++){var curve=curves[i];curve=curve.getPoints(curve&&curve.isEllipseCurve?2*divisions:curve&&(curve.isLineCurve||curve.isLineCurve3)?1:curve&&curve.isSplineCurve?divisions*curve.points.length:divisions);for(var j=0;j<curve.length;j++){var point=curve[j];last&&last.equals(point)||(points.push(point),last=point)}}this.autoClose&&1<points.length&&!points[points.length-1].equals(points[0])&&points.push(points[0]);
return points},copy:function(source){Curve.prototype.copy.call(this,source);this.curves=[];for(var i=0,l=source.curves.length;i<l;i++)this.curves.push(source.curves[i].clone());this.autoClose=source.autoClose;return this},toJSON:function(){var data=Curve.prototype.toJSON.call(this);data.autoClose=this.autoClose;data.curves=[];for(var i=0,l=this.curves.length;i<l;i++)data.curves.push(this.curves[i].toJSON());return data},fromJSON:function(json){Curve.prototype.fromJSON.call(this,json);this.autoClose=
json.autoClose;this.curves=[];for(var i=0,l=json.curves.length;i<l;i++){var curve=json.curves[i];this.curves.push((new Curves[curve.type]).fromJSON(curve))}return this}});Path.prototype=Object.assign(Object.create(CurvePath.prototype),{constructor:Path,setFromPoints:function(points){this.moveTo(points[0].x,points[0].y);for(var i=1,l=points.length;i<l;i++)this.lineTo(points[i].x,points[i].y);return this},moveTo:function(x,y){this.currentPoint.set(x,y);return this},lineTo:function(x,y){var curve=new LineCurve(this.currentPoint.clone(),
new Vector2(x,y));this.curves.push(curve);this.currentPoint.set(x,y);return this},quadraticCurveTo:function(aCPx,aCPy,aX,aY){aCPx=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(aCPx,aCPy),new Vector2(aX,aY));this.curves.push(aCPx);this.currentPoint.set(aX,aY);return this},bezierCurveTo:function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){aCP1x=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(aCP1x,aCP1y),new Vector2(aCP2x,aCP2y),new Vector2(aX,aY));this.curves.push(aCP1x);this.currentPoint.set(aX,
aY);return this},splineThru:function(pts){var npts=[this.currentPoint.clone()].concat(pts);npts=new SplineCurve(npts);this.curves.push(npts);this.currentPoint.copy(pts[pts.length-1]);return this},arc:function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this.absarc(aX+this.currentPoint.x,aY+this.currentPoint.y,aRadius,aStartAngle,aEndAngle,aClockwise);return this},absarc:function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this.absellipse(aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise);
return this},ellipse:function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){this.absellipse(aX+this.currentPoint.x,aY+this.currentPoint.y,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);return this},absellipse:function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){aX=new EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);0<this.curves.length&&(aY=aX.getPoint(0),aY.equals(this.currentPoint)||this.lineTo(aY.x,aY.y));this.curves.push(aX);
aX=aX.getPoint(1);this.currentPoint.copy(aX);return this},copy:function(source){CurvePath.prototype.copy.call(this,source);this.currentPoint.copy(source.currentPoint);return this},toJSON:function(){var data=CurvePath.prototype.toJSON.call(this);data.currentPoint=this.currentPoint.toArray();return data},fromJSON:function(json){CurvePath.prototype.fromJSON.call(this,json);this.currentPoint.fromArray(json.currentPoint);return this}});Shape.prototype=Object.assign(Object.create(Path.prototype),{constructor:Shape,
getPointsHoles:function(divisions){for(var holesPts=[],i=0,l=this.holes.length;i<l;i++)holesPts[i]=this.holes[i].getPoints(divisions);return holesPts},extractPoints:function(divisions){return{shape:this.getPoints(divisions),holes:this.getPointsHoles(divisions)}},copy:function(source){Path.prototype.copy.call(this,source);this.holes=[];for(var i=0,l=source.holes.length;i<l;i++)this.holes.push(source.holes[i].clone());return this},toJSON:function(){var data=Path.prototype.toJSON.call(this);data.uuid=
this.uuid;data.holes=[];for(var i=0,l=this.holes.length;i<l;i++)data.holes.push(this.holes[i].toJSON());return data},fromJSON:function(json){Path.prototype.fromJSON.call(this,json);this.uuid=json.uuid;this.holes=[];for(var i=0,l=json.holes.length;i<l;i++){var hole=json.holes[i];this.holes.push((new Path).fromJSON(hole))}return this}});Light.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Light,isLight:!0,copy:function(source){Object3D.prototype.copy.call(this,source);this.color.copy(source.color);
this.intensity=source.intensity;return this},toJSON:function(meta){meta=Object3D.prototype.toJSON.call(this,meta);meta.object.color=this.color.getHex();meta.object.intensity=this.intensity;void 0!==this.groundColor&&(meta.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(meta.object.distance=this.distance);void 0!==this.angle&&(meta.object.angle=this.angle);void 0!==this.decay&&(meta.object.decay=this.decay);void 0!==this.penumbra&&(meta.object.penumbra=this.penumbra);void 0!==
this.shadow&&(meta.object.shadow=this.shadow.toJSON());return meta}});HemisphereLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:HemisphereLight,isHemisphereLight:!0,copy:function(source){Light.prototype.copy.call(this,source);this.groundColor.copy(source.groundColor);return this}});Object.assign(LightShadow.prototype,{_projScreenMatrix:new Matrix4,_lightPositionWorld:new Vector3,_lookTarget:new Vector3,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},
updateMatrices:function(light){var shadowCamera=this.camera,shadowMatrix=this.matrix,projScreenMatrix=this._projScreenMatrix,lookTarget=this._lookTarget,lightPositionWorld=this._lightPositionWorld;lightPositionWorld.setFromMatrixPosition(light.matrixWorld);shadowCamera.position.copy(lightPositionWorld);lookTarget.setFromMatrixPosition(light.target.matrixWorld);shadowCamera.lookAt(lookTarget);shadowCamera.updateMatrixWorld();projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix,shadowCamera.matrixWorldInverse);
this._frustum.setFromProjectionMatrix(projScreenMatrix);shadowMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);shadowMatrix.multiply(shadowCamera.projectionMatrix);shadowMatrix.multiply(shadowCamera.matrixWorldInverse)},getViewport:function(viewportIndex){return this._viewports[viewportIndex]},getFrameExtents:function(){return this._frameExtents},copy:function(source){this.camera=source.camera.clone();this.bias=source.bias;this.radius=source.radius;this.mapSize.copy(source.mapSize);return this},
clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var object={};0!==this.bias&&(object.bias=this.bias);0!==this.normalBias&&(object.normalBias=this.normalBias);1!==this.radius&&(object.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)object.mapSize=this.mapSize.toArray();object.camera=this.camera.toJSON(!1).object;delete object.camera.matrix;return object}});SpotLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:SpotLightShadow,
isSpotLightShadow:!0,updateMatrices:function(light){var camera=this.camera,fov=2*MathUtils.RAD2DEG*light.angle*this.focus,aspect=this.mapSize.width/this.mapSize.height,far=light.distance||camera.far;if(fov!==camera.fov||aspect!==camera.aspect||far!==camera.far)camera.fov=fov,camera.aspect=aspect,camera.far=far,camera.updateProjectionMatrix();LightShadow.prototype.updateMatrices.call(this,light)}});SpotLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:SpotLight,isSpotLight:!0,
copy:function(source){Light.prototype.copy.call(this,source);this.distance=source.distance;this.angle=source.angle;this.penumbra=source.penumbra;this.decay=source.decay;this.target=source.target.clone();this.shadow=source.shadow.clone();return this}});PointLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:PointLightShadow,isPointLightShadow:!0,updateMatrices:function(light,viewportIndex){void 0===viewportIndex&&(viewportIndex=0);var camera=this.camera,shadowMatrix=
this.matrix,lightPositionWorld=this._lightPositionWorld,lookTarget=this._lookTarget,projScreenMatrix=this._projScreenMatrix;lightPositionWorld.setFromMatrixPosition(light.matrixWorld);camera.position.copy(lightPositionWorld);lookTarget.copy(camera.position);lookTarget.add(this._cubeDirections[viewportIndex]);camera.up.copy(this._cubeUps[viewportIndex]);camera.lookAt(lookTarget);camera.updateMatrixWorld();shadowMatrix.makeTranslation(-lightPositionWorld.x,-lightPositionWorld.y,-lightPositionWorld.z);
projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse);this._frustum.setFromProjectionMatrix(projScreenMatrix)}});PointLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:PointLight,isPointLight:!0,copy:function(source){Light.prototype.copy.call(this,source);this.distance=source.distance;this.decay=source.decay;this.shadow=source.shadow.clone();return this}});OrthographicCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:OrthographicCamera,
isOrthographicCamera:!0,copy:function(source,recursive){Camera.prototype.copy.call(this,source,recursive);this.left=source.left;this.right=source.right;this.top=source.top;this.bottom=source.bottom;this.near=source.near;this.far=source.far;this.zoom=source.zoom;this.view=null===source.view?null:Object.assign({},source.view);return this},setViewOffset:function(fullWidth,fullHeight,x,y,width,height){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});
this.view.enabled=!0;this.view.fullWidth=fullWidth;this.view.fullHeight=fullHeight;this.view.offsetX=x;this.view.offsetY=y;this.view.width=width;this.view.height=height;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var dx=(this.right-this.left)/(2*this.zoom),dy=(this.top-this.bottom)/(2*this.zoom),cx=(this.right+this.left)/2,cy=(this.top+this.bottom)/2,left=cx-dx;cx+=dx;dx=cy+dy;dy=
cy-dy;null!==this.view&&this.view.enabled&&(cy=(this.right-this.left)/this.view.fullWidth/this.zoom,dy=(this.top-this.bottom)/this.view.fullHeight/this.zoom,left+=cy*this.view.offsetX,cx=left+cy*this.view.width,dx-=dy*this.view.offsetY,dy=dx-dy*this.view.height);this.projectionMatrix.makeOrthographic(left,cx,dx,dy,this.near,this.far);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(meta){meta=Object3D.prototype.toJSON.call(this,meta);meta.object.zoom=this.zoom;meta.object.left=
this.left;meta.object.right=this.right;meta.object.top=this.top;meta.object.bottom=this.bottom;meta.object.near=this.near;meta.object.far=this.far;null!==this.view&&(meta.object.view=Object.assign({},this.view));return meta}});DirectionalLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:DirectionalLightShadow,isDirectionalLightShadow:!0,updateMatrices:function(light){LightShadow.prototype.updateMatrices.call(this,light)}});DirectionalLight.prototype=Object.assign(Object.create(Light.prototype),
{constructor:DirectionalLight,isDirectionalLight:!0,copy:function(source){Light.prototype.copy.call(this,source);this.target=source.target.clone();this.shadow=source.shadow.clone();return this}});AmbientLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:AmbientLight,isAmbientLight:!0});RectAreaLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:RectAreaLight,isRectAreaLight:!0,copy:function(source){Light.prototype.copy.call(this,source);this.width=source.width;
this.height=source.height;return this},toJSON:function(meta){meta=Light.prototype.toJSON.call(this,meta);meta.object.width=this.width;meta.object.height=this.height;return meta}});var SphericalHarmonics3=function(){function SphericalHarmonics3(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0});this.coefficients=[];for(var i=0;9>i;i++)this.coefficients.push(new Vector3)}var _proto=SphericalHarmonics3.prototype;_proto.set=function(coefficients){for(var i=0;9>i;i++)this.coefficients[i].copy(coefficients[i]);
return this};_proto.zero=function(){for(var i=0;9>i;i++)this.coefficients[i].set(0,0,0);return this};_proto.getAt=function(normal,target){var x=normal.x,y=normal.y;normal=normal.z;var coeff=this.coefficients;target.copy(coeff[0]).multiplyScalar(.282095);target.addScaledVector(coeff[1],.488603*y);target.addScaledVector(coeff[2],.488603*normal);target.addScaledVector(coeff[3],.488603*x);target.addScaledVector(coeff[4],1.092548*x*y);target.addScaledVector(coeff[5],1.092548*y*normal);target.addScaledVector(coeff[6],
.315392*(3*normal*normal-1));target.addScaledVector(coeff[7],1.092548*x*normal);target.addScaledVector(coeff[8],.546274*(x*x-y*y));return target};_proto.getIrradianceAt=function(normal,target){var x=normal.x,y=normal.y;normal=normal.z;var coeff=this.coefficients;target.copy(coeff[0]).multiplyScalar(.886227);target.addScaledVector(coeff[1],1.023328*y);target.addScaledVector(coeff[2],1.023328*normal);target.addScaledVector(coeff[3],1.023328*x);target.addScaledVector(coeff[4],.858086*x*y);target.addScaledVector(coeff[5],
.858086*y*normal);target.addScaledVector(coeff[6],.743125*normal*normal-.247708);target.addScaledVector(coeff[7],.858086*x*normal);target.addScaledVector(coeff[8],.429043*(x*x-y*y));return target};_proto.add=function(sh){for(var i=0;9>i;i++)this.coefficients[i].add(sh.coefficients[i]);return this};_proto.addScaledSH=function(sh,s){for(var i=0;9>i;i++)this.coefficients[i].addScaledVector(sh.coefficients[i],s);return this};_proto.scale=function(s){for(var i=0;9>i;i++)this.coefficients[i].multiplyScalar(s);
return this};_proto.lerp=function(sh,alpha){for(var i=0;9>i;i++)this.coefficients[i].lerp(sh.coefficients[i],alpha);return this};_proto.equals=function(sh){for(var i=0;9>i;i++)if(!this.coefficients[i].equals(sh.coefficients[i]))return!1;return!0};_proto.copy=function(sh){return this.set(sh.coefficients)};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.fromArray=function(array,offset){void 0===offset&&(offset=0);for(var coefficients=this.coefficients,i=0;9>i;i++)coefficients[i].fromArray(array,
offset+3*i);return this};_proto.toArray=function(array,offset){void 0===array&&(array=[]);void 0===offset&&(offset=0);for(var coefficients=this.coefficients,i=0;9>i;i++)coefficients[i].toArray(array,offset+3*i);return array};SphericalHarmonics3.getBasisAt=function(normal,shBasis){var x=normal.x,y=normal.y;normal=normal.z;shBasis[0]=.282095;shBasis[1]=.488603*y;shBasis[2]=.488603*normal;shBasis[3]=.488603*x;shBasis[4]=1.092548*x*y;shBasis[5]=1.092548*y*normal;shBasis[6]=.315392*(3*normal*normal-1);
shBasis[7]=1.092548*x*normal;shBasis[8]=.546274*(x*x-y*y)};return SphericalHarmonics3}();LightProbe.prototype=Object.assign(Object.create(Light.prototype),{constructor:LightProbe,isLightProbe:!0,copy:function(source){Light.prototype.copy.call(this,source);this.sh.copy(source.sh);return this},fromJSON:function(json){this.intensity=json.intensity;this.sh.fromArray(json.sh);return this},toJSON:function(meta){meta=Light.prototype.toJSON.call(this,meta);meta.object.sh=this.sh.toArray();return meta}});
MaterialLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:MaterialLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new FileLoader(scope.manager);loader.setPath(scope.path);loader.setRequestHeader(scope.requestHeader);loader.setWithCredentials(scope.withCredentials);loader.load(url,function(text){try{onLoad(scope.parse(JSON.parse(text)))}catch(e$160){onError?onError(e$160):console.error(e$160),scope.manager.itemError(url)}},onProgress,onError)},parse:function(json){function getTexture(name){void 0===
textures[name]&&console.warn("THREE.MaterialLoader: Undefined texture",name);return textures[name]}var textures=this.textures,material=new Materials[json.type];void 0!==json.uuid&&(material.uuid=json.uuid);void 0!==json.name&&(material.name=json.name);void 0!==json.color&&void 0!==material.color&&material.color.setHex(json.color);void 0!==json.roughness&&(material.roughness=json.roughness);void 0!==json.metalness&&(material.metalness=json.metalness);void 0!==json.sheen&&(material.sheen=(new Color).setHex(json.sheen));
void 0!==json.emissive&&void 0!==material.emissive&&material.emissive.setHex(json.emissive);void 0!==json.specular&&void 0!==material.specular&&material.specular.setHex(json.specular);void 0!==json.shininess&&(material.shininess=json.shininess);void 0!==json.clearcoat&&(material.clearcoat=json.clearcoat);void 0!==json.clearcoatRoughness&&(material.clearcoatRoughness=json.clearcoatRoughness);void 0!==json.fog&&(material.fog=json.fog);void 0!==json.flatShading&&(material.flatShading=json.flatShading);
void 0!==json.blending&&(material.blending=json.blending);void 0!==json.combine&&(material.combine=json.combine);void 0!==json.side&&(material.side=json.side);void 0!==json.opacity&&(material.opacity=json.opacity);void 0!==json.transparent&&(material.transparent=json.transparent);void 0!==json.alphaTest&&(material.alphaTest=json.alphaTest);void 0!==json.depthTest&&(material.depthTest=json.depthTest);void 0!==json.depthWrite&&(material.depthWrite=json.depthWrite);void 0!==json.colorWrite&&(material.colorWrite=
json.colorWrite);void 0!==json.stencilWrite&&(material.stencilWrite=json.stencilWrite);void 0!==json.stencilWriteMask&&(material.stencilWriteMask=json.stencilWriteMask);void 0!==json.stencilFunc&&(material.stencilFunc=json.stencilFunc);void 0!==json.stencilRef&&(material.stencilRef=json.stencilRef);void 0!==json.stencilFuncMask&&(material.stencilFuncMask=json.stencilFuncMask);void 0!==json.stencilFail&&(material.stencilFail=json.stencilFail);void 0!==json.stencilZFail&&(material.stencilZFail=json.stencilZFail);
void 0!==json.stencilZPass&&(material.stencilZPass=json.stencilZPass);void 0!==json.wireframe&&(material.wireframe=json.wireframe);void 0!==json.wireframeLinewidth&&(material.wireframeLinewidth=json.wireframeLinewidth);void 0!==json.wireframeLinecap&&(material.wireframeLinecap=json.wireframeLinecap);void 0!==json.wireframeLinejoin&&(material.wireframeLinejoin=json.wireframeLinejoin);void 0!==json.rotation&&(material.rotation=json.rotation);1!==json.linewidth&&(material.linewidth=json.linewidth);void 0!==
json.dashSize&&(material.dashSize=json.dashSize);void 0!==json.gapSize&&(material.gapSize=json.gapSize);void 0!==json.scale&&(material.scale=json.scale);void 0!==json.polygonOffset&&(material.polygonOffset=json.polygonOffset);void 0!==json.polygonOffsetFactor&&(material.polygonOffsetFactor=json.polygonOffsetFactor);void 0!==json.polygonOffsetUnits&&(material.polygonOffsetUnits=json.polygonOffsetUnits);void 0!==json.skinning&&(material.skinning=json.skinning);void 0!==json.morphTargets&&(material.morphTargets=
json.morphTargets);void 0!==json.morphNormals&&(material.morphNormals=json.morphNormals);void 0!==json.dithering&&(material.dithering=json.dithering);void 0!==json.vertexTangents&&(material.vertexTangents=json.vertexTangents);void 0!==json.visible&&(material.visible=json.visible);void 0!==json.toneMapped&&(material.toneMapped=json.toneMapped);void 0!==json.userData&&(material.userData=json.userData);void 0!==json.vertexColors&&(material.vertexColors="number"===typeof json.vertexColors?0<json.vertexColors?
!0:!1:json.vertexColors);if(void 0!==json.uniforms)for(var name$jscomp$0 in json.uniforms){var uniform=json.uniforms[name$jscomp$0];material.uniforms[name$jscomp$0]={};switch(uniform.type){case "t":material.uniforms[name$jscomp$0].value=getTexture(uniform.value);break;case "c":material.uniforms[name$jscomp$0].value=(new Color).setHex(uniform.value);break;case "v2":material.uniforms[name$jscomp$0].value=(new Vector2).fromArray(uniform.value);break;case "v3":material.uniforms[name$jscomp$0].value=(new Vector3).fromArray(uniform.value);
break;case "v4":material.uniforms[name$jscomp$0].value=(new Vector4).fromArray(uniform.value);break;case "m3":material.uniforms[name$jscomp$0].value=(new Matrix3).fromArray(uniform.value);break;case "m4":material.uniforms[name$jscomp$0].value=(new Matrix4).fromArray(uniform.value);break;default:material.uniforms[name$jscomp$0].value=uniform.value}}void 0!==json.defines&&(material.defines=json.defines);void 0!==json.vertexShader&&(material.vertexShader=json.vertexShader);void 0!==json.fragmentShader&&
(material.fragmentShader=json.fragmentShader);if(void 0!==json.extensions)for(var key in json.extensions)material.extensions[key]=json.extensions[key];void 0!==json.shading&&(material.flatShading=1===json.shading);void 0!==json.size&&(material.size=json.size);void 0!==json.sizeAttenuation&&(material.sizeAttenuation=json.sizeAttenuation);void 0!==json.map&&(material.map=getTexture(json.map));void 0!==json.matcap&&(material.matcap=getTexture(json.matcap));void 0!==json.alphaMap&&(material.alphaMap=
getTexture(json.alphaMap));void 0!==json.bumpMap&&(material.bumpMap=getTexture(json.bumpMap));void 0!==json.bumpScale&&(material.bumpScale=json.bumpScale);void 0!==json.normalMap&&(material.normalMap=getTexture(json.normalMap));void 0!==json.normalMapType&&(material.normalMapType=json.normalMapType);void 0!==json.normalScale&&(name$jscomp$0=json.normalScale,!1===Array.isArray(name$jscomp$0)&&(name$jscomp$0=[name$jscomp$0,name$jscomp$0]),material.normalScale=(new Vector2).fromArray(name$jscomp$0));
void 0!==json.displacementMap&&(material.displacementMap=getTexture(json.displacementMap));void 0!==json.displacementScale&&(material.displacementScale=json.displacementScale);void 0!==json.displacementBias&&(material.displacementBias=json.displacementBias);void 0!==json.roughnessMap&&(material.roughnessMap=getTexture(json.roughnessMap));void 0!==json.metalnessMap&&(material.metalnessMap=getTexture(json.metalnessMap));void 0!==json.emissiveMap&&(material.emissiveMap=getTexture(json.emissiveMap));
void 0!==json.emissiveIntensity&&(material.emissiveIntensity=json.emissiveIntensity);void 0!==json.specularMap&&(material.specularMap=getTexture(json.specularMap));void 0!==json.envMap&&(material.envMap=getTexture(json.envMap));void 0!==json.envMapIntensity&&(material.envMapIntensity=json.envMapIntensity);void 0!==json.reflectivity&&(material.reflectivity=json.reflectivity);void 0!==json.refractionRatio&&(material.refractionRatio=json.refractionRatio);void 0!==json.lightMap&&(material.lightMap=getTexture(json.lightMap));
void 0!==json.lightMapIntensity&&(material.lightMapIntensity=json.lightMapIntensity);void 0!==json.aoMap&&(material.aoMap=getTexture(json.aoMap));void 0!==json.aoMapIntensity&&(material.aoMapIntensity=json.aoMapIntensity);void 0!==json.gradientMap&&(material.gradientMap=getTexture(json.gradientMap));void 0!==json.clearcoatMap&&(material.clearcoatMap=getTexture(json.clearcoatMap));void 0!==json.clearcoatRoughnessMap&&(material.clearcoatRoughnessMap=getTexture(json.clearcoatRoughnessMap));void 0!==
json.clearcoatNormalMap&&(material.clearcoatNormalMap=getTexture(json.clearcoatNormalMap));void 0!==json.clearcoatNormalScale&&(material.clearcoatNormalScale=(new Vector2).fromArray(json.clearcoatNormalScale));void 0!==json.transmission&&(material.transmission=json.transmission);void 0!==json.transmissionMap&&(material.transmissionMap=getTexture(json.transmissionMap));return material},setTextures:function(value){this.textures=value;return this}});var LoaderUtils={decodeText:function(array){if("undefined"!==
typeof TextDecoder)return(new TextDecoder).decode(array);for(var s="",i=0,il=array.length;i<il;i++)s+=String.fromCharCode(array[i]);try{return decodeURIComponent(escape(s))}catch(e$161){return s}},extractUrlBase:function(url){var index=url.lastIndexOf("/");return-1===index?"./":url.substr(0,index+1)}};InstancedBufferGeometry.prototype=Object.assign(Object.create(BufferGeometry.prototype),{constructor:InstancedBufferGeometry,isInstancedBufferGeometry:!0,copy:function(source){BufferGeometry.prototype.copy.call(this,
source);this.instanceCount=source.instanceCount;return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var data=BufferGeometry.prototype.toJSON.call(this);data.instanceCount=this.instanceCount;data.isInstancedBufferGeometry=!0;return data}});InstancedBufferAttribute.prototype=Object.assign(Object.create(BufferAttribute.prototype),{constructor:InstancedBufferAttribute,isInstancedBufferAttribute:!0,copy:function(source){BufferAttribute.prototype.copy.call(this,source);
this.meshPerAttribute=source.meshPerAttribute;return this},toJSON:function(){var data=BufferAttribute.prototype.toJSON.call(this);data.meshPerAttribute=this.meshPerAttribute;data.isInstancedBufferAttribute=!0;return data}});BufferGeometryLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:BufferGeometryLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new FileLoader(scope.manager);loader.setPath(scope.path);loader.setRequestHeader(scope.requestHeader);
loader.setWithCredentials(scope.withCredentials);loader.load(url,function(text){try{onLoad(scope.parse(JSON.parse(text)))}catch(e$162){onError?onError(e$162):console.error(e$162),scope.manager.itemError(url)}},onProgress,onError)},parse:function(json$jscomp$0){function getInterleavedBuffer(json,uuid){if(void 0!==interleavedBufferMap[uuid])return interleavedBufferMap[uuid];var interleavedBuffer=json.interleavedBuffers[uuid];var buffer=interleavedBuffer.buffer;void 0!==arrayBufferMap[buffer]?buffer=
arrayBufferMap[buffer]:(json=(new Uint32Array(json.arrayBuffers[buffer])).buffer,buffer=arrayBufferMap[buffer]=json);buffer=new TYPED_ARRAYS[interleavedBuffer.type](buffer);buffer=new InterleavedBuffer(buffer,interleavedBuffer.stride);buffer.uuid=interleavedBuffer.uuid;return interleavedBufferMap[uuid]=buffer}var interleavedBufferMap={},arrayBufferMap={},geometry=json$jscomp$0.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,index=json$jscomp$0.data.index;void 0!==index&&(index=
new TYPED_ARRAYS[index.type](index.array),geometry.setIndex(new BufferAttribute(index,1)));index=json$jscomp$0.data.attributes;for(var key in index){var attribute=index[key],bufferAttribute=void 0;attribute.isInterleavedBufferAttribute?(bufferAttribute=getInterleavedBuffer(json$jscomp$0.data,attribute.data),bufferAttribute=new InterleavedBufferAttribute(bufferAttribute,attribute.itemSize,attribute.offset,attribute.normalized)):(bufferAttribute=new TYPED_ARRAYS[attribute.type](attribute.array),bufferAttribute=
new (attribute.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute)(bufferAttribute,attribute.itemSize,attribute.normalized));void 0!==attribute.name&&(bufferAttribute.name=attribute.name);geometry.setAttribute(key,bufferAttribute)}if(key=json$jscomp$0.data.morphAttributes)for(var _key in key){index=key[_key];attribute=[];bufferAttribute=0;for(var il=index.length;bufferAttribute<il;bufferAttribute++){var _attribute=index[bufferAttribute],_bufferAttribute=void 0;_attribute.isInterleavedBufferAttribute?
(_bufferAttribute=getInterleavedBuffer(json$jscomp$0.data,_attribute.data),_bufferAttribute=new InterleavedBufferAttribute(_bufferAttribute,_attribute.itemSize,_attribute.offset,_attribute.normalized)):(_bufferAttribute=new TYPED_ARRAYS[_attribute.type](_attribute.array),_bufferAttribute=new BufferAttribute(_bufferAttribute,_attribute.itemSize,_attribute.normalized));void 0!==_attribute.name&&(_bufferAttribute.name=_attribute.name);attribute.push(_bufferAttribute)}geometry.morphAttributes[_key]=attribute}json$jscomp$0.data.morphTargetsRelative&&
(geometry.morphTargetsRelative=!0);_key=json$jscomp$0.data.groups||json$jscomp$0.data.drawcalls||json$jscomp$0.data.offsets;if(void 0!==_key)for(key=0,index=_key.length;key!==index;++key)attribute=_key[key],geometry.addGroup(attribute.start,attribute.count,attribute.materialIndex);_key=json$jscomp$0.data.boundingSphere;void 0!==_key&&(key=new Vector3,void 0!==_key.center&&key.fromArray(_key.center),geometry.boundingSphere=new Sphere(key,_key.radius));json$jscomp$0.name&&(geometry.name=json$jscomp$0.name);
json$jscomp$0.userData&&(geometry.userData=json$jscomp$0.userData);return geometry}});var ObjectLoader=function(_Loader){function ObjectLoader(manager){return _Loader.call(this,manager)||this}_inheritsLoose(ObjectLoader,_Loader);var _proto=ObjectLoader.prototype;_proto.load=function(url,onLoad,onProgress,onError){var scope=this,path=""===this.path?LoaderUtils.extractUrlBase(url):this.path;this.resourcePath=this.resourcePath||path;path=new FileLoader(this.manager);path.setPath(this.path);path.setRequestHeader(this.requestHeader);
path.setWithCredentials(this.withCredentials);path.load(url,function(text){var json=null;try{json=JSON.parse(text)}catch(error){void 0!==onError&&onError(error);console.error("THREE:ObjectLoader: Can't parse "+url+".",error.message);return}text=json.metadata;void 0===text||void 0===text.type||"geometry"===text.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+url):scope.parse(json,onLoad)},onProgress,onError)};_proto.parse=function(json,onLoad){var animations=this.parseAnimations(json.animations),
shapes=this.parseShapes(json.shapes),geometries=this.parseGeometries(json.geometries,shapes);shapes=this.parseImages(json.images,function(){void 0!==onLoad&&onLoad(object)});var textures=this.parseTextures(json.textures,shapes);textures=this.parseMaterials(json.materials,textures);var object=this.parseObject(json.object,geometries,textures,animations);json=this.parseSkeletons(json.skeletons,object);this.bindSkeletons(object,json);if(void 0!==onLoad){json=!1;for(var uuid in shapes)if(shapes[uuid]instanceof
HTMLImageElement){json=!0;break}!1===json&&onLoad(object)}return object};_proto.parseShapes=function(json){var shapes={};if(void 0!==json)for(var i=0,l=json.length;i<l;i++){var shape=(new Shape).fromJSON(json[i]);shapes[shape.uuid]=shape}return shapes};_proto.parseSkeletons=function(json,object){var skeletons={},bones={};object.traverse(function(child){child.isBone&&(bones[child.uuid]=child)});if(void 0!==json){object=0;for(var l=json.length;object<l;object++){var skeleton=(new Skeleton).fromJSON(json[object],
bones);skeletons[skeleton.uuid]=skeleton}}return skeletons};_proto.parseGeometries=function(json,shapes){var geometries={};if(void 0!==json)for(var bufferGeometryLoader=new BufferGeometryLoader,i=0,l=json.length;i<l;i++){var geometryShapes=void 0;var data=json[i];switch(data.type){case "PlaneGeometry":case "PlaneBufferGeometry":geometryShapes=new Geometries[data.type](data.width,data.height,data.widthSegments,data.heightSegments);break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":geometryShapes=
new Geometries[data.type](data.width,data.height,data.depth,data.widthSegments,data.heightSegments,data.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":geometryShapes=new Geometries[data.type](data.radius,data.segments,data.thetaStart,data.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":geometryShapes=new Geometries[data.type](data.radiusTop,data.radiusBottom,data.height,data.radialSegments,data.heightSegments,data.openEnded,data.thetaStart,data.thetaLength);
break;case "ConeGeometry":case "ConeBufferGeometry":geometryShapes=new Geometries[data.type](data.radius,data.height,data.radialSegments,data.heightSegments,data.openEnded,data.thetaStart,data.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":geometryShapes=new Geometries[data.type](data.radius,data.widthSegments,data.heightSegments,data.phiStart,data.phiLength,data.thetaStart,data.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":geometryShapes=
new Geometries[data.type](data.radius,data.detail);break;case "RingGeometry":case "RingBufferGeometry":geometryShapes=new Geometries[data.type](data.innerRadius,data.outerRadius,data.thetaSegments,data.phiSegments,data.thetaStart,data.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":geometryShapes=new Geometries[data.type](data.radius,data.tube,data.radialSegments,data.tubularSegments,data.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":geometryShapes=new Geometries[data.type](data.radius,
data.tube,data.tubularSegments,data.radialSegments,data.p,data.q);break;case "TubeGeometry":case "TubeBufferGeometry":geometryShapes=new Geometries[data.type]((new Curves[data.path.type]).fromJSON(data.path),data.tubularSegments,data.radius,data.radialSegments,data.closed);break;case "LatheGeometry":case "LatheBufferGeometry":geometryShapes=new Geometries[data.type](data.points,data.segments,data.phiStart,data.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":geometryShapes=
new Geometries[data.type](data.vertices,data.indices,data.radius,data.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":geometryShapes=[];for(var j=0,jl=data.shapes.length;j<jl;j++)geometryShapes.push(shapes[data.shapes[j]]);geometryShapes=new Geometries[data.type](geometryShapes,data.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":geometryShapes=[];j=0;for(jl=data.shapes.length;j<jl;j++)geometryShapes.push(shapes[data.shapes[j]]);j=data.options.extrudePath;void 0!==
j&&(data.options.extrudePath=(new Curves[j.type]).fromJSON(j));geometryShapes=new Geometries[data.type](geometryShapes,data.options);break;case "BufferGeometry":case "InstancedBufferGeometry":geometryShapes=bufferGeometryLoader.parse(data);break;case "Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?geometryShapes=(new THREE.LegacyJSONLoader).parse(data,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');
break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+data.type+'"');continue}geometryShapes.uuid=data.uuid;void 0!==data.name&&(geometryShapes.name=data.name);!0===geometryShapes.isBufferGeometry&&void 0!==data.userData&&(geometryShapes.userData=data.userData);geometries[data.uuid]=geometryShapes}return geometries};_proto.parseMaterials=function(json,textures){var cache={},materials={};if(void 0!==json){var loader=new MaterialLoader;loader.setTextures(textures);textures=0;
for(var l=json.length;textures<l;textures++){var data=json[textures];if("MultiMaterial"===data.type){for(var array=[],j=0;j<data.materials.length;j++){var material=data.materials[j];void 0===cache[material.uuid]&&(cache[material.uuid]=loader.parse(material));array.push(cache[material.uuid])}materials[data.uuid]=array}else void 0===cache[data.uuid]&&(cache[data.uuid]=loader.parse(data)),materials[data.uuid]=cache[data.uuid]}}return materials};_proto.parseAnimations=function(json){var animations={};
if(void 0!==json)for(var i=0;i<json.length;i++){var clip=AnimationClip.parse(json[i]);animations[clip.uuid]=clip}return animations};_proto.parseImages=function(json,onLoad){function loadImage(url){scope.manager.itemStart(url);return loader.load(url,function(){scope.manager.itemEnd(url)},void 0,function(){scope.manager.itemError(url);scope.manager.itemEnd(url)})}function deserializeImage(image){return"string"===typeof image?(image=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(image)?image:scope.resourcePath+image,
loadImage(image)):image.data?{data:new TYPED_ARRAYS[image.type](image.data),width:image.width,height:image.height}:null}var scope=this,images={};if(void 0!==json&&0<json.length){onLoad=new LoadingManager(onLoad);var loader=new ImageLoader(onLoad);loader.setCrossOrigin(this.crossOrigin);onLoad=0;for(var il=json.length;onLoad<il;onLoad++){var image$jscomp$0=json[onLoad],url$jscomp$0=image$jscomp$0.url;if(Array.isArray(url$jscomp$0)){images[image$jscomp$0.uuid]=[];for(var j=0,jl=url$jscomp$0.length;j<
jl;j++){var deserializedImage=deserializeImage(url$jscomp$0[j]);null!==deserializedImage&&(deserializedImage instanceof HTMLImageElement?images[image$jscomp$0.uuid].push(deserializedImage):images[image$jscomp$0.uuid].push(new DataTexture(deserializedImage.data,deserializedImage.width,deserializedImage.height)))}}else url$jscomp$0=deserializeImage(image$jscomp$0.url),null!==url$jscomp$0&&(images[image$jscomp$0.uuid]=url$jscomp$0)}}return images};_proto.parseTextures=function(json,images){function parseConstant(value,
type){if("number"===typeof value)return value;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",value);return type[value]}var textures={};if(void 0!==json)for(var i=0,l=json.length;i<l;i++){var data=json[i];void 0===data.image&&console.warn('THREE.ObjectLoader: No "image" specified for',data.uuid);void 0===images[data.image]&&console.warn("THREE.ObjectLoader: Undefined image",data.image);var texture=void 0,image=images[data.image];Array.isArray(image)?(texture=new CubeTexture(image),
6===image.length&&(texture.needsUpdate=!0)):(texture=image&&image.data?new DataTexture(image.data,image.width,image.height):new Texture(image),image&&(texture.needsUpdate=!0));texture.uuid=data.uuid;void 0!==data.name&&(texture.name=data.name);void 0!==data.mapping&&(texture.mapping=parseConstant(data.mapping,TEXTURE_MAPPING));void 0!==data.offset&&texture.offset.fromArray(data.offset);void 0!==data.repeat&&texture.repeat.fromArray(data.repeat);void 0!==data.center&&texture.center.fromArray(data.center);
void 0!==data.rotation&&(texture.rotation=data.rotation);void 0!==data.wrap&&(texture.wrapS=parseConstant(data.wrap[0],TEXTURE_WRAPPING),texture.wrapT=parseConstant(data.wrap[1],TEXTURE_WRAPPING));void 0!==data.format&&(texture.format=data.format);void 0!==data.type&&(texture.type=data.type);void 0!==data.encoding&&(texture.encoding=data.encoding);void 0!==data.minFilter&&(texture.minFilter=parseConstant(data.minFilter,TEXTURE_FILTER));void 0!==data.magFilter&&(texture.magFilter=parseConstant(data.magFilter,
TEXTURE_FILTER));void 0!==data.anisotropy&&(texture.anisotropy=data.anisotropy);void 0!==data.flipY&&(texture.flipY=data.flipY);void 0!==data.premultiplyAlpha&&(texture.premultiplyAlpha=data.premultiplyAlpha);void 0!==data.unpackAlignment&&(texture.unpackAlignment=data.unpackAlignment);textures[data.uuid]=texture}return textures};_proto.parseObject=function(data,geometries,materials,animations){function getGeometry(name){void 0===geometries[name]&&console.warn("THREE.ObjectLoader: Undefined geometry",
name);return geometries[name]}function getMaterial(name){if(void 0!==name){if(Array.isArray(name)){for(var array=[],i=0,l=name.length;i<l;i++){var uuid=name[i];void 0===materials[uuid]&&console.warn("THREE.ObjectLoader: Undefined material",uuid);array.push(materials[uuid])}return array}void 0===materials[name]&&console.warn("THREE.ObjectLoader: Undefined material",name);return materials[name]}}switch(data.type){case "Scene":var object=new Scene;void 0!==data.background&&Number.isInteger(data.background)&&
(object.background=new Color(data.background));void 0!==data.fog&&("Fog"===data.fog.type?object.fog=new Fog(data.fog.color,data.fog.near,data.fog.far):"FogExp2"===data.fog.type&&(object.fog=new FogExp2(data.fog.color,data.fog.density)));break;case "PerspectiveCamera":object=new PerspectiveCamera(data.fov,data.aspect,data.near,data.far);void 0!==data.focus&&(object.focus=data.focus);void 0!==data.zoom&&(object.zoom=data.zoom);void 0!==data.filmGauge&&(object.filmGauge=data.filmGauge);void 0!==data.filmOffset&&
(object.filmOffset=data.filmOffset);void 0!==data.view&&(object.view=Object.assign({},data.view));break;case "OrthographicCamera":object=new OrthographicCamera(data.left,data.right,data.top,data.bottom,data.near,data.far);void 0!==data.zoom&&(object.zoom=data.zoom);void 0!==data.view&&(object.view=Object.assign({},data.view));break;case "AmbientLight":object=new AmbientLight(data.color,data.intensity);break;case "DirectionalLight":object=new DirectionalLight(data.color,data.intensity);break;case "PointLight":object=
new PointLight(data.color,data.intensity,data.distance,data.decay);break;case "RectAreaLight":object=new RectAreaLight(data.color,data.intensity,data.width,data.height);break;case "SpotLight":object=new SpotLight(data.color,data.intensity,data.distance,data.angle,data.penumbra,data.decay);break;case "HemisphereLight":object=new HemisphereLight(data.color,data.groundColor,data.intensity);break;case "LightProbe":object=(new LightProbe).fromJSON(data);break;case "SkinnedMesh":object=getGeometry(data.geometry);
var material=getMaterial(data.material);object=new SkinnedMesh(object,material);void 0!==data.bindMode&&(object.bindMode=data.bindMode);void 0!==data.bindMatrix&&object.bindMatrix.fromArray(data.bindMatrix);void 0!==data.skeleton&&(object.skeleton=data.skeleton);break;case "Mesh":object=getGeometry(data.geometry);material=getMaterial(data.material);object=new Mesh(object,material);break;case "InstancedMesh":object=getGeometry(data.geometry);material=getMaterial(data.material);var instanceMatrix=data.instanceMatrix;
object=new InstancedMesh(object,material,data.count);object.instanceMatrix=new BufferAttribute(new Float32Array(instanceMatrix.array),16);break;case "LOD":object=new LOD;break;case "Line":object=new Line(getGeometry(data.geometry),getMaterial(data.material),data.mode);break;case "LineLoop":object=new LineLoop(getGeometry(data.geometry),getMaterial(data.material));break;case "LineSegments":object=new LineSegments(getGeometry(data.geometry),getMaterial(data.material));break;case "PointCloud":case "Points":object=
new Points(getGeometry(data.geometry),getMaterial(data.material));break;case "Sprite":object=new Sprite(getMaterial(data.material));break;case "Group":object=new Group;break;case "Bone":object=new Bone;break;default:object=new Object3D}object.uuid=data.uuid;void 0!==data.name&&(object.name=data.name);void 0!==data.matrix?(object.matrix.fromArray(data.matrix),void 0!==data.matrixAutoUpdate&&(object.matrixAutoUpdate=data.matrixAutoUpdate),object.matrixAutoUpdate&&object.matrix.decompose(object.position,
object.quaternion,object.scale)):(void 0!==data.position&&object.position.fromArray(data.position),void 0!==data.rotation&&object.rotation.fromArray(data.rotation),void 0!==data.quaternion&&object.quaternion.fromArray(data.quaternion),void 0!==data.scale&&object.scale.fromArray(data.scale));void 0!==data.castShadow&&(object.castShadow=data.castShadow);void 0!==data.receiveShadow&&(object.receiveShadow=data.receiveShadow);data.shadow&&(void 0!==data.shadow.bias&&(object.shadow.bias=data.shadow.bias),
void 0!==data.shadow.normalBias&&(object.shadow.normalBias=data.shadow.normalBias),void 0!==data.shadow.radius&&(object.shadow.radius=data.shadow.radius),void 0!==data.shadow.mapSize&&object.shadow.mapSize.fromArray(data.shadow.mapSize),void 0!==data.shadow.camera&&(object.shadow.camera=this.parseObject(data.shadow.camera)));void 0!==data.visible&&(object.visible=data.visible);void 0!==data.frustumCulled&&(object.frustumCulled=data.frustumCulled);void 0!==data.renderOrder&&(object.renderOrder=data.renderOrder);
void 0!==data.userData&&(object.userData=data.userData);void 0!==data.layers&&(object.layers.mask=data.layers);if(void 0!==data.children)for(instanceMatrix=data.children,material=0;material<instanceMatrix.length;material++)object.add(this.parseObject(instanceMatrix[material],geometries,materials,animations));if(void 0!==data.animations)for(instanceMatrix=data.animations,material=0;material<instanceMatrix.length;material++)object.animations.push(animations[instanceMatrix[material]]);if("LOD"===data.type)for(void 0!==
data.autoUpdate&&(object.autoUpdate=data.autoUpdate),data=data.levels,animations=0;animations<data.length;animations++)instanceMatrix=data[animations],material=object.getObjectByProperty("uuid",instanceMatrix.object),void 0!==material&&object.addLevel(material,instanceMatrix.distance);return object};_proto.bindSkeletons=function(object,skeletons){0!==Object.keys(skeletons).length&&object.traverse(function(child){if(!0===child.isSkinnedMesh&&void 0!==child.skeleton){var skeleton=skeletons[child.skeleton];
void 0===skeleton?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",child.skeleton):child.bind(skeleton,child.bindMatrix)}})};_proto.setTexturePath=function(value){console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().");return this.setResourcePath(value)};return ObjectLoader}(Loader),TEXTURE_MAPPING={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,
CubeUVRefractionMapping:307},TEXTURE_WRAPPING={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},TEXTURE_FILTER={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};ImageBitmapLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageBitmapLoader,isImageBitmapLoader:!0,setOptions:function(options){this.options=options;return this},load:function(url,
onLoad,onProgress,onError){void 0===url&&(url="");void 0!==this.path&&(url=this.path+url);url=this.manager.resolveURL(url);var scope=this,cached=Cache.get(url);if(void 0!==cached)return scope.manager.itemStart(url),setTimeout(function(){onLoad&&onLoad(cached);scope.manager.itemEnd(url)},0),cached;onProgress={};onProgress.credentials="anonymous"===this.crossOrigin?"same-origin":"include";fetch(url,onProgress).then(function(res){return res.blob()}).then(function(blob){return createImageBitmap(blob,
scope.options)}).then(function(imageBitmap){Cache.add(url,imageBitmap);onLoad&&onLoad(imageBitmap);scope.manager.itemEnd(url)}).catch(function(e){onError&&onError(e);scope.manager.itemError(url);scope.manager.itemEnd(url)});scope.manager.itemStart(url)}});Object.assign(ShapePath.prototype,{moveTo:function(x,y){this.currentPath=new Path;this.subPaths.push(this.currentPath);this.currentPath.moveTo(x,y);return this},lineTo:function(x,y){this.currentPath.lineTo(x,y);return this},quadraticCurveTo:function(aCPx,
aCPy,aX,aY){this.currentPath.quadraticCurveTo(aCPx,aCPy,aX,aY);return this},bezierCurveTo:function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){this.currentPath.bezierCurveTo(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY);return this},splineThru:function(pts){this.currentPath.splineThru(pts);return this},toShapes:function(isCCW,noHoles){function toShapesNoHoles(inSubpaths){for(var shapes=[],i=0,l=inSubpaths.length;i<l;i++){var _tmpPath=inSubpaths[i],_tmpShape=new Shape;_tmpShape.curves=_tmpPath.curves;shapes.push(_tmpShape)}return shapes}
function isPointInsidePolygon(inPt,inPolygon){for(var polyLen=inPolygon.length,inside=!1,p=polyLen-1,q=0;q<polyLen;p=q++){var edgeLowPt=inPolygon[p],edgeHighPt=inPolygon[q],edgeDx=edgeHighPt.x-edgeLowPt.x,edgeDy=edgeHighPt.y-edgeLowPt.y;if(Math.abs(edgeDy)>Number.EPSILON){if(0>edgeDy&&(edgeLowPt=inPolygon[q],edgeDx=-edgeDx,edgeHighPt=inPolygon[p],edgeDy=-edgeDy),!(inPt.y<edgeLowPt.y||inPt.y>edgeHighPt.y))if(inPt.y===edgeLowPt.y){if(inPt.x===edgeLowPt.x)return!0}else{p=edgeDy*(inPt.x-edgeLowPt.x)-
edgeDx*(inPt.y-edgeLowPt.y);if(0===p)return!0;0>p||(inside=!inside)}}else if(inPt.y===edgeLowPt.y&&(edgeHighPt.x<=inPt.x&&inPt.x<=edgeLowPt.x||edgeLowPt.x<=inPt.x&&inPt.x<=edgeHighPt.x))return!0}return inside}var isClockWise=ShapeUtils.isClockWise,subPaths=this.subPaths;if(0===subPaths.length)return[];if(!0===noHoles)return toShapesNoHoles(subPaths);noHoles=[];if(1===subPaths.length){var tmpPath=subPaths[0];var tmpShape=new Shape;tmpShape.curves=tmpPath.curves;noHoles.push(tmpShape);return noHoles}var holesFirst=
!isClockWise(subPaths[0].getPoints());holesFirst=isCCW?!holesFirst:holesFirst;tmpShape=[];var newShapes=[],newShapeHoles=[],mainIdx=0;newShapes[mainIdx]=void 0;newShapeHoles[mainIdx]=[];for(var i$jscomp$0=0,l$jscomp$0=subPaths.length;i$jscomp$0<l$jscomp$0;i$jscomp$0++){tmpPath=subPaths[i$jscomp$0];var tmpPoints=tmpPath.getPoints();var solid=isClockWise(tmpPoints);(solid=isCCW?!solid:solid)?(!holesFirst&&newShapes[mainIdx]&&mainIdx++,newShapes[mainIdx]={s:new Shape,p:tmpPoints},newShapes[mainIdx].s.curves=
tmpPath.curves,holesFirst&&mainIdx++,newShapeHoles[mainIdx]=[]):newShapeHoles[mainIdx].push({h:tmpPath,p:tmpPoints[0]})}if(!newShapes[0])return toShapesNoHoles(subPaths);if(1<newShapes.length){isCCW=!1;isClockWise=[];subPaths=0;for(tmpPath=newShapes.length;subPaths<tmpPath;subPaths++)tmpShape[subPaths]=[];subPaths=0;for(tmpPath=newShapes.length;subPaths<tmpPath;subPaths++)for(solid=newShapeHoles[subPaths],holesFirst=0;holesFirst<solid.length;holesFirst++){mainIdx=solid[holesFirst];tmpPoints=!0;for(i$jscomp$0=
0;i$jscomp$0<newShapes.length;i$jscomp$0++)isPointInsidePolygon(mainIdx.p,newShapes[i$jscomp$0].p)&&(subPaths!==i$jscomp$0&&isClockWise.push({froms:subPaths,tos:i$jscomp$0,hole:holesFirst}),tmpPoints?(tmpPoints=!1,tmpShape[i$jscomp$0].push(mainIdx)):isCCW=!0);tmpPoints&&tmpShape[subPaths].push(mainIdx)}0<isClockWise.length&&(isCCW||(newShapeHoles=tmpShape))}isClockWise=0;for(subPaths=newShapes.length;isClockWise<subPaths;isClockWise++)for(tmpShape=newShapes[isClockWise].s,noHoles.push(tmpShape),isCCW=
newShapeHoles[isClockWise],tmpPath=0,solid=isCCW.length;tmpPath<solid;tmpPath++)tmpShape.holes.push(isCCW[tmpPath].h);return noHoles}});Object.assign(Font.prototype,{isFont:!0,generateShapes:function(text,size$jscomp$0){void 0===size$jscomp$0&&(size$jscomp$0=100);var shapes=[],size=size$jscomp$0;size$jscomp$0=this.data;var chars=Array.from?Array.from(text):String(text).split("");size/=size$jscomp$0.resolution;var line_height=(size$jscomp$0.boundingBox.yMax-size$jscomp$0.boundingBox.yMin+size$jscomp$0.underlineThickness)*
size;text=[];for(var offsetX=0,offsetY=0,i=0;i<chars.length;i++){var char=chars[i];if("\n"===char)offsetX=0,offsetY-=line_height;else{var char$jscomp$0=char;char=size;var offsetX$jscomp$0=offsetX,offsetY$jscomp$0=offsetY,data=size$jscomp$0,glyph=data.glyphs[char$jscomp$0]||data.glyphs["?"];if(glyph){char$jscomp$0=new ShapePath;if(glyph.o){data=glyph._cachedOutline||(glyph._cachedOutline=glyph.o.split(" "));for(var i$jscomp$0=0,l=data.length;i$jscomp$0<l;)switch(data[i$jscomp$0++]){case "m":var cpx2=
data[i$jscomp$0++]*char+offsetX$jscomp$0;var cpy2=data[i$jscomp$0++]*char+offsetY$jscomp$0;char$jscomp$0.moveTo(cpx2,cpy2);break;case "l":cpx2=data[i$jscomp$0++]*char+offsetX$jscomp$0;cpy2=data[i$jscomp$0++]*char+offsetY$jscomp$0;char$jscomp$0.lineTo(cpx2,cpy2);break;case "q":var cpx=data[i$jscomp$0++]*char+offsetX$jscomp$0;var cpy=data[i$jscomp$0++]*char+offsetY$jscomp$0;var cpx1=data[i$jscomp$0++]*char+offsetX$jscomp$0;var cpy1=data[i$jscomp$0++]*char+offsetY$jscomp$0;char$jscomp$0.quadraticCurveTo(cpx1,
cpy1,cpx,cpy);break;case "b":cpx=data[i$jscomp$0++]*char+offsetX$jscomp$0,cpy=data[i$jscomp$0++]*char+offsetY$jscomp$0,cpx1=data[i$jscomp$0++]*char+offsetX$jscomp$0,cpy1=data[i$jscomp$0++]*char+offsetY$jscomp$0,cpx2=data[i$jscomp$0++]*char+offsetX$jscomp$0,cpy2=data[i$jscomp$0++]*char+offsetY$jscomp$0,char$jscomp$0.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,cpx,cpy)}}char={offsetX:glyph.ha*char,path:char$jscomp$0}}else console.error('THREE.Font: character "'+char$jscomp$0+'" does not exists in font family '+
data.familyName+"."),char=void 0;offsetX+=char.offsetX;text.push(char.path)}}size$jscomp$0=0;for(chars=text.length;size$jscomp$0<chars;size$jscomp$0++)Array.prototype.push.apply(shapes,text[size$jscomp$0].toShapes());return shapes}});FontLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FontLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new FileLoader(this.manager);loader.setPath(this.path);loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(scope.withCredentials);
loader.load(url,function(text){try{var json=JSON.parse(text)}catch(e$163){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),json=JSON.parse(text.substring(65,text.length-2))}text=scope.parse(json);onLoad&&onLoad(text)},onProgress,onError)},parse:function(json){return new Font(json)}});var _context,AudioContext={getContext:function(){void 0===_context&&(_context=new (window.AudioContext||window.webkitAudioContext));return _context},setContext:function(value){_context=
value}};AudioLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AudioLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new FileLoader(scope.manager);loader.setResponseType("arraybuffer");loader.setPath(scope.path);loader.setRequestHeader(scope.requestHeader);loader.setWithCredentials(scope.withCredentials);loader.load(url,function(buffer){try{var bufferCopy=buffer.slice(0);AudioContext.getContext().decodeAudioData(bufferCopy,function(audioBuffer){onLoad(audioBuffer)})}catch(e$164){onError?
onError(e$164):console.error(e$164),scope.manager.itemError(url)}},onProgress,onError)}});HemisphereLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:HemisphereLightProbe,isHemisphereLightProbe:!0,copy:function(source){LightProbe.prototype.copy.call(this,source);return this},toJSON:function(meta){return LightProbe.prototype.toJSON.call(this,meta)}});AmbientLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:AmbientLightProbe,isAmbientLightProbe:!0,
copy:function(source){LightProbe.prototype.copy.call(this,source);return this},toJSON:function(meta){return LightProbe.prototype.toJSON.call(this,meta)}});var _eyeRight=new Matrix4,_eyeLeft=new Matrix4;Object.assign(StereoCamera.prototype,{update:function(camera){var cache=this._cache;if(cache.focus!==camera.focus||cache.fov!==camera.fov||cache.aspect!==camera.aspect*this.aspect||cache.near!==camera.near||cache.far!==camera.far||cache.zoom!==camera.zoom||cache.eyeSep!==this.eyeSep){cache.focus=camera.focus;
cache.fov=camera.fov;cache.aspect=camera.aspect*this.aspect;cache.near=camera.near;cache.far=camera.far;cache.zoom=camera.zoom;cache.eyeSep=this.eyeSep;var projectionMatrix=camera.projectionMatrix.clone(),eyeSepHalf=cache.eyeSep/2,eyeSepOnProjection=eyeSepHalf*cache.near/cache.focus,ymax=cache.near*Math.tan(MathUtils.DEG2RAD*cache.fov*.5)/cache.zoom;_eyeLeft.elements[12]=-eyeSepHalf;_eyeRight.elements[12]=eyeSepHalf;eyeSepHalf=-ymax*cache.aspect+eyeSepOnProjection;var xmax=ymax*cache.aspect+eyeSepOnProjection;
projectionMatrix.elements[0]=2*cache.near/(xmax-eyeSepHalf);projectionMatrix.elements[8]=(xmax+eyeSepHalf)/(xmax-eyeSepHalf);this.cameraL.projectionMatrix.copy(projectionMatrix);eyeSepHalf=-ymax*cache.aspect-eyeSepOnProjection;xmax=ymax*cache.aspect-eyeSepOnProjection;projectionMatrix.elements[0]=2*cache.near/(xmax-eyeSepHalf);projectionMatrix.elements[8]=(xmax+eyeSepHalf)/(xmax-eyeSepHalf);this.cameraR.projectionMatrix.copy(projectionMatrix)}this.cameraL.matrixWorld.copy(camera.matrixWorld).multiply(_eyeLeft);
this.cameraR.matrixWorld.copy(camera.matrixWorld).multiply(_eyeRight)}});var Clock$jscomp$0=function(){function Clock(autoStart){this.autoStart=void 0!==autoStart?autoStart:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}var _proto=Clock.prototype;_proto.start=function(){this.oldTime=this.startTime=now$jscomp$0();this.elapsedTime=0;this.running=!0};_proto.stop=function(){this.getElapsedTime();this.autoStart=this.running=!1};_proto.getElapsedTime=function(){this.getDelta();return this.elapsedTime};
_proto.getDelta=function(){var diff=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var newTime=now$jscomp$0();diff=(newTime-this.oldTime)/1E3;this.oldTime=newTime;this.elapsedTime+=diff}return diff};return Clock}(),_position$2=new Vector3,_quaternion$3=new Quaternion,_scale$1=new Vector3,_orientation=new Vector3,AudioListener$jscomp$0=function(_Object3D){function AudioListener(){var _this=_Object3D.call(this)||this;_this.type="AudioListener";_this.context=AudioContext.getContext();
_this.gain=_this.context.createGain();_this.gain.connect(_this.context.destination);_this.filter=null;_this.timeDelta=0;_this._clock=new Clock$jscomp$0;return _this}_inheritsLoose(AudioListener,_Object3D);var _proto=AudioListener.prototype;_proto.getInput=function(){return this.gain};_proto.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this};_proto.getFilter=
function(){return this.filter};_proto.setFilter=function(value){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=value;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this};_proto.getMasterVolume=function(){return this.gain.gain.value};_proto.setMasterVolume=function(value){this.gain.gain.setTargetAtTime(value,this.context.currentTime,.01);return this};
_proto.updateMatrixWorld=function(force){_Object3D.prototype.updateMatrixWorld.call(this,force);force=this.context.listener;var up=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(_position$2,_quaternion$3,_scale$1);_orientation.set(0,0,-1).applyQuaternion(_quaternion$3);if(force.positionX){var endTime=this.context.currentTime+this.timeDelta;force.positionX.linearRampToValueAtTime(_position$2.x,endTime);force.positionY.linearRampToValueAtTime(_position$2.y,endTime);force.positionZ.linearRampToValueAtTime(_position$2.z,
endTime);force.forwardX.linearRampToValueAtTime(_orientation.x,endTime);force.forwardY.linearRampToValueAtTime(_orientation.y,endTime);force.forwardZ.linearRampToValueAtTime(_orientation.z,endTime);force.upX.linearRampToValueAtTime(up.x,endTime);force.upY.linearRampToValueAtTime(up.y,endTime);force.upZ.linearRampToValueAtTime(up.z,endTime)}else force.setPosition(_position$2.x,_position$2.y,_position$2.z),force.setOrientation(_orientation.x,_orientation.y,_orientation.z,up.x,up.y,up.z)};return AudioListener}(Object3D),
Audio$jscomp$0=function(_Object3D){function Audio(listener){var _this=_Object3D.call(this)||this;_this.type="Audio";_this.listener=listener;_this.context=listener.context;_this.gain=_this.context.createGain();_this.gain.connect(listener.getInput());_this.autoplay=!1;_this.buffer=null;_this.detune=0;_this.loop=!1;_this.loopStart=0;_this.loopEnd=0;_this.offset=0;_this.duration=void 0;_this.playbackRate=1;_this.isPlaying=!1;_this.hasPlaybackControl=!0;_this.source=null;_this.sourceType="empty";_this._startedAt=
0;_this._progress=0;_this._connected=!1;_this.filters=[];return _this}_inheritsLoose(Audio,_Object3D);var _proto=Audio.prototype;_proto.getOutput=function(){return this.gain};_proto.setNodeSource=function(audioNode){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=audioNode;this.connect();return this};_proto.setMediaElementSource=function(mediaElement){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(mediaElement);this.connect();
return this};_proto.setMediaStreamSource=function(mediaStream){this.hasPlaybackControl=!1;this.sourceType="mediaStreamNode";this.source=this.context.createMediaStreamSource(mediaStream);this.connect();return this};_proto.setBuffer=function(audioBuffer){this.buffer=audioBuffer;this.sourceType="buffer";this.autoplay&&this.play();return this};_proto.play=function(delay){void 0===delay&&(delay=0);if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else return this._startedAt=this.context.currentTime+delay,delay=this.context.createBufferSource(),delay.buffer=this.buffer,delay.loop=this.loop,delay.loopStart=this.loopStart,delay.loopEnd=this.loopEnd,delay.onended=this.onEnded.bind(this),delay.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=delay,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()};_proto.pause=function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this};_proto.stop=function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this};_proto.connect=function(){if(0<
this.filters.length){this.source.connect(this.filters[0]);for(var i=1,l=this.filters.length;i<l;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());this._connected=!0;return this};_proto.disconnect=function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var i=1,l=this.filters.length;i<l;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());
this._connected=!1;return this};_proto.getFilters=function(){return this.filters};_proto.setFilters=function(value){value||(value=[]);!0===this._connected?(this.disconnect(),this.filters=value.slice(),this.connect()):this.filters=value.slice();return this};_proto.setDetune=function(value){this.detune=value;if(void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this};_proto.getDetune=function(){return this.detune};_proto.getFilter=
function(){return this.getFilters()[0]};_proto.setFilter=function(filter){return this.setFilters(filter?[filter]:[])};_proto.setPlaybackRate=function(value){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=value,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this};_proto.getPlaybackRate=function(){return this.playbackRate};_proto.onEnded=function(){this.isPlaying=
!1};_proto.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop};_proto.setLoop=function(value){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=value,!0===this.isPlaying&&(this.source.loop=this.loop),this};_proto.setLoopStart=function(value){this.loopStart=value;return this};_proto.setLoopEnd=function(value){this.loopEnd=value;return this};_proto.getVolume=
function(){return this.gain.gain.value};_proto.setVolume=function(value){this.gain.gain.setTargetAtTime(value,this.context.currentTime,.01);return this};return Audio}(Object3D),_position$3=new Vector3,_quaternion$4=new Quaternion,_scale$2=new Vector3,_orientation$1=new Vector3,PositionalAudio=function(_Audio){function PositionalAudio(listener){listener=_Audio.call(this,listener)||this;listener.panner=listener.context.createPanner();listener.panner.panningModel="HRTF";listener.panner.connect(listener.gain);
return listener}_inheritsLoose(PositionalAudio,_Audio);var _proto=PositionalAudio.prototype;_proto.getOutput=function(){return this.panner};_proto.getRefDistance=function(){return this.panner.refDistance};_proto.setRefDistance=function(value){this.panner.refDistance=value;return this};_proto.getRolloffFactor=function(){return this.panner.rolloffFactor};_proto.setRolloffFactor=function(value){this.panner.rolloffFactor=value;return this};_proto.getDistanceModel=function(){return this.panner.distanceModel};
_proto.setDistanceModel=function(value){this.panner.distanceModel=value;return this};_proto.getMaxDistance=function(){return this.panner.maxDistance};_proto.setMaxDistance=function(value){this.panner.maxDistance=value;return this};_proto.setDirectionalCone=function(coneInnerAngle,coneOuterAngle,coneOuterGain){this.panner.coneInnerAngle=coneInnerAngle;this.panner.coneOuterAngle=coneOuterAngle;this.panner.coneOuterGain=coneOuterGain;return this};_proto.updateMatrixWorld=function(force){_Audio.prototype.updateMatrixWorld.call(this,
force);if(!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(_position$3,_quaternion$4,_scale$2),_orientation$1.set(0,0,1).applyQuaternion(_quaternion$4),force=this.panner,force.positionX){var endTime=this.context.currentTime+this.listener.timeDelta;force.positionX.linearRampToValueAtTime(_position$3.x,endTime);force.positionY.linearRampToValueAtTime(_position$3.y,endTime);force.positionZ.linearRampToValueAtTime(_position$3.z,endTime);force.orientationX.linearRampToValueAtTime(_orientation$1.x,
endTime);force.orientationY.linearRampToValueAtTime(_orientation$1.y,endTime);force.orientationZ.linearRampToValueAtTime(_orientation$1.z,endTime)}else force.setPosition(_position$3.x,_position$3.y,_position$3.z),force.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z)};return PositionalAudio}(Audio$jscomp$0),AudioAnalyser=function(){function AudioAnalyser(audio,fftSize){void 0===fftSize&&(fftSize=2048);this.analyser=audio.context.createAnalyser();this.analyser.fftSize=fftSize;this.data=
new Uint8Array(this.analyser.frequencyBinCount);audio.getOutput().connect(this.analyser)}var _proto=AudioAnalyser.prototype;_proto.getFrequencyData=function(){this.analyser.getByteFrequencyData(this.data);return this.data};_proto.getAverageFrequency=function(){for(var value=0,data=this.getFrequencyData(),i=0;i<data.length;i++)value+=data[i];return value/data.length};return AudioAnalyser}();Object.assign(PropertyMixer.prototype,{accumulate:function(accuIndex,weight){var buffer=this.buffer,stride=this.valueSize;
accuIndex=accuIndex*stride+stride;var currentWeight=this.cumulativeWeight;if(0===currentWeight){for(currentWeight=0;currentWeight!==stride;++currentWeight)buffer[accuIndex+currentWeight]=buffer[currentWeight];currentWeight=weight}else currentWeight+=weight,this._mixBufferRegion(buffer,accuIndex,0,weight/currentWeight,stride);this.cumulativeWeight=currentWeight},accumulateAdditive:function(weight){var buffer=this.buffer,stride=this.valueSize,offset=stride*this._addIndex;0===this.cumulativeWeightAdditive&&
this._setIdentity();this._mixBufferRegionAdditive(buffer,offset,0,weight,stride);this.cumulativeWeightAdditive+=weight},apply:function(accuIndex){var stride=this.valueSize,buffer=this.buffer;accuIndex=accuIndex*stride+stride;var weight=this.cumulativeWeight,weightAdditive=this.cumulativeWeightAdditive,binding=this.binding;this.cumulativeWeightAdditive=this.cumulativeWeight=0;1>weight&&this._mixBufferRegion(buffer,accuIndex,stride*this._origIndex,1-weight,stride);0<weightAdditive&&this._mixBufferRegionAdditive(buffer,
accuIndex,this._addIndex*stride,1,stride);weight=stride;for(weightAdditive=stride+stride;weight!==weightAdditive;++weight)if(buffer[weight]!==buffer[weight+stride]){binding.setValue(buffer,accuIndex);break}},saveOriginalState:function(){var buffer=this.buffer,stride=this.valueSize,originalValueOffset=stride*this._origIndex;this.binding.getValue(buffer,originalValueOffset);for(var i=stride;i!==originalValueOffset;++i)buffer[i]=buffer[originalValueOffset+i%stride];this._setIdentity();this.cumulativeWeightAdditive=
this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var startIndex=this._addIndex*this.valueSize,endIndex=startIndex+this.valueSize;startIndex<endIndex;startIndex++)this.buffer[startIndex]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var startIndex=this._origIndex*this.valueSize,
targetIndex=this._addIndex*this.valueSize,i=0;i<this.valueSize;i++)this.buffer[targetIndex+i]=this.buffer[startIndex+i]},_select:function(buffer,dstOffset,srcOffset,t,stride){if(.5<=t)for(t=0;t!==stride;++t)buffer[dstOffset+t]=buffer[srcOffset+t]},_slerp:function(buffer,dstOffset,srcOffset,t){Quaternion.slerpFlat(buffer,dstOffset,buffer,dstOffset,buffer,srcOffset,t)},_slerpAdditive:function(buffer,dstOffset,srcOffset,t,stride){stride*=this._workIndex;Quaternion.multiplyQuaternionsFlat(buffer,stride,
buffer,dstOffset,buffer,srcOffset);Quaternion.slerpFlat(buffer,dstOffset,buffer,dstOffset,buffer,stride,t)},_lerp:function(buffer,dstOffset,srcOffset,t,stride){for(var s=1-t,i=0;i!==stride;++i){var j=dstOffset+i;buffer[j]=buffer[j]*s+buffer[srcOffset+i]*t}},_lerpAdditive:function(buffer,dstOffset,srcOffset,t,stride){for(var i=0;i!==stride;++i){var j=dstOffset+i;buffer[j]+=buffer[srcOffset+i]*t}}});var _reservedRe=/[\[\]\.:\/]/g,_wordCharOrDot="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",_directoryRe=
/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones"];Object.assign(Composite.prototype,{getValue:function(array,offset){this.bind();var binding=this._bindings[this._targetGroup.nCachedObjects_];
void 0!==binding&&binding.getValue(array,offset)},setValue:function(array,offset){for(var bindings=this._bindings,i=this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].setValue(array,offset)},bind:function(){for(var bindings=this._bindings,i=this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].bind()},unbind:function(){for(var bindings=this._bindings,i=this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].unbind()}});Object.assign(PropertyBinding,
{Composite:Composite,create:function(root,path,parsedPath){return root&&root.isAnimationObjectGroup?new PropertyBinding.Composite(root,path,parsedPath):new PropertyBinding(root,path,parsedPath)},sanitizeNodeName:function(name){return name.replace(/\s/g,"_").replace(_reservedRe,"")},parseTrackName:function(trackName){var matches=_trackRe.exec(trackName);if(!matches)throw Error("PropertyBinding: Cannot parse trackName: "+trackName);matches={nodeName:matches[2],objectName:matches[3],objectIndex:matches[4],
propertyName:matches[5],propertyIndex:matches[6]};var lastDot=matches.nodeName&&matches.nodeName.lastIndexOf(".");if(void 0!==lastDot&&-1!==lastDot){var objectName=matches.nodeName.substring(lastDot+1);-1!==_supportedObjectNames.indexOf(objectName)&&(matches.nodeName=matches.nodeName.substring(0,lastDot),matches.objectName=objectName)}if(null===matches.propertyName||0===matches.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+trackName);return matches},
findNode:function(root,nodeName){if(!nodeName||""===nodeName||"."===nodeName||-1===nodeName||nodeName===root.name||nodeName===root.uuid)return root;if(root.skeleton){var bone=root.skeleton.getBoneByName(nodeName);if(void 0!==bone)return bone}return root.children&&(root=function searchNodeSubtree(children){for(var i=0;i<children.length;i++){var childNode=children[i];if(childNode.name===nodeName||childNode.uuid===nodeName||(childNode=searchNodeSubtree(childNode.children)))return childNode}return null}(root.children))?
root:null}});Object.assign(PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(buffer,offset){buffer[offset]=this.node[this.propertyName]},function(buffer,offset){for(var source=this.resolvedProperty,i=0,n=source.length;i!==n;++i)buffer[offset++]=source[i]},function(buffer,offset){buffer[offset]=this.resolvedProperty[this.propertyIndex]},
function(buffer,offset){this.resolvedProperty.toArray(buffer,offset)}],SetterByBindingTypeAndVersioning:[[function(buffer,offset){this.targetObject[this.propertyName]=buffer[offset]},function(buffer,offset){this.targetObject[this.propertyName]=buffer[offset];this.targetObject.needsUpdate=!0},function(buffer,offset){this.targetObject[this.propertyName]=buffer[offset];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(buffer,offset){for(var dest=this.resolvedProperty,i=0,n=dest.length;i!==n;++i)dest[i]=
buffer[offset++]},function(buffer,offset){for(var dest=this.resolvedProperty,i=0,n=dest.length;i!==n;++i)dest[i]=buffer[offset++];this.targetObject.needsUpdate=!0},function(buffer,offset){for(var dest=this.resolvedProperty,i=0,n=dest.length;i!==n;++i)dest[i]=buffer[offset++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(buffer,offset){this.resolvedProperty[this.propertyIndex]=buffer[offset]},function(buffer,offset){this.resolvedProperty[this.propertyIndex]=buffer[offset];this.targetObject.needsUpdate=
!0},function(buffer,offset){this.resolvedProperty[this.propertyIndex]=buffer[offset];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(buffer,offset){this.resolvedProperty.fromArray(buffer,offset)},function(buffer,offset){this.resolvedProperty.fromArray(buffer,offset);this.targetObject.needsUpdate=!0},function(buffer,offset){this.resolvedProperty.fromArray(buffer,offset);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(targetArray,offset){this.bind();this.getValue(targetArray,
offset)},setValue:function(sourceArray,offset){this.bind();this.setValue(sourceArray,offset)},bind:function(){var targetObject=this.node,parsedPath=this.parsedPath,objectName=parsedPath.objectName,propertyName=parsedPath.propertyName,propertyIndex=parsedPath.propertyIndex;targetObject||(this.node=targetObject=PropertyBinding.findNode(this.rootNode,parsedPath.nodeName)||this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(targetObject){if(objectName){var objectIndex=
parsedPath.objectIndex;switch(objectName){case "materials":if(!targetObject.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!targetObject.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}targetObject=targetObject.material.materials;break;case "bones":if(!targetObject.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",
this);return}targetObject=targetObject.skeleton.bones;for(objectName=0;objectName<targetObject.length;objectName++)if(targetObject[objectName].name===objectIndex){objectIndex=objectName;break}break;default:if(void 0===targetObject[objectName]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}targetObject=targetObject[objectName]}if(void 0!==objectIndex){if(void 0===targetObject[objectIndex]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",
this,targetObject);return}targetObject=targetObject[objectIndex]}}objectIndex=targetObject[propertyName];if(void 0===objectIndex)console.error("THREE.PropertyBinding: Trying to update property for track: "+parsedPath.nodeName+"."+propertyName+" but it wasn't found.",targetObject);else{parsedPath=this.Versioning.None;this.targetObject=targetObject;void 0!==targetObject.needsUpdate?parsedPath=this.Versioning.NeedsUpdate:void 0!==targetObject.matrixWorldNeedsUpdate&&(parsedPath=this.Versioning.MatrixWorldNeedsUpdate);
objectName=this.BindingType.Direct;if(void 0!==propertyIndex){if("morphTargetInfluences"===propertyName){if(!targetObject.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(targetObject.geometry.isBufferGeometry){if(!targetObject.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==
targetObject.morphTargetDictionary[propertyIndex]&&(propertyIndex=targetObject.morphTargetDictionary[propertyIndex])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}objectName=this.BindingType.ArrayElement;this.resolvedProperty=objectIndex;this.propertyIndex=propertyIndex}else void 0!==objectIndex.fromArray&&void 0!==objectIndex.toArray?(objectName=this.BindingType.HasFromToArray,this.resolvedProperty=
objectIndex):Array.isArray(objectIndex)?(objectName=this.BindingType.EntireArray,this.resolvedProperty=objectIndex):this.propertyName=propertyName;this.getValue=this.GetterByBindingType[objectName];this.setValue=this.SetterByBindingTypeAndVersioning[objectName][parsedPath]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(PropertyBinding.prototype,
{_getValue_unbound:PropertyBinding.prototype.getValue,_setValue_unbound:PropertyBinding.prototype.setValue});Object.assign(AnimationObjectGroup.prototype,{isAnimationObjectGroup:!0,add:function(){for(var objects=this._objects,indicesByUUID=this._indicesByUUID,paths=this._paths,parsedPaths=this._parsedPaths,bindings=this._bindings,nBindings=bindings.length,knownObject=void 0,nObjects=objects.length,nCachedObjects=this.nCachedObjects_,i=0,n=arguments.length;i!==n;++i){var object=arguments[i],uuid=object.uuid,
index=indicesByUUID[uuid];if(void 0===index){index=nObjects++;indicesByUUID[uuid]=index;objects.push(object);index=0;for(var m=nBindings;index!==m;++index)bindings[index].push(new PropertyBinding(object,paths[index],parsedPaths[index]))}else if(index<nCachedObjects){knownObject=objects[index];m=--nCachedObjects;var lastCachedObject=objects[m];indicesByUUID[lastCachedObject.uuid]=index;objects[index]=lastCachedObject;indicesByUUID[uuid]=m;objects[m]=object;uuid=0;for(lastCachedObject=nBindings;uuid!==
lastCachedObject;++uuid){var bindingsForPath=bindings[uuid],binding=bindingsForPath[index];bindingsForPath[index]=bindingsForPath[m];void 0===binding&&(binding=new PropertyBinding(object,paths[uuid],parsedPaths[uuid]));bindingsForPath[m]=binding}}else objects[index]!==knownObject&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=nCachedObjects},remove:function(){for(var objects=
this._objects,indicesByUUID=this._indicesByUUID,bindings=this._bindings,nBindings=bindings.length,nCachedObjects=this.nCachedObjects_,i=0,n=arguments.length;i!==n;++i){var object=arguments[i],uuid=object.uuid,index=indicesByUUID[uuid];if(void 0!==index&&index>=nCachedObjects){var lastCachedIndex=nCachedObjects++,firstActiveObject=objects[lastCachedIndex];indicesByUUID[firstActiveObject.uuid]=index;objects[index]=firstActiveObject;indicesByUUID[uuid]=lastCachedIndex;objects[lastCachedIndex]=object;
object=0;for(uuid=nBindings;object!==uuid;++object){firstActiveObject=bindings[object];var binding=firstActiveObject[index];firstActiveObject[index]=firstActiveObject[lastCachedIndex];firstActiveObject[lastCachedIndex]=binding}}}this.nCachedObjects_=nCachedObjects},uncache:function(){for(var objects=this._objects,indicesByUUID=this._indicesByUUID,bindings=this._bindings,nBindings=bindings.length,nCachedObjects=this.nCachedObjects_,nObjects=objects.length,i=0,n=arguments.length;i!==n;++i){var uuid=
arguments[i].uuid,index=indicesByUUID[uuid];if(void 0!==index)if(delete indicesByUUID[uuid],index<nCachedObjects){uuid=--nCachedObjects;var lastCachedObject=objects[uuid],lastIndex=--nObjects,lastObject=objects[lastIndex];indicesByUUID[lastCachedObject.uuid]=index;objects[index]=lastCachedObject;indicesByUUID[lastObject.uuid]=uuid;objects[uuid]=lastObject;objects.pop();lastCachedObject=0;for(lastObject=nBindings;lastCachedObject!==lastObject;++lastCachedObject){var bindingsForPath=bindings[lastCachedObject],
last=bindingsForPath[lastIndex];bindingsForPath[index]=bindingsForPath[uuid];bindingsForPath[uuid]=last;bindingsForPath.pop()}}else for(uuid=--nObjects,lastIndex=objects[uuid],0<uuid&&(indicesByUUID[lastIndex.uuid]=index),objects[index]=lastIndex,objects.pop(),lastIndex=0,lastCachedObject=nBindings;lastIndex!==lastCachedObject;++lastIndex)lastObject=bindings[lastIndex],lastObject[index]=lastObject[uuid],lastObject.pop()}this.nCachedObjects_=nCachedObjects},subscribe_:function(path,parsedPath){var indicesByPath=
this._bindingsIndicesByPath,index=indicesByPath[path],bindings=this._bindings;if(void 0!==index)return bindings[index];var paths=this._paths,parsedPaths=this._parsedPaths,objects=this._objects,nCachedObjects=this.nCachedObjects_,bindingsForPath=Array(objects.length);index=bindings.length;indicesByPath[path]=index;paths.push(path);parsedPaths.push(parsedPath);bindings.push(bindingsForPath);indicesByPath=nCachedObjects;for(index=objects.length;indicesByPath!==index;++indicesByPath)bindingsForPath[indicesByPath]=
new PropertyBinding(objects[indicesByPath],path,parsedPath);return bindingsForPath},unsubscribe_:function(path){var indicesByPath=this._bindingsIndicesByPath,index=indicesByPath[path];if(void 0!==index){var paths=this._paths,parsedPaths=this._parsedPaths,bindings=this._bindings,lastBindingsIndex=bindings.length-1,lastBindings=bindings[lastBindingsIndex];indicesByPath[path[lastBindingsIndex]]=index;bindings[index]=lastBindings;bindings.pop();parsedPaths[index]=parsedPaths[lastBindingsIndex];parsedPaths.pop();
paths[index]=paths[lastBindingsIndex];paths.pop()}}});var AnimationAction=function(){function AnimationAction(mixer,clip,localRoot,blendMode){void 0===localRoot&&(localRoot=null);void 0===blendMode&&(blendMode=clip.blendMode);this._mixer=mixer;this._clip=clip;this._localRoot=localRoot;this.blendMode=blendMode;mixer=clip.tracks;clip=mixer.length;localRoot=Array(clip);blendMode={endingStart:2400,endingEnd:2400};for(var i=0;i!==clip;++i){var interpolant=mixer[i].createInterpolant(null);localRoot[i]=
interpolant;interpolant.settings=blendMode}this._interpolantSettings=blendMode;this._interpolants=localRoot;this._propertyBindings=Array(clip);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=
!0}var _proto=AnimationAction.prototype;_proto.play=function(){this._mixer._activateAction(this);return this};_proto.stop=function(){this._mixer._deactivateAction(this);return this.reset()};_proto.reset=function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()};_proto.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)};_proto.isScheduled=function(){return this._mixer._isActiveAction(this)};
_proto.startAt=function(time){this._startTime=time;return this};_proto.setLoop=function(mode,repetitions){this.loop=mode;this.repetitions=repetitions;return this};_proto.setEffectiveWeight=function(weight){this.weight=weight;this._effectiveWeight=this.enabled?weight:0;return this.stopFading()};_proto.getEffectiveWeight=function(){return this._effectiveWeight};_proto.fadeIn=function(duration){return this._scheduleFading(duration,0,1)};_proto.fadeOut=function(duration){return this._scheduleFading(duration,
1,0)};_proto.crossFadeFrom=function(fadeOutAction,duration,warp){fadeOutAction.fadeOut(duration);this.fadeIn(duration);if(warp){warp=this._clip.duration;var fadeOutDuration=fadeOutAction._clip.duration,endStartRatio=warp/fadeOutDuration;fadeOutAction.warp(1,fadeOutDuration/warp,duration);this.warp(endStartRatio,1,duration)}return this};_proto.crossFadeTo=function(fadeInAction,duration,warp){return fadeInAction.crossFadeFrom(this,duration,warp)};_proto.stopFading=function(){var weightInterpolant=this._weightInterpolant;
null!==weightInterpolant&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(weightInterpolant));return this};_proto.setEffectiveTimeScale=function(timeScale){this.timeScale=timeScale;this._effectiveTimeScale=this.paused?0:timeScale;return this.stopWarping()};_proto.getEffectiveTimeScale=function(){return this._effectiveTimeScale};_proto.setDuration=function(duration){this.timeScale=this._clip.duration/duration;return this.stopWarping()};_proto.syncWith=function(action){this.time=
action.time;this.timeScale=action.timeScale;return this.stopWarping()};_proto.halt=function(duration){return this.warp(this._effectiveTimeScale,0,duration)};_proto.warp=function(startTimeScale,endTimeScale,duration){var mixer=this._mixer,now=mixer.time,timeScale=this.timeScale,interpolant=this._timeScaleInterpolant;null===interpolant&&(this._timeScaleInterpolant=interpolant=mixer._lendControlInterpolant());mixer=interpolant.parameterPositions;interpolant=interpolant.sampleValues;mixer[0]=now;mixer[1]=
now+duration;interpolant[0]=startTimeScale/timeScale;interpolant[1]=endTimeScale/timeScale;return this};_proto.stopWarping=function(){var timeScaleInterpolant=this._timeScaleInterpolant;null!==timeScaleInterpolant&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(timeScaleInterpolant));return this};_proto.getMixer=function(){return this._mixer};_proto.getClip=function(){return this._clip};_proto.getRoot=function(){return this._localRoot||this._mixer._root};_proto._update=function(time,
deltaTime,timeDirection,accuIndex){if(this.enabled){var startTime=this._startTime;if(null!==startTime){deltaTime=(time-startTime)*timeDirection;if(0>deltaTime||0===timeDirection)return;this._startTime=null;deltaTime*=timeDirection}deltaTime*=this._updateTimeScale(time);timeDirection=this._updateTime(deltaTime);time=this._updateWeight(time);if(0<time)switch(deltaTime=this._interpolants,startTime=this._propertyBindings,this.blendMode){case 2501:accuIndex=0;for(var m=deltaTime.length;accuIndex!==m;++accuIndex)deltaTime[accuIndex].evaluate(timeDirection),
startTime[accuIndex].accumulateAdditive(time);break;default:m=0;for(var _m=deltaTime.length;m!==_m;++m)deltaTime[m].evaluate(timeDirection),startTime[m].accumulate(accuIndex,time)}}else this._updateWeight(time)};_proto._updateWeight=function(time){var weight=0;if(this.enabled){weight=this.weight;var interpolant=this._weightInterpolant;if(null!==interpolant){var interpolantValue=interpolant.evaluate(time)[0];weight*=interpolantValue;time>interpolant.parameterPositions[1]&&(this.stopFading(),0===interpolantValue&&
(this.enabled=!1))}}return this._effectiveWeight=weight};_proto._updateTimeScale=function(time){var timeScale=0;if(!this.paused){timeScale=this.timeScale;var interpolant=this._timeScaleInterpolant;if(null!==interpolant){var interpolantValue=interpolant.evaluate(time)[0];timeScale*=interpolantValue;time>interpolant.parameterPositions[1]&&(this.stopWarping(),0===timeScale?this.paused=!0:this.timeScale=timeScale)}}return this._effectiveTimeScale=timeScale};_proto._updateTime=function(deltaTime){var duration=
this._clip.duration,loop=this.loop,time=this.time+deltaTime,loopCount=this._loopCount,pingPong=2202===loop;if(0===deltaTime)return-1===loopCount?time:pingPong&&1===(loopCount&1)?duration-time:time;if(2200===loop)a:{if(-1===loopCount&&(this._loopCount=0,this._setEndings(!0,!0,!1)),time>=duration)time=duration;else if(0>time)time=0;else{this.time=time;break a}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this.time=time;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>deltaTime?
-1:1})}else{-1===loopCount&&(0<=deltaTime?(loopCount=0,this._setEndings(!0,0===this.repetitions,pingPong)):this._setEndings(0===this.repetitions,!0,pingPong));if(time>=duration||0>time){loop=Math.floor(time/duration);time-=duration*loop;loopCount+=Math.abs(loop);var pending=this.repetitions-loopCount;0>=pending?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=time=0<deltaTime?duration:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<deltaTime?1:-1})):(1===pending?
(deltaTime=0>deltaTime,this._setEndings(deltaTime,!deltaTime,pingPong)):this._setEndings(!1,!1,pingPong),this._loopCount=loopCount,this.time=time,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:loop}))}else this.time=time;if(pingPong&&1===(loopCount&1))return duration-time}return time};_proto._setEndings=function(atStart,atEnd,pingPong){var settings=this._interpolantSettings;pingPong?(settings.endingStart=2401,settings.endingEnd=2401):(settings.endingStart=atStart?this.zeroSlopeAtStart?
2401:2400:2402,settings.endingEnd=atEnd?this.zeroSlopeAtEnd?2401:2400:2402)};_proto._scheduleFading=function(duration,weightNow,weightThen){var mixer=this._mixer,now=mixer.time,interpolant=this._weightInterpolant;null===interpolant&&(this._weightInterpolant=interpolant=mixer._lendControlInterpolant());mixer=interpolant.parameterPositions;interpolant=interpolant.sampleValues;mixer[0]=now;interpolant[0]=weightNow;mixer[1]=now+duration;interpolant[1]=weightThen;return this};return AnimationAction}();
AnimationMixer.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:AnimationMixer,_bindAction:function(action,prototypeAction){var root=action._localRoot||this._root,tracks=action._clip.tracks,nTracks=tracks.length,bindings=action._propertyBindings;action=action._interpolants;var rootUuid=root.uuid,bindingsByRoot=this._bindingsByRootAndName,bindingsByName=bindingsByRoot[rootUuid];void 0===bindingsByName&&(bindingsByName={},bindingsByRoot[rootUuid]=bindingsByName);for(bindingsByRoot=
0;bindingsByRoot!==nTracks;++bindingsByRoot){var track=tracks[bindingsByRoot],trackName=track.name,binding=bindingsByName[trackName];if(void 0===binding){binding=bindings[bindingsByRoot];if(void 0!==binding){null===binding._cacheIndex&&(++binding.referenceCount,this._addInactiveBinding(binding,rootUuid,trackName));continue}binding=new PropertyMixer(PropertyBinding.create(root,trackName,prototypeAction&&prototypeAction._propertyBindings[bindingsByRoot].binding.parsedPath),track.ValueTypeName,track.getValueSize());
++binding.referenceCount;this._addInactiveBinding(binding,rootUuid,trackName)}bindings[bindingsByRoot]=binding;action[bindingsByRoot].resultBuffer=binding.buffer}},_activateAction:function(action){if(!this._isActiveAction(action)){if(null===action._cacheIndex){var rootUuid=(action._localRoot||this._root).uuid,clipUuid=action._clip.uuid,actionsForClip=this._actionsByClip[clipUuid];this._bindAction(action,actionsForClip&&actionsForClip.knownActions[0]);this._addInactiveAction(action,clipUuid,rootUuid)}rootUuid=
action._propertyBindings;clipUuid=0;for(actionsForClip=rootUuid.length;clipUuid!==actionsForClip;++clipUuid){var binding=rootUuid[clipUuid];0===binding.useCount++&&(this._lendBinding(binding),binding.saveOriginalState())}this._lendAction(action)}},_deactivateAction:function(action){if(this._isActiveAction(action)){for(var bindings=action._propertyBindings,i=0,n=bindings.length;i!==n;++i){var binding=bindings[i];0===--binding.useCount&&(binding.restoreOriginalState(),this._takeBackBinding(binding))}this._takeBackAction(action)}},
_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var scope=this;this.stats={actions:{get total(){return scope._actions.length},get inUse(){return scope._nActiveActions}},bindings:{get total(){return scope._bindings.length},get inUse(){return scope._nActiveBindings}},controlInterpolants:{get total(){return scope._controlInterpolants.length},
get inUse(){return scope._nActiveControlInterpolants}}}},_isActiveAction:function(action){action=action._cacheIndex;return null!==action&&action<this._nActiveActions},_addInactiveAction:function(action,clipUuid,rootUuid){var actions=this._actions,actionsByClip=this._actionsByClip,actionsForClip=actionsByClip[clipUuid];void 0===actionsForClip?(actionsForClip={knownActions:[action],actionByRoot:{}},action._byClipCacheIndex=0,actionsByClip[clipUuid]=actionsForClip):(clipUuid=actionsForClip.knownActions,
action._byClipCacheIndex=clipUuid.length,clipUuid.push(action));action._cacheIndex=actions.length;actions.push(action);actionsForClip.actionByRoot[rootUuid]=action},_removeInactiveAction:function(action){var actions=this._actions,lastInactiveAction=actions[actions.length-1],cacheIndex=action._cacheIndex;lastInactiveAction._cacheIndex=cacheIndex;actions[cacheIndex]=lastInactiveAction;actions.pop();action._cacheIndex=null;actions=action._clip.uuid;lastInactiveAction=this._actionsByClip;cacheIndex=lastInactiveAction[actions];
var knownActionsForClip=cacheIndex.knownActions,lastKnownAction=knownActionsForClip[knownActionsForClip.length-1],byClipCacheIndex=action._byClipCacheIndex;lastKnownAction._byClipCacheIndex=byClipCacheIndex;knownActionsForClip[byClipCacheIndex]=lastKnownAction;knownActionsForClip.pop();action._byClipCacheIndex=null;delete cacheIndex.actionByRoot[(action._localRoot||this._root).uuid];0===knownActionsForClip.length&&delete lastInactiveAction[actions];this._removeInactiveBindingsForAction(action)},_removeInactiveBindingsForAction:function(action){action=
action._propertyBindings;for(var i=0,n=action.length;i!==n;++i){var binding=action[i];0===--binding.referenceCount&&this._removeInactiveBinding(binding)}},_lendAction:function(action){var actions=this._actions,prevIndex=action._cacheIndex,lastActiveIndex=this._nActiveActions++,firstInactiveAction=actions[lastActiveIndex];action._cacheIndex=lastActiveIndex;actions[lastActiveIndex]=action;firstInactiveAction._cacheIndex=prevIndex;actions[prevIndex]=firstInactiveAction},_takeBackAction:function(action){var actions=
this._actions,prevIndex=action._cacheIndex,firstInactiveIndex=--this._nActiveActions,lastActiveAction=actions[firstInactiveIndex];action._cacheIndex=firstInactiveIndex;actions[firstInactiveIndex]=action;lastActiveAction._cacheIndex=prevIndex;actions[prevIndex]=lastActiveAction},_addInactiveBinding:function(binding,rootUuid,trackName){var bindingsByRoot=this._bindingsByRootAndName,bindings=this._bindings,bindingByName=bindingsByRoot[rootUuid];void 0===bindingByName&&(bindingByName={},bindingsByRoot[rootUuid]=
bindingByName);bindingByName[trackName]=binding;binding._cacheIndex=bindings.length;bindings.push(binding)},_removeInactiveBinding:function(binding){var bindings=this._bindings,propBinding=binding.binding,rootUuid=propBinding.rootNode.uuid;propBinding=propBinding.path;var bindingsByRoot=this._bindingsByRootAndName,bindingByName=bindingsByRoot[rootUuid],lastInactiveBinding=bindings[bindings.length-1];binding=binding._cacheIndex;lastInactiveBinding._cacheIndex=binding;bindings[binding]=lastInactiveBinding;
bindings.pop();delete bindingByName[propBinding];0===Object.keys(bindingByName).length&&delete bindingsByRoot[rootUuid]},_lendBinding:function(binding){var bindings=this._bindings,prevIndex=binding._cacheIndex,lastActiveIndex=this._nActiveBindings++,firstInactiveBinding=bindings[lastActiveIndex];binding._cacheIndex=lastActiveIndex;bindings[lastActiveIndex]=binding;firstInactiveBinding._cacheIndex=prevIndex;bindings[prevIndex]=firstInactiveBinding},_takeBackBinding:function(binding){var bindings=this._bindings,
prevIndex=binding._cacheIndex,firstInactiveIndex=--this._nActiveBindings,lastActiveBinding=bindings[firstInactiveIndex];binding._cacheIndex=firstInactiveIndex;bindings[firstInactiveIndex]=binding;lastActiveBinding._cacheIndex=prevIndex;bindings[prevIndex]=lastActiveBinding},_lendControlInterpolant:function(){var interpolants=this._controlInterpolants,lastActiveIndex=this._nActiveControlInterpolants++,interpolant=interpolants[lastActiveIndex];void 0===interpolant&&(interpolant=new LinearInterpolant(new Float32Array(2),
new Float32Array(2),1,this._controlInterpolantsResultBuffer),interpolant.__cacheIndex=lastActiveIndex,interpolants[lastActiveIndex]=interpolant);return interpolant},_takeBackControlInterpolant:function(interpolant){var interpolants=this._controlInterpolants,prevIndex=interpolant.__cacheIndex,firstInactiveIndex=--this._nActiveControlInterpolants,lastActiveInterpolant=interpolants[firstInactiveIndex];interpolant.__cacheIndex=firstInactiveIndex;interpolants[firstInactiveIndex]=interpolant;lastActiveInterpolant.__cacheIndex=
prevIndex;interpolants[prevIndex]=lastActiveInterpolant},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(clip,optionalRoot,blendMode){var root=optionalRoot||this._root,rootUuid=root.uuid;root="string"===typeof clip?AnimationClip.findByName(root,clip):clip;clip=null!==root?root.uuid:clip;var actionsForClip=this._actionsByClip[clip],prototypeAction=null;void 0===blendMode&&(blendMode=null!==root?root.blendMode:2500);if(void 0!==actionsForClip){prototypeAction=actionsForClip.actionByRoot[rootUuid];
if(void 0!==prototypeAction&&prototypeAction.blendMode===blendMode)return prototypeAction;prototypeAction=actionsForClip.knownActions[0];null===root&&(root=prototypeAction._clip)}if(null===root)return null;optionalRoot=new AnimationAction(this,root,optionalRoot,blendMode);this._bindAction(optionalRoot,prototypeAction);this._addInactiveAction(optionalRoot,clip,rootUuid);return optionalRoot},existingAction:function(clip,optionalRoot){var root=optionalRoot||this._root;optionalRoot=root.uuid;root="string"===
typeof clip?AnimationClip.findByName(root,clip):clip;clip=this._actionsByClip[root?root.uuid:clip];return void 0!==clip?clip.actionByRoot[optionalRoot]||null:null},stopAllAction:function(){for(var actions=this._actions,i=this._nActiveActions-1;0<=i;--i)actions[i].stop();return this},update:function(deltaTime){deltaTime*=this.timeScale;for(var actions=this._actions,nActions=this._nActiveActions,time=this.time+=deltaTime,timeDirection=Math.sign(deltaTime),accuIndex=this._accuIndex^=1,i=0;i!==nActions;++i)actions[i]._update(time,
deltaTime,timeDirection,accuIndex);deltaTime=this._bindings;actions=this._nActiveBindings;for(nActions=0;nActions!==actions;++nActions)deltaTime[nActions].apply(accuIndex);return this},setTime:function(timeInSeconds){for(var i=this.time=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(timeInSeconds)},getRoot:function(){return this._root},uncacheClip:function(clip){var actions=this._actions;clip=clip.uuid;var actionsByClip=this._actionsByClip,actionsForClip=actionsByClip[clip];
if(void 0!==actionsForClip){actionsForClip=actionsForClip.knownActions;for(var i=0,n=actionsForClip.length;i!==n;++i){var action=actionsForClip[i];this._deactivateAction(action);var cacheIndex=action._cacheIndex,lastInactiveAction=actions[actions.length-1];action._cacheIndex=null;action._byClipCacheIndex=null;lastInactiveAction._cacheIndex=cacheIndex;actions[cacheIndex]=lastInactiveAction;actions.pop();this._removeInactiveBindingsForAction(action)}delete actionsByClip[clip]}},uncacheRoot:function(root){root=
root.uuid;var actionsByClip=this._actionsByClip;for(clipUuid in actionsByClip){var action=actionsByClip[clipUuid].actionByRoot[root];void 0!==action&&(this._deactivateAction(action),this._removeInactiveAction(action))}var clipUuid=this._bindingsByRootAndName[root];if(void 0!==clipUuid)for(var trackName in clipUuid)root=clipUuid[trackName],root.restoreOriginalState(),this._removeInactiveBinding(root)},uncacheAction:function(clip,optionalRoot){clip=this.existingAction(clip,optionalRoot);null!==clip&&
(this._deactivateAction(clip),this._removeInactiveAction(clip))}});var Uniform=function(){function Uniform(value,JSCompiler_OptimizeArgumentsArray_p3){"string"===typeof value&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),value=JSCompiler_OptimizeArgumentsArray_p3);this.value=value}Uniform.prototype.clone=function(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())};return Uniform}();InstancedInterleavedBuffer.prototype=Object.assign(Object.create(InterleavedBuffer.prototype),
{constructor:InstancedInterleavedBuffer,isInstancedInterleavedBuffer:!0,copy:function(source){InterleavedBuffer.prototype.copy.call(this,source);this.meshPerAttribute=source.meshPerAttribute;return this},clone:function(data){data=InterleavedBuffer.prototype.clone.call(this,data);data.meshPerAttribute=this.meshPerAttribute;return data},toJSON:function(data){data=InterleavedBuffer.prototype.toJSON.call(this,data);data.isInstancedInterleavedBuffer=!0;data.meshPerAttribute=this.meshPerAttribute;return data}});
Object.defineProperty(GLBufferAttribute.prototype,"needsUpdate",{set:function(value){!0===value&&this.version++}});Object.assign(GLBufferAttribute.prototype,{isGLBufferAttribute:!0,setBuffer:function(buffer){this.buffer=buffer;return this},setType:function(type,elementSize){this.type=type;this.elementSize=elementSize;return this},setItemSize:function(itemSize){this.itemSize=itemSize;return this},setCount:function(count){this.count=count;return this}});Object.assign(Raycaster.prototype,{set:function(origin,
direction){this.ray.set(origin,direction)},setFromCamera:function(coords,camera){camera&&camera.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(camera.matrixWorld),this.ray.direction.set(coords.x,coords.y,.5).unproject(camera).sub(this.ray.origin).normalize(),this.camera=camera):camera&&camera.isOrthographicCamera?(this.ray.origin.set(coords.x,coords.y,(camera.near+camera.far)/(camera.near-camera.far)).unproject(camera),this.ray.direction.set(0,0,-1).transformDirection(camera.matrixWorld),
this.camera=camera):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(object,recursive,optionalTarget){optionalTarget=optionalTarget||[];_intersectObject(object,this,optionalTarget,recursive);optionalTarget.sort(ascSort);return optionalTarget},intersectObjects:function(objects,recursive,optionalTarget){optionalTarget=optionalTarget||[];if(!1===Array.isArray(objects))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),optionalTarget;
for(var i=0,l=objects.length;i<l;i++)_intersectObject(objects[i],this,optionalTarget,recursive);optionalTarget.sort(ascSort);return optionalTarget}});var Spherical=function(){function Spherical(radius,phi,theta){void 0===radius&&(radius=1);void 0===phi&&(phi=0);void 0===theta&&(theta=0);this.radius=radius;this.phi=phi;this.theta=theta;return this}var _proto=Spherical.prototype;_proto.set=function(radius,phi,theta){this.radius=radius;this.phi=phi;this.theta=theta;return this};_proto.clone=function(){return(new this.constructor).copy(this)};
_proto.copy=function(other){this.radius=other.radius;this.phi=other.phi;this.theta=other.theta;return this};_proto.makeSafe=function(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this};_proto.setFromVector3=function(v){return this.setFromCartesianCoords(v.x,v.y,v.z)};_proto.setFromCartesianCoords=function(x,y,z){this.radius=Math.sqrt(x*x+y*y+z*z);0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(x,z),this.phi=Math.acos(MathUtils.clamp(y/this.radius,-1,1)));return this};
return Spherical}(),Cylindrical=function(){function Cylindrical(radius,theta,y){this.radius=void 0!==radius?radius:1;this.theta=void 0!==theta?theta:0;this.y=void 0!==y?y:0;return this}var _proto=Cylindrical.prototype;_proto.set=function(radius,theta,y){this.radius=radius;this.theta=theta;this.y=y;return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(other){this.radius=other.radius;this.theta=other.theta;this.y=other.y;return this};_proto.setFromVector3=
function(v){return this.setFromCartesianCoords(v.x,v.y,v.z)};_proto.setFromCartesianCoords=function(x,y,z){this.radius=Math.sqrt(x*x+z*z);this.theta=Math.atan2(x,z);this.y=y;return this};return Cylindrical}(),_vector$7=new Vector2,Box2=function(){function Box2(min,max){Object.defineProperty(this,"isBox2",{value:!0});this.min=void 0!==min?min:new Vector2(Infinity,Infinity);this.max=void 0!==max?max:new Vector2(-Infinity,-Infinity)}var _proto=Box2.prototype;_proto.set=function(min,max){this.min.copy(min);
this.max.copy(max);return this};_proto.setFromPoints=function(points){this.makeEmpty();for(var i=0,il=points.length;i<il;i++)this.expandByPoint(points[i]);return this};_proto.setFromCenterAndSize=function(center,size){size=_vector$7.copy(size).multiplyScalar(.5);this.min.copy(center).sub(size);this.max.copy(center).add(size);return this};_proto.clone=function(){return(new this.constructor).copy(this)};_proto.copy=function(box){this.min.copy(box.min);this.max.copy(box.max);return this};_proto.makeEmpty=
function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this};_proto.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y};_proto.getCenter=function(target){void 0===target&&(console.warn("THREE.Box2: .getCenter() target is now required"),target=new Vector2);return this.isEmpty()?target.set(0,0):target.addVectors(this.min,this.max).multiplyScalar(.5)};_proto.getSize=function(target){void 0===target&&(console.warn("THREE.Box2: .getSize() target is now required"),
target=new Vector2);return this.isEmpty()?target.set(0,0):target.subVectors(this.max,this.min)};_proto.expandByPoint=function(point){this.min.min(point);this.max.max(point);return this};_proto.expandByVector=function(vector){this.min.sub(vector);this.max.add(vector);return this};_proto.expandByScalar=function(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this};_proto.containsPoint=function(point){return point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y?
!1:!0};_proto.containsBox=function(box){return this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&box.max.y<=this.max.y};_proto.getParameter=function(point,target){void 0===target&&(console.warn("THREE.Box2: .getParameter() target is now required"),target=new Vector2);return target.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y))};_proto.intersectsBox=function(box){return box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||
box.min.y>this.max.y?!1:!0};_proto.clampPoint=function(point,target){void 0===target&&(console.warn("THREE.Box2: .clampPoint() target is now required"),target=new Vector2);return target.copy(point).clamp(this.min,this.max)};_proto.distanceToPoint=function(point){return _vector$7.copy(point).clamp(this.min,this.max).sub(point).length()};_proto.intersect=function(box){this.min.max(box.min);this.max.min(box.max);return this};_proto.union=function(box){this.min.min(box.min);this.max.max(box.max);return this};
_proto.translate=function(offset){this.min.add(offset);this.max.add(offset);return this};_proto.equals=function(box){return box.min.equals(this.min)&&box.max.equals(this.max)};return Box2}(),_startP=new Vector3,_startEnd=new Vector3,Line3=function(){function Line3(start,end){this.start=void 0!==start?start:new Vector3;this.end=void 0!==end?end:new Vector3}var _proto=Line3.prototype;_proto.set=function(start,end){this.start.copy(start);this.end.copy(end);return this};_proto.clone=function(){return(new this.constructor).copy(this)};
_proto.copy=function(line){this.start.copy(line.start);this.end.copy(line.end);return this};_proto.getCenter=function(target){void 0===target&&(console.warn("THREE.Line3: .getCenter() target is now required"),target=new Vector3);return target.addVectors(this.start,this.end).multiplyScalar(.5)};_proto.delta=function(target){void 0===target&&(console.warn("THREE.Line3: .delta() target is now required"),target=new Vector3);return target.subVectors(this.end,this.start)};_proto.distanceSq=function(){return this.start.distanceToSquared(this.end)};
_proto.distance=function(){return this.start.distanceTo(this.end)};_proto.at=function(t,target){void 0===target&&(console.warn("THREE.Line3: .at() target is now required"),target=new Vector3);return this.delta(target).multiplyScalar(t).add(this.start)};_proto.closestPointToPointParameter=function(point,clampToLine){_startP.subVectors(point,this.start);_startEnd.subVectors(this.end,this.start);point=_startEnd.dot(_startEnd);point=_startEnd.dot(_startP)/point;clampToLine&&(point=MathUtils.clamp(point,
0,1));return point};_proto.closestPointToPoint=function(point,clampToLine,target){point=this.closestPointToPointParameter(point,clampToLine);void 0===target&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),target=new Vector3);return this.delta(target).multiplyScalar(point).add(this.start)};_proto.applyMatrix4=function(matrix){this.start.applyMatrix4(matrix);this.end.applyMatrix4(matrix);return this};_proto.equals=function(line){return line.start.equals(this.start)&&line.end.equals(this.end)};
return Line3}();ImmediateRenderObject.prototype=Object.create(Object3D.prototype);ImmediateRenderObject.prototype.constructor=ImmediateRenderObject;ImmediateRenderObject.prototype.isImmediateRenderObject=!0;var _vector$8=new Vector3,SpotLightHelper=function(_Object3D){function SpotLightHelper(light,color){var _this=_Object3D.call(this)||this;_this.light=light;_this.light.updateMatrixWorld();_this.matrix=light.matrixWorld;_this.matrixAutoUpdate=!1;_this.color=color;light=new BufferGeometry;color=[0,
0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,j=1;32>i;i++,j++){var p1=i/32*Math.PI*2,p2=j/32*Math.PI*2;color.push(Math.cos(p1),Math.sin(p1),1,Math.cos(p2),Math.sin(p2),1)}light.setAttribute("position",new Float32BufferAttribute(color,3));color=new LineBasicMaterial({fog:!1,toneMapped:!1});_this.cone=new LineSegments(light,color);_this.add(_this.cone);_this.update();return _this}_inheritsLoose(SpotLightHelper,_Object3D);var _proto=SpotLightHelper.prototype;_proto.dispose=
function(){this.cone.geometry.dispose();this.cone.material.dispose()};_proto.update=function(){this.light.updateMatrixWorld();var coneLength=this.light.distance?this.light.distance:1E3,coneWidth=coneLength*Math.tan(this.light.angle);this.cone.scale.set(coneWidth,coneWidth,coneLength);_vector$8.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(_vector$8);void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};return SpotLightHelper}(Object3D),
_vector$9=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4,SkeletonHelper=function(_LineSegments){function SkeletonHelper(object){var bones=getBoneList(object);var _this=new BufferGeometry;for(var vertices=[],colors=[],color1=new Color(0,0,1),color2=new Color(0,1,0),i=0;i<bones.length;i++){var bone=bones[i];bone.parent&&bone.parent.isBone&&(vertices.push(0,0,0),vertices.push(0,0,0),colors.push(color1.r,color1.g,color1.b),colors.push(color2.r,color2.g,color2.b))}_this.setAttribute("position",
new Float32BufferAttribute(vertices,3));_this.setAttribute("color",new Float32BufferAttribute(colors,3));vertices=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});_this=_LineSegments.call(this,_this,vertices)||this;_this.type="SkeletonHelper";_this.isSkeletonHelper=!0;_this.root=object;_this.bones=bones;_this.matrix=object.matrixWorld;_this.matrixAutoUpdate=!1;return _this}_inheritsLoose(SkeletonHelper,_LineSegments);SkeletonHelper.prototype.updateMatrixWorld=
function(force){var bones=this.bones,geometry=this.geometry,position=geometry.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(var i=0,j=0;i<bones.length;i++){var bone=bones[i];bone.parent&&bone.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,bone.matrixWorld),_vector$9.setFromMatrixPosition(_boneMatrix),position.setXYZ(j,_vector$9.x,_vector$9.y,_vector$9.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,bone.parent.matrixWorld),_vector$9.setFromMatrixPosition(_boneMatrix),
position.setXYZ(j+1,_vector$9.x,_vector$9.y,_vector$9.z),j+=2)}geometry.getAttribute("position").needsUpdate=!0;_LineSegments.prototype.updateMatrixWorld.call(this,force)};return SkeletonHelper}(LineSegments),PointLightHelper=function(_Mesh){function PointLightHelper(light,sphereSize,color){sphereSize=new SphereBufferGeometry(sphereSize,4,2);var material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});sphereSize=_Mesh.call(this,sphereSize,material)||this;sphereSize.light=light;sphereSize.light.updateMatrixWorld();
sphereSize.color=color;sphereSize.type="PointLightHelper";sphereSize.matrix=sphereSize.light.matrixWorld;sphereSize.matrixAutoUpdate=!1;sphereSize.update();return sphereSize}_inheritsLoose(PointLightHelper,_Mesh);var _proto=PointLightHelper.prototype;_proto.dispose=function(){this.geometry.dispose();this.material.dispose()};_proto.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};return PointLightHelper}(Mesh),_vector$a=new Vector3,
_color1=new Color,_color2=new Color,HemisphereLightHelper=function(_Object3D){function HemisphereLightHelper(light,size,color){var _this=_Object3D.call(this)||this;_this.light=light;_this.light.updateMatrixWorld();_this.matrix=light.matrixWorld;_this.matrixAutoUpdate=!1;_this.color=color;light=new OctahedronBufferGeometry(size);light.rotateY(.5*Math.PI);_this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});void 0===_this.color&&(_this.material.vertexColors=!0);size=light.getAttribute("position");
size=new Float32Array(3*size.count);light.setAttribute("color",new BufferAttribute(size,3));_this.add(new Mesh(light,_this.material));_this.update();return _this}_inheritsLoose(HemisphereLightHelper,_Object3D);var _proto=HemisphereLightHelper.prototype;_proto.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};_proto.update=function(){var mesh=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var colors=mesh.geometry.getAttribute("color");
_color1.copy(this.light.color);_color2.copy(this.light.groundColor);for(var i=0,l=colors.count;i<l;i++){var color=i<l/2?_color1:_color2;colors.setXYZ(i,color.r,color.g,color.b)}colors.needsUpdate=!0}mesh.lookAt(_vector$a.setFromMatrixPosition(this.light.matrixWorld).negate())};return HemisphereLightHelper}(Object3D),GridHelper=function(_LineSegments){function GridHelper(size,divisions,color1,color2){void 0===size&&(size=10);void 0===divisions&&(divisions=10);void 0===color1&&(color1=4473924);void 0===
color2&&(color2=8947848);color1=new Color(color1);color2=new Color(color2);var center=divisions/2,step=size/divisions,halfSize=size/2;size=[];for(var colors=[],i=0,j=0,k=-halfSize;i<=divisions;i++,k+=step){size.push(-halfSize,0,k,halfSize,0,k);size.push(k,0,-halfSize,k,0,halfSize);var color=i===center?color1:color2;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3}divisions=new BufferGeometry;divisions.setAttribute("position",new Float32BufferAttribute(size,
3));divisions.setAttribute("color",new Float32BufferAttribute(colors,3));color1=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});divisions=_LineSegments.call(this,divisions,color1)||this;divisions.type="GridHelper";return divisions}_inheritsLoose(GridHelper,_LineSegments);return GridHelper}(LineSegments),PolarGridHelper=function(_LineSegments){function PolarGridHelper(radius,radials,circles,divisions,color1,color2){void 0===radius&&(radius=10);void 0===radials&&(radials=16);void 0===circles&&
(circles=8);void 0===divisions&&(divisions=64);void 0===color1&&(color1=4473924);void 0===color2&&(color2=8947848);color1=new Color(color1);color2=new Color(color2);var _this=[];for(var colors=[],i=0;i<=radials;i++){var v=i/radials*2*Math.PI,x=Math.sin(v)*radius;v=Math.cos(v)*radius;_this.push(0,0,0);_this.push(x,0,v);x=i&1?color1:color2;colors.push(x.r,x.g,x.b);colors.push(x.r,x.g,x.b)}for(radials=0;radials<=circles;radials++)for(i=radials&1?color1:color2,x=radius-radius/circles*radials,v=0;v<divisions;v++){var _v=
v/divisions*2*Math.PI,_x=Math.sin(_v)*x;_v=Math.cos(_v)*x;_this.push(_x,0,_v);colors.push(i.r,i.g,i.b);_v=(v+1)/divisions*2*Math.PI;_x=Math.sin(_v)*x;_v=Math.cos(_v)*x;_this.push(_x,0,_v);colors.push(i.r,i.g,i.b)}radius=new BufferGeometry;radius.setAttribute("position",new Float32BufferAttribute(_this,3));radius.setAttribute("color",new Float32BufferAttribute(colors,3));_this=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});_this=_LineSegments.call(this,radius,_this)||this;_this.type="PolarGridHelper";
return _this}_inheritsLoose(PolarGridHelper,_LineSegments);return PolarGridHelper}(LineSegments),_v1$6=new Vector3,_v2$3=new Vector3,_v3$1=new Vector3,DirectionalLightHelper=function(_Object3D){function DirectionalLightHelper(light,size,color){var _this=_Object3D.call(this)||this;_this.light=light;_this.light.updateMatrixWorld();_this.matrix=light.matrixWorld;_this.matrixAutoUpdate=!1;_this.color=color;void 0===size&&(size=1);light=new BufferGeometry;light.setAttribute("position",new Float32BufferAttribute([-size,
size,0,size,size,0,size,-size,0,-size,-size,0,-size,size,0],3));size=new LineBasicMaterial({fog:!1,toneMapped:!1});_this.lightPlane=new Line(light,size);_this.add(_this.lightPlane);light=new BufferGeometry;light.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3));_this.targetLine=new Line(light,size);_this.add(_this.targetLine);_this.update();return _this}_inheritsLoose(DirectionalLightHelper,_Object3D);var _proto=DirectionalLightHelper.prototype;_proto.dispose=function(){this.lightPlane.geometry.dispose();
this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};_proto.update=function(){_v1$6.setFromMatrixPosition(this.light.matrixWorld);_v2$3.setFromMatrixPosition(this.light.target.matrixWorld);_v3$1.subVectors(_v2$3,_v1$6);this.lightPlane.lookAt(_v2$3);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));
this.targetLine.lookAt(_v2$3);this.targetLine.scale.z=_v3$1.length()};return DirectionalLightHelper}(Object3D),_vector$b=new Vector3,_camera=new Camera,CameraHelper=function(_LineSegments){function CameraHelper(camera){function addLine(a,b,color){addPoint(a,color);addPoint(b,color)}function addPoint(id,color){vertices.push(0,0,0);colors.push(color.r,color.g,color.b);void 0===pointMap[id]&&(pointMap[id]=[]);pointMap[id].push(vertices.length/3-1)}var _this=new BufferGeometry;var material=new LineBasicMaterial({color:16777215,
vertexColors:!0,toneMapped:!1}),vertices=[],colors=[],pointMap={},colorFrustum=new Color(16755200),colorCone=new Color(16711680),colorUp=new Color(43775),colorTarget=new Color(16777215),colorCross=new Color(3355443);addLine("n1","n2",colorFrustum);addLine("n2","n4",colorFrustum);addLine("n4","n3",colorFrustum);addLine("n3","n1",colorFrustum);addLine("f1","f2",colorFrustum);addLine("f2","f4",colorFrustum);addLine("f4","f3",colorFrustum);addLine("f3","f1",colorFrustum);addLine("n1","f1",colorFrustum);
addLine("n2","f2",colorFrustum);addLine("n3","f3",colorFrustum);addLine("n4","f4",colorFrustum);addLine("p","n1",colorCone);addLine("p","n2",colorCone);addLine("p","n3",colorCone);addLine("p","n4",colorCone);addLine("u1","u2",colorUp);addLine("u2","u3",colorUp);addLine("u3","u1",colorUp);addLine("c","t",colorTarget);addLine("p","c",colorCross);addLine("cn1","cn2",colorCross);addLine("cn3","cn4",colorCross);addLine("cf1","cf2",colorCross);addLine("cf3","cf4",colorCross);_this.setAttribute("position",
new Float32BufferAttribute(vertices,3));_this.setAttribute("color",new Float32BufferAttribute(colors,3));_this=_LineSegments.call(this,_this,material)||this;_this.type="CameraHelper";_this.camera=camera;_this.camera.updateProjectionMatrix&&_this.camera.updateProjectionMatrix();_this.matrix=camera.matrixWorld;_this.matrixAutoUpdate=!1;_this.pointMap=pointMap;_this.update();return _this}_inheritsLoose(CameraHelper,_LineSegments);CameraHelper.prototype.update=function(){var geometry=this.geometry,pointMap=
this.pointMap;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);setPoint("c",pointMap,geometry,_camera,0,0,-1);setPoint("t",pointMap,geometry,_camera,0,0,1);setPoint("n1",pointMap,geometry,_camera,-1,-1,-1);setPoint("n2",pointMap,geometry,_camera,1,-1,-1);setPoint("n3",pointMap,geometry,_camera,-1,1,-1);setPoint("n4",pointMap,geometry,_camera,1,1,-1);setPoint("f1",pointMap,geometry,_camera,-1,-1,1);setPoint("f2",pointMap,geometry,_camera,1,-1,1);setPoint("f3",pointMap,geometry,
_camera,-1,1,1);setPoint("f4",pointMap,geometry,_camera,1,1,1);setPoint("u1",pointMap,geometry,_camera,.7,1.1,-1);setPoint("u2",pointMap,geometry,_camera,-.7,1.1,-1);setPoint("u3",pointMap,geometry,_camera,0,2,-1);setPoint("cf1",pointMap,geometry,_camera,-1,0,1);setPoint("cf2",pointMap,geometry,_camera,1,0,1);setPoint("cf3",pointMap,geometry,_camera,0,-1,1);setPoint("cf4",pointMap,geometry,_camera,0,1,1);setPoint("cn1",pointMap,geometry,_camera,-1,0,-1);setPoint("cn2",pointMap,geometry,_camera,1,
0,-1);setPoint("cn3",pointMap,geometry,_camera,0,-1,-1);setPoint("cn4",pointMap,geometry,_camera,0,1,-1);geometry.getAttribute("position").needsUpdate=!0};return CameraHelper}(LineSegments),_box$3=new Box3,BoxHelper=function(_LineSegments){function BoxHelper(object,color){void 0===color&&(color=16776960);var indices=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),positions=new Float32Array(24),geometry=new BufferGeometry;geometry.setIndex(new BufferAttribute(indices,1));geometry.setAttribute("position",
new BufferAttribute(positions,3));color=_LineSegments.call(this,geometry,new LineBasicMaterial({color:color,toneMapped:!1}))||this;color.object=object;color.type="BoxHelper";color.matrixAutoUpdate=!1;color.update();return color}_inheritsLoose(BoxHelper,_LineSegments);var _proto=BoxHelper.prototype;_proto.update=function(object){void 0!==object&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==this.object&&_box$3.setFromObject(this.object);if(!_box$3.isEmpty()){object=_box$3.min;
var max=_box$3.max,position=this.geometry.attributes.position,array=position.array;array[0]=max.x;array[1]=max.y;array[2]=max.z;array[3]=object.x;array[4]=max.y;array[5]=max.z;array[6]=object.x;array[7]=object.y;array[8]=max.z;array[9]=max.x;array[10]=object.y;array[11]=max.z;array[12]=max.x;array[13]=max.y;array[14]=object.z;array[15]=object.x;array[16]=max.y;array[17]=object.z;array[18]=object.x;array[19]=object.y;array[20]=object.z;array[21]=max.x;array[22]=object.y;array[23]=object.z;position.needsUpdate=
!0;this.geometry.computeBoundingSphere()}};_proto.setFromObject=function(object){this.object=object;this.update();return this};_proto.copy=function(source){LineSegments.prototype.copy.call(this,source);this.object=source.object;return this};return BoxHelper}(LineSegments),Box3Helper=function(_LineSegments){function Box3Helper(box,color){void 0===color&&(color=16776960);var indices=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),geometry=new BufferGeometry;geometry.setIndex(new BufferAttribute(indices,
1));geometry.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));color=_LineSegments.call(this,geometry,new LineBasicMaterial({color:color,toneMapped:!1}))||this;color.box=box;color.type="Box3Helper";color.geometry.computeBoundingSphere();return color}_inheritsLoose(Box3Helper,_LineSegments);Box3Helper.prototype.updateMatrixWorld=function(force){var box=this.box;box.isEmpty()||(box.getCenter(this.position),box.getSize(this.scale),this.scale.multiplyScalar(.5),
_LineSegments.prototype.updateMatrixWorld.call(this,force))};return Box3Helper}(LineSegments),PlaneHelper=function(_Line){function PlaneHelper(plane,size,hex){void 0===size&&(size=1);void 0===hex&&(hex=16776960);var _this=new BufferGeometry;_this.setAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));_this.computeBoundingSphere();_this=_Line.call(this,_this,new LineBasicMaterial({color:hex,toneMapped:!1}))||this;_this.type="PlaneHelper";
_this.plane=plane;_this.size=size;plane=new BufferGeometry;plane.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));plane.computeBoundingSphere();_this.add(new Mesh(plane,new MeshBasicMaterial({color:hex,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})));return _this}_inheritsLoose(PlaneHelper,_Line);PlaneHelper.prototype.updateMatrixWorld=function(force){var scale=-this.plane.constant;1E-8>Math.abs(scale)&&(scale=1E-8);this.scale.set(.5*this.size,
.5*this.size,scale);this.children[0].material.side=0>scale?1:0;this.lookAt(this.plane.normal);_Line.prototype.updateMatrixWorld.call(this,force)};return PlaneHelper}(Line),_axis=new Vector3,_lineGeometry,_coneGeometry,ArrowHelper=function(_Object3D){function ArrowHelper(dir,origin,length,color,headLength,headWidth){var _this=_Object3D.call(this)||this;_this.type="ArrowHelper";void 0===dir&&(dir=new Vector3(0,0,1));void 0===origin&&(origin=new Vector3(0,0,0));void 0===length&&(length=1);void 0===color&&
(color=16776960);void 0===headLength&&(headLength=.2*length);void 0===headWidth&&(headWidth=.2*headLength);void 0===_lineGeometry&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderBufferGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0));_this.position.copy(origin);_this.line=new Line(_lineGeometry,new LineBasicMaterial({color:color,toneMapped:!1}));_this.line.matrixAutoUpdate=!1;_this.add(_this.line);
_this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:color,toneMapped:!1}));_this.cone.matrixAutoUpdate=!1;_this.add(_this.cone);_this.setDirection(dir);_this.setLength(length,headLength,headWidth);return _this}_inheritsLoose(ArrowHelper,_Object3D);var _proto=ArrowHelper.prototype;_proto.setDirection=function(dir){.99999<dir.y?this.quaternion.set(0,0,0,1):-.99999>dir.y?this.quaternion.set(1,0,0,0):(_axis.set(dir.z,0,-dir.x).normalize(),this.quaternion.setFromAxisAngle(_axis,Math.acos(dir.y)))};
_proto.setLength=function(length,headLength,headWidth){void 0===headLength&&(headLength=.2*length);void 0===headWidth&&(headWidth=.2*headLength);this.line.scale.set(1,Math.max(1E-4,length-headLength),1);this.line.updateMatrix();this.cone.scale.set(headWidth,headLength,headWidth);this.cone.position.y=length;this.cone.updateMatrix()};_proto.setColor=function(color){this.line.material.color.set(color);this.cone.material.color.set(color)};_proto.copy=function(source){_Object3D.prototype.copy.call(this,
source,!1);this.line.copy(source.line);this.cone.copy(source.cone);return this};return ArrowHelper}(Object3D),AxesHelper=function(_LineSegments){function AxesHelper(size){void 0===size&&(size=1);var vertices=[0,0,0,size,0,0,0,0,0,0,size,0,0,0,0,0,0,size];size=new BufferGeometry;size.setAttribute("position",new Float32BufferAttribute(vertices,3));size.setAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));vertices=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});
size=_LineSegments.call(this,size,vertices)||this;size.type="AxesHelper";return size}_inheritsLoose(AxesHelper,_LineSegments);return AxesHelper}(LineSegments),_floatView=new Float32Array(1),_int32View=new Int32Array(_floatView.buffer),_ENCODINGS,SIZE_MAX=Math.pow(2,8),EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],TOTAL_LODS=5+EXTRA_LOD_SIGMA.length,ENCODINGS=(_ENCODINGS={},_ENCODINGS[3E3]=0,_ENCODINGS[3001]=1,_ENCODINGS[3002]=2,_ENCODINGS[3004]=3,_ENCODINGS[3005]=4,_ENCODINGS[3006]=5,_ENCODINGS[3007]=
6,_ENCODINGS),_flatCamera=new OrthographicCamera,_createPlanes2=function(){for(var _lodPlanes=[],_sizeLods=[],_sigmas=[],lod=8,i=0;i<TOTAL_LODS;i++){var sizeLod=Math.pow(2,lod);_sizeLods.push(sizeLod);var sigma=1/sizeLod;4<i?sigma=EXTRA_LOD_SIGMA[i-8+4-1]:0==i&&(sigma=0);_sigmas.push(sigma);sigma=1/(sizeLod-1);sizeLod=-sigma/2;sigma=1+sigma/2;var uv1=[sizeLod,sizeLod,sigma,sizeLod,sigma,sigma,sizeLod,sizeLod,sigma,sigma,sizeLod,sigma];sizeLod=new Float32Array(108);sigma=new Float32Array(72);for(var faceIndex=
new Float32Array(36),face=0;6>face;face++){var x=face%3*2/3-1,y=2<face?0:-1;sizeLod.set([x,y,0,x+2/3,y,0,x+2/3,y+1,0,x,y,0,x+2/3,y+1,0,x,y+1,0],18*face);sigma.set(uv1,12*face);faceIndex.set([face,face,face,face,face,face],6*face)}uv1=new BufferGeometry;uv1.setAttribute("position",new BufferAttribute(sizeLod,3));uv1.setAttribute("uv",new BufferAttribute(sigma,2));uv1.setAttribute("faceIndex",new BufferAttribute(faceIndex,1));_lodPlanes.push(uv1);4<lod&&lod--}return{_lodPlanes:_lodPlanes,_sizeLods:_sizeLods,
_sigmas:_sigmas}}(),_lodPlanes=_createPlanes2._lodPlanes,_sizeLods=_createPlanes2._sizeLods,_sigmas=_createPlanes2._sigmas,_oldTarget=null,PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)],PMREMGenerator=function(){function PMREMGenerator(renderer){this._renderer=
renderer;this._pingPongRenderTarget=null;renderer=new Float32Array(20);var poleAxis=new Vector3(0,1,0);this._blurMaterial=new RawShaderMaterial({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:renderer},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:poleAxis},inputEncoding:{value:ENCODINGS[3E3]},outputEncoding:{value:ENCODINGS[3E3]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t"+
_getEncodings()+"\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include \x3ccube_uv_reflection_fragment\x3e\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta \x3d cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection \x3d vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis \x3d latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis \x3d vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis \x3d normalize( axis );\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb +\x3d weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i \x3d 1; i \x3c n; i++ ) {\n\n\t\t\t\t\tif ( i \x3e\x3d samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta \x3d dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor \x3d linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1});this._cubemapShader=this._equirectShader=null;this._compileMaterial(this._blurMaterial)}var _proto=PMREMGenerator.prototype;_proto.fromScene=function(scene,sigma,near,far){void 0===sigma&&(sigma=0);void 0===near&&(near=.1);void 0===far&&(far=100);_oldTarget=this._renderer.getRenderTarget();var cubeUVRenderTarget=this._allocateTargets();this._sceneToCubeUV(scene,near,far,cubeUVRenderTarget);0<sigma&&this._blur(cubeUVRenderTarget,0,0,sigma);this._applyPMREM(cubeUVRenderTarget);
this._cleanup(cubeUVRenderTarget);return cubeUVRenderTarget};_proto.fromEquirectangular=function(equirectangular){return this._fromTexture(equirectangular)};_proto.fromCubemap=function(cubemap){return this._fromTexture(cubemap)};_proto.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=_getCubemapShader(),this._compileMaterial(this._cubemapShader))};_proto.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=_getEquirectShader(),
this._compileMaterial(this._equirectShader))};_proto.dispose=function(){this._blurMaterial.dispose();null!==this._cubemapShader&&this._cubemapShader.dispose();null!==this._equirectShader&&this._equirectShader.dispose();for(var i=0;i<_lodPlanes.length;i++)_lodPlanes[i].dispose()};_proto._cleanup=function(outputTarget){this._pingPongRenderTarget.dispose();this._renderer.setRenderTarget(_oldTarget);outputTarget.scissorTest=!1;_setViewport(outputTarget,0,0,outputTarget.width,outputTarget.height)};_proto._fromTexture=
function(texture){_oldTarget=this._renderer.getRenderTarget();var cubeUVRenderTarget=this._allocateTargets(texture);this._textureToCubeUV(texture,cubeUVRenderTarget);this._applyPMREM(cubeUVRenderTarget);this._cleanup(cubeUVRenderTarget);return cubeUVRenderTarget};_proto._allocateTargets=function(texture){var JSCompiler_inline_result=void 0===texture||1009!==texture.type?!1:3E3===texture.encoding||3001===texture.encoding||3007===texture.encoding;JSCompiler_inline_result={magFilter:1003,minFilter:1003,
generateMipmaps:!1,type:1009,format:1023,encoding:JSCompiler_inline_result?texture.encoding:3002,depthBuffer:!1};var cubeUVRenderTarget=_createRenderTarget(JSCompiler_inline_result);cubeUVRenderTarget.depthBuffer=texture?!1:!0;this._pingPongRenderTarget=_createRenderTarget(JSCompiler_inline_result);return cubeUVRenderTarget};_proto._compileMaterial=function(material){material=new Mesh(_lodPlanes[0],material);this._renderer.compile(material,_flatCamera)};_proto._sceneToCubeUV=function(scene,near,far,
cubeUVRenderTarget){near=new PerspectiveCamera(90,1,near,far);far=[1,-1,1,1,1,1];var forwardSign=[1,1,1,-1,-1,-1],renderer=this._renderer,outputEncoding=renderer.outputEncoding,toneMapping=renderer.toneMapping,clearColor=renderer.getClearColor(),clearAlpha=renderer.getClearAlpha();renderer.toneMapping=0;renderer.outputEncoding=3E3;var background=scene.background;if(background&&background.isColor){background.convertSRGBToLinear();var fExp=Math.min(Math.max(Math.ceil(Math.log2(Math.max(background.r,
background.g,background.b))),-128),127);background=background.multiplyScalar(Math.pow(2,-fExp));renderer.setClearColor(background,(fExp+128)/255);scene.background=null}for(background=0;6>background;background++)fExp=background%3,0==fExp?(near.up.set(0,far[background],0),near.lookAt(forwardSign[background],0,0)):1==fExp?(near.up.set(0,0,far[background]),near.lookAt(0,forwardSign[background],0)):(near.up.set(0,far[background],0),near.lookAt(0,0,forwardSign[background])),_setViewport(cubeUVRenderTarget,
fExp*SIZE_MAX,2<background?SIZE_MAX:0,SIZE_MAX,SIZE_MAX),renderer.setRenderTarget(cubeUVRenderTarget),renderer.render(scene,near);renderer.toneMapping=toneMapping;renderer.outputEncoding=outputEncoding;renderer.setClearColor(clearColor,clearAlpha)};_proto._textureToCubeUV=function(texture,cubeUVRenderTarget){var renderer=this._renderer;texture.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=_getCubemapShader()):null==this._equirectShader&&(this._equirectShader=_getEquirectShader());
var material=texture.isCubeTexture?this._cubemapShader:this._equirectShader,mesh=new Mesh(_lodPlanes[0],material);material=material.uniforms;material.envMap.value=texture;texture.isCubeTexture||material.texelSize.value.set(1/texture.image.width,1/texture.image.height);material.inputEncoding.value=ENCODINGS[texture.encoding];material.outputEncoding.value=ENCODINGS[cubeUVRenderTarget.texture.encoding];_setViewport(cubeUVRenderTarget,0,0,3*SIZE_MAX,2*SIZE_MAX);renderer.setRenderTarget(cubeUVRenderTarget);
renderer.render(mesh,_flatCamera)};_proto._applyPMREM=function(cubeUVRenderTarget){var renderer=this._renderer,autoClear=renderer.autoClear;renderer.autoClear=!1;for(var i=1;i<TOTAL_LODS;i++)this._blur(cubeUVRenderTarget,i-1,i,Math.sqrt(_sigmas[i]*_sigmas[i]-_sigmas[i-1]*_sigmas[i-1]),_axisDirections[(i-1)%_axisDirections.length]);renderer.autoClear=autoClear};_proto._blur=function(cubeUVRenderTarget,lodIn,lodOut,sigma,poleAxis){var pingPongRenderTarget=this._pingPongRenderTarget;this._halfBlur(cubeUVRenderTarget,
pingPongRenderTarget,lodIn,lodOut,sigma,"latitudinal",poleAxis);this._halfBlur(pingPongRenderTarget,cubeUVRenderTarget,lodOut,lodOut,sigma,"longitudinal",poleAxis)};_proto._halfBlur=function(targetIn,targetOut,lodIn,lodOut,sigmaRadians,direction,poleAxis){var renderer=this._renderer,blurMaterial=this._blurMaterial;"latitudinal"!==direction&&"longitudinal"!==direction&&console.error("blur direction must be either latitudinal or longitudinal!");var blurMesh=new Mesh(_lodPlanes[lodOut],blurMaterial);
blurMaterial=blurMaterial.uniforms;var pixels=_sizeLods[lodIn]-1;pixels=isFinite(sigmaRadians)?Math.PI/(2*pixels):2*Math.PI/39;var sigmaPixels=sigmaRadians/pixels,samples=isFinite(sigmaRadians)?1+Math.floor(3*sigmaPixels):20;20<samples&&console.warn("sigmaRadians, "+sigmaRadians+", is too large and will clip, as it requested "+samples+" samples when the maximum is set to 20");sigmaRadians=[];for(var sum=0,i=0;20>i;++i){var _x=i/sigmaPixels;_x=Math.exp(-_x*_x/2);sigmaRadians.push(_x);0==i?sum+=_x:
i<samples&&(sum+=2*_x)}for(sigmaPixels=0;sigmaPixels<sigmaRadians.length;sigmaPixels++)sigmaRadians[sigmaPixels]/=sum;blurMaterial.envMap.value=targetIn.texture;blurMaterial.samples.value=samples;blurMaterial.weights.value=sigmaRadians;blurMaterial.latitudinal.value="latitudinal"===direction;poleAxis&&(blurMaterial.poleAxis.value=poleAxis);blurMaterial.dTheta.value=pixels;blurMaterial.mipInt.value=8-lodIn;blurMaterial.inputEncoding.value=ENCODINGS[targetIn.texture.encoding];blurMaterial.outputEncoding.value=
ENCODINGS[targetIn.texture.encoding];targetIn=_sizeLods[lodOut];_setViewport(targetOut,3*Math.max(0,SIZE_MAX-2*targetIn),(0===lodOut?0:2*SIZE_MAX)+2*targetIn*(4<lodOut?lodOut-8+4:0),3*targetIn,2*targetIn);renderer.setRenderTarget(targetOut);renderer.render(blurMesh,_flatCamera)};return PMREMGenerator}();Curve.create=function(construct,getPoint){console.log("THREE.Curve.create() has been deprecated");construct.prototype=Object.create(Curve.prototype);construct.prototype.constructor=construct;construct.prototype.getPoint=
getPoint;return construct};Object.assign(CurvePath.prototype,{createPointsGeometry:function(divisions){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");divisions=this.getPoints(divisions);return this.createGeometry(divisions)},createSpacedPointsGeometry:function(divisions){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");divisions=
this.getSpacedPoints(divisions);return this.createGeometry(divisions)},createGeometry:function(points){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var geometry=new Geometry,i=0,l=points.length;i<l;i++){var point=points[i];geometry.vertices.push(new Vector3(point.x,point.y,point.z||0))}return geometry}});Object.assign(Path.prototype,{fromPoints:function(points){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");
return this.setFromPoints(points)}});ClosedSplineCurve3.prototype=Object.create(CatmullRomCurve3.prototype);SplineCurve3.prototype=Object.create(CatmullRomCurve3.prototype);Spline.prototype=Object.create(CatmullRomCurve3.prototype);Object.assign(Spline.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});
GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};SkeletonHelper.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(Loader.prototype,{extractUrlBase:function(url){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");return LoaderUtils.extractUrlBase(url)}});Loader.Handlers=
{add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Object.assign(Box2.prototype,{center:function(optionalTarget){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(optionalTarget)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");
return this.isEmpty()},isIntersectionBox:function(box){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)},size:function(optionalTarget){console.warn("THREE.Box2: .size() has been renamed to .getSize().");return this.getSize(optionalTarget)}});Object.assign(Box3.prototype,{center:function(optionalTarget){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(optionalTarget)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");
return this.isEmpty()},isIntersectionBox:function(box){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)},isIntersectionSphere:function(sphere){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(sphere)},size:function(optionalTarget){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(optionalTarget)}});Object.assign(Sphere.prototype,
{empty:function(){console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty().");return this.isEmpty()}});Frustum.prototype.setFromMatrix=function(m){console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix().");return this.setFromProjectionMatrix(m)};Line3.prototype.center=function(optionalTarget){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(optionalTarget)};Object.assign(MathUtils,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");
return Math.random()},nearestPowerOfTwo:function(value){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");return MathUtils.floorPowerOfTwo(value)},nextPowerOfTwo:function(value){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return MathUtils.ceilPowerOfTwo(value)}});Object.assign(Matrix3.prototype,{flattenToArrayOffset:function(array,offset){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");
return this.toArray(array,offset)},multiplyVector3:function(vector){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return vector.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(attribute){console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead.");return attribute.applyMatrix3(this)},
applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(matrix){console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.");return this.copy(matrix).invert()}});Object.assign(Matrix4.prototype,{extractPosition:function(m){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(m)},flattenToArrayOffset:function(array,offset){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");
return this.toArray(array,offset)},getPosition:function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return(new Vector3).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(q){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(q)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},
multiplyVector3:function(vector){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return vector.applyMatrix4(this)},multiplyVector4:function(vector){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return vector.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(v){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
v.transformDirection(this)},crossVector:function(vector){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return vector.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},
rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(attribute){console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead.");return attribute.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(left,right,bottom,top,near,far){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");
return this.makePerspective(left,right,top,bottom,near,far)},getInverse:function(matrix){console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.");return this.copy(matrix).invert()}});Plane.prototype.isIntersectionLine=function(line){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(line)};Object.assign(Quaternion.prototype,{multiplyVector3:function(vector){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");
return vector.applyQuaternion(this)},inverse:function(){console.warn("THREE.Quaternion: .inverse() has been renamed to invert().");return this.invert()}});Object.assign(Ray.prototype,{isIntersectionBox:function(box){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)},isIntersectionPlane:function(plane){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(plane)},isIntersectionSphere:function(sphere){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");
return this.intersectsSphere(sphere)}});Object.assign(Triangle.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(point,target){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(point,target)},midpoint:function(target){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");return this.getMidpoint(target)},normal:function(target){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");
return this.getNormal(target)},plane:function(target){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(target)}});Object.assign(Triangle,{barycoordFromPoint:function(point,a,b,c,target){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return Triangle.getBarycoord(point,a,b,c,target)},normal:function(a,b,c,target){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return Triangle.getNormal(a,
b,c,target)}});Object.assign(Shape.prototype,{extractAllPoints:function(divisions){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(divisions)},extrude:function(options){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new ExtrudeGeometry(this,options)},makeGeometry:function(options){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new ShapeGeometry(this,
options)}});Object.assign(Vector2.prototype,{fromAttribute:function(attribute,index,offset){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(attribute,index,offset)},distanceToManhattan:function(v){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(v)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");
return this.manhattanLength()}});Object.assign(Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(m){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");
return this.setFromMatrixPosition(m)},getScaleFromMatrix:function(m){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(m)},getColumnFromMatrix:function(index,matrix){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(matrix,index)},applyProjection:function(m){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");
return this.applyMatrix4(m)},fromAttribute:function(attribute,index,offset){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(attribute,index,offset)},distanceToManhattan:function(v){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(v)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");
return this.manhattanLength()}});Object.assign(Vector4.prototype,{fromAttribute:function(attribute,index,offset){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(attribute,index,offset)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(Geometry.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},
computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(matrix){console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4().");return this.applyMatrix4(matrix)}});Object.assign(Object3D.prototype,{getChildByName:function(name){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(name)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},
translate:function(distance,axis){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(axis,distance)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(matrix){console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4().");return this.applyMatrix4(matrix)}});Object.defineProperties(Object3D.prototype,
{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(value){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=value}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
Object.assign(Mesh.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}});Object.defineProperties(Mesh.prototype,{drawMode:{get:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode.");return 0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});
Object.defineProperties(LOD.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Skeleton.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});SkinnedMesh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(Curve.prototype,
"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");return this.arcLengthDivisions},set:function(value){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=value}});PerspectiveCamera.prototype.setLens=function(focalLength,filmGauge){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==filmGauge&&(this.filmGauge=
filmGauge);this.setFocalLength(focalLength)};Object.defineProperties(Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(value){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=value}},shadowCameraLeft:{set:function(value){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=value}},shadowCameraRight:{set:function(value){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");
this.shadow.camera.right=value}},shadowCameraTop:{set:function(value){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=value}},shadowCameraBottom:{set:function(value){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=value}},shadowCameraNear:{set:function(value){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=value}},shadowCameraFar:{set:function(value){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");
this.shadow.camera.far=value}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(value){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=value}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(value){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");
this.shadow.mapSize.width=value}},shadowMapHeight:{set:function(value){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=value}}});Object.defineProperties(BufferAttribute.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");return this.array.length}},dynamic:{get:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.");return 35048===
this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.");this.setUsage(35048)}}});Object.assign(BufferAttribute.prototype,{setDynamic:function(value){console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead.");this.setUsage(!0===value?35048:35044);return this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});
Object.assign(BufferGeometry.prototype,{addIndex:function(index){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(index)},addAttribute:function(name,attribute,JSCompiler_OptimizeArgumentsArray_p4){console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute().");return attribute&&attribute.isBufferAttribute||attribute&&attribute.isInterleavedBufferAttribute?"index"===name?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),
this.setIndex(attribute),this):this.setAttribute(name,attribute):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(name,new BufferAttribute(attribute,JSCompiler_OptimizeArgumentsArray_p4)))},addDrawCall:function(start,count,indexOffset){void 0!==indexOffset&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(start,count)},
clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(name){console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute().");return this.deleteAttribute(name)},applyMatrix:function(matrix){console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4().");
return this.applyMatrix4(matrix)}});Object.defineProperties(BufferGeometry.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});Object.defineProperties(InstancedBufferGeometry.prototype,{maxInstancedCount:{get:function(){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount.");
return this.instanceCount},set:function(value){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount.");this.instanceCount=value}}});Object.defineProperties(Raycaster.prototype,{linePrecision:{get:function(){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.");return this.params.Line.threshold},set:function(value){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.");
this.params.Line.threshold=value}}});Object.defineProperties(InterleavedBuffer.prototype,{dynamic:{get:function(){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.");return 35048===this.usage},set:function(value){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.");this.setUsage(value)}}});Object.assign(InterleavedBuffer.prototype,{setDynamic:function(value){console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead.");
this.setUsage(!0===value?35048:35044);return this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(ExtrudeBufferGeometry.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});
Object.assign(Scene.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}});Object.defineProperties(Uniform.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(Material.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},
set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new Color}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(value){console.warn("THREE."+
this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===value}},stencilMask:{get:function(){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead.");return this.stencilFuncMask},set:function(value){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead.");this.stencilFuncMask=value}}});Object.defineProperties(MeshPhongMaterial.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");
return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(MeshPhysicalMaterial.prototype,{transparency:{get:function(){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission.");return this.transmission},set:function(value){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission.");this.transmission=value}}});Object.defineProperties(ShaderMaterial.prototype,
{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(value){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=value}}});Object.assign(WebGLRenderer.prototype,{clearTarget:function(renderTarget,color,depth,stencil){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.");
this.setRenderTarget(renderTarget);this.clear(color,depth,stencil)},animate:function(callback){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(callback)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},
getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");
return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")},
supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");
return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(boolean){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(boolean)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},
addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},
getActiveMipMapLevel:function(){console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().");return this.getActiveMipmapLevel()}});Object.defineProperties(WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(value){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=value}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(value){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");
this.shadowMap.type=value}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.");return this.getContext()}},vr:{get:function(){console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr");
return this.xr}},gammaInput:{get:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.");return!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.");return!1},set:function(value){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.");
this.outputEncoding=!0===value?3001:3E3}},toneMappingWhitePoint:{get:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.");return 1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(WebGLShadowMap.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},
renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});
Object.defineProperties(WebGLRenderTarget.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(value){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=value}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(value){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");
this.texture.wrapT=value}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(value){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=value}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(value){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");
this.texture.minFilter=value}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(value){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=value}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(value){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");
this.texture.offset=value}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(value){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=value}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(value){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=
value}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(value){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=value}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},set:function(value){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");
this.texture.generateMipmaps=value}}});Object.defineProperties(Audio$jscomp$0.prototype,{load:{value:function(file){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var scope=this;(new AudioLoader).load(file,function(buffer){scope.setBuffer(buffer)});return this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}});AudioAnalyser.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");
return this.getFrequencyData()};CubeCamera.prototype.updateCubeMap=function(renderer,scene){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(renderer,scene)};CubeCamera.prototype.clear=function(renderer,color,depth,stencil){console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear().");return this.renderTarget.clear(renderer,color,depth,stencil)};ImageUtils.crossOrigin=void 0;ImageUtils.loadTexture=function(url,mapping,onLoad,onError){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
var loader=new TextureLoader;loader.setCrossOrigin(this.crossOrigin);url=loader.load(url,onLoad,void 0,onError);mapping&&(url.mapping=mapping);return url};ImageUtils.loadTextureCube=function(urls,mapping,onLoad,onError){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var loader=new CubeTextureLoader;loader.setCrossOrigin(this.crossOrigin);urls=loader.load(urls,onLoad,void 0,onError);mapping&&(urls.mapping=mapping);return urls};ImageUtils.loadCompressedTexture=
function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};ImageUtils.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"123"}}));exports.ACESFilmicToneMapping=4;exports.AddEquation=100;exports.AddOperation=2;exports.AdditiveAnimationBlendMode=
2501;exports.AdditiveBlending=2;exports.AlphaFormat=1021;exports.AlwaysDepth=1;exports.AlwaysStencilFunc=519;exports.AmbientLight=AmbientLight;exports.AmbientLightProbe=AmbientLightProbe;exports.AnimationClip=AnimationClip;exports.AnimationLoader=AnimationLoader;exports.AnimationMixer=AnimationMixer;exports.AnimationObjectGroup=AnimationObjectGroup;exports.AnimationUtils=AnimationUtils;exports.ArcCurve=ArcCurve;exports.ArrayCamera=ArrayCamera;exports.ArrowHelper=ArrowHelper;exports.Audio=Audio$jscomp$0;
exports.AudioAnalyser=AudioAnalyser;exports.AudioContext=AudioContext;exports.AudioListener=AudioListener$jscomp$0;exports.AudioLoader=AudioLoader;exports.AxesHelper=AxesHelper;exports.AxisHelper=function(size){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new AxesHelper(size)};exports.BackSide=1;exports.BasicDepthPacking=3200;exports.BasicShadowMap=0;exports.BinaryTextureLoader=function(manager){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");
return new DataTextureLoader(manager)};exports.Bone=Bone;exports.BooleanKeyframeTrack=BooleanKeyframeTrack;exports.BoundingBoxHelper=function(object,color){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");return new BoxHelper(object,color)};exports.Box2=Box2;exports.Box3=Box3;exports.Box3Helper=Box3Helper;exports.BoxBufferGeometry=BoxBufferGeometry;exports.BoxGeometry=BoxGeometry;exports.BoxHelper=BoxHelper;exports.BufferAttribute=BufferAttribute;exports.BufferGeometry=
BufferGeometry;exports.BufferGeometryLoader=BufferGeometryLoader;exports.ByteType=1010;exports.Cache=Cache;exports.Camera=Camera;exports.CameraHelper=CameraHelper;exports.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")};exports.CanvasTexture=CanvasTexture;exports.CatmullRomCurve3=CatmullRomCurve3;exports.CineonToneMapping=3;exports.CircleBufferGeometry=CircleBufferGeometry;exports.CircleGeometry=CircleGeometry;exports.ClampToEdgeWrapping=1001;exports.Clock=Clock$jscomp$0;
exports.ClosedSplineCurve3=ClosedSplineCurve3;exports.Color=Color;exports.ColorKeyframeTrack=ColorKeyframeTrack;exports.CompressedTexture=CompressedTexture;exports.CompressedTextureLoader=CompressedTextureLoader;exports.ConeBufferGeometry=ConeBufferGeometry;exports.ConeGeometry=ConeGeometry;exports.CubeCamera=CubeCamera;exports.CubeGeometry=BoxGeometry;exports.CubeReflectionMapping=301;exports.CubeRefractionMapping=302;exports.CubeTexture=CubeTexture;exports.CubeTextureLoader=CubeTextureLoader;exports.CubeUVReflectionMapping=
306;exports.CubeUVRefractionMapping=307;exports.CubicBezierCurve=CubicBezierCurve;exports.CubicBezierCurve3=CubicBezierCurve3;exports.CubicInterpolant=CubicInterpolant;exports.CullFaceBack=1;exports.CullFaceFront=2;exports.CullFaceFrontBack=3;exports.CullFaceNone=0;exports.Curve=Curve;exports.CurvePath=CurvePath;exports.CustomBlending=5;exports.CustomToneMapping=5;exports.CylinderBufferGeometry=CylinderBufferGeometry;exports.CylinderGeometry=CylinderGeometry;exports.Cylindrical=Cylindrical;exports.DataTexture=
DataTexture;exports.DataTexture2DArray=DataTexture2DArray;exports.DataTexture3D=DataTexture3D;exports.DataTextureLoader=DataTextureLoader;exports.DataUtils={toHalfFloat:function(val){_floatView[0]=val;val=_int32View[0];var bits=val>>16&32768,m=val>>12&2047,e=val>>23&255;return 103>e?bits:142<e?bits|31744|((255==e?0:1)&&val&8388607):113>e?(m|=2048,bits|(m>>114-e)+(m>>113-e&1)):bits=(bits|e-112<<10|m>>1)+(m&1)}};exports.DecrementStencilOp=7683;exports.DecrementWrapStencilOp=34056;exports.DefaultLoadingManager=
DefaultLoadingManager;exports.DepthFormat=1026;exports.DepthStencilFormat=1027;exports.DepthTexture=DepthTexture;exports.DirectionalLight=DirectionalLight;exports.DirectionalLightHelper=DirectionalLightHelper;exports.DiscreteInterpolant=DiscreteInterpolant;exports.DodecahedronBufferGeometry=DodecahedronBufferGeometry;exports.DodecahedronGeometry=DodecahedronGeometry;exports.DoubleSide=2;exports.DstAlphaFactor=206;exports.DstColorFactor=208;exports.DynamicBufferAttribute=function(array,itemSize){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead.");
return(new BufferAttribute(array,itemSize)).setUsage(35048)};exports.DynamicCopyUsage=35050;exports.DynamicDrawUsage=35048;exports.DynamicReadUsage=35049;exports.EdgesGeometry=EdgesGeometry;exports.EdgesHelper=function(object,hex){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new LineSegments(new EdgesGeometry(object.geometry),new LineBasicMaterial({color:void 0!==hex?hex:16777215}))};exports.EllipseCurve=EllipseCurve;exports.EqualDepth=4;exports.EqualStencilFunc=
514;exports.EquirectangularReflectionMapping=303;exports.EquirectangularRefractionMapping=304;exports.Euler=Euler;exports.EventDispatcher=EventDispatcher;exports.ExtrudeBufferGeometry=ExtrudeBufferGeometry;exports.ExtrudeGeometry=ExtrudeGeometry;exports.Face3=Face3;exports.Face4=function(a,b,c,d,normal,color,materialIndex){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Face3(a,b,c,normal,color,materialIndex)};exports.FaceColors=1;exports.FileLoader=
FileLoader;exports.FlatShading=1;exports.Float16BufferAttribute=Float16BufferAttribute;exports.Float32Attribute=function(array,itemSize){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new Float32BufferAttribute(array,itemSize)};exports.Float32BufferAttribute=Float32BufferAttribute;exports.Float64Attribute=function(array,itemSize){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");
return new Float64BufferAttribute(array,itemSize)};exports.Float64BufferAttribute=Float64BufferAttribute;exports.FloatType=1015;exports.Fog=Fog;exports.FogExp2=FogExp2;exports.Font=Font;exports.FontLoader=FontLoader;exports.FrontSide=0;exports.Frustum=Frustum;exports.GLBufferAttribute=GLBufferAttribute;exports.GLSL1="100";exports.GLSL3="300 es";exports.GammaEncoding=3007;exports.Geometry=Geometry;exports.GeometryUtils={merge:function(geometry1,geometry2,materialIndexOffset){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");
if(geometry2.isMesh){geometry2.matrixAutoUpdate&&geometry2.updateMatrix();var matrix=geometry2.matrix;geometry2=geometry2.geometry}geometry1.merge(geometry2,matrix,materialIndexOffset)},center:function(geometry){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return geometry.center()}};exports.GreaterDepth=6;exports.GreaterEqualDepth=5;exports.GreaterEqualStencilFunc=518;exports.GreaterStencilFunc=516;exports.GridHelper=GridHelper;exports.Group=
Group;exports.HalfFloatType=1016;exports.HemisphereLight=HemisphereLight;exports.HemisphereLightHelper=HemisphereLightHelper;exports.HemisphereLightProbe=HemisphereLightProbe;exports.IcosahedronBufferGeometry=IcosahedronBufferGeometry;exports.IcosahedronGeometry=IcosahedronGeometry;exports.ImageBitmapLoader=ImageBitmapLoader;exports.ImageLoader=ImageLoader;exports.ImageUtils=ImageUtils;exports.ImmediateRenderObject=ImmediateRenderObject;exports.IncrementStencilOp=7682;exports.IncrementWrapStencilOp=
34055;exports.InstancedBufferAttribute=InstancedBufferAttribute;exports.InstancedBufferGeometry=InstancedBufferGeometry;exports.InstancedInterleavedBuffer=InstancedInterleavedBuffer;exports.InstancedMesh=InstancedMesh;exports.Int16Attribute=function(array,itemSize){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");return new Int16BufferAttribute(array,itemSize)};exports.Int16BufferAttribute=Int16BufferAttribute;exports.Int32Attribute=function(array,
itemSize){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new Int32BufferAttribute(array,itemSize)};exports.Int32BufferAttribute=Int32BufferAttribute;exports.Int8Attribute=function(array,itemSize){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new Int8BufferAttribute(array,itemSize)};exports.Int8BufferAttribute=Int8BufferAttribute;exports.IntType=1013;exports.InterleavedBuffer=InterleavedBuffer;
exports.InterleavedBufferAttribute=InterleavedBufferAttribute;exports.Interpolant=Interpolant;exports.InterpolateDiscrete=2300;exports.InterpolateLinear=2301;exports.InterpolateSmooth=2302;exports.InvertStencilOp=5386;exports.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")};exports.KeepStencilOp=7680;exports.KeyframeTrack=KeyframeTrack;exports.LOD=LOD;exports.LatheBufferGeometry=LatheBufferGeometry;exports.LatheGeometry=LatheGeometry;exports.Layers=Layers;exports.LensFlare=
function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")};exports.LessDepth=2;exports.LessEqualDepth=3;exports.LessEqualStencilFunc=515;exports.LessStencilFunc=513;exports.Light=Light;exports.LightProbe=LightProbe;exports.Line=Line;exports.Line3=Line3;exports.LineBasicMaterial=LineBasicMaterial;exports.LineCurve=LineCurve;exports.LineCurve3=LineCurve3;exports.LineDashedMaterial=LineDashedMaterial;exports.LineLoop=LineLoop;exports.LinePieces=1;exports.LineSegments=
LineSegments;exports.LineStrip=0;exports.LinearEncoding=3E3;exports.LinearFilter=1006;exports.LinearInterpolant=LinearInterpolant;exports.LinearMipMapLinearFilter=1008;exports.LinearMipMapNearestFilter=1007;exports.LinearMipmapLinearFilter=1008;exports.LinearMipmapNearestFilter=1007;exports.LinearToneMapping=1;exports.Loader=Loader;exports.LoaderUtils=LoaderUtils;exports.LoadingManager=LoadingManager;exports.LogLuvEncoding=3003;exports.LoopOnce=2200;exports.LoopPingPong=2202;exports.LoopRepeat=2201;
exports.LuminanceAlphaFormat=1025;exports.LuminanceFormat=1024;exports.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};exports.Material=Material;exports.MaterialLoader=MaterialLoader;exports.Math=MathUtils;exports.MathUtils=MathUtils;exports.Matrix3=Matrix3;exports.Matrix4=Matrix4;exports.MaxEquation=104;exports.Mesh=Mesh;exports.MeshBasicMaterial=MeshBasicMaterial;exports.MeshDepthMaterial=MeshDepthMaterial;exports.MeshDistanceMaterial=MeshDistanceMaterial;exports.MeshFaceMaterial=function(materials){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");
return materials};exports.MeshLambertMaterial=MeshLambertMaterial;exports.MeshMatcapMaterial=MeshMatcapMaterial;exports.MeshNormalMaterial=MeshNormalMaterial;exports.MeshPhongMaterial=MeshPhongMaterial;exports.MeshPhysicalMaterial=MeshPhysicalMaterial;exports.MeshStandardMaterial=MeshStandardMaterial;exports.MeshToonMaterial=MeshToonMaterial;exports.MinEquation=103;exports.MirroredRepeatWrapping=1002;exports.MixOperation=1;exports.MultiMaterial=function(materials){void 0===materials&&(materials=[]);
console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");materials.isMultiMaterial=!0;materials.materials=materials;materials.clone=function(){return materials.slice()};return materials};exports.MultiplyBlending=4;exports.MultiplyOperation=0;exports.NearestFilter=1003;exports.NearestMipMapLinearFilter=1005;exports.NearestMipMapNearestFilter=1004;exports.NearestMipmapLinearFilter=1005;exports.NearestMipmapNearestFilter=1004;exports.NeverDepth=0;exports.NeverStencilFunc=512;exports.NoBlending=
0;exports.NoColors=0;exports.NoToneMapping=0;exports.NormalAnimationBlendMode=2500;exports.NormalBlending=1;exports.NotEqualDepth=7;exports.NotEqualStencilFunc=517;exports.NumberKeyframeTrack=NumberKeyframeTrack;exports.Object3D=Object3D;exports.ObjectLoader=ObjectLoader;exports.ObjectSpaceNormalMap=1;exports.OctahedronBufferGeometry=OctahedronBufferGeometry;exports.OctahedronGeometry=OctahedronGeometry;exports.OneFactor=201;exports.OneMinusDstAlphaFactor=207;exports.OneMinusDstColorFactor=209;exports.OneMinusSrcAlphaFactor=
205;exports.OneMinusSrcColorFactor=203;exports.OrthographicCamera=OrthographicCamera;exports.PCFShadowMap=1;exports.PCFSoftShadowMap=2;exports.PMREMGenerator=PMREMGenerator;exports.ParametricBufferGeometry=ParametricBufferGeometry;exports.ParametricGeometry=ParametricGeometry;exports.Particle=function(material){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new Sprite(material)};exports.ParticleBasicMaterial=function(parameters){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");
return new PointsMaterial(parameters)};exports.ParticleSystem=function(geometry,material){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Points(geometry,material)};exports.ParticleSystemMaterial=function(parameters){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new PointsMaterial(parameters)};exports.Path=Path;exports.PerspectiveCamera=PerspectiveCamera;exports.Plane=Plane;exports.PlaneBufferGeometry=PlaneBufferGeometry;
exports.PlaneGeometry=PlaneGeometry;exports.PlaneHelper=PlaneHelper;exports.PointCloud=function(geometry,material){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Points(geometry,material)};exports.PointCloudMaterial=function(parameters){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new PointsMaterial(parameters)};exports.PointLight=PointLight;exports.PointLightHelper=PointLightHelper;exports.Points=Points;exports.PointsMaterial=
PointsMaterial;exports.PolarGridHelper=PolarGridHelper;exports.PolyhedronBufferGeometry=PolyhedronBufferGeometry;exports.PolyhedronGeometry=PolyhedronGeometry;exports.PositionalAudio=PositionalAudio;exports.PropertyBinding=PropertyBinding;exports.PropertyMixer=PropertyMixer;exports.QuadraticBezierCurve=QuadraticBezierCurve;exports.QuadraticBezierCurve3=QuadraticBezierCurve3;exports.Quaternion=Quaternion;exports.QuaternionKeyframeTrack=QuaternionKeyframeTrack;exports.QuaternionLinearInterpolant=QuaternionLinearInterpolant;
exports.REVISION="123";exports.RGBADepthPacking=3201;exports.RGBAFormat=1023;exports.RGBAIntegerFormat=1033;exports.RGBA_ASTC_10x10_Format=37819;exports.RGBA_ASTC_10x5_Format=37816;exports.RGBA_ASTC_10x6_Format=37817;exports.RGBA_ASTC_10x8_Format=37818;exports.RGBA_ASTC_12x10_Format=37820;exports.RGBA_ASTC_12x12_Format=37821;exports.RGBA_ASTC_4x4_Format=37808;exports.RGBA_ASTC_5x4_Format=37809;exports.RGBA_ASTC_5x5_Format=37810;exports.RGBA_ASTC_6x5_Format=37811;exports.RGBA_ASTC_6x6_Format=37812;
exports.RGBA_ASTC_8x5_Format=37813;exports.RGBA_ASTC_8x6_Format=37814;exports.RGBA_ASTC_8x8_Format=37815;exports.RGBA_BPTC_Format=36492;exports.RGBA_ETC2_EAC_Format=37496;exports.RGBA_PVRTC_2BPPV1_Format=35843;exports.RGBA_PVRTC_4BPPV1_Format=35842;exports.RGBA_S3TC_DXT1_Format=33777;exports.RGBA_S3TC_DXT3_Format=33778;exports.RGBA_S3TC_DXT5_Format=33779;exports.RGBDEncoding=3006;exports.RGBEEncoding=3002;exports.RGBEFormat=1023;exports.RGBFormat=1022;exports.RGBIntegerFormat=1032;exports.RGBM16Encoding=
3005;exports.RGBM7Encoding=3004;exports.RGB_ETC1_Format=36196;exports.RGB_ETC2_Format=37492;exports.RGB_PVRTC_2BPPV1_Format=35841;exports.RGB_PVRTC_4BPPV1_Format=35840;exports.RGB_S3TC_DXT1_Format=33776;exports.RGFormat=1030;exports.RGIntegerFormat=1031;exports.RawShaderMaterial=RawShaderMaterial;exports.Ray=Ray;exports.Raycaster=Raycaster;exports.RectAreaLight=RectAreaLight;exports.RedFormat=1028;exports.RedIntegerFormat=1029;exports.ReinhardToneMapping=2;exports.RepeatWrapping=1E3;exports.ReplaceStencilOp=
7681;exports.ReverseSubtractEquation=102;exports.RingBufferGeometry=RingBufferGeometry;exports.RingGeometry=RingGeometry;exports.SRGB8_ALPHA8_ASTC_10x10_Format=37851;exports.SRGB8_ALPHA8_ASTC_10x5_Format=37848;exports.SRGB8_ALPHA8_ASTC_10x6_Format=37849;exports.SRGB8_ALPHA8_ASTC_10x8_Format=37850;exports.SRGB8_ALPHA8_ASTC_12x10_Format=37852;exports.SRGB8_ALPHA8_ASTC_12x12_Format=37853;exports.SRGB8_ALPHA8_ASTC_4x4_Format=37840;exports.SRGB8_ALPHA8_ASTC_5x4_Format=37841;exports.SRGB8_ALPHA8_ASTC_5x5_Format=
37842;exports.SRGB8_ALPHA8_ASTC_6x5_Format=37843;exports.SRGB8_ALPHA8_ASTC_6x6_Format=37844;exports.SRGB8_ALPHA8_ASTC_8x5_Format=37845;exports.SRGB8_ALPHA8_ASTC_8x6_Format=37846;exports.SRGB8_ALPHA8_ASTC_8x8_Format=37847;exports.Scene=Scene;exports.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};
exports.ShaderChunk=ShaderChunk;exports.ShaderLib=ShaderLib;exports.ShaderMaterial=ShaderMaterial;exports.ShadowMaterial=ShadowMaterial;exports.Shape=Shape;exports.ShapeBufferGeometry=ShapeBufferGeometry;exports.ShapeGeometry=ShapeGeometry;exports.ShapePath=ShapePath;exports.ShapeUtils=ShapeUtils;exports.ShortType=1011;exports.Skeleton=Skeleton;exports.SkeletonHelper=SkeletonHelper;exports.SkinnedMesh=SkinnedMesh;exports.SmoothShading=2;exports.Sphere=Sphere;exports.SphereBufferGeometry=SphereBufferGeometry;
exports.SphereGeometry=SphereGeometry;exports.Spherical=Spherical;exports.SphericalHarmonics3=SphericalHarmonics3;exports.Spline=Spline;exports.SplineCurve=SplineCurve;exports.SplineCurve3=SplineCurve3;exports.SpotLight=SpotLight;exports.SpotLightHelper=SpotLightHelper;exports.Sprite=Sprite;exports.SpriteMaterial=SpriteMaterial;exports.SrcAlphaFactor=204;exports.SrcAlphaSaturateFactor=210;exports.SrcColorFactor=202;exports.StaticCopyUsage=35046;exports.StaticDrawUsage=35044;exports.StaticReadUsage=
35045;exports.StereoCamera=StereoCamera;exports.StreamCopyUsage=35042;exports.StreamDrawUsage=35040;exports.StreamReadUsage=35041;exports.StringKeyframeTrack=StringKeyframeTrack;exports.SubtractEquation=101;exports.SubtractiveBlending=3;exports.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};exports.TangentSpaceNormalMap=0;exports.TetrahedronBufferGeometry=TetrahedronBufferGeometry;exports.TetrahedronGeometry=TetrahedronGeometry;exports.TextBufferGeometry=TextBufferGeometry;exports.TextGeometry=
TextGeometry;exports.Texture=Texture;exports.TextureLoader=TextureLoader;exports.TorusBufferGeometry=TorusBufferGeometry;exports.TorusGeometry=TorusGeometry;exports.TorusKnotBufferGeometry=TorusKnotBufferGeometry;exports.TorusKnotGeometry=TorusKnotGeometry;exports.Triangle=Triangle;exports.TriangleFanDrawMode=2;exports.TriangleStripDrawMode=1;exports.TrianglesDrawMode=0;exports.TubeBufferGeometry=TubeBufferGeometry;exports.TubeGeometry=TubeGeometry;exports.UVMapping=300;exports.Uint16Attribute=function(array,
itemSize){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new Uint16BufferAttribute(array,itemSize)};exports.Uint16BufferAttribute=Uint16BufferAttribute;exports.Uint32Attribute=function(array,itemSize){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new Uint32BufferAttribute(array,itemSize)};exports.Uint32BufferAttribute=Uint32BufferAttribute;exports.Uint8Attribute=function(array,
itemSize){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new Uint8BufferAttribute(array,itemSize)};exports.Uint8BufferAttribute=Uint8BufferAttribute;exports.Uint8ClampedAttribute=function(array,itemSize){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new Uint8ClampedBufferAttribute(array,itemSize)};exports.Uint8ClampedBufferAttribute=Uint8ClampedBufferAttribute;exports.Uniform=
Uniform;exports.UniformsLib=UniformsLib;exports.UniformsUtils=UniformsUtils;exports.UnsignedByteType=1009;exports.UnsignedInt248Type=1020;exports.UnsignedIntType=1014;exports.UnsignedShort4444Type=1017;exports.UnsignedShort5551Type=1018;exports.UnsignedShort565Type=1019;exports.UnsignedShortType=1012;exports.VSMShadowMap=3;exports.Vector2=Vector2;exports.Vector3=Vector3;exports.Vector4=Vector4;exports.VectorKeyframeTrack=VectorKeyframeTrack;exports.Vertex=function(x,y,z){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");
return new Vector3(x,y,z)};exports.VertexColors=2;exports.VideoTexture=VideoTexture;exports.WebGL1Renderer=WebGL1Renderer;exports.WebGLCubeRenderTarget=WebGLCubeRenderTarget;exports.WebGLMultisampleRenderTarget=WebGLMultisampleRenderTarget;exports.WebGLRenderTarget=WebGLRenderTarget;exports.WebGLRenderTargetCube=function(width,height,options){console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options ).");return new WebGLCubeRenderTarget(width,
options)};exports.WebGLRenderer=WebGLRenderer;exports.WebGLUtils=WebGLUtils;exports.WireframeGeometry=WireframeGeometry;exports.WireframeHelper=function(object,hex){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new LineSegments(new WireframeGeometry(object.geometry),new LineBasicMaterial({color:void 0!==hex?hex:16777215}))};exports.WrapAroundEnding=2402;exports.XHRLoader=function(manager){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");
return new FileLoader(manager)};exports.ZeroCurvatureEnding=2400;exports.ZeroFactor=200;exports.ZeroSlopeEnding=2401;exports.ZeroStencilOp=0;exports.sRGBEncoding=3001;Object.defineProperty(exports,"__esModule",{value:!0})})},{}],58:[function(_dereq_,module$jscomp$0,exports){THREE.DRACOLoader=function(manager){THREE.Loader.call(this,manager);this.decoderPath="";this.decoderConfig={};this.decoderPending=this.decoderBinary=null;this.workerLimit=4;this.workerPool=[];this.workerNextTaskID=1;this.workerSourceURL=
"";this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"};this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(path){this.decoderPath=path;return this},setDecoderConfig:function(config){this.decoderConfig=config;return this},setWorkerLimit:function(workerLimit){this.workerLimit=
workerLimit;return this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(url,onLoad,onProgress,onError){var $jscomp$this=this,loader=new THREE.FileLoader(this.manager);loader.setPath(this.path);loader.setResponseType("arraybuffer");
loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(this.withCredentials);loader.load(url,function(buffer){$jscomp$this.decodeGeometry(buffer,{attributeIDs:$jscomp$this.defaultAttributeIDs,attributeTypes:$jscomp$this.defaultAttributeTypes,useUniqueIDs:!1}).then(onLoad).catch(onError)},onProgress,onError)},decodeDracoFile:function(buffer,callback,attributeIDs,attributeTypes){this.decodeGeometry(buffer,{attributeIDs:attributeIDs||this.defaultAttributeIDs,attributeTypes:attributeTypes||
this.defaultAttributeTypes,useUniqueIDs:!!attributeIDs}).then(callback)},decodeGeometry:function(buffer,taskConfig){var $jscomp$this=this;for(attribute in taskConfig.attributeTypes){var type=taskConfig.attributeTypes[attribute];void 0!==type.BYTES_PER_ELEMENT&&(taskConfig.attributeTypes[attribute]=type.name)}var attribute=JSON.stringify(taskConfig);if(THREE.DRACOLoader.taskCache.has(buffer)){type=THREE.DRACOLoader.taskCache.get(buffer);if(type.key===attribute)return type.promise;if(0===buffer.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.");
}var worker,taskID=this.workerNextTaskID++;type=this._getWorker(taskID,buffer.byteLength).then(function(_worker){worker=_worker;return new Promise(function(resolve,reject){worker._callbacks[taskID]={resolve:resolve,reject:reject};worker.postMessage({type:"decode",id:taskID,taskConfig:taskConfig,buffer:buffer},[buffer])})}).then(function(message){return $jscomp$this._createGeometry(message.geometry)});type.catch(function(){return!0}).then(function(){worker&&taskID&&$jscomp$this._releaseTask(worker,
taskID)});THREE.DRACOLoader.taskCache.set(buffer,{key:attribute,promise:type});return type},_createGeometry:function(geometryData){var geometry=new THREE.BufferGeometry;geometryData.index&&geometry.setIndex(new THREE.BufferAttribute(geometryData.index.array,1));for(var i=0;i<geometryData.attributes.length;i++){var attribute=geometryData.attributes[i];geometry.setAttribute(attribute.name,new THREE.BufferAttribute(attribute.array,attribute.itemSize))}return geometry},_loadLibrary:function(url,responseType){var loader=
new THREE.FileLoader(this.manager);loader.setPath(this.decoderPath);loader.setResponseType(responseType);loader.setWithCredentials(this.withCredentials);return new Promise(function(resolve,reject){loader.load(url,resolve,void 0,reject)})},preload:function(){this._initDecoder();return this},_initDecoder:function(){var $jscomp$this=this;if(this.decoderPending)return this.decoderPending;var useJS="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,librariesPending=[];useJS?librariesPending.push(this._loadLibrary("draco_decoder.js",
"text")):(librariesPending.push(this._loadLibrary("draco_wasm_wrapper.js","text")),librariesPending.push(this._loadLibrary("draco_decoder.wasm","arraybuffer")));return this.decoderPending=Promise.all(librariesPending).then(function(libraries){var jsContent=libraries[0];useJS||($jscomp$this.decoderConfig.wasmBinary=libraries[1]);libraries=THREE.DRACOLoader.DRACOWorker.toString();jsContent=["/* draco decoder */",jsContent,"\n/* worker */",libraries.substring(libraries.indexOf("{")+1,libraries.lastIndexOf("}"))].join("\n");
$jscomp$this.workerSourceURL=URL.createObjectURL(new Blob([jsContent]))})},_getWorker:function(taskID,taskCost){var $jscomp$this=this;return this._initDecoder().then(function(){if($jscomp$this.workerPool.length<$jscomp$this.workerLimit){var worker=new Worker($jscomp$this.workerSourceURL);worker._callbacks={};worker._taskCosts={};worker._taskLoad=0;worker.postMessage({type:"init",decoderConfig:$jscomp$this.decoderConfig});worker.onmessage=function(e){e=e.data;switch(e.type){case "decode":worker._callbacks[e.id].resolve(e);
break;case "error":worker._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}};$jscomp$this.workerPool.push(worker)}else $jscomp$this.workerPool.sort(function(a,b){return a._taskLoad>b._taskLoad?-1:1});worker=$jscomp$this.workerPool[$jscomp$this.workerPool.length-1];worker._taskCosts[taskID]=taskCost;worker._taskLoad+=taskCost;return worker})},_releaseTask:function(worker,taskID){worker._taskLoad-=worker._taskCosts[taskID];delete worker._callbacks[taskID];
delete worker._taskCosts[taskID]},debug:function(){console.log("Task load: ",this.workerPool.map(function(worker){return worker._taskLoad}))},dispose:function(){for(var i=0;i<this.workerPool.length;++i)this.workerPool[i].terminate();this.workerPool.length=0;return this}});THREE.DRACOLoader.DRACOWorker=function(){function decodeGeometry(draco,decoder,decoderBuffer,taskConfig){var attributeIDs=taskConfig.attributeIDs,attributeTypes=taskConfig.attributeTypes,geometryType=decoder.GetEncodedGeometryType(decoderBuffer);
if(geometryType===draco.TRIANGULAR_MESH){var dracoGeometry=new draco.Mesh;decoderBuffer=decoder.DecodeBufferToMesh(decoderBuffer,dracoGeometry)}else if(geometryType===draco.POINT_CLOUD)dracoGeometry=new draco.PointCloud,decoderBuffer=decoder.DecodeBufferToPointCloud(decoderBuffer,dracoGeometry);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!decoderBuffer.ok()||0===dracoGeometry.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+decoderBuffer.error_msg());decoderBuffer={index:null,
attributes:[]};for(var attributeName in attributeIDs){var attributeType=self[attributeTypes[attributeName]];if(taskConfig.useUniqueIDs){var attribute=attributeIDs[attributeName];attribute=decoder.GetAttributeByUniqueId(dracoGeometry,attribute)}else{attribute=decoder.GetAttributeId(dracoGeometry,draco[attributeIDs[attributeName]]);if(-1===attribute)continue;attribute=decoder.GetAttribute(dracoGeometry,attribute)}decoderBuffer.attributes.push(decodeAttribute(draco,decoder,dracoGeometry,attributeName,
attributeType,attribute))}geometryType===draco.TRIANGULAR_MESH&&(attributeIDs=dracoGeometry,attributeTypes=3*attributeIDs.num_faces(),geometryType=4*attributeTypes,taskConfig=draco._malloc(geometryType),decoder.GetTrianglesUInt32Array(attributeIDs,geometryType,taskConfig),decoder=(new Uint32Array(draco.HEAPF32.buffer,taskConfig,attributeTypes)).slice(),draco._free(taskConfig),decoderBuffer.index={array:decoder,itemSize:1});draco.destroy(dracoGeometry);return decoderBuffer}function decodeAttribute(draco,
decoder,dracoGeometry,attributeName,attributeType,attribute){var numComponents=attribute.num_components(),numValues=dracoGeometry.num_points()*numComponents,byteLength=numValues*attributeType.BYTES_PER_ELEMENT,dataType=getDracoDataType(draco,attributeType),ptr=draco._malloc(byteLength);decoder.GetAttributeDataArrayForAllPoints(dracoGeometry,attribute,dataType,byteLength,ptr);decoder=(new attributeType(draco.HEAPF32.buffer,ptr,numValues)).slice();draco._free(ptr);return{name:attributeName,array:decoder,
itemSize:numComponents}}function getDracoDataType(draco,attributeType){switch(attributeType){case Float32Array:return draco.DT_FLOAT32;case Int8Array:return draco.DT_INT8;case Int16Array:return draco.DT_INT16;case Int32Array:return draco.DT_INT32;case Uint8Array:return draco.DT_UINT8;case Uint16Array:return draco.DT_UINT16;case Uint32Array:return draco.DT_UINT32}}var decoderConfig,decoderPending;onmessage=function(e){var message=e.data;switch(message.type){case "init":decoderConfig=message.decoderConfig;
decoderPending=new Promise(function(resolve){decoderConfig.onModuleLoaded=function(draco){resolve({draco:draco})};DracoDecoderModule(decoderConfig)});break;case "decode":var buffer=message.buffer,taskConfig=message.taskConfig;decoderPending.then(function(module){module=module.draco;var decoder=new module.Decoder,decoderBuffer=new module.DecoderBuffer;decoderBuffer.Init(new Int8Array(buffer),buffer.byteLength);try{var geometry=decodeGeometry(module,decoder,decoderBuffer,taskConfig),buffers=geometry.attributes.map(function(attr){return attr.array.buffer});
geometry.index&&buffers.push(geometry.index.array.buffer);self.postMessage({type:"decode",id:message.id,geometry:geometry},buffers)}catch(error){console.error(error),self.postMessage({type:"error",id:message.id,error:error.message})}finally{module.destroy(decoderBuffer),module.destroy(decoder)}})}}};THREE.DRACOLoader.taskCache=new WeakMap;THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")};THREE.DRACOLoader.setDecoderConfig=
function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")};THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")};THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},{}],59:[function(_dereq_,module,exports){THREE.GLTFLoader=function(){function GLTFLoader(manager){THREE.Loader.call(this,
manager);this.meshoptDecoder=this.ktx2Loader=this.ddsLoader=this.dracoLoader=null;this.pluginCallbacks=[];this.register(function(parser){return new GLTFMaterialsClearcoatExtension(parser)});this.register(function(parser){return new GLTFTextureBasisUExtension(parser)});this.register(function(parser){return new GLTFTextureWebPExtension(parser)});this.register(function(parser){return new GLTFMaterialsTransmissionExtension(parser)});this.register(function(parser){return new GLTFLightsExtension(parser)});
this.register(function(parser){return new GLTFMeshoptCompression(parser)})}function GLTFRegistry(){var objects={};return{get:function(key){return objects[key]},add:function(key,object){objects[key]=object},remove:function(key){delete objects[key]},removeAll:function(){objects={}}}}function GLTFTextureDDSExtension(ddsLoader){if(!ddsLoader)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=EXTENSIONS.MSFT_TEXTURE_DDS;this.ddsLoader=ddsLoader}
function GLTFLightsExtension(parser){this.parser=parser;this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL;this.cache={refs:{},uses:{}}}function GLTFMaterialsUnlitExtension(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}function GLTFMaterialsClearcoatExtension(parser){this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}function GLTFMaterialsTransmissionExtension(parser){this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}function GLTFTextureBasisUExtension(parser){this.parser=parser;
this.name=EXTENSIONS.KHR_TEXTURE_BASISU}function GLTFTextureWebPExtension(parser){this.parser=parser;this.name=EXTENSIONS.EXT_TEXTURE_WEBP;this.isSupported=null}function GLTFMeshoptCompression(parser){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION;this.parser=parser}function GLTFBinaryExtension(data){this.name=EXTENSIONS.KHR_BINARY_GLTF;this.body=this.content=null;var headerView=new DataView(data,0,BINARY_EXTENSION_HEADER_LENGTH);this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(data.slice(0,
4))),version:headerView.getUint32(4,!0),length:headerView.getUint32(8,!0)};if(this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");headerView=new DataView(data,BINARY_EXTENSION_HEADER_LENGTH);for(var chunkIndex=0;chunkIndex<headerView.byteLength;){var chunkLength=headerView.getUint32(chunkIndex,!0);chunkIndex+=4;var chunkType=headerView.getUint32(chunkIndex,
!0);chunkIndex+=4;chunkType===BINARY_EXTENSION_CHUNK_TYPES.JSON?(chunkType=new Uint8Array(data,BINARY_EXTENSION_HEADER_LENGTH+chunkIndex,chunkLength),this.content=THREE.LoaderUtils.decodeText(chunkType)):chunkType===BINARY_EXTENSION_CHUNK_TYPES.BIN&&(chunkType=BINARY_EXTENSION_HEADER_LENGTH+chunkIndex,this.body=data.slice(chunkType,chunkType+chunkLength));chunkIndex+=chunkLength}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.");}function GLTFDracoMeshCompressionExtension(json,
dracoLoader){if(!dracoLoader)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;this.json=json;this.dracoLoader=dracoLoader;this.dracoLoader.preload()}function GLTFTextureTransformExtension(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}function GLTFMeshStandardSGMaterial(params){THREE.MeshStandardMaterial.call(this);this.isGLTFSpecularGlossinessMaterial=!0;var uniforms={specular:{value:(new THREE.Color).setHex(16777215)},glossiness:{value:1},
specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=uniforms;this.onBeforeCompile=function(shader){for(var uniformName in uniforms)shader.uniforms[uniformName]=uniforms[uniformName];shader.fragmentShader=shader.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include \x3croughnessmap_pars_fragment\x3e","#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif").replace("#include \x3cmetalnessmap_pars_fragment\x3e",
"#ifdef USE_GLOSSINESSMAP\n\tuniform sampler2D glossinessMap;\n#endif").replace("#include \x3croughnessmap_fragment\x3e","vec3 specularFactor \x3d specular;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular \x3d texture2D( specularMap, vUv );\n\ttexelSpecular \x3d sRGBToLinear( texelSpecular );\n\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tspecularFactor *\x3d texelSpecular.rgb;\n#endif").replace("#include \x3cmetalnessmap_fragment\x3e","float glossinessFactor \x3d glossiness;\n#ifdef USE_GLOSSINESSMAP\n\tvec4 texelGlossiness \x3d texture2D( glossinessMap, vUv );\n\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tglossinessFactor *\x3d texelGlossiness.a;\n#endif").replace("#include \x3clights_physical_fragment\x3e",
"PhysicalMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy \x3d max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness \x3d max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness \x3d max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness +\x3d geometryRoughness;\nmaterial.specularRoughness \x3d min( material.specularRoughness, 1.0 );\nmaterial.specularColor \x3d specularFactor;")};
Object.defineProperties(this,{specular:{get:function(){return uniforms.specular.value},set:function(v){uniforms.specular.value=v}},specularMap:{get:function(){return uniforms.specularMap.value},set:function(v){(uniforms.specularMap.value=v)?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return uniforms.glossiness.value},set:function(v){uniforms.glossiness.value=v}},glossinessMap:{get:function(){return uniforms.glossinessMap.value},set:function(v){(uniforms.glossinessMap.value=
v)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}});delete this.metalness;delete this.roughness;delete this.metalnessMap;delete this.roughnessMap;this.setValues(params)}function GLTFMaterialsPbrSpecularGlossinessExtension(){return{name:EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:"color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" "),
getMaterialType:function(){return GLTFMeshStandardSGMaterial},extendParams:function(materialParams,materialDef,parser){var pbrSpecularGlossiness=materialDef.extensions[this.name];materialParams.color=new THREE.Color(1,1,1);materialParams.opacity=1;materialDef=[];if(Array.isArray(pbrSpecularGlossiness.diffuseFactor)){var array=pbrSpecularGlossiness.diffuseFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3]}void 0!==pbrSpecularGlossiness.diffuseTexture&&materialDef.push(parser.assignTexture(materialParams,
"map",pbrSpecularGlossiness.diffuseTexture));materialParams.emissive=new THREE.Color(0,0,0);materialParams.glossiness=void 0!==pbrSpecularGlossiness.glossinessFactor?pbrSpecularGlossiness.glossinessFactor:1;materialParams.specular=new THREE.Color(1,1,1);Array.isArray(pbrSpecularGlossiness.specularFactor)&&materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);void 0!==pbrSpecularGlossiness.specularGlossinessTexture&&(pbrSpecularGlossiness=pbrSpecularGlossiness.specularGlossinessTexture,
materialDef.push(parser.assignTexture(materialParams,"glossinessMap",pbrSpecularGlossiness)),materialDef.push(parser.assignTexture(materialParams,"specularMap",pbrSpecularGlossiness)));return Promise.all(materialDef)},createMaterial:function(materialParams){var material=new GLTFMeshStandardSGMaterial(materialParams);material.fog=!0;material.color=materialParams.color;material.map=void 0===materialParams.map?null:materialParams.map;material.lightMap=null;material.lightMapIntensity=1;material.aoMap=
void 0===materialParams.aoMap?null:materialParams.aoMap;material.aoMapIntensity=1;material.emissive=materialParams.emissive;material.emissiveIntensity=1;material.emissiveMap=void 0===materialParams.emissiveMap?null:materialParams.emissiveMap;material.bumpMap=void 0===materialParams.bumpMap?null:materialParams.bumpMap;material.bumpScale=1;material.normalMap=void 0===materialParams.normalMap?null:materialParams.normalMap;material.normalMapType=THREE.TangentSpaceNormalMap;materialParams.normalScale&&
(material.normalScale=materialParams.normalScale);material.displacementMap=null;material.displacementScale=1;material.displacementBias=0;material.specularMap=void 0===materialParams.specularMap?null:materialParams.specularMap;material.specular=materialParams.specular;material.glossinessMap=void 0===materialParams.glossinessMap?null:materialParams.glossinessMap;material.glossiness=materialParams.glossiness;material.alphaMap=null;material.envMap=void 0===materialParams.envMap?null:materialParams.envMap;
material.envMapIntensity=1;material.refractionRatio=.98;return material}}}function GLTFMeshQuantizationExtension(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}function GLTFCubicSplineInterpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){THREE.Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)}function resolveURL(url,path){if("string"!==typeof url||""===url)return"";/^https?:\/\//i.test(path)&&/^\//.test(url)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));
return/^(https?:)?\/\//i.test(url)||/^data:.*,.*$/i.test(url)||/^blob:.*$/i.test(url)?url:path+url}function createDefaultMaterial(cache){void 0===cache.DefaultMaterial&&(cache.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}));return cache.DefaultMaterial}function addUnknownExtensionsToUserData(knownExtensions,object,objectDef){for(var name in objectDef.extensions)void 0===knownExtensions[name]&&(object.userData.gltfExtensions=
object.userData.gltfExtensions||{},object.userData.gltfExtensions[name]=objectDef.extensions[name])}function assignExtrasToUserData(object,gltfDef){void 0!==gltfDef.extras&&("object"===typeof gltfDef.extras?Object.assign(object.userData,gltfDef.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+gltfDef.extras))}function addMorphTargets(geometry,targets,parser){for(var hasMorphPosition=!1,hasMorphNormal=!1,i=0,il=targets.length;i<il;i++){var target=targets[i];void 0!==target.POSITION&&
(hasMorphPosition=!0);void 0!==target.NORMAL&&(hasMorphNormal=!0);if(hasMorphPosition&&hasMorphNormal)break}if(!hasMorphPosition&&!hasMorphNormal)return Promise.resolve(geometry);var pendingPositionAccessors=[],pendingNormalAccessors=[];i=0;for(il=targets.length;i<il;i++){target=targets[i];if(hasMorphPosition){var pendingAccessor=void 0!==target.POSITION?parser.getDependency("accessor",target.POSITION):geometry.attributes.position;pendingPositionAccessors.push(pendingAccessor)}hasMorphNormal&&(pendingAccessor=
void 0!==target.NORMAL?parser.getDependency("accessor",target.NORMAL):geometry.attributes.normal,pendingNormalAccessors.push(pendingAccessor))}return Promise.all([Promise.all(pendingPositionAccessors),Promise.all(pendingNormalAccessors)]).then(function(accessors){var morphPositions=accessors[0];accessors=accessors[1];hasMorphPosition&&(geometry.morphAttributes.position=morphPositions);hasMorphNormal&&(geometry.morphAttributes.normal=accessors);geometry.morphTargetsRelative=!0;return geometry})}function createPrimitiveKey(primitiveDef){var dracoExtension=
primitiveDef.extensions&&primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];return dracoExtension?"draco:"+dracoExtension.bufferView+":"+dracoExtension.indices+":"+createAttributesKey(dracoExtension.attributes):primitiveDef.indices+":"+createAttributesKey(primitiveDef.attributes)+":"+primitiveDef.mode}function createAttributesKey(attributes){for(var attributesKey="",keys=Object.keys(attributes).sort(),i=0,il=keys.length;i<il;i++)attributesKey+=keys[i]+":"+attributes[keys[i]]+";";return attributesKey}
function GLTFParser(json,options){this.json=json||{};this.extensions={};this.plugins={};this.options=options||{};this.cache=new GLTFRegistry;this.associations=new Map;this.primitiveCache={};this.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};this.lightCache={refs:{},uses:{}};this.nodeNamesUsed={};"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager);
this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.fileLoader=new THREE.FileLoader(this.options.manager);this.fileLoader.setResponseType("arraybuffer");"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function computeBounds(geometry,primitiveDef,parser){var attributes=primitiveDef.attributes,box=new THREE.Box3;if(void 0!==attributes.POSITION){var accessor=parser.json.accessors[attributes.POSITION];attributes=accessor.min;accessor=accessor.max;if(void 0!==
attributes&&void 0!==accessor){box.set(new THREE.Vector3(attributes[0],attributes[1],attributes[2]),new THREE.Vector3(accessor[0],accessor[1],accessor[2]));primitiveDef=primitiveDef.targets;if(void 0!==primitiveDef){for(var maxDisplacement=new THREE.Vector3,vector=new THREE.Vector3,i=0,il=primitiveDef.length;i<il;i++)attributes=primitiveDef[i],void 0!==attributes.POSITION&&(accessor=parser.json.accessors[attributes.POSITION],attributes=accessor.min,accessor=accessor.max,void 0!==attributes&&void 0!==
accessor?(vector.setX(Math.max(Math.abs(attributes[0]),Math.abs(accessor[0]))),vector.setY(Math.max(Math.abs(attributes[1]),Math.abs(accessor[1]))),vector.setZ(Math.max(Math.abs(attributes[2]),Math.abs(accessor[2]))),maxDisplacement.max(vector)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."));box.expandByVector(maxDisplacement)}geometry.boundingBox=box;parser=new THREE.Sphere;box.getCenter(parser.center);parser.radius=box.min.distanceTo(box.max)/2;geometry.boundingSphere=
parser}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function addPrimitiveAttributes(geometry,primitiveDef,parser){function assignAttributeAccessor(accessorIndex,attributeName){return parser.getDependency("accessor",accessorIndex).then(function(accessor){geometry.setAttribute(attributeName,accessor)})}var attributes=primitiveDef.attributes,pending=[],gltfAttributeName;for(gltfAttributeName in attributes){var threeAttributeName=ATTRIBUTES[gltfAttributeName]||
gltfAttributeName.toLowerCase();threeAttributeName in geometry.attributes||pending.push(assignAttributeAccessor(attributes[gltfAttributeName],threeAttributeName))}void 0===primitiveDef.indices||geometry.index||(attributes=parser.getDependency("accessor",primitiveDef.indices).then(function(accessor){geometry.setIndex(accessor)}),pending.push(attributes));assignExtrasToUserData(geometry,primitiveDef);computeBounds(geometry,primitiveDef,parser);return Promise.all(pending).then(function(){return void 0!==
primitiveDef.targets?addMorphTargets(geometry,primitiveDef.targets,parser):geometry})}function toTrianglesDrawMode(geometry,drawMode){var index=geometry.getIndex();if(null===index){var indices=[];index=geometry.getAttribute("position");if(void 0!==index){for(var i=0;i<index.count;i++)indices.push(i);geometry.setIndex(indices);index=geometry.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),geometry}var numberOfTriangles=
index.count-2;indices=[];if(drawMode===THREE.TriangleFanDrawMode)for(i=1;i<=numberOfTriangles;i++)indices.push(index.getX(0)),indices.push(index.getX(i)),indices.push(index.getX(i+1));else for(i=0;i<numberOfTriangles;i++)0===i%2?(indices.push(index.getX(i)),indices.push(index.getX(i+1)),indices.push(index.getX(i+2))):(indices.push(index.getX(i+2)),indices.push(index.getX(i+1)),indices.push(index.getX(i)));indices.length/3!==numberOfTriangles&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");
geometry=geometry.clone();geometry.setIndex(indices);return geometry}GLTFLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:GLTFLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var resourcePath=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(url);this.manager.itemStart(url);var _onError=function(e){onError?onError(e):console.error(e);scope.manager.itemError(url);scope.manager.itemEnd(url)},loader=new THREE.FileLoader(this.manager);
loader.setPath(this.path);loader.setResponseType("arraybuffer");loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(this.withCredentials);loader.load(url,function(data){try{scope.parse(data,resourcePath,function(gltf){onLoad(gltf);scope.manager.itemEnd(url)},_onError)}catch(e$165){_onError(e$165)}},onProgress,_onError)},setDRACOLoader:function(dracoLoader){this.dracoLoader=dracoLoader;return this},setDDSLoader:function(ddsLoader){this.ddsLoader=ddsLoader;return this},setKTX2Loader:function(ktx2Loader){this.ktx2Loader=
ktx2Loader;return this},setMeshoptDecoder:function(meshoptDecoder){this.meshoptDecoder=meshoptDecoder;return this},register:function(callback){-1===this.pluginCallbacks.indexOf(callback)&&this.pluginCallbacks.push(callback);return this},unregister:function(callback){-1!==this.pluginCallbacks.indexOf(callback)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(callback),1);return this},parse:function(data,path,onLoad,onError){var extensions={},plugins={};if("string"!==typeof data)if(THREE.LoaderUtils.decodeText(new Uint8Array(data,
0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{extensions[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(data)}catch(error){onError&&onError(error);return}data=extensions[EXTENSIONS.KHR_BINARY_GLTF].content}else data=THREE.LoaderUtils.decodeText(new Uint8Array(data));data=JSON.parse(data);if(void 0===data.asset||2>data.asset.version[0])onError&&onError(Error("THREE.GLTFLoader: Unsupported asset. glTF versions \x3e\x3d2.0 are supported."));else{path=new GLTFParser(data,{path:path||this.resourcePath||
"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});path.fileLoader.setRequestHeader(this.requestHeader);for(var i=0;i<this.pluginCallbacks.length;i++){var plugin=this.pluginCallbacks[i](path);plugins[plugin.name]=plugin;extensions[plugin.name]=!0}if(data.extensionsUsed)for(i=0;i<data.extensionsUsed.length;++i){plugin=data.extensionsUsed[i];var extensionsRequired=data.extensionsRequired||[];switch(plugin){case EXTENSIONS.KHR_MATERIALS_UNLIT:extensions[plugin]=
new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:extensions[plugin]=new GLTFMaterialsPbrSpecularGlossinessExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:extensions[plugin]=new GLTFDracoMeshCompressionExtension(data,this.dracoLoader);break;case EXTENSIONS.MSFT_TEXTURE_DDS:extensions[plugin]=new GLTFTextureDDSExtension(this.ddsLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:extensions[plugin]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:extensions[plugin]=
new GLTFMeshQuantizationExtension;break;default:0<=extensionsRequired.indexOf(plugin)&&void 0===plugins[plugin]&&console.warn('THREE.GLTFLoader: Unknown extension "'+plugin+'".')}}path.setExtensions(extensions);path.setPlugins(plugins);path.parse(onLoad,onError)}}});var EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",
KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};GLTFLightsExtension.prototype._markDefs=function(){for(var parser=this.parser,nodeDefs=this.parser.json.nodes||[],nodeIndex=0,nodeLength=nodeDefs.length;nodeIndex<
nodeLength;nodeIndex++){var nodeDef=nodeDefs[nodeIndex];nodeDef.extensions&&nodeDef.extensions[this.name]&&void 0!==nodeDef.extensions[this.name].light&&parser._addNodeRef(this.cache,nodeDef.extensions[this.name].light)}};GLTFLightsExtension.prototype._loadLight=function(lightIndex){var parser=this.parser,cacheKey="light:"+lightIndex,dependency=parser.cache.get(cacheKey);if(dependency)return dependency;dependency=parser.json;dependency=((dependency.extensions&&dependency.extensions[this.name]||{}).lights||
[])[lightIndex];var lightNode=new THREE.Color(16777215);void 0!==dependency.color&&lightNode.fromArray(dependency.color);var range=void 0!==dependency.range?dependency.range:0;switch(dependency.type){case "directional":lightNode=new THREE.DirectionalLight(lightNode);lightNode.target.position.set(0,0,-1);lightNode.add(lightNode.target);break;case "point":lightNode=new THREE.PointLight(lightNode);lightNode.distance=range;break;case "spot":lightNode=new THREE.SpotLight(lightNode);lightNode.distance=
range;dependency.spot=dependency.spot||{};dependency.spot.innerConeAngle=void 0!==dependency.spot.innerConeAngle?dependency.spot.innerConeAngle:0;dependency.spot.outerConeAngle=void 0!==dependency.spot.outerConeAngle?dependency.spot.outerConeAngle:Math.PI/4;lightNode.angle=dependency.spot.outerConeAngle;lightNode.penumbra=1-dependency.spot.innerConeAngle/dependency.spot.outerConeAngle;lightNode.target.position.set(0,0,-1);lightNode.add(lightNode.target);break;default:throw Error('THREE.GLTFLoader: Unexpected light type, "'+
dependency.type+'".');}lightNode.position.set(0,0,0);lightNode.decay=2;void 0!==dependency.intensity&&(lightNode.intensity=dependency.intensity);lightNode.name=parser.createUniqueName(dependency.name||"light_"+lightIndex);dependency=Promise.resolve(lightNode);parser.cache.add(cacheKey,dependency);return dependency};GLTFLightsExtension.prototype.createNodeAttachment=function(nodeIndex){var self=this,parser=this.parser;nodeIndex=parser.json.nodes[nodeIndex];var lightIndex=(nodeIndex.extensions&&nodeIndex.extensions[this.name]||
{}).light;return void 0===lightIndex?null:this._loadLight(lightIndex).then(function(light){return parser._getNodeRef(self.cache,lightIndex,light)})};GLTFMaterialsUnlitExtension.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial};GLTFMaterialsUnlitExtension.prototype.extendParams=function(materialParams,materialDef,parser){var pending=[];materialParams.color=new THREE.Color(1,1,1);materialParams.opacity=1;if(materialDef=materialDef.pbrMetallicRoughness){if(Array.isArray(materialDef.baseColorFactor)){var array=
materialDef.baseColorFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3]}void 0!==materialDef.baseColorTexture&&pending.push(parser.assignTexture(materialParams,"map",materialDef.baseColorTexture))}return Promise.all(pending)};GLTFMaterialsClearcoatExtension.prototype.getMaterialType=function(materialIndex){materialIndex=this.parser.json.materials[materialIndex];return materialIndex.extensions&&materialIndex.extensions[this.name]?THREE.MeshPhysicalMaterial:null};GLTFMaterialsClearcoatExtension.prototype.extendMaterialParams=
function(materialIndex,materialParams){var parser=this.parser,materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return Promise.resolve();materialIndex=[];materialDef=materialDef.extensions[this.name];void 0!==materialDef.clearcoatFactor&&(materialParams.clearcoat=materialDef.clearcoatFactor);void 0!==materialDef.clearcoatTexture&&materialIndex.push(parser.assignTexture(materialParams,"clearcoatMap",materialDef.clearcoatTexture));void 0!==
materialDef.clearcoatRoughnessFactor&&(materialParams.clearcoatRoughness=materialDef.clearcoatRoughnessFactor);void 0!==materialDef.clearcoatRoughnessTexture&&materialIndex.push(parser.assignTexture(materialParams,"clearcoatRoughnessMap",materialDef.clearcoatRoughnessTexture));void 0!==materialDef.clearcoatNormalTexture&&(materialIndex.push(parser.assignTexture(materialParams,"clearcoatNormalMap",materialDef.clearcoatNormalTexture)),void 0!==materialDef.clearcoatNormalTexture.scale&&(parser=materialDef.clearcoatNormalTexture.scale,
materialParams.clearcoatNormalScale=new THREE.Vector2(parser,parser)));return Promise.all(materialIndex)};GLTFMaterialsTransmissionExtension.prototype.getMaterialType=function(materialIndex){materialIndex=this.parser.json.materials[materialIndex];return materialIndex.extensions&&materialIndex.extensions[this.name]?THREE.MeshPhysicalMaterial:null};GLTFMaterialsTransmissionExtension.prototype.extendMaterialParams=function(materialIndex,materialParams){var parser=this.parser,materialDef=parser.json.materials[materialIndex];
if(!materialDef.extensions||!materialDef.extensions[this.name])return Promise.resolve();materialIndex=[];materialDef=materialDef.extensions[this.name];void 0!==materialDef.transmissionFactor&&(materialParams.transmission=materialDef.transmissionFactor);void 0!==materialDef.transmissionTexture&&materialIndex.push(parser.assignTexture(materialParams,"transmissionMap",materialDef.transmissionTexture));return Promise.all(materialIndex)};GLTFTextureBasisUExtension.prototype.loadTexture=function(textureIndex){var parser=
this.parser,json=parser.json,textureDef=json.textures[textureIndex];if(!textureDef.extensions||!textureDef.extensions[this.name])return null;textureDef=json.images[textureDef.extensions[this.name].source];var loader=parser.options.ktx2Loader;if(!loader){if(json.extensionsRequired&&0<=json.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return parser.loadTextureImage(textureIndex,textureDef,loader)};GLTFTextureWebPExtension.prototype.loadTexture=
function(textureIndex){var name=this.name,parser=this.parser,json=parser.json,textureDef=json.textures[textureIndex];if(!textureDef.extensions||!textureDef.extensions[name])return null;var source=json.images[textureDef.extensions[name].source],loader=source.uri?parser.options.manager.getHandler(source.uri):parser.textureLoader;return this.detectSupport().then(function(isSupported){if(isSupported)return parser.loadTextureImage(textureIndex,source,loader);if(json.extensionsRequired&&0<=json.extensionsRequired.indexOf(name))throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");
return parser.loadTexture(textureIndex)})};GLTFTextureWebPExtension.prototype.detectSupport=function(){this.isSupported||(this.isSupported=new Promise(function(resolve){var image=new Image;image.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";image.onload=image.onerror=function(){resolve(1===image.height)}}));return this.isSupported};GLTFMeshoptCompression.prototype.loadBufferView=function(index){var json=this.parser.json;index=json.bufferViews[index];if(index.extensions&&
index.extensions[this.name]){var extensionDef=index.extensions[this.name];index=this.parser.getDependency("buffer",extensionDef.buffer);var decoder=this.parser.options.meshoptDecoder;if(!decoder||!decoder.supported){if(json.extensionsRequired&&0<=json.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([index,decoder.ready]).then(function(res){var byteOffset=extensionDef.byteOffset||
0,byteLength=extensionDef.byteLength||0,count=extensionDef.count,stride=extensionDef.byteStride,result=new ArrayBuffer(count*stride);res=new Uint8Array(res[0],byteOffset,byteLength);decoder.decodeGltfBuffer(new Uint8Array(result),count,stride,res,extensionDef.mode,extensionDef.filter);return result})}return null};var BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};GLTFDracoMeshCompressionExtension.prototype.decodePrimitive=
function(primitive,parser){var json=this.json,dracoLoader=this.dracoLoader,bufferViewIndex=primitive.extensions[this.name].bufferView,gltfAttributeMap=primitive.extensions[this.name].attributes,threeAttributeMap={},attributeNormalizedMap={},attributeTypeMap={},attributeName$jscomp$0;for(attributeName$jscomp$0 in gltfAttributeMap){var threeAttributeName=ATTRIBUTES[attributeName$jscomp$0]||attributeName$jscomp$0.toLowerCase();threeAttributeMap[threeAttributeName]=gltfAttributeMap[attributeName$jscomp$0]}for(attributeName$jscomp$0 in primitive.attributes)if(threeAttributeName=
ATTRIBUTES[attributeName$jscomp$0]||attributeName$jscomp$0.toLowerCase(),void 0!==gltfAttributeMap[attributeName$jscomp$0]){var accessorDef=json.accessors[primitive.attributes[attributeName$jscomp$0]];attributeTypeMap[threeAttributeName]=WEBGL_COMPONENT_TYPES[accessorDef.componentType];attributeNormalizedMap[threeAttributeName]=!0===accessorDef.normalized}return parser.getDependency("bufferView",bufferViewIndex).then(function(bufferView){return new Promise(function(resolve){dracoLoader.decodeDracoFile(bufferView,
function(geometry){for(var attributeName in geometry.attributes){var attribute=geometry.attributes[attributeName],normalized=attributeNormalizedMap[attributeName];void 0!==normalized&&(attribute.normalized=normalized)}resolve(geometry)},threeAttributeMap,attributeTypeMap)})})};GLTFTextureTransformExtension.prototype.extendTexture=function(texture,transform){texture=texture.clone();void 0!==transform.offset&&texture.offset.fromArray(transform.offset);void 0!==transform.rotation&&(texture.rotation=
transform.rotation);void 0!==transform.scale&&texture.repeat.fromArray(transform.scale);void 0!==transform.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.');texture.needsUpdate=!0;return texture};GLTFMeshStandardSGMaterial.prototype=Object.create(THREE.MeshStandardMaterial.prototype);GLTFMeshStandardSGMaterial.prototype.constructor=GLTFMeshStandardSGMaterial;GLTFMeshStandardSGMaterial.prototype.copy=function(source){THREE.MeshStandardMaterial.prototype.copy.call(this,
source);this.specularMap=source.specularMap;this.specular.copy(source.specular);this.glossinessMap=source.glossinessMap;this.glossiness=source.glossiness;delete this.metalness;delete this.roughness;delete this.metalnessMap;delete this.roughnessMap;return this};GLTFCubicSplineInterpolant.prototype=Object.create(THREE.Interpolant.prototype);GLTFCubicSplineInterpolant.prototype.constructor=GLTFCubicSplineInterpolant;GLTFCubicSplineInterpolant.prototype.copySampleValue_=function(index){var result=this.resultBuffer,
values=this.sampleValues,valueSize=this.valueSize;index=index*valueSize*3+valueSize;for(var i=0;i!==valueSize;i++)result[i]=values[index+i];return result};GLTFCubicSplineInterpolant.prototype.beforeStart_=GLTFCubicSplineInterpolant.prototype.copySampleValue_;GLTFCubicSplineInterpolant.prototype.afterEnd_=GLTFCubicSplineInterpolant.prototype.copySampleValue_;GLTFCubicSplineInterpolant.prototype.interpolate_=function(i1,t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize,
stride2=2*stride,stride3=3*stride;t1-=t0;t0=(t-t0)/t1;t=t0*t0;var ppp=t*t0;i1*=stride3;stride3=i1-stride3;var s2=-2*ppp+3*t;ppp-=t;var s0=1-s2;t0=ppp-t+t0;for(t=0;t!==stride;t++)result[t]=s0*values[stride3+t+stride]+t0*values[stride3+t+stride2]*t1+s2*values[i1+t+stride]+ppp*values[i1+t]*t1;return result};var WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,
9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",
rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete};GLTFParser.prototype.setExtensions=function(extensions){this.extensions=extensions};GLTFParser.prototype.setPlugins=function(plugins){this.plugins=plugins};GLTFParser.prototype.parse=function(onLoad,onError){var parser=this,json=this.json,extensions=this.extensions;this.cache.removeAll();this._invokeAll(function(ext){return ext._markDefs&&ext._markDefs()});
Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(dependencies){dependencies={scene:dependencies[0][json.scene||0],scenes:dependencies[0],animations:dependencies[1],cameras:dependencies[2],asset:json.asset,parser:parser,userData:{}};addUnknownExtensionsToUserData(extensions,dependencies,json);assignExtrasToUserData(dependencies,json);onLoad(dependencies)}).catch(onError)};GLTFParser.prototype._markDefs=function(){for(var nodeDefs=
this.json.nodes||[],skinDefs=this.json.skins||[],meshDefs=this.json.meshes||[],skinIndex=0,skinLength=skinDefs.length;skinIndex<skinLength;skinIndex++)for(var joints=skinDefs[skinIndex].joints,i=0,il=joints.length;i<il;i++)nodeDefs[joints[i]].isBone=!0;skinDefs=0;for(skinIndex=nodeDefs.length;skinDefs<skinIndex;skinDefs++)skinLength=nodeDefs[skinDefs],void 0!==skinLength.mesh&&(this._addNodeRef(this.meshCache,skinLength.mesh),void 0!==skinLength.skin&&(meshDefs[skinLength.mesh].isSkinnedMesh=!0)),
void 0!==skinLength.camera&&this._addNodeRef(this.cameraCache,skinLength.camera)};GLTFParser.prototype._addNodeRef=function(cache,index){void 0!==index&&(void 0===cache.refs[index]&&(cache.refs[index]=cache.uses[index]=0),cache.refs[index]++)};GLTFParser.prototype._getNodeRef=function(cache,index,object){if(1>=cache.refs[index])return object;object=object.clone();object.name+="_instance_"+cache.uses[index]++;return object};GLTFParser.prototype._invokeOne=function(func){var extensions=Object.values(this.plugins);
extensions.push(this);for(var i=0;i<extensions.length;i++){var result=func(extensions[i]);if(result)return result}};GLTFParser.prototype._invokeAll=function(func){var extensions=Object.values(this.plugins);extensions.unshift(this);for(var pending=[],i=0;i<extensions.length;i++){var result=func(extensions[i]);result&&pending.push(result)}return pending};GLTFParser.prototype.getDependency=function(type,index){var cacheKey=type+":"+index,dependency=this.cache.get(cacheKey);if(!dependency){switch(type){case "scene":dependency=
this.loadScene(index);break;case "node":dependency=this.loadNode(index);break;case "mesh":dependency=this._invokeOne(function(ext){return ext.loadMesh&&ext.loadMesh(index)});break;case "accessor":dependency=this.loadAccessor(index);break;case "bufferView":dependency=this._invokeOne(function(ext){return ext.loadBufferView&&ext.loadBufferView(index)});break;case "buffer":dependency=this.loadBuffer(index);break;case "material":dependency=this._invokeOne(function(ext){return ext.loadMaterial&&ext.loadMaterial(index)});
break;case "texture":dependency=this._invokeOne(function(ext){return ext.loadTexture&&ext.loadTexture(index)});break;case "skin":dependency=this.loadSkin(index);break;case "animation":dependency=this.loadAnimation(index);break;case "camera":dependency=this.loadCamera(index);break;default:throw Error("Unknown type: "+type);}this.cache.add(cacheKey,dependency)}return dependency};GLTFParser.prototype.getDependencies=function(type){var dependencies=this.cache.get(type);if(!dependencies){var parser=this;
dependencies=Promise.all((this.json[type+("mesh"===type?"es":"s")]||[]).map(function(def,index){return parser.getDependency(type,index)}));this.cache.add(type,dependencies)}return dependencies};GLTFParser.prototype.loadBuffer=function(bufferIndex){var bufferDef=this.json.buffers[bufferIndex],loader=this.fileLoader;if(bufferDef.type&&"arraybuffer"!==bufferDef.type)throw Error("THREE.GLTFLoader: "+bufferDef.type+" buffer type is not supported.");if(void 0===bufferDef.uri&&0===bufferIndex)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);
var options=this.options;return new Promise(function(resolve,reject){loader.load(resolveURL(bufferDef.uri,options.path),resolve,void 0,function(){reject(Error('THREE.GLTFLoader: Failed to load buffer "'+bufferDef.uri+'".'))})})};GLTFParser.prototype.loadBufferView=function(bufferViewIndex){var bufferViewDef=this.json.bufferViews[bufferViewIndex];return this.getDependency("buffer",bufferViewDef.buffer).then(function(buffer){var byteOffset=bufferViewDef.byteOffset||0;return buffer.slice(byteOffset,
byteOffset+(bufferViewDef.byteLength||0))})};GLTFParser.prototype.loadAccessor=function(accessorIndex){var parser=this,json=this.json,accessorDef=this.json.accessors[accessorIndex];if(void 0===accessorDef.bufferView&&void 0===accessorDef.sparse)return Promise.resolve(null);accessorIndex=[];void 0!==accessorDef.bufferView?accessorIndex.push(this.getDependency("bufferView",accessorDef.bufferView)):accessorIndex.push(null);void 0!==accessorDef.sparse&&(accessorIndex.push(this.getDependency("bufferView",
accessorDef.sparse.indices.bufferView)),accessorIndex.push(this.getDependency("bufferView",accessorDef.sparse.values.bufferView)));return Promise.all(accessorIndex).then(function(bufferViews){var bufferView=bufferViews[0],itemSize=WEBGL_TYPE_SIZES[accessorDef.type],TypedArray=WEBGL_COMPONENT_TYPES[accessorDef.componentType],elementBytes=TypedArray.BYTES_PER_ELEMENT,byteOffset=accessorDef.byteOffset||0,byteStride=void 0!==accessorDef.bufferView?json.bufferViews[accessorDef.bufferView].byteStride:void 0,
normalized=!0===accessorDef.normalized;if(byteStride&&byteStride!==elementBytes*itemSize){var array=Math.floor(byteOffset/byteStride);var ibCacheKey="InterleavedBuffer:"+accessorDef.bufferView+":"+accessorDef.componentType+":"+array+":"+accessorDef.count,ib=parser.cache.get(ibCacheKey);ib||(array=new TypedArray(bufferView,array*byteStride,accessorDef.count*byteStride/elementBytes),ib=new THREE.InterleavedBuffer(array,byteStride/elementBytes),parser.cache.add(ibCacheKey,ib));elementBytes=new THREE.InterleavedBufferAttribute(ib,
itemSize,byteOffset%byteStride/elementBytes,normalized)}else array=null===bufferView?new TypedArray(accessorDef.count*itemSize):new TypedArray(bufferView,byteOffset,accessorDef.count*itemSize),elementBytes=new THREE.BufferAttribute(array,itemSize,normalized);if(void 0!==accessorDef.sparse)for(byteStride=accessorDef.sparse.values.byteOffset||0,byteOffset=new WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType](bufferViews[1],accessorDef.sparse.indices.byteOffset||0,accessorDef.sparse.count*
WEBGL_TYPE_SIZES.SCALAR),bufferViews=new TypedArray(bufferViews[2],byteStride,accessorDef.sparse.count*itemSize),null!==bufferView&&(elementBytes=new THREE.BufferAttribute(elementBytes.array.slice(),elementBytes.itemSize,elementBytes.normalized)),bufferView=0,TypedArray=byteOffset.length;bufferView<TypedArray;bufferView++)if(byteStride=byteOffset[bufferView],elementBytes.setX(byteStride,bufferViews[bufferView*itemSize]),2<=itemSize&&elementBytes.setY(byteStride,bufferViews[bufferView*itemSize+1]),
3<=itemSize&&elementBytes.setZ(byteStride,bufferViews[bufferView*itemSize+2]),4<=itemSize&&elementBytes.setW(byteStride,bufferViews[bufferView*itemSize+3]),5<=itemSize)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.");return elementBytes})};GLTFParser.prototype.loadTexture=function(textureIndex){var json=this.json,options=this.options,textureDef=json.textures[textureIndex],textureExtensions=textureDef.extensions||{};json=textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]?
json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source]:json.images[textureDef.source];var loader;json.uri&&(loader=options.manager.getHandler(json.uri));loader||(loader=textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]?this.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader);return this.loadTextureImage(textureIndex,json,loader)};GLTFParser.prototype.loadTextureImage=function(textureIndex,source,loader){var parser=this,json=this.json,options=this.options,textureDef=json.textures[textureIndex],
URL=self.URL||self.webkitURL,sourceURI=source.uri,isObjectURL=!1,hasAlpha=!0;"image/jpeg"===source.mimeType&&(hasAlpha=!1);void 0!==source.bufferView&&(sourceURI=parser.getDependency("bufferView",source.bufferView).then(function(bufferView){if("image/png"===source.mimeType){var colorType=(new DataView(bufferView,25,1)).getUint8(0,!1);hasAlpha=6===colorType||4===colorType||3===colorType}isObjectURL=!0;bufferView=new Blob([bufferView],{type:source.mimeType});return sourceURI=URL.createObjectURL(bufferView)}));
return Promise.resolve(sourceURI).then(function(sourceURI){return new Promise(function(resolve,reject){var onLoad=resolve;!0===loader.isImageBitmapLoader&&(onLoad=function(imageBitmap){resolve(new THREE.CanvasTexture(imageBitmap))});loader.load(resolveURL(sourceURI,options.path),onLoad,void 0,reject)})}).then(function(texture){!0===isObjectURL&&URL.revokeObjectURL(sourceURI);texture.flipY=!1;textureDef.name&&(texture.name=textureDef.name);hasAlpha||(texture.format=THREE.RGBFormat);var sampler=(json.samplers||
{})[textureDef.sampler]||{};texture.magFilter=WEBGL_FILTERS[sampler.magFilter]||THREE.LinearFilter;texture.minFilter=WEBGL_FILTERS[sampler.minFilter]||THREE.LinearMipmapLinearFilter;texture.wrapS=WEBGL_WRAPPINGS[sampler.wrapS]||THREE.RepeatWrapping;texture.wrapT=WEBGL_WRAPPINGS[sampler.wrapT]||THREE.RepeatWrapping;parser.associations.set(texture,{type:"textures",index:textureIndex});return texture})};GLTFParser.prototype.assignTexture=function(materialParams,mapName,mapDef){var parser=this;return this.getDependency("texture",
mapDef.index).then(function(texture){void 0===mapDef.texCoord||0==mapDef.texCoord||"aoMap"===mapName&&1==mapDef.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+mapDef.texCoord+" for texture "+mapName+" not yet supported.");if(parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){var transform=void 0!==mapDef.extensions?mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(transform){var gltfReference=parser.associations.get(texture);texture=parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(texture,
transform);parser.associations.set(texture,gltfReference)}}materialParams[mapName]=texture})};GLTFParser.prototype.assignFinalMaterial=function(mesh){var geometry=mesh.geometry,material=mesh.material,useVertexTangents=void 0!==geometry.attributes.tangent,useVertexColors=void 0!==geometry.attributes.color,useFlatShading=void 0===geometry.attributes.normal,useSkinning=!0===mesh.isSkinnedMesh,useMorphTargets=0<Object.keys(geometry.morphAttributes).length,useMorphNormals=useMorphTargets&&void 0!==geometry.morphAttributes.normal;
if(mesh.isPoints){var cacheKey="PointsMaterial:"+material.uuid,pointsMaterial=this.cache.get(cacheKey);pointsMaterial||(pointsMaterial=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(pointsMaterial,material),pointsMaterial.color.copy(material.color),pointsMaterial.map=material.map,pointsMaterial.sizeAttenuation=!1,this.cache.add(cacheKey,pointsMaterial));material=pointsMaterial}else mesh.isLine&&(cacheKey="LineBasicMaterial:"+material.uuid,pointsMaterial=this.cache.get(cacheKey),pointsMaterial||
(pointsMaterial=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(pointsMaterial,material),pointsMaterial.color.copy(material.color),this.cache.add(cacheKey,pointsMaterial)),material=pointsMaterial);if(useVertexTangents||useVertexColors||useFlatShading||useSkinning||useMorphTargets)cacheKey="ClonedMaterial:"+material.uuid+":",material.isGLTFSpecularGlossinessMaterial&&(cacheKey+="specular-glossiness:"),useSkinning&&(cacheKey+="skinning:"),useVertexTangents&&(cacheKey+="vertex-tangents:"),
useVertexColors&&(cacheKey+="vertex-colors:"),useFlatShading&&(cacheKey+="flat-shading:"),useMorphTargets&&(cacheKey+="morph-targets:"),useMorphNormals&&(cacheKey+="morph-normals:"),pointsMaterial=this.cache.get(cacheKey),pointsMaterial||(pointsMaterial=material.clone(),useSkinning&&(pointsMaterial.skinning=!0),useVertexTangents&&(pointsMaterial.vertexTangents=!0),useVertexColors&&(pointsMaterial.vertexColors=!0),useFlatShading&&(pointsMaterial.flatShading=!0),useMorphTargets&&(pointsMaterial.morphTargets=
!0),useMorphNormals&&(pointsMaterial.morphNormals=!0),this.cache.add(cacheKey,pointsMaterial),this.associations.set(pointsMaterial,this.associations.get(material))),material=pointsMaterial;material.aoMap&&void 0===geometry.attributes.uv2&&void 0!==geometry.attributes.uv&&geometry.setAttribute("uv2",geometry.attributes.uv);material.normalScale&&!useVertexTangents&&(material.normalScale.y=-material.normalScale.y);material.clearcoatNormalScale&&!useVertexTangents&&(material.clearcoatNormalScale.y=-material.clearcoatNormalScale.y);
mesh.material=material};GLTFParser.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial};GLTFParser.prototype.loadMaterial=function(materialIndex){var parser=this,extensions=this.extensions,materialDef=this.json.materials[materialIndex],materialParams={},materialExtensions=materialDef.extensions||{},pending=[];if(materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){materialExtensions=extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];var materialType=materialExtensions.getMaterialType();
pending.push(materialExtensions.extendParams(materialParams,materialDef,parser))}else if(materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT])materialExtensions=extensions[EXTENSIONS.KHR_MATERIALS_UNLIT],materialType=materialExtensions.getMaterialType(),pending.push(materialExtensions.extendParams(materialParams,materialDef,parser));else{materialExtensions=materialDef.pbrMetallicRoughness||{};materialParams.color=new THREE.Color(1,1,1);materialParams.opacity=1;if(Array.isArray(materialExtensions.baseColorFactor)){var array=
materialExtensions.baseColorFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3]}void 0!==materialExtensions.baseColorTexture&&pending.push(parser.assignTexture(materialParams,"map",materialExtensions.baseColorTexture));materialParams.metalness=void 0!==materialExtensions.metallicFactor?materialExtensions.metallicFactor:1;materialParams.roughness=void 0!==materialExtensions.roughnessFactor?materialExtensions.roughnessFactor:1;void 0!==materialExtensions.metallicRoughnessTexture&&
(pending.push(parser.assignTexture(materialParams,"metalnessMap",materialExtensions.metallicRoughnessTexture)),pending.push(parser.assignTexture(materialParams,"roughnessMap",materialExtensions.metallicRoughnessTexture)));materialType=this._invokeOne(function(ext){return ext.getMaterialType&&ext.getMaterialType(materialIndex)});pending.push(Promise.all(this._invokeAll(function(ext){return ext.extendMaterialParams&&ext.extendMaterialParams(materialIndex,materialParams)})))}!0===materialDef.doubleSided&&
(materialParams.side=THREE.DoubleSide);materialExtensions=materialDef.alphaMode||"OPAQUE";"BLEND"===materialExtensions?(materialParams.transparent=!0,materialParams.depthWrite=!1):(materialParams.transparent=!1,"MASK"===materialExtensions&&(materialParams.alphaTest=void 0!==materialDef.alphaCutoff?materialDef.alphaCutoff:.5));void 0!==materialDef.normalTexture&&materialType!==THREE.MeshBasicMaterial&&(pending.push(parser.assignTexture(materialParams,"normalMap",materialDef.normalTexture)),materialParams.normalScale=
new THREE.Vector2(1,1),void 0!==materialDef.normalTexture.scale&&materialParams.normalScale.set(materialDef.normalTexture.scale,materialDef.normalTexture.scale));void 0!==materialDef.occlusionTexture&&materialType!==THREE.MeshBasicMaterial&&(pending.push(parser.assignTexture(materialParams,"aoMap",materialDef.occlusionTexture)),void 0!==materialDef.occlusionTexture.strength&&(materialParams.aoMapIntensity=materialDef.occlusionTexture.strength));void 0!==materialDef.emissiveFactor&&materialType!==
THREE.MeshBasicMaterial&&(materialParams.emissive=(new THREE.Color).fromArray(materialDef.emissiveFactor));void 0!==materialDef.emissiveTexture&&materialType!==THREE.MeshBasicMaterial&&pending.push(parser.assignTexture(materialParams,"emissiveMap",materialDef.emissiveTexture));return Promise.all(pending).then(function(){var material=materialType===GLTFMeshStandardSGMaterial?extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams):new materialType(materialParams);
materialDef.name&&(material.name=materialDef.name);material.map&&(material.map.encoding=THREE.sRGBEncoding);material.emissiveMap&&(material.emissiveMap.encoding=THREE.sRGBEncoding);assignExtrasToUserData(material,materialDef);parser.associations.set(material,{type:"materials",index:materialIndex});materialDef.extensions&&addUnknownExtensionsToUserData(extensions,material,materialDef);return material})};GLTFParser.prototype.createUniqueName=function(originalName){for(var name=THREE.PropertyBinding.sanitizeNodeName(originalName||
""),i=1;this.nodeNamesUsed[name];++i)name=originalName+"_"+i;this.nodeNamesUsed[name]=!0;return name};GLTFParser.prototype.loadGeometries=function(primitives){function createDracoPrimitive(primitive){return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(primitive,parser).then(function(geometry){return addPrimitiveAttributes(geometry,primitive,parser)})}for(var parser=this,extensions=this.extensions,cache=this.primitiveCache,pending=[],i=0,il=primitives.length;i<il;i++){var primitive$jscomp$0=
primitives[i],cacheKey=createPrimitiveKey(primitive$jscomp$0),cached=cache[cacheKey];cached?pending.push(cached.promise):(cached=primitive$jscomp$0.extensions&&primitive$jscomp$0.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?createDracoPrimitive(primitive$jscomp$0):addPrimitiveAttributes(new THREE.BufferGeometry,primitive$jscomp$0,parser),cache[cacheKey]={primitive:primitive$jscomp$0,promise:cached},pending.push(cached))}return Promise.all(pending)};GLTFParser.prototype.loadMesh=function(meshIndex){for(var parser=
this,extensions=this.extensions,meshDef$jscomp$0=this.json.meshes[meshIndex],primitives=meshDef$jscomp$0.primitives,pending=[],i$jscomp$1=0,il$jscomp$1=primitives.length;i$jscomp$1<il$jscomp$1;i$jscomp$1++){var material$jscomp$0=void 0===primitives[i$jscomp$1].material?createDefaultMaterial(this.cache):this.getDependency("material",primitives[i$jscomp$1].material);pending.push(material$jscomp$0)}pending.push(parser.loadGeometries(primitives));return Promise.all(pending).then(function(results){var materials=
results.slice(0,results.length-1),geometries=results[results.length-1];results=[];for(var i=0,il=geometries.length;i<il;i++){var geometry=geometries[i],primitive=primitives[i],material=materials[i];if(4===primitive.mode||5===primitive.mode||6===primitive.mode||void 0===primitive.mode)geometry=!0===meshDef$jscomp$0.isSkinnedMesh?new THREE.SkinnedMesh(geometry,material):new THREE.Mesh(geometry,material),!0!==geometry.isSkinnedMesh||geometry.geometry.attributes.skinWeight.normalized||geometry.normalizeSkinWeights(),
5===primitive.mode?geometry.geometry=toTrianglesDrawMode(geometry.geometry,THREE.TriangleStripDrawMode):6===primitive.mode&&(geometry.geometry=toTrianglesDrawMode(geometry.geometry,THREE.TriangleFanDrawMode));else if(1===primitive.mode)geometry=new THREE.LineSegments(geometry,material);else if(3===primitive.mode)geometry=new THREE.Line(geometry,material);else if(2===primitive.mode)geometry=new THREE.LineLoop(geometry,material);else if(0===primitive.mode)geometry=new THREE.Points(geometry,material);
else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+primitive.mode);if(0<Object.keys(geometry.geometry.morphAttributes).length){material=geometry;var meshDef=meshDef$jscomp$0;material.updateMorphTargets();if(void 0!==meshDef.weights)for(var i$jscomp$0=0,il$jscomp$0=meshDef.weights.length;i$jscomp$0<il$jscomp$0;i$jscomp$0++)material.morphTargetInfluences[i$jscomp$0]=meshDef.weights[i$jscomp$0];if(meshDef.extras&&Array.isArray(meshDef.extras.targetNames))if(meshDef=meshDef.extras.targetNames,
material.morphTargetInfluences.length===meshDef.length)for(material.morphTargetDictionary={},i$jscomp$0=0,il$jscomp$0=meshDef.length;i$jscomp$0<il$jscomp$0;i$jscomp$0++)material.morphTargetDictionary[meshDef[i$jscomp$0]]=i$jscomp$0;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}geometry.name=parser.createUniqueName(meshDef$jscomp$0.name||"mesh_"+meshIndex);assignExtrasToUserData(geometry,meshDef$jscomp$0);primitive.extensions&&addUnknownExtensionsToUserData(extensions,
geometry,primitive);parser.assignFinalMaterial(geometry);results.push(geometry)}if(1===results.length)return results[0];materials=new THREE.Group;i=0;for(il=results.length;i<il;i++)materials.add(results[i]);return materials})};GLTFParser.prototype.loadCamera=function(cameraIndex){var camera;cameraIndex=this.json.cameras[cameraIndex];var params=cameraIndex[cameraIndex.type];if(params)return"perspective"===cameraIndex.type?camera=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(params.yfov),params.aspectRatio||
1,params.znear||1,params.zfar||2E6):"orthographic"===cameraIndex.type&&(camera=new THREE.OrthographicCamera(-params.xmag,params.xmag,params.ymag,-params.ymag,params.znear,params.zfar)),cameraIndex.name&&(camera.name=this.createUniqueName(cameraIndex.name)),assignExtrasToUserData(camera,cameraIndex),Promise.resolve(camera);console.warn("THREE.GLTFLoader: Missing camera parameters.")};GLTFParser.prototype.loadSkin=function(skinIndex){skinIndex=this.json.skins[skinIndex];var skinEntry={joints:skinIndex.joints};
return void 0===skinIndex.inverseBindMatrices?Promise.resolve(skinEntry):this.getDependency("accessor",skinIndex.inverseBindMatrices).then(function(accessor){skinEntry.inverseBindMatrices=accessor;return skinEntry})};GLTFParser.prototype.loadAnimation=function(animationIndex){for(var animationDef=this.json.animations[animationIndex],pendingNodes=[],pendingInputAccessors=[],pendingOutputAccessors=[],pendingSamplers=[],pendingTargets=[],i$jscomp$0=0,il$jscomp$0=animationDef.channels.length;i$jscomp$0<
il$jscomp$0;i$jscomp$0++){var channel=animationDef.channels[i$jscomp$0],sampler$jscomp$0=animationDef.samplers[channel.sampler];channel=channel.target;var input=void 0!==animationDef.parameters?animationDef.parameters[sampler$jscomp$0.input]:sampler$jscomp$0.input,output=void 0!==animationDef.parameters?animationDef.parameters[sampler$jscomp$0.output]:sampler$jscomp$0.output;pendingNodes.push(this.getDependency("node",void 0!==channel.node?channel.node:channel.id));pendingInputAccessors.push(this.getDependency("accessor",
input));pendingOutputAccessors.push(this.getDependency("accessor",output));pendingSamplers.push(sampler$jscomp$0);pendingTargets.push(channel)}return Promise.all([Promise.all(pendingNodes),Promise.all(pendingInputAccessors),Promise.all(pendingOutputAccessors),Promise.all(pendingSamplers),Promise.all(pendingTargets)]).then(function(dependencies){var nodes=dependencies[0],inputAccessors=dependencies[1],outputAccessors=dependencies[2],samplers=dependencies[3];dependencies=dependencies[4];for(var tracks=
[],i=0,il=nodes.length;i<il;i++){var node=nodes[i],inputAccessor=inputAccessors[i],outputAccessor=outputAccessors[i],sampler=samplers[i],target=dependencies[i];if(void 0!==node){node.updateMatrix();node.matrixAutoUpdate=!0;switch(PATH_PROPERTIES[target.path]){case PATH_PROPERTIES.weights:var TypedKeyframeTrack=THREE.NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:TypedKeyframeTrack=THREE.QuaternionKeyframeTrack;break;default:TypedKeyframeTrack=THREE.VectorKeyframeTrack}var targetName=node.name?
node.name:node.uuid,interpolation=void 0!==sampler.interpolation?INTERPOLATION[sampler.interpolation]:THREE.InterpolateLinear,targetNames=[];PATH_PROPERTIES[target.path]===PATH_PROPERTIES.weights?node.traverse(function(object){!0===object.isMesh&&object.morphTargetInfluences&&targetNames.push(object.name?object.name:object.uuid)}):targetNames.push(targetName);node=outputAccessor.array;if(outputAccessor.normalized){if(node.constructor===Int8Array)var scale=1/127;else if(node.constructor===Uint8Array)scale=
1/255;else if(node.constructor==Int16Array)scale=1/32767;else if(node.constructor===Uint16Array)scale=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");var scaled=new Float32Array(node.length);outputAccessor=0;for(targetName=node.length;outputAccessor<targetName;outputAccessor++)scaled[outputAccessor]=node[outputAccessor]*scale;node=scaled}outputAccessor=0;for(targetName=targetNames.length;outputAccessor<targetName;outputAccessor++)scale=new TypedKeyframeTrack(targetNames[outputAccessor]+
"."+PATH_PROPERTIES[target.path],inputAccessor.array,node,interpolation),"CUBICSPLINE"===sampler.interpolation&&(scale.createInterpolant=function(result){return new GLTFCubicSplineInterpolant(this.times,this.values,this.getValueSize()/3,result)},scale.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),tracks.push(scale)}}return new THREE.AnimationClip(animationDef.name?animationDef.name:"animation_"+animationIndex,void 0,tracks)})};GLTFParser.prototype.loadNode=function(nodeIndex){var extensions=
this.extensions,parser=this,nodeDef=this.json.nodes[nodeIndex],nodeName=nodeDef.name?parser.createUniqueName(nodeDef.name):"";return function(){var pending=[];void 0!==nodeDef.mesh&&pending.push(parser.getDependency("mesh",nodeDef.mesh).then(function(mesh){mesh=parser._getNodeRef(parser.meshCache,nodeDef.mesh,mesh);void 0!==nodeDef.weights&&mesh.traverse(function(o){if(o.isMesh)for(var i=0,il=nodeDef.weights.length;i<il;i++)o.morphTargetInfluences[i]=nodeDef.weights[i]});return mesh}));void 0!==nodeDef.camera&&
pending.push(parser.getDependency("camera",nodeDef.camera).then(function(camera){return parser._getNodeRef(parser.cameraCache,nodeDef.camera,camera)}));parser._invokeAll(function(ext){return ext.createNodeAttachment&&ext.createNodeAttachment(nodeIndex)}).forEach(function(promise){pending.push(promise)});return Promise.all(pending)}().then(function(objects){var node=!0===nodeDef.isBone?new THREE.Bone:1<objects.length?new THREE.Group:1===objects.length?objects[0]:new THREE.Object3D;if(node!==objects[0])for(var i=
0,il=objects.length;i<il;i++)node.add(objects[i]);nodeDef.name&&(node.userData.name=nodeDef.name,node.name=nodeName);assignExtrasToUserData(node,nodeDef);nodeDef.extensions&&addUnknownExtensionsToUserData(extensions,node,nodeDef);void 0!==nodeDef.matrix?(objects=new THREE.Matrix4,objects.fromArray(nodeDef.matrix),node.applyMatrix4(objects)):(void 0!==nodeDef.translation&&node.position.fromArray(nodeDef.translation),void 0!==nodeDef.rotation&&node.quaternion.fromArray(nodeDef.rotation),void 0!==nodeDef.scale&&
node.scale.fromArray(nodeDef.scale));parser.associations.set(node,{type:"nodes",index:nodeIndex});return node})};GLTFParser.prototype.loadScene=function(){function buildNodeHierachy(nodeId,parentObject,json,parser){var nodeDef=json.nodes[nodeId];return parser.getDependency("node",nodeId).then(function(node){if(void 0===nodeDef.skin)return node;var skinEntry;return parser.getDependency("skin",nodeDef.skin).then(function(skin){skinEntry=skin;skin=[];for(var i=0,il=skinEntry.joints.length;i<il;i++)skin.push(parser.getDependency("node",
skinEntry.joints[i]));return Promise.all(skin)}).then(function(jointNodes){node.traverse(function(mesh){if(mesh.isMesh){for(var bones=[],boneInverses=[],j=0,jl=jointNodes.length;j<jl;j++){var jointNode=jointNodes[j];jointNode?(bones.push(jointNode),jointNode=new THREE.Matrix4,void 0!==skinEntry.inverseBindMatrices&&jointNode.fromArray(skinEntry.inverseBindMatrices.array,16*j),boneInverses.push(jointNode)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',skinEntry.joints[j])}mesh.bind(new THREE.Skeleton(bones,
boneInverses),mesh.matrixWorld)}});return node})}).then(function(node){parentObject.add(node);var pending=[];if(nodeDef.children)for(var children=nodeDef.children,i=0,il=children.length;i<il;i++)pending.push(buildNodeHierachy(children[i],node,json,parser));return Promise.all(pending)})}return function(sceneIndex){var json=this.json,extensions=this.extensions;sceneIndex=this.json.scenes[sceneIndex];var scene=new THREE.Group;sceneIndex.name&&(scene.name=this.createUniqueName(sceneIndex.name));assignExtrasToUserData(scene,
sceneIndex);sceneIndex.extensions&&addUnknownExtensionsToUserData(extensions,scene,sceneIndex);extensions=sceneIndex.nodes||[];sceneIndex=[];for(var i=0,il=extensions.length;i<il;i++)sceneIndex.push(buildNodeHierachy(extensions[i],scene,json,this));return Promise.all(sceneIndex).then(function(){return scene})}}();return GLTFLoader}()},{}],60:[function(_dereq_,module,exports){THREE.MTLLoader=function(manager){THREE.Loader.call(this,manager)};THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),
{constructor:THREE.MTLLoader,load:function(url,onLoad,onProgress,onError){var scope=this,path=""===this.path?THREE.LoaderUtils.extractUrlBase(url):this.path,loader=new THREE.FileLoader(this.manager);loader.setPath(this.path);loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(this.withCredentials);loader.load(url,function(text){try{onLoad(scope.parse(text,path))}catch(e$166){onError?onError(e$166):console.error(e$166),scope.manager.itemError(url)}},onProgress,onError)},setMaterialOptions:function(value){this.materialOptions=
value;return this},parse:function(text,path){var lines=text.split("\n"),info={},delimiter_pattern=/\s+/;text={};for(var i=0;i<lines.length;i++){var line=lines[i];line=line.trim();if(0!==line.length&&"#"!==line.charAt(0)){var pos=line.indexOf(" "),key=0<=pos?line.substring(0,pos):line;key=key.toLowerCase();line=0<=pos?line.substring(pos+1):"";line=line.trim();"newmtl"===key?(info={name:line},text[line]=info):"ka"===key||"kd"===key||"ks"===key||"ke"===key?(line=line.split(delimiter_pattern,3),info[key]=
[parseFloat(line[0]),parseFloat(line[1]),parseFloat(line[2])]):info[key]=line}}path=new THREE.MTLLoader.MaterialCreator(this.resourcePath||path,this.materialOptions);path.setCrossOrigin(this.crossOrigin);path.setManager(this.manager);path.setMaterials(text);return path}});THREE.MTLLoader.MaterialCreator=function(baseUrl,options){this.baseUrl=baseUrl||"";this.options=options;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?
this.options.side:THREE.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping};THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(value){this.crossOrigin=value;return this},setManager:function(value){this.manager=value},setMaterials:function(materialsInfo){this.materialsInfo=this.convert(materialsInfo);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(materialsInfo){if(!this.options)return materialsInfo;
var converted={},mn;for(mn in materialsInfo){var mat=materialsInfo[mn],covmat={};converted[mn]=covmat;for(var prop in mat){var save=!0,value=mat[prop],lprop=prop.toLowerCase();switch(lprop){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(value=[value[0]/255,value[1]/255,value[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===value[0]&&0===value[1]&&0===value[2]&&(save=!1)}save&&(covmat[lprop]=value)}}return converted},preload:function(){for(var mn in this.materialsInfo)this.create(mn)},
getIndex:function(materialName){return this.nameLookup[materialName]},getAsArray:function(){var index=0,mn;for(mn in this.materialsInfo)this.materialsArray[index]=this.create(mn),this.nameLookup[mn]=index,index++;return this.materialsArray},create:function(materialName){void 0===this.materials[materialName]&&this.createMaterial_(materialName);return this.materials[materialName]},createMaterial_:function(materialName){function resolveURL(baseUrl,url){return"string"!==typeof url||""===url?"":/^https?:\/\//i.test(url)?
url:baseUrl+url}function setMapForType(mapType,value){if(!params[mapType]){value=scope.getTextureParams(value,params);var map=scope.loadTexture(resolveURL(scope.baseUrl,value.url));map.repeat.copy(value.scale);map.offset.copy(value.offset);map.wrapS=scope.wrap;map.wrapT=scope.wrap;params[mapType]=map}}var scope=this,mat=this.materialsInfo[materialName],params={name:materialName,side:this.side},prop;for(prop in mat){var value$jscomp$0=mat[prop];if(""!==value$jscomp$0)switch(prop.toLowerCase()){case "kd":params.color=
(new THREE.Color).fromArray(value$jscomp$0);break;case "ks":params.specular=(new THREE.Color).fromArray(value$jscomp$0);break;case "ke":params.emissive=(new THREE.Color).fromArray(value$jscomp$0);break;case "map_kd":setMapForType("map",value$jscomp$0);break;case "map_ks":setMapForType("specularMap",value$jscomp$0);break;case "map_ke":setMapForType("emissiveMap",value$jscomp$0);break;case "norm":setMapForType("normalMap",value$jscomp$0);break;case "map_bump":case "bump":setMapForType("bumpMap",value$jscomp$0);
break;case "map_d":setMapForType("alphaMap",value$jscomp$0);params.transparent=!0;break;case "ns":params.shininess=parseFloat(value$jscomp$0);break;case "d":value$jscomp$0=parseFloat(value$jscomp$0);1>value$jscomp$0&&(params.opacity=value$jscomp$0,params.transparent=!0);break;case "tr":value$jscomp$0=parseFloat(value$jscomp$0),this.options&&this.options.invertTrProperty&&(value$jscomp$0=1-value$jscomp$0),0<value$jscomp$0&&(params.opacity=1-value$jscomp$0,params.transparent=!0)}}this.materials[materialName]=
new THREE.MeshPhongMaterial(params);return this.materials[materialName]},getTextureParams:function(value,matParams){var texParams={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)};value=value.split(/\s+/);var pos=value.indexOf("-bm");0<=pos&&(matParams.bumpScale=parseFloat(value[pos+1]),value.splice(pos,2));pos=value.indexOf("-s");0<=pos&&(texParams.scale.set(parseFloat(value[pos+1]),parseFloat(value[pos+2])),value.splice(pos,4));pos=value.indexOf("-o");0<=pos&&(texParams.offset.set(parseFloat(value[pos+
1]),parseFloat(value[pos+2])),value.splice(pos,4));texParams.url=value.join(" ").trim();return texParams},loadTexture:function(url,mapping,onLoad,onProgress,onError){var manager=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager,loader=manager.getHandler(url);null===loader&&(loader=new THREE.TextureLoader(manager));loader.setCrossOrigin&&loader.setCrossOrigin(this.crossOrigin);url=loader.load(url,onLoad,onProgress,onError);void 0!==mapping&&(url.mapping=mapping);return url}}},{}],61:[function(_dereq_,
module,exports){THREE.OBJLoader=function(){function ParserState(){var state={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(name$jscomp$0,fromDeclaration){if(this.object&&!1===this.object.fromDeclaration)this.object.name=name$jscomp$0,this.object.fromDeclaration=!1!==fromDeclaration;else{var previousMaterial=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===
typeof this.object._finalize&&this.object._finalize(!0);this.object={name:name$jscomp$0||"",fromDeclaration:!1!==fromDeclaration,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(name,libraries){var previous=this._finalize(!1);previous&&(previous.inherited||0>=previous.groupCount)&&this.materials.splice(previous.index,1);name={index:this.materials.length,name:name||"",mtllib:Array.isArray(libraries)&&0<libraries.length?libraries[libraries.length-
1]:"",smooth:void 0!==previous?previous.smooth:this.smooth,groupStart:void 0!==previous?previous.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(index){index={index:"number"===typeof index?index:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};index.clone=this.clone.bind(index);return index}};this.materials.push(name);return name},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-
1]},_finalize:function(end){var lastMultiMaterial=this.currentMaterial();lastMultiMaterial&&-1===lastMultiMaterial.groupEnd&&(lastMultiMaterial.groupEnd=this.geometry.vertices.length/3,lastMultiMaterial.groupCount=lastMultiMaterial.groupEnd-lastMultiMaterial.groupStart,lastMultiMaterial.inherited=!1);if(end&&1<this.materials.length)for(var mi=this.materials.length-1;0<=mi;mi--)0>=this.materials[mi].groupCount&&this.materials.splice(mi,1);end&&0===this.materials.length&&this.materials.push({name:"",
smooth:this.smooth});return lastMultiMaterial}};previousMaterial&&previousMaterial.name&&"function"===typeof previousMaterial.clone&&(name$jscomp$0=previousMaterial.clone(0),name$jscomp$0.inherited=!0,this.object.materials.push(name$jscomp$0));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(value,len){value=parseInt(value,10);return 3*(0<=value?value-1:value+len/3)},parseNormalIndex:function(value,
len){value=parseInt(value,10);return 3*(0<=value?value-1:value+len/3)},parseUVIndex:function(value,len){value=parseInt(value,10);return 2*(0<=value?value-1:value+len/2)},addVertex:function(a,b,c){var src=this.vertices,dst=this.object.geometry.vertices;dst.push(src[a+0],src[a+1],src[a+2]);dst.push(src[b+0],src[b+1],src[b+2]);dst.push(src[c+0],src[c+1],src[c+2])},addVertexPoint:function(a){var src=this.vertices;this.object.geometry.vertices.push(src[a+0],src[a+1],src[a+2])},addVertexLine:function(a){var src=
this.vertices;this.object.geometry.vertices.push(src[a+0],src[a+1],src[a+2])},addNormal:function(a,b,c){var src=this.normals,dst=this.object.geometry.normals;dst.push(src[a+0],src[a+1],src[a+2]);dst.push(src[b+0],src[b+1],src[b+2]);dst.push(src[c+0],src[c+1],src[c+2])},addFaceNormal:function(a,b,c){var src=this.vertices,dst=this.object.geometry.normals;vA.fromArray(src,a);vB.fromArray(src,b);vC.fromArray(src,c);cb.subVectors(vC,vB);ab.subVectors(vA,vB);cb.cross(ab);cb.normalize();dst.push(cb.x,cb.y,
cb.z);dst.push(cb.x,cb.y,cb.z);dst.push(cb.x,cb.y,cb.z)},addColor:function(a,b,c){var src=this.colors,dst=this.object.geometry.colors;void 0!==src[a]&&dst.push(src[a+0],src[a+1],src[a+2]);void 0!==src[b]&&dst.push(src[b+0],src[b+1],src[b+2]);void 0!==src[c]&&dst.push(src[c+0],src[c+1],src[c+2])},addUV:function(a,b,c){var src=this.uvs,dst=this.object.geometry.uvs;dst.push(src[a+0],src[a+1]);dst.push(src[b+0],src[b+1]);dst.push(src[c+0],src[c+1])},addDefaultUV:function(){var dst=this.object.geometry.uvs;
dst.push(0,0);dst.push(0,0);dst.push(0,0)},addUVLine:function(a){var src=this.uvs;this.object.geometry.uvs.push(src[a+0],src[a+1])},addFace:function(a,b,c,ua,ub,uc,na,nb,nc){var vLen=this.vertices.length;a=this.parseVertexIndex(a,vLen);b=this.parseVertexIndex(b,vLen);c=this.parseVertexIndex(c,vLen);this.addVertex(a,b,c);this.addColor(a,b,c);void 0!==na&&""!==na?(c=this.normals.length,a=this.parseNormalIndex(na,c),b=this.parseNormalIndex(nb,c),c=this.parseNormalIndex(nc,c),this.addNormal(a,b,c)):this.addFaceNormal(a,
b,c);void 0!==ua&&""!==ua?(na=this.uvs.length,a=this.parseUVIndex(ua,na),b=this.parseUVIndex(ub,na),c=this.parseUVIndex(uc,na),this.addUV(a,b,c),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(vertices){this.object.geometry.type="Points";for(var vLen=this.vertices.length,vi=0,l=vertices.length;vi<l;vi++){var index=this.parseVertexIndex(vertices[vi],vLen);this.addVertexPoint(index);this.addColor(index)}},addLineGeometry:function(vertices,uvs){this.object.geometry.type=
"Line";for(var vLen=this.vertices.length,uvLen=this.uvs.length,vi=0,l=vertices.length;vi<l;vi++)this.addVertexLine(this.parseVertexIndex(vertices[vi],vLen));vertices=0;for(l=uvs.length;vertices<l;vertices++)this.addUVLine(this.parseUVIndex(uvs[vertices],uvLen))}};state.startObject("",!1);return state}function OBJLoader(manager){THREE.Loader.call(this,manager);this.materials=null}var object_pattern=/^[og]\s*(.+)?/,material_library_pattern=/^mtllib /,material_use_pattern=/^usemtl /,map_use_pattern=
/^usemap /,vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,ab=new THREE.Vector3,cb=new THREE.Vector3;OBJLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:OBJLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new THREE.FileLoader(this.manager);loader.setPath(this.path);loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(this.withCredentials);loader.load(url,function(text){try{onLoad(scope.parse(text))}catch(e$167){onError?
onError(e$167):console.error(e$167),scope.manager.itemError(url)}},onProgress,onError)},setMaterials:function(materials){this.materials=materials;return this},parse:function(text){var state=new ParserState;-1!==text.indexOf("\r\n")&&(text=text.replace(/\r\n/g,"\n"));-1!==text.indexOf("\\\n")&&(text=text.replace(/\\\n/g,""));var lines=text.split("\n"),result,trimLeft="function"===typeof"".trimLeft;text=0;for(var l=lines.length;text<l;text++){var line=lines[text];line=trimLeft?line.trimLeft():line.trim();
var lineFirstChar=line.length;if(0!==lineFirstChar&&(lineFirstChar=line.charAt(0),"#"!==lineFirstChar))if("v"===lineFirstChar)switch(line=line.split(/\s+/),line[0]){case "v":state.vertices.push(parseFloat(line[1]),parseFloat(line[2]),parseFloat(line[3]));7<=line.length?state.colors.push(parseFloat(line[4]),parseFloat(line[5]),parseFloat(line[6])):state.colors.push(void 0,void 0,void 0);break;case "vn":state.normals.push(parseFloat(line[1]),parseFloat(line[2]),parseFloat(line[3]));break;case "vt":state.uvs.push(parseFloat(line[1]),
parseFloat(line[2]))}else if("f"===lineFirstChar){line=line.substr(1).trim();var vertexData=line.split(/\s+/);line=[];lineFirstChar=0;for(result=vertexData.length;lineFirstChar<result;lineFirstChar++){var vertex=vertexData[lineFirstChar];0<vertex.length&&(vertex=vertex.split("/"),line.push(vertex))}vertexData=line[0];lineFirstChar=1;for(result=line.length-1;lineFirstChar<result;lineFirstChar++){vertex=line[lineFirstChar];var v3=line[lineFirstChar+1];state.addFace(vertexData[0],vertex[0],v3[0],vertexData[1],
vertex[1],v3[1],vertexData[2],vertex[2],v3[2])}}else if("l"===lineFirstChar){lineFirstChar=line.substring(1).trim().split(" ");result=[];vertexData=[];if(-1===line.indexOf("/"))result=lineFirstChar;else for(line=0,vertex=lineFirstChar.length;line<vertex;line++)v3=lineFirstChar[line].split("/"),""!==v3[0]&&result.push(v3[0]),""!==v3[1]&&vertexData.push(v3[1]);state.addLineGeometry(result,vertexData)}else if("p"===lineFirstChar)line=line.substr(1).trim(),line=line.split(" "),state.addPointGeometry(line);
else if(null!==(result=object_pattern.exec(line)))line=(" "+result[0].substr(1).trim()).substr(1),state.startObject(line);else if(material_use_pattern.test(line))state.object.startMaterial(line.substring(7).trim(),state.materialLibraries);else if(material_library_pattern.test(line))state.materialLibraries.push(line.substring(7).trim());else if(map_use_pattern.test(line))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===
lineFirstChar){if(result=line.split(" "),1<result.length?(line=result[1].trim().toLowerCase(),state.object.smooth="0"!==line&&"off"!==line):state.object.smooth=!0,line=state.object.currentMaterial())line.smooth=state.object.smooth}else"\x00"!==line&&console.warn('THREE.OBJLoader: Unexpected line: "'+line+'"')}state.finalize();lines=new THREE.Group;lines.materialLibraries=[].concat(state.materialLibraries);if(!0===!(1===state.objects.length&&0===state.objects[0].geometry.vertices.length))for(text=
0,l=state.objects.length;text<l;text++){if(trimLeft=state.objects[text],line=trimLeft.geometry,lineFirstChar=trimLeft.materials,result="Line"===line.type,vertexData="Points"===line.type,vertex=!1,0!==line.vertices.length){v3=new THREE.BufferGeometry;v3.setAttribute("position",new THREE.Float32BufferAttribute(line.vertices,3));0<line.normals.length&&v3.setAttribute("normal",new THREE.Float32BufferAttribute(line.normals,3));0<line.colors.length&&(vertex=!0,v3.setAttribute("color",new THREE.Float32BufferAttribute(line.colors,
3)));!0===line.hasUVIndices&&v3.setAttribute("uv",new THREE.Float32BufferAttribute(line.uvs,2));for(var createdMaterials=[],mi=0,miLen=lineFirstChar.length;mi<miLen;mi++){var sourceMaterial=lineFirstChar[mi],materialHash=sourceMaterial.name+"_"+sourceMaterial.smooth+"_"+vertex;line=state.materials[materialHash];if(null!==this.materials)if(line=this.materials.create(sourceMaterial.name),!result||!line||line instanceof THREE.LineBasicMaterial)!vertexData||!line||line instanceof THREE.PointsMaterial||
(materialLine=new THREE.PointsMaterial({size:10,sizeAttenuation:!1}),THREE.Material.prototype.copy.call(materialLine,line),materialLine.color.copy(line.color),materialLine.map=line.map,line=materialLine);else{var materialLine=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(materialLine,line);materialLine.color.copy(line.color);line=materialLine}void 0===line&&(line=result?new THREE.LineBasicMaterial:vertexData?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial,
line.name=sourceMaterial.name,line.flatShading=sourceMaterial.smooth?!1:!0,line.vertexColors=vertex,state.materials[materialHash]=line);createdMaterials.push(line)}if(1<createdMaterials.length){mi=0;for(miLen=lineFirstChar.length;mi<miLen;mi++)sourceMaterial=lineFirstChar[mi],v3.addGroup(sourceMaterial.groupStart,sourceMaterial.groupCount,mi);line=result?new THREE.LineSegments(v3,createdMaterials):vertexData?new THREE.Points(v3,createdMaterials):new THREE.Mesh(v3,createdMaterials)}else line=result?
new THREE.LineSegments(v3,createdMaterials[0]):vertexData?new THREE.Points(v3,createdMaterials[0]):new THREE.Mesh(v3,createdMaterials[0]);line.name=trimLeft.name;lines.add(line)}}else 0<state.vertices.length&&(line=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),v3=new THREE.BufferGeometry,v3.setAttribute("position",new THREE.Float32BufferAttribute(state.vertices,3)),0<state.colors.length&&(v3.setAttribute("color",new THREE.Float32BufferAttribute(state.colors,3)),line.vertexColors=!0),state=
new THREE.Points(v3,line),lines.add(state));return lines}});return OBJLoader}()},{}],62:[function(_dereq_,module,exports){function TextGeometry(opt){Base.call(this);"string"===typeof opt&&(opt={text:opt});this._opt=assign({},opt);opt&&this.update(opt)}var createLayout=_dereq_("layout-bmfont-text");exports=_dereq_("inherits");var createIndices=_dereq_("quad-indices"),buffer=_dereq_("three-buffer-vertex-data"),assign=_dereq_("object-assign"),vertices=_dereq_("./lib/vertices"),utils=_dereq_("./lib/utils"),
Base=THREE.BufferGeometry;module.exports=function(opt){return new TextGeometry(opt)};exports(TextGeometry,Base);TextGeometry.prototype.update=function(opt){"string"===typeof opt&&(opt={text:opt});opt=assign({},this._opt,opt);if(!opt.font)throw new TypeError("must specify a { font } in options");this.layout=createLayout(opt);var flipY=!1!==opt.flipY,font=opt.font,texWidth=font.common.scaleW,texHeight=font.common.scaleH;this.visibleGlyphs=font=this.layout.glyphs.filter(function(glyph){glyph=glyph.data;
return 0<glyph.width*glyph.height});var positions=vertices.positions(font);flipY=vertices.uvs(font,texWidth,texHeight,flipY);texWidth=createIndices({clockwise:!0,type:"uint16",count:font.length});buffer.index(this,texWidth,1,"uint16");buffer.attr(this,"position",positions,2);buffer.attr(this,"uv",flipY,2);!opt.multipage&&"page"in this.attributes?this.removeAttribute("page"):opt.multipage&&(opt=vertices.pages(font),buffer.attr(this,"page",opt,1))};TextGeometry.prototype.computeBoundingSphere=function(){null===
this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var positions=this.attributes.position.array,itemSize=this.attributes.position.itemSize;!positions||!itemSize||2>positions.length?(this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0)):(utils.computeSphere(positions,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.'))};TextGeometry.prototype.computeBoundingBox=
function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var bbox=this.boundingBox,positions=this.attributes.position.array,itemSize=this.attributes.position.itemSize;!positions||!itemSize||2>positions.length?bbox.makeEmpty():utils.computeBox(positions,bbox)}},{"./lib/utils":63,"./lib/vertices":64,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":65}],63:[function(_dereq_,module,exports){function bounds(positions){var count=positions.length/
2;box.min[0]=positions[0];box.min[1]=positions[1];box.max[0]=positions[0];box.max[1]=positions[1];for(var i=0;i<count;i++){var x=positions[2*i],y=positions[2*i+1];box.min[0]=Math.min(x,box.min[0]);box.min[1]=Math.min(y,box.min[1]);box.max[0]=Math.max(x,box.max[0]);box.max[1]=Math.max(y,box.max[1])}}var box={min:[0,0],max:[0,0]};module.exports.computeBox=function(positions,output){bounds(positions);output.min.set(box.min[0],box.min[1],0);output.max.set(box.max[0],box.max[1],0)};module.exports.computeSphere=
function(positions,output){bounds(positions);positions=box.min[0];var minY=box.min[1],width=box.max[0]-positions,height=box.max[1]-minY,length=Math.sqrt(width*width+height*height);output.center.set(positions+width/2,minY+height/2,0);output.radius=length/2}},{}],64:[function(_dereq_,module,exports){module.exports.pages=function(glyphs){var pages=new Float32Array(4*glyphs.length),i=0;glyphs.forEach(function(glyph){glyph=glyph.data.page||0;pages[i++]=glyph;pages[i++]=glyph;pages[i++]=glyph;pages[i++]=
glyph});return pages};module.exports.uvs=function(glyphs,texWidth,texHeight,flipY){var uvs=new Float32Array(8*glyphs.length),i=0;glyphs.forEach(function(glyph){glyph=glyph.data;var bh=glyph.y+glyph.height,u0=glyph.x/texWidth,v1=glyph.y/texHeight,u1=(glyph.x+glyph.width)/texWidth,v0=bh/texHeight;flipY&&(v1=(texHeight-glyph.y)/texHeight,v0=(texHeight-bh)/texHeight);uvs[i++]=u0;uvs[i++]=v1;uvs[i++]=u0;uvs[i++]=v0;uvs[i++]=u1;uvs[i++]=v0;uvs[i++]=u1;uvs[i++]=v1});return uvs};module.exports.positions=
function(glyphs){var positions=new Float32Array(8*glyphs.length),i=0;glyphs.forEach(function(glyph){var bitmap=glyph.data,x=glyph.position[0]+bitmap.xoffset;glyph=glyph.position[1]+bitmap.yoffset;var w=bitmap.width;bitmap=bitmap.height;positions[i++]=x;positions[i++]=glyph;positions[i++]=x;positions[i++]=glyph+bitmap;positions[i++]=x+w;positions[i++]=glyph+bitmap;positions[i++]=x+w;positions[i++]=glyph});return positions}},{}],65:[function(_dereq_,module,exports){function updateAttribute(attrib,data,
itemSize,dtype){data=data||[];data=flatten(data,dtype);attrib=new THREE.BufferAttribute(data,itemSize);attrib.itemSize=itemSize;attrib.needsUpdate=!0;return attrib}var flatten=_dereq_("flatten-vertex-data");module.exports.attr=function(geometry,key,data,itemSize,dtype){"number"!==typeof itemSize&&(itemSize=3);"string"!==typeof dtype&&(dtype="float32");if(Array.isArray(data)&&Array.isArray(data[0])&&data[0].length!==itemSize)throw Error("Nested vertex array has unexpected size; expected "+itemSize+
" but found "+data[0].length);var attrib=geometry.getAttribute(key);data=updateAttribute(attrib,data,itemSize,dtype);geometry.setAttribute(key,data)};module.exports.index=function(geometry,data,itemSize,dtype){"number"!==typeof itemSize&&(itemSize=1);"string"!==typeof dtype&&(dtype="uint16");var isR69=!geometry.index&&"function"!==typeof geometry.setIndex,attrib=isR69?geometry.getAttribute("index"):geometry.index;if(data=updateAttribute(attrib,data,itemSize,dtype))isR69?geometry.addAttribute("index",
data):geometry.index=data}},{"flatten-vertex-data":23}],66:[function(_dereq_,module,exports){(function(setImmediate,clearImmediate){function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}var nextTick=_dereq_("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,
window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()};Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);
var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))};exports.setImmediate="function"===typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=2>arguments.length?!1:slice.call(arguments,1);immediateIds[id]=!0;nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))});return id};exports.clearImmediate="function"===typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,
_dereq_("timers").setImmediate,_dereq_("timers").clearImmediate)},{"process/browser.js":49,timers:66}],67:[function(_dereq_,module$jscomp$2,exports$jscomp$2){(function(global$jscomp$0){(function(global,factory){"object"===typeof exports$jscomp$2&&"undefined"!==typeof module$jscomp$2?module$jscomp$2.exports=factory():global.WebVRPolyfill=factory()})(this,function(){function WebVRPolyfill(config){this.config=extend$jscomp$0(extend$jscomp$0({},DefaultConfig),config);this.polyfillDisplays=[];this.enabled=
!1;this.hasNative="getVRDisplays"in navigator;this.native={};this.native.getVRDisplays=navigator.getVRDisplays;this.native.VRFrameData=window.VRFrameData;this.native.VRDisplay=window.VRDisplay;if(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&isMobile())this.enable(),this.getVRDisplays().then(function(displays){displays&&displays[0]&&displays[0].fireVRDisplayConnect_&&displays[0].fireVRDisplayConnect_()})}var commonjsGlobal="undefined"!==typeof window?window:"undefined"!==typeof global$jscomp$0?
global$jscomp$0:"undefined"!==typeof self?self:{},isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},copyArray=function(source,dest){for(var i=0,n=source.length;i<n;i++)dest[i]=source[i]},extend$jscomp$0=function(dest,src){for(var key in src)src.hasOwnProperty(key)&&(dest[key]=src[key]);return dest},CardboardVRDisplay=function(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x["default"]:x}(function(fn,module){return module=
{exports:{}},fn(module,module.exports),module.exports}(function(module$jscomp$1,exports$jscomp$1){(function(global,factory){module$jscomp$1.exports=factory()})(commonjsGlobal,function(){function CardboardDistorter(gl,cardboardUI,bufferScale,dirtySubmitFrameBindings){this.gl=gl;this.cardboardUI=cardboardUI;this.bufferScale=bufferScale;this.dirtySubmitFrameBindings=dirtySubmitFrameBindings;this.ctxAttribs=gl.getContextAttributes();this.instanceExt=gl.getExtension("ANGLE_instanced_arrays");this.meshHeight=
this.meshWidth=20;this.bufferWidth=gl.drawingBufferWidth;this.bufferHeight=gl.drawingBufferHeight;this.realBindFramebuffer=gl.bindFramebuffer;this.realEnable=gl.enable;this.realDisable=gl.disable;this.realColorMask=gl.colorMask;this.realClearColor=gl.clearColor;this.realViewport=gl.viewport;isIOS()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(gl.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(gl.canvas.__proto__,"height"));this.isPatched=!1;this.lastBoundFramebuffer=
null;this.stencilTest=this.scissorTest=this.blend=this.depthTest=this.cullFace=!1;this.viewport=[0,0,0,0];this.colorMask=[!0,!0,!0,!0];this.clearColor=[0,0,0,0];this.attribs={position:0,texCoord:1};this.program=linkProgram(gl,"attribute vec2 position;\nattribute vec3 texCoord;\nvarying vec2 vTexCoord;\nuniform vec4 viewportOffsetScale[2];\nvoid main() {\n  vec4 viewport \x3d viewportOffsetScale[int(texCoord.z)];\n  vTexCoord \x3d (texCoord.xy * viewport.zw) + viewport.xy;\n  gl_Position \x3d vec4( position, 1.0, 1.0 );\n}",
"precision mediump float;\nuniform sampler2D diffuse;\nvarying vec2 vTexCoord;\nvoid main() {\n  gl_FragColor \x3d texture2D(diffuse, vTexCoord);\n}",this.attribs);this.uniforms=getProgramUniforms(gl,this.program);this.viewportOffsetScale=new Float32Array(8);this.setTextureBounds();this.vertexBuffer=gl.createBuffer();this.indexBuffer=gl.createBuffer();this.indexCount=0;this.renderTarget=gl.createTexture();this.framebuffer=gl.createFramebuffer();this.stencilBuffer=this.depthBuffer=this.depthStencilBuffer=
null;this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=gl.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=gl.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=gl.createRenderbuffer());this.patch();this.onResize()}function CardboardUI(gl){this.gl=gl;this.attribs={position:0};this.program=linkProgram(gl,"attribute vec2 position;\nuniform mat4 projectionMat;\nvoid main() {\n  gl_Position \x3d projectionMat * vec4( position, -1.0, 1.0 );\n}","precision mediump float;\nuniform vec4 color;\nvoid main() {\n  gl_FragColor \x3d color;\n}",
this.attribs);this.uniforms=getProgramUniforms(gl,this.program);this.vertexBuffer=gl.createBuffer();this.arrowVertexCount=this.arrowOffset=this.gearVertexCount=this.gearOffset=0;this.projMat=new Float32Array(16);this.listener=null;this.onResize()}function Distortion(coefficients){this.coefficients=coefficients}function Device(params){this.width=params.width||getScreenWidth();this.height=params.height||getScreenHeight();this.widthMeters=params.widthMeters;this.heightMeters=params.heightMeters;this.bevelMeters=
params.bevelMeters}function DeviceInfo(deviceParams,additionalViewers){this.viewer=Viewers.CardboardV2;this.updateDeviceParams(deviceParams);this.distortion=new Distortion(this.viewer.distortionCoefficients);for(deviceParams=0;deviceParams<additionalViewers.length;deviceParams++){var viewer=additionalViewers[deviceParams];Viewers[viewer.id]=new CardboardViewer(viewer)}}function CardboardViewer(params){this.id=params.id;this.label=params.label;this.fov=params.fov;this.interLensDistance=params.interLensDistance;
this.baselineLensDistance=params.baselineLensDistance;this.screenLensDistance=params.screenLensDistance;this.distortionCoefficients=params.distortionCoefficients;this.inverseCoefficients=params.inverseCoefficients}function Dpdb(url,onDeviceParamsUpdated){this.dpdb=DPDB_CACHE;this.recalculateDeviceParams_();if(url){this.onDeviceParamsUpdated=onDeviceParamsUpdated;var xhr=new XMLHttpRequest,obj=this;xhr.open("GET",url,!0);xhr.addEventListener("load",function(){obj.loading=!1;200<=xhr.status&&299>=xhr.status?
(obj.dpdb=JSON.parse(xhr.response),obj.recalculateDeviceParams_()):console.error("Error loading online DPDB!")});xhr.send()}}function DeviceParams(params){this.xdpi=params.xdpi;this.ydpi=params.ydpi;this.bevelMm=params.bevelMm}function SensorSample(sample,timestampS){this.set(sample,timestampS)}function ComplementaryFilter(kFilter,isDebug){this.kFilter=kFilter;this.isDebug=isDebug;this.currentAccelMeasurement=new SensorSample;this.currentGyroMeasurement=new SensorSample;this.previousGyroMeasurement=
new SensorSample;isIOS()?this.filterQ=new Quaternion(-1,0,0,1):this.filterQ=new Quaternion(1,0,0,1);this.previousFilterQ=new Quaternion;this.previousFilterQ.copy(this.filterQ);this.accelQ=new Quaternion;this.isOrientationInitialized=!1;this.estimatedGravity=new Vector3;this.measuredGravity=new Vector3;this.gyroIntegralQ=new Quaternion}function PosePredictor(predictionTimeS,isDebug){this.predictionTimeS=predictionTimeS;this.isDebug=isDebug;this.previousQ=new Quaternion;this.previousTimestampS=null;
this.deltaQ=new Quaternion;this.outQ=new Quaternion}function FusionPoseSensor(kFilter,predictionTime,yawOnly,isDebug){this.yawOnly=yawOnly;this.accelerometer=new Vector3;this.gyroscope=new Vector3;this.filter=new ComplementaryFilter(kFilter,isDebug);this.posePredictor=new PosePredictor(predictionTime,isDebug);this.isFirefoxAndroid=isFirefoxAndroid();this.isIOS=isIOS();kFilter=getChromeVersion();this.isDeviceMotionInRadians=!this.isIOS&&kFilter&&66>kFilter;this.isWithoutDeviceMotion=isChromeWithoutDeviceMotion()||
isSafariWithoutDeviceMotion();this.filterToWorldQ=new Quaternion;isIOS()?this.filterToWorldQ.setFromAxisAngle(new Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Vector3(1,0,0),-Math.PI/2);this.inverseWorldToScreenQ=new Quaternion;this.worldToScreenQ=new Quaternion;this.originalPoseAdjustQ=new Quaternion;this.originalPoseAdjustQ.setFromAxisAngle(new Vector3(0,0,1),-window.orientation*Math.PI/180);this.setScreenTransform_();isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);
this.resetQ=new Quaternion;this.orientationOut_=new Float32Array(4);this.start()}function RotateInstructions(){this.loadIcon_();var overlay=document.createElement("div"),s=overlay.style;s.position="fixed";s.top=0;s.right=0;s.bottom=0;s.left=0;s.backgroundColor="gray";s.fontFamily="sans-serif";s.zIndex=1E6;var img=document.createElement("img");img.src=this.icon;s=img.style;s.marginLeft="25%";s.marginTop="25%";s.width="50%";overlay.appendChild(img);img=document.createElement("div");s=img.style;s.textAlign=
"center";s.fontSize="16px";s.lineHeight="24px";s.margin="24px 25%";s.width="50%";img.innerHTML="Place your phone into your Cardboard viewer.";overlay.appendChild(img);var snackbar=document.createElement("div");s=snackbar.style;s.backgroundColor="#CFD8DC";s.position="fixed";s.bottom=0;s.width="100%";s.height="48px";s.padding="14px 24px";s.boxSizing="border-box";s.color="#656A6B";overlay.appendChild(snackbar);var snackbarText=document.createElement("div");snackbarText.style.float="left";snackbarText.innerHTML=
"No Cardboard viewer?";var snackbarButton=document.createElement("a");snackbarButton.href="https://www.google.com/get/cardboard/get-cardboard/";snackbarButton.innerHTML="get one";snackbarButton.target="_blank";s=snackbarButton.style;s.float="right";s.fontWeight=600;s.textTransform="uppercase";s.borderLeft="1px solid gray";s.paddingLeft="24px";s.textDecoration="none";s.color="#656A6B";snackbar.appendChild(snackbarText);snackbar.appendChild(snackbarButton);this.overlay=overlay;this.text=img;this.hide()}
function ViewerSelector(defaultViewer){try{this.selectedKey=localStorage.getItem("WEBVR_CARDBOARD_VIEWER")}catch(error){console.error("Failed to load viewer profile: %s",error)}this.selectedKey||(this.selectedKey=defaultViewer||"CardboardV1");this.dialog=this.createDialog_(DeviceInfo.Viewers);this.root=null;this.onChangeCallbacks_=[]}function VRDisplayCapabilities(config){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:config.hasPosition},hasExternalDisplay:{writable:!1,
enumerable:!0,value:config.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:config.canPresent},maxLayers:{writable:!1,enumerable:!0,value:config.maxLayers},hasOrientation:{enumerable:!0,get:function(){deprecateWarning("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData");return config.hasOrientation}}})}function VRDisplay(config){config=config||{};config="wakelock"in config?config.wakelock:!0;this.isPolyfilled=!0;this.displayId=nextDisplayId++;this.displayName=
"";this.depthNear=.01;this.depthFar=1E4;this.isPresenting=!1;Object.defineProperty(this,"isConnected",{get:function(){deprecateWarning("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay");return!1}});this.capabilities=new VRDisplayCapabilities({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1});this.stageParameters=null;this.waitingForPresent_=!1;this.fullscreenErrorHandler_=this.fullscreenChangeHandler_=this.fullscreenEventTarget_=
this.fullscreenElementCachedStyle_=this.fullscreenWrapper_=this.fullscreenElement_=this.originalParent_=this.layer_=null;config&&isMobile()&&(this.wakelock_=new NoSleep$1)}function CardboardVRDisplay(config$$1){var defaults=extend({},config$jscomp$0);config$$1=extend(defaults,config$$1||{});VRDisplay.call(this,{wakelock:config$$1.MOBILE_WAKE_LOCK});this.config=config$$1;this.displayName="Cardboard VRDisplay";this.capabilities=new VRDisplayCapabilities({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,
canPresent:!0,maxLayers:1});this.stageParameters=null;this.bufferScale_=this.config.BUFFER_SCALE;this.poseSensor_=new PoseSensor(this.config);this.cardboardUI_=this.distorter_=null;this.dpdb_=new Dpdb(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this));this.deviceInfo_=new DeviceInfo(this.dpdb_.getDeviceParams(),config$$1.ADDITIONAL_VIEWERS);this.viewerSelector_=new ViewerSelector(config$$1.DEFAULT_VIEWER);this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());
this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new RotateInstructions);isIOS()&&window.addEventListener("resize",this.onResize_.bind(this))}var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,
staticProps){protoProps&&defineProperties(Constructor.prototype,protoProps);staticProps&&defineProperties(Constructor,staticProps);return Constructor}}(),slicedToArray=function(){return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr)){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e;
}}return _arr}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),isIOS=function(){var isIOS=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return isIOS}}(),isWebViewAndroid=function(){var isWebViewAndroid=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return isWebViewAndroid}}(),isSafari$jscomp$0=function(){var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);
return function(){return isSafari}}(),isFirefoxAndroid=function(){var isFirefoxAndroid=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return isFirefoxAndroid}}(),getChromeVersion=function(){var match=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),value=match?parseInt(match[1],10):null;return function(){return value}}(),isSafariWithoutDeviceMotion=function(){var value=!1;value=isIOS()&&isSafari$jscomp$0()&&-1!==navigator.userAgent.indexOf("13_4");
return function(){return value}}(),isChromeWithoutDeviceMotion=function(){var value=!1;if(65===getChromeVersion()){var match=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(match){match=match[1].split(".");match=slicedToArray(match,4);var build=match[3];value=3325===parseInt(match[2],10)&&148>parseInt(build,10)}}return function(){return value}}(),isR7=function(){var isR7=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return isR7}}(),isLandscapeMode=function(){var rtn=90==window.orientation||
-90==window.orientation;return isR7()?!rtn:rtn},getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},requestFullscreen=function(element){if(isWebViewAndroid())return!1;if(element.requestFullscreen)element.requestFullscreen();else if(element.webkitRequestFullscreen)element.webkitRequestFullscreen();else if(element.mozRequestFullScreen)element.mozRequestFullScreen();
else if(element.msRequestFullscreen)element.msRequestFullscreen();else return!1;return!0},exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},linkProgram=function(gl,vertexSource,fragmentSource,attribLocationMap){var vertexShader=gl.createShader(gl.VERTEX_SHADER);
gl.shaderSource(vertexShader,vertexSource);gl.compileShader(vertexShader);vertexSource=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(vertexSource,fragmentSource);gl.compileShader(vertexSource);fragmentSource=gl.createProgram();gl.attachShader(fragmentSource,vertexShader);gl.attachShader(fragmentSource,vertexSource);for(var attribName in attribLocationMap)gl.bindAttribLocation(fragmentSource,attribLocationMap[attribName],attribName);gl.linkProgram(fragmentSource);gl.deleteShader(vertexShader);
gl.deleteShader(vertexSource);return fragmentSource},getProgramUniforms=function(gl,program){for(var uniforms={},uniformCount=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),uniformName,i=0;i<uniformCount;i++)uniformName=gl.getActiveUniform(program,i).name.replace("[0]",""),uniforms[uniformName]=gl.getUniformLocation(program,uniformName);return uniforms},isMobile=function(){var check=!1,a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))check=!0;return check},extend=function(dest,src){for(var key in src)src.hasOwnProperty(key)&&(dest[key]=src[key]);return dest},safariCssSizeWorkaround=function(canvas){if(isIOS()){var width=canvas.style.width,height=canvas.style.height;canvas.style.width=parseInt(width)+1+"px";canvas.style.height=parseInt(height)+"px";setTimeout(function(){canvas.style.width=width;canvas.style.height=height},100)}window.canvas=canvas},frameDataFromPose=function(){function updateEyeMatrices(projection,view,pose,
fov$jscomp$0,offset,vrDisplay){var fov=fov$jscomp$0||null;fov$jscomp$0=vrDisplay.depthNear;vrDisplay=vrDisplay.depthFar;var upTan=Math.tan(fov?fov.upDegrees*piOver180:rad45),downTan=Math.tan(fov?fov.downDegrees*piOver180:rad45),leftTan=Math.tan(fov?fov.leftDegrees*piOver180:rad45);fov=Math.tan(fov?fov.rightDegrees*piOver180:rad45);var xScale=2/(leftTan+fov),yScale=2/(upTan+downTan);projection[0]=xScale;projection[1]=0;projection[2]=0;projection[3]=0;projection[4]=0;projection[5]=yScale;projection[6]=
0;projection[7]=0;projection[8]=-((leftTan-fov)*xScale*.5);projection[9]=(upTan-downTan)*yScale*.5;projection[10]=vrDisplay/(fov$jscomp$0-vrDisplay);projection[11]=-1;projection[12]=0;projection[13]=0;projection[14]=vrDisplay*fov$jscomp$0/(fov$jscomp$0-vrDisplay);projection[15]=0;projection=pose.orientation||defaultOrientation;pose=pose.position||defaultPosition;downTan=projection[0];xScale=projection[1];yScale=projection[2];vrDisplay=projection[3];var x2=downTan+downTan;fov=xScale+xScale;upTan=yScale+
yScale;projection=downTan*x2;fov$jscomp$0=downTan*fov;downTan*=upTan;leftTan=xScale*fov;xScale*=upTan;yScale*=upTan;x2*=vrDisplay;fov*=vrDisplay;vrDisplay*=upTan;view[0]=1-(leftTan+yScale);view[1]=fov$jscomp$0+vrDisplay;view[2]=downTan-fov;view[3]=0;view[4]=fov$jscomp$0-vrDisplay;view[5]=1-(projection+yScale);view[6]=xScale+x2;view[7]=0;view[8]=downTan+fov;view[9]=xScale-x2;view[10]=1-(projection+leftTan);view[11]=0;view[12]=pose[0];view[13]=pose[1];view[14]=pose[2];view[15]=1;if(offset)if(pose=offset[0],
projection=offset[1],offset=offset[2],view===view)view[12]=view[0]*pose+view[4]*projection+view[8]*offset+view[12],view[13]=view[1]*pose+view[5]*projection+view[9]*offset+view[13],view[14]=view[2]*pose+view[6]*projection+view[10]*offset+view[14],view[15]=view[3]*pose+view[7]*projection+view[11]*offset+view[15];else{fov$jscomp$0=view[0];vrDisplay=view[1];upTan=view[2];downTan=view[3];leftTan=view[4];fov=view[5];xScale=view[6];yScale=view[7];x2=view[8];var a21=view[9];var a22=view[10];var a23=view[11];
view[0]=fov$jscomp$0;view[1]=vrDisplay;view[2]=upTan;view[3]=downTan;view[4]=leftTan;view[5]=fov;view[6]=xScale;view[7]=yScale;view[8]=x2;view[9]=a21;view[10]=a22;view[11]=a23;view[12]=fov$jscomp$0*pose+leftTan*projection+x2*offset+view[12];view[13]=vrDisplay*pose+fov*projection+a21*offset+view[13];view[14]=upTan*pose+xScale*projection+a22*offset+view[14];view[15]=downTan*pose+yScale*projection+a23*offset+view[15]}offset=view[0];pose=view[1];projection=view[2];fov$jscomp$0=view[3];vrDisplay=view[4];
upTan=view[5];downTan=view[6];leftTan=view[7];fov=view[8];xScale=view[9];yScale=view[10];x2=view[11];a21=view[12];a22=view[13];a23=view[14];var a33=view[15],b00=offset*upTan-pose*vrDisplay,b01=offset*downTan-projection*vrDisplay,b02=offset*leftTan-fov$jscomp$0*vrDisplay,b03=pose*downTan-projection*upTan,b04=pose*leftTan-fov$jscomp$0*upTan,b05=projection*leftTan-fov$jscomp$0*downTan,b06=fov*a22-xScale*a21,b07=fov*a23-yScale*a21,b08=fov*a33-x2*a21,b09=xScale*a23-yScale*a22,b10=xScale*a33-x2*a22,b11=
yScale*a33-x2*a23,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;det&&(det=1/det,view[0]=(upTan*b11-downTan*b10+leftTan*b09)*det,view[1]=(projection*b10-pose*b11-fov$jscomp$0*b09)*det,view[2]=(a22*b05-a23*b04+a33*b03)*det,view[3]=(yScale*b04-xScale*b05-x2*b03)*det,view[4]=(downTan*b08-vrDisplay*b11-leftTan*b07)*det,view[5]=(offset*b11-projection*b08+fov$jscomp$0*b07)*det,view[6]=(a23*b02-a21*b05-a33*b01)*det,view[7]=(fov*b05-yScale*b02+x2*b01)*det,view[8]=(vrDisplay*b10-upTan*b08+leftTan*b06)*
det,view[9]=(pose*b08-offset*b10-fov$jscomp$0*b06)*det,view[10]=(a21*b04-a22*b02+a33*b00)*det,view[11]=(xScale*b02-fov*b04-x2*b00)*det,view[12]=(upTan*b07-vrDisplay*b09-downTan*b06)*det,view[13]=(offset*b09-pose*b07+projection*b06)*det,view[14]=(a22*b01-a21*b03-a23*b00)*det,view[15]=(fov*b03-xScale*b01+yScale*b00)*det)}var piOver180=Math.PI/180,rad45=.25*Math.PI,defaultOrientation=new Float32Array([0,0,0,1]),defaultPosition=new Float32Array([0,0,0]);return function(frameData,pose,vrDisplay){if(!frameData||
!pose)return!1;frameData.pose=pose;frameData.timestamp=pose.timestamp;updateEyeMatrices(frameData.leftProjectionMatrix,frameData.leftViewMatrix,pose,vrDisplay._getFieldOfView("left"),vrDisplay._getEyeOffset("left"),vrDisplay);updateEyeMatrices(frameData.rightProjectionMatrix,frameData.rightViewMatrix,pose,vrDisplay._getFieldOfView("right"),vrDisplay._getEyeOffset("right"),vrDisplay);return!0}}(),getOriginFromUrl=function(url){var protoSepIdx=url.indexOf("://");protoSepIdx=url.indexOf("/",-1!==protoSepIdx?
protoSepIdx+3:0);-1===protoSepIdx&&(protoSepIdx=url.length);return url.substring(0,protoSepIdx)},getQuaternionAngle=function(quat){return 1<quat.w?(console.warn("getQuaternionAngle: w \x3e 1"),0):2*Math.acos(quat.w)},warnOnce=function(){var observedWarnings={};return function(key,message){void 0===observedWarnings[key]&&(console.warn("webvr-polyfill: "+message),observedWarnings[key]=!0)}}(),deprecateWarning=function(deprecated,suggested){warnOnce(deprecated,deprecated+" has been deprecated. This may not work on native WebVR displays. "+
(suggested?"Please use "+suggested+" instead.":""))},glPreserveState=function(gl,bindings,callback){if(bindings){for(var boundValues=[],activeTexture=null,i=0;i<bindings.length;++i){var binding=bindings[i];switch(binding){case gl.TEXTURE_BINDING_2D:case gl.TEXTURE_BINDING_CUBE_MAP:var textureUnit=bindings[++i];if(textureUnit<gl.TEXTURE0||textureUnit>gl.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit");boundValues.push(null,null);break}activeTexture||
(activeTexture=gl.getParameter(gl.ACTIVE_TEXTURE));gl.activeTexture(textureUnit);boundValues.push(gl.getParameter(binding),null);break;case gl.ACTIVE_TEXTURE:activeTexture=gl.getParameter(gl.ACTIVE_TEXTURE);boundValues.push(null);break;default:boundValues.push(gl.getParameter(binding))}}callback(gl);for(i=0;i<bindings.length;++i){binding=bindings[i];callback=boundValues[i];switch(binding){case gl.ACTIVE_TEXTURE:break;case gl.ARRAY_BUFFER_BINDING:gl.bindBuffer(gl.ARRAY_BUFFER,callback);break;case gl.COLOR_CLEAR_VALUE:gl.clearColor(callback[0],
callback[1],callback[2],callback[3]);break;case gl.COLOR_WRITEMASK:gl.colorMask(callback[0],callback[1],callback[2],callback[3]);break;case gl.CURRENT_PROGRAM:gl.useProgram(callback);break;case gl.ELEMENT_ARRAY_BUFFER_BINDING:gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,callback);break;case gl.FRAMEBUFFER_BINDING:gl.bindFramebuffer(gl.FRAMEBUFFER,callback);break;case gl.RENDERBUFFER_BINDING:gl.bindRenderbuffer(gl.RENDERBUFFER,callback);break;case gl.TEXTURE_BINDING_2D:textureUnit=bindings[++i];if(textureUnit<
gl.TEXTURE0||textureUnit>gl.TEXTURE31)break;gl.activeTexture(textureUnit);gl.bindTexture(gl.TEXTURE_2D,callback);break;case gl.TEXTURE_BINDING_CUBE_MAP:textureUnit=bindings[++i];if(textureUnit<gl.TEXTURE0||textureUnit>gl.TEXTURE31)break;gl.activeTexture(textureUnit);gl.bindTexture(gl.TEXTURE_CUBE_MAP,callback);break;case gl.VIEWPORT:gl.viewport(callback[0],callback[1],callback[2],callback[3]);break;case gl.BLEND:case gl.CULL_FACE:case gl.DEPTH_TEST:case gl.SCISSOR_TEST:case gl.STENCIL_TEST:callback?
gl.enable(binding):gl.disable(binding);break;default:console.log("No GL restore behavior for 0x"+binding.toString(16))}activeTexture&&gl.activeTexture(activeTexture)}}else callback(gl)};CardboardDistorter.prototype.destroy=function(){var gl=this.gl;this.unpatch();gl.deleteProgram(this.program);gl.deleteBuffer(this.vertexBuffer);gl.deleteBuffer(this.indexBuffer);gl.deleteTexture(this.renderTarget);gl.deleteFramebuffer(this.framebuffer);this.depthStencilBuffer&&gl.deleteRenderbuffer(this.depthStencilBuffer);
this.depthBuffer&&gl.deleteRenderbuffer(this.depthBuffer);this.stencilBuffer&&gl.deleteRenderbuffer(this.stencilBuffer);this.cardboardUI&&this.cardboardUI.destroy()};CardboardDistorter.prototype.onResize=function(){var gl$jscomp$0=this.gl,self=this;glPreserveState(gl$jscomp$0,[gl$jscomp$0.RENDERBUFFER_BINDING,gl$jscomp$0.TEXTURE_BINDING_2D,gl$jscomp$0.TEXTURE0],function(gl){self.realBindFramebuffer.call(gl,gl.FRAMEBUFFER,null);self.scissorTest&&self.realDisable.call(gl,gl.SCISSOR_TEST);self.realColorMask.call(gl,
!0,!0,!0,!0);self.realViewport.call(gl,0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);self.realClearColor.call(gl,0,0,0,1);gl.clear(gl.COLOR_BUFFER_BIT);self.realBindFramebuffer.call(gl,gl.FRAMEBUFFER,self.framebuffer);gl.bindTexture(gl.TEXTURE_2D,self.renderTarget);gl.texImage2D(gl.TEXTURE_2D,0,self.ctxAttribs.alpha?gl.RGBA:gl.RGB,self.bufferWidth,self.bufferHeight,0,self.ctxAttribs.alpha?gl.RGBA:gl.RGB,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,
gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,self.renderTarget,0);self.ctxAttribs.depth&&self.ctxAttribs.stencil?(gl.bindRenderbuffer(gl.RENDERBUFFER,self.depthStencilBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,self.bufferWidth,self.bufferHeight),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,
gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,self.depthStencilBuffer)):self.ctxAttribs.depth?(gl.bindRenderbuffer(gl.RENDERBUFFER,self.depthBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,self.bufferWidth,self.bufferHeight),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,self.depthBuffer)):self.ctxAttribs.stencil&&(gl.bindRenderbuffer(gl.RENDERBUFFER,self.stencilBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.STENCIL_INDEX8,self.bufferWidth,self.bufferHeight),
gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.STENCIL_ATTACHMENT,gl.RENDERBUFFER,self.stencilBuffer));!gl.checkFramebufferStatus(gl.FRAMEBUFFER)===gl.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!");self.realBindFramebuffer.call(gl,gl.FRAMEBUFFER,self.lastBoundFramebuffer);self.scissorTest&&self.realEnable.call(gl,gl.SCISSOR_TEST);self.realColorMask.apply(gl,self.colorMask);self.realViewport.apply(gl,self.viewport);self.realClearColor.apply(gl,self.clearColor)});if(this.cardboardUI)this.cardboardUI.onResize()};
CardboardDistorter.prototype.patch=function(){if(!this.isPatched){var self=this,canvas=this.gl.canvas,gl=this.gl;isIOS()||(canvas.width=getScreenWidth()*this.bufferScale,canvas.height=getScreenHeight()*this.bufferScale,Object.defineProperty(canvas,"width",{configurable:!0,enumerable:!0,get:function(){return self.bufferWidth},set:function(value){self.bufferWidth=value;self.realCanvasWidth.set.call(canvas,value);self.onResize()}}),Object.defineProperty(canvas,"height",{configurable:!0,enumerable:!0,
get:function(){return self.bufferHeight},set:function(value){self.bufferHeight=value;self.realCanvasHeight.set.call(canvas,value);self.onResize()}}));this.lastBoundFramebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer));this.gl.bindFramebuffer=function(target,framebuffer){self.lastBoundFramebuffer=framebuffer?framebuffer:self.framebuffer;self.realBindFramebuffer.call(gl,
target,self.lastBoundFramebuffer)};this.cullFace=gl.getParameter(gl.CULL_FACE);this.depthTest=gl.getParameter(gl.DEPTH_TEST);this.blend=gl.getParameter(gl.BLEND);this.scissorTest=gl.getParameter(gl.SCISSOR_TEST);this.stencilTest=gl.getParameter(gl.STENCIL_TEST);gl.enable=function(pname){switch(pname){case gl.CULL_FACE:self.cullFace=!0;break;case gl.DEPTH_TEST:self.depthTest=!0;break;case gl.BLEND:self.blend=!0;break;case gl.SCISSOR_TEST:self.scissorTest=!0;break;case gl.STENCIL_TEST:self.stencilTest=
!0}self.realEnable.call(gl,pname)};gl.disable=function(pname){switch(pname){case gl.CULL_FACE:self.cullFace=!1;break;case gl.DEPTH_TEST:self.depthTest=!1;break;case gl.BLEND:self.blend=!1;break;case gl.SCISSOR_TEST:self.scissorTest=!1;break;case gl.STENCIL_TEST:self.stencilTest=!1}self.realDisable.call(gl,pname)};this.colorMask=gl.getParameter(gl.COLOR_WRITEMASK);gl.colorMask=function(r,g,b,a){self.colorMask[0]=r;self.colorMask[1]=g;self.colorMask[2]=b;self.colorMask[3]=a;self.realColorMask.call(gl,
r,g,b,a)};this.clearColor=gl.getParameter(gl.COLOR_CLEAR_VALUE);gl.clearColor=function(r,g,b,a){self.clearColor[0]=r;self.clearColor[1]=g;self.clearColor[2]=b;self.clearColor[3]=a;self.realClearColor.call(gl,r,g,b,a)};this.viewport=gl.getParameter(gl.VIEWPORT);gl.viewport=function(x,y,w,h){self.viewport[0]=x;self.viewport[1]=y;self.viewport[2]=w;self.viewport[3]=h;self.realViewport.call(gl,x,y,w,h)};this.isPatched=!0;safariCssSizeWorkaround(canvas)}};CardboardDistorter.prototype.unpatch=function(){if(this.isPatched){var gl=
this.gl,canvas=this.gl.canvas;isIOS()||(Object.defineProperty(canvas,"width",this.realCanvasWidth),Object.defineProperty(canvas,"height",this.realCanvasHeight));canvas.width=this.bufferWidth;canvas.height=this.bufferHeight;gl.bindFramebuffer=this.realBindFramebuffer;gl.enable=this.realEnable;gl.disable=this.realDisable;gl.colorMask=this.realColorMask;gl.clearColor=this.realClearColor;gl.viewport=this.realViewport;this.lastBoundFramebuffer==this.framebuffer&&gl.bindFramebuffer(gl.FRAMEBUFFER,null);
this.isPatched=!1;setTimeout(function(){safariCssSizeWorkaround(canvas)},1)}};CardboardDistorter.prototype.setTextureBounds=function(leftBounds,rightBounds){leftBounds||(leftBounds=[0,0,.5,1]);rightBounds||(rightBounds=[.5,0,.5,1]);this.viewportOffsetScale[0]=leftBounds[0];this.viewportOffsetScale[1]=leftBounds[1];this.viewportOffsetScale[2]=leftBounds[2];this.viewportOffsetScale[3]=leftBounds[3];this.viewportOffsetScale[4]=rightBounds[0];this.viewportOffsetScale[5]=rightBounds[1];this.viewportOffsetScale[6]=
rightBounds[2];this.viewportOffsetScale[7]=rightBounds[3]};CardboardDistorter.prototype.submitFrame=function(){var gl$jscomp$0=this.gl,self=this,glState=[];this.dirtySubmitFrameBindings||glState.push(gl$jscomp$0.CURRENT_PROGRAM,gl$jscomp$0.ARRAY_BUFFER_BINDING,gl$jscomp$0.ELEMENT_ARRAY_BUFFER_BINDING,gl$jscomp$0.TEXTURE_BINDING_2D,gl$jscomp$0.TEXTURE0);glPreserveState(gl$jscomp$0,glState,function(gl){self.realBindFramebuffer.call(gl,gl.FRAMEBUFFER,null);var positionDivisor=0,texCoordDivisor=0;self.instanceExt&&
(positionDivisor=gl.getVertexAttrib(self.attribs.position,self.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),texCoordDivisor=gl.getVertexAttrib(self.attribs.texCoord,self.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE));self.cullFace&&self.realDisable.call(gl,gl.CULL_FACE);self.depthTest&&self.realDisable.call(gl,gl.DEPTH_TEST);self.blend&&self.realDisable.call(gl,gl.BLEND);self.scissorTest&&self.realDisable.call(gl,gl.SCISSOR_TEST);self.stencilTest&&self.realDisable.call(gl,gl.STENCIL_TEST);self.realColorMask.call(gl,
!0,!0,!0,!0);self.realViewport.call(gl,0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);if(self.ctxAttribs.alpha||isIOS())self.realClearColor.call(gl,0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT);gl.useProgram(self.program);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,self.indexBuffer);gl.bindBuffer(gl.ARRAY_BUFFER,self.vertexBuffer);gl.enableVertexAttribArray(self.attribs.position);gl.enableVertexAttribArray(self.attribs.texCoord);gl.vertexAttribPointer(self.attribs.position,2,gl.FLOAT,!1,20,0);gl.vertexAttribPointer(self.attribs.texCoord,
3,gl.FLOAT,!1,20,8);self.instanceExt&&(0!=positionDivisor&&self.instanceExt.vertexAttribDivisorANGLE(self.attribs.position,0),0!=texCoordDivisor&&self.instanceExt.vertexAttribDivisorANGLE(self.attribs.texCoord,0));gl.activeTexture(gl.TEXTURE0);gl.uniform1i(self.uniforms.diffuse,0);gl.bindTexture(gl.TEXTURE_2D,self.renderTarget);gl.uniform4fv(self.uniforms.viewportOffsetScale,self.viewportOffsetScale);gl.drawElements(gl.TRIANGLES,self.indexCount,gl.UNSIGNED_SHORT,0);self.cardboardUI&&self.cardboardUI.renderNoState();
self.realBindFramebuffer.call(self.gl,gl.FRAMEBUFFER,self.framebuffer);self.ctxAttribs.preserveDrawingBuffer||(self.realClearColor.call(gl,0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT));self.dirtySubmitFrameBindings||self.realBindFramebuffer.call(gl,gl.FRAMEBUFFER,self.lastBoundFramebuffer);self.cullFace&&self.realEnable.call(gl,gl.CULL_FACE);self.depthTest&&self.realEnable.call(gl,gl.DEPTH_TEST);self.blend&&self.realEnable.call(gl,gl.BLEND);self.scissorTest&&self.realEnable.call(gl,gl.SCISSOR_TEST);self.stencilTest&&
self.realEnable.call(gl,gl.STENCIL_TEST);self.realColorMask.apply(gl,self.colorMask);self.realViewport.apply(gl,self.viewport);!self.ctxAttribs.alpha&&self.ctxAttribs.preserveDrawingBuffer||self.realClearColor.apply(gl,self.clearColor);self.instanceExt&&(0!=positionDivisor&&self.instanceExt.vertexAttribDivisorANGLE(self.attribs.position,positionDivisor),0!=texCoordDivisor&&self.instanceExt.vertexAttribDivisorANGLE(self.attribs.texCoord,texCoordDivisor))});isIOS()&&(gl$jscomp$0=gl$jscomp$0.canvas,
gl$jscomp$0.width!=self.bufferWidth||gl$jscomp$0.height!=self.bufferHeight)&&(self.bufferWidth=gl$jscomp$0.width,self.bufferHeight=gl$jscomp$0.height,self.onResize())};CardboardDistorter.prototype.updateDeviceInfo=function(deviceInfo){var gl$jscomp$0=this.gl,self=this;glPreserveState(gl$jscomp$0,[gl$jscomp$0.ARRAY_BUFFER_BINDING,gl$jscomp$0.ELEMENT_ARRAY_BUFFER_BINDING],function(gl){var vertices=self.computeMeshVertices_(self.meshWidth,self.meshHeight,deviceInfo);gl.bindBuffer(gl.ARRAY_BUFFER,self.vertexBuffer);
gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);self.indexCount||(vertices=self.computeMeshIndices_(self.meshWidth,self.meshHeight),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,self.indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,vertices,gl.STATIC_DRAW),self.indexCount=vertices.length)})};CardboardDistorter.prototype.computeMeshVertices_=function(width,height,deviceInfo){for(var vertices=new Float32Array(2*width*height*5),lensFrustum=deviceInfo.getLeftEyeVisibleTanAngles(),noLensFrustum=deviceInfo.getLeftEyeNoLensTanAngles(),
viewport=deviceInfo.getLeftEyeVisibleScreenRect(noLensFrustum),vidx=0,e=0;2>e;e++){for(var j=0;j<height;j++)for(var i=0;i<width;i++,vidx++){var u=i/(width-1),v=j/(height-1),s=u,t=v,a=lensFrustum[0];u=a+(lensFrustum[2]-a)*u;a=lensFrustum[3];var y=a+(lensFrustum[1]-a)*v;v=Math.sqrt(u*u+y*y);a=deviceInfo.distortion.distortInverse(v);y=y*a/v;u=(u*a/v-noLensFrustum[0])/(noLensFrustum[2]-noLensFrustum[0]);v=(y-noLensFrustum[3])/(noLensFrustum[1]-noLensFrustum[3]);u=2*(viewport.x+u*viewport.width-.5);v=
2*(viewport.y+v*viewport.height-.5);vertices[5*vidx]=u;vertices[5*vidx+1]=v;vertices[5*vidx+2]=s;vertices[5*vidx+3]=t;vertices[5*vidx+4]=e}j=lensFrustum[2]-lensFrustum[0];lensFrustum[0]=-(j+lensFrustum[0]);lensFrustum[2]=j-lensFrustum[2];j=noLensFrustum[2]-noLensFrustum[0];noLensFrustum[0]=-(j+noLensFrustum[0]);noLensFrustum[2]=j-noLensFrustum[2];viewport.x=1-(viewport.x+viewport.width)}return vertices};CardboardDistorter.prototype.computeMeshIndices_=function(width,height){for(var indices=new Uint16Array(2*
(width-1)*(height-1)*6),halfwidth=width/2,halfheight=height/2,vidx=0,iidx=0,e=0;2>e;e++)for(var j=0;j<height;j++)for(var i=0;i<width;i++,vidx++)0!=i&&0!=j&&(i<=halfwidth==j<=halfheight?(indices[iidx++]=vidx,indices[iidx++]=vidx-width-1,indices[iidx++]=vidx-width,indices[iidx++]=vidx-width-1,indices[iidx++]=vidx,indices[iidx++]=vidx-1):(indices[iidx++]=vidx-1,indices[iidx++]=vidx-width,indices[iidx++]=vidx,indices[iidx++]=vidx-width,indices[iidx++]=vidx-1,indices[iidx++]=vidx-width-1));return indices};
CardboardDistorter.prototype.getOwnPropertyDescriptor_=function(proto,attrName){proto=Object.getOwnPropertyDescriptor(proto,attrName);if(void 0===proto.get||void 0===proto.set)proto.configurable=!0,proto.enumerable=!0,proto.get=function(){return this.getAttribute(attrName)},proto.set=function(val){this.setAttribute(attrName,val)};return proto};var DEG2RAD=Math.PI/180;CardboardUI.prototype.destroy=function(){var gl=this.gl;this.listener&&gl.canvas.removeEventListener("click",this.listener,!1);gl.deleteProgram(this.program);
gl.deleteBuffer(this.vertexBuffer)};CardboardUI.prototype.listen=function(optionsCallback,backCallback){var canvas=this.gl.canvas;this.listener=function(event){var midline=canvas.clientWidth/2;event.clientX>midline-42&&event.clientX<midline+42&&event.clientY>canvas.clientHeight-42?optionsCallback(event):42>event.clientX&&42>event.clientY&&backCallback(event)};canvas.addEventListener("click",this.listener,!1)};CardboardUI.prototype.onResize=function(){var gl$jscomp$0=this.gl,self=this;glPreserveState(gl$jscomp$0,
[gl$jscomp$0.ARRAY_BUFFER_BINDING],function(gl){function addGearSegment(theta,r){var angle=(90-theta)*DEG2RAD;theta=Math.cos(angle);angle=Math.sin(angle);vertices.push(.3125*theta*buttonScale+midline,.3125*angle*buttonScale+buttonScale);vertices.push(r*theta*buttonScale+midline,r*angle*buttonScale+buttonScale)}function addArrowVertex(x,y){vertices.push(buttonBorder+x,gl.drawingBufferHeight-buttonBorder-y)}var vertices=[],midline=gl.drawingBufferWidth/2,dps=gl.drawingBufferWidth/(Math.max(screen.width,
screen.height)*window.devicePixelRatio)*window.devicePixelRatio,lineWidth=4*dps/2,buttonSize=42*dps,buttonScale=28*dps/2,buttonBorder=14*dps;vertices.push(midline-lineWidth,buttonSize);vertices.push(midline-lineWidth,gl.drawingBufferHeight);vertices.push(midline+lineWidth,buttonSize);vertices.push(midline+lineWidth,gl.drawingBufferHeight);self.gearOffset=vertices.length/2;for(buttonSize=0;6>=buttonSize;buttonSize++){var segmentTheta=60*buttonSize;addGearSegment(segmentTheta,1);addGearSegment(segmentTheta+
12,1);addGearSegment(segmentTheta+20,.75);addGearSegment(segmentTheta+40,.75);addGearSegment(segmentTheta+48,1)}self.gearVertexCount=vertices.length/2-self.gearOffset;self.arrowOffset=vertices.length/2;buttonSize=lineWidth/Math.sin(45*DEG2RAD);addArrowVertex(0,buttonScale);addArrowVertex(buttonScale,0);addArrowVertex(buttonScale+buttonSize,buttonSize);addArrowVertex(buttonSize,buttonScale+buttonSize);addArrowVertex(buttonSize,buttonScale-buttonSize);addArrowVertex(0,buttonScale);addArrowVertex(buttonScale,
2*buttonScale);addArrowVertex(buttonScale+buttonSize,2*buttonScale-buttonSize);addArrowVertex(buttonSize,buttonScale-buttonSize);addArrowVertex(0,buttonScale);addArrowVertex(buttonSize,buttonScale-lineWidth);addArrowVertex(28*dps,buttonScale-lineWidth);addArrowVertex(buttonSize,buttonScale+lineWidth);addArrowVertex(28*dps,buttonScale+lineWidth);self.arrowVertexCount=vertices.length/2-self.arrowOffset;gl.bindBuffer(gl.ARRAY_BUFFER,self.vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(vertices),
gl.STATIC_DRAW)})};CardboardUI.prototype.render=function(){var gl$jscomp$0=this.gl,self=this;glPreserveState(gl$jscomp$0,[gl$jscomp$0.CULL_FACE,gl$jscomp$0.DEPTH_TEST,gl$jscomp$0.BLEND,gl$jscomp$0.SCISSOR_TEST,gl$jscomp$0.STENCIL_TEST,gl$jscomp$0.COLOR_WRITEMASK,gl$jscomp$0.VIEWPORT,gl$jscomp$0.CURRENT_PROGRAM,gl$jscomp$0.ARRAY_BUFFER_BINDING],function(gl){gl.disable(gl.CULL_FACE);gl.disable(gl.DEPTH_TEST);gl.disable(gl.BLEND);gl.disable(gl.SCISSOR_TEST);gl.disable(gl.STENCIL_TEST);gl.colorMask(!0,
!0,!0,!0);gl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);self.renderNoState()})};CardboardUI.prototype.renderNoState=function(){var gl=this.gl;gl.useProgram(this.program);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.enableVertexAttribArray(this.attribs.position);gl.vertexAttribPointer(this.attribs.position,2,gl.FLOAT,!1,8,0);gl.uniform4f(this.uniforms.color,1,1,1,1);var out=this.projMat,right=gl.drawingBufferWidth,top=gl.drawingBufferHeight,lr=1/(0-right),bt=1/(0-top),nf=1/-1023.9;
out[0]=-2*lr;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=-2*bt;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=2*nf;out[11]=0;out[12]=(0+right)*lr;out[13]=(top+0)*bt;out[14]=1024.1*nf;out[15]=1;gl.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat);gl.drawArrays(gl.TRIANGLE_STRIP,0,4);gl.drawArrays(gl.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount);gl.drawArrays(gl.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};Distortion.prototype.distortInverse=function(radius){for(var r0=0,r1=
1,dr0=radius-this.distort(r0);1E-4<Math.abs(r1-r0);){var dr1=radius-this.distort(r1);dr0=r1-(r1-r0)/(dr1-dr0)*dr1;r0=r1;r1=dr0;dr0=dr1}return r1};Distortion.prototype.distort=function(radius){for(var r2=radius*radius,ret=0,i=0;i<this.coefficients.length;i++)ret=r2*(ret+this.coefficients[i]);return(ret+1)*radius};var degToRad=Math.PI/180,radToDeg=180/Math.PI,Vector3=function(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0};Vector3.prototype={constructor:Vector3,set:function(x,y,z){this.x=x;this.y=y;this.z=
z;return this},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var scalar=this.length();0!==scalar?this.multiplyScalar(1/scalar):this.z=this.y=this.x=0;return this},multiplyScalar:function(scalar){this.x*=scalar;this.y*=scalar;this.z*=scalar},applyQuaternion:function(q){var x=this.x,y=this.y,z=this.z,qx=q.x,qy=q.y,qz=q.z;q=q.w;var ix=q*x+qy*z-qz*y,iy=q*y+qz*x-qx*z,iz=q*z+qx*y-qy*x;x=
-qx*x-qy*y-qz*z;this.x=ix*q+x*-qx+iy*-qz-iz*-qy;this.y=iy*q+x*-qy+iz*-qx-ix*-qz;this.z=iz*q+x*-qz+ix*-qy-iy*-qx;return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},crossVectors:function(a,b){var ax=a.x,ay=a.y;a=a.z;var bx=b.x,by=b.y;b=b.z;this.x=ay*b-a*by;this.y=a*bx-ax*b;this.z=ax*by-ay*bx;return this}};var Quaternion=function(x,y,z,w){this.x=x||0;this.y=y||0;this.z=z||0;this.w=void 0!==w?w:1};Quaternion.prototype={constructor:Quaternion,set:function(x,y,z,w){this.x=x;this.y=y;
this.z=z;this.w=w;return this},copy:function(quaternion){this.x=quaternion.x;this.y=quaternion.y;this.z=quaternion.z;this.w=quaternion.w;return this},setFromEulerXYZ:function(x,y,z){var c1=Math.cos(x/2),c2=Math.cos(y/2),c3=Math.cos(z/2);x=Math.sin(x/2);y=Math.sin(y/2);z=Math.sin(z/2);this.x=x*c2*c3+c1*y*z;this.y=c1*y*c3-x*c2*z;this.z=c1*c2*z+x*y*c3;this.w=c1*c2*c3-x*y*z;return this},setFromEulerYXZ:function(x,y,z){var c1=Math.cos(x/2),c2=Math.cos(y/2),c3=Math.cos(z/2);x=Math.sin(x/2);y=Math.sin(y/
2);z=Math.sin(z/2);this.x=x*c2*c3+c1*y*z;this.y=c1*y*c3-x*c2*z;this.z=c1*c2*z-x*y*c3;this.w=c1*c2*c3+x*y*z;return this},setFromAxisAngle:function(axis,angle){angle/=2;var s=Math.sin(angle);this.x=axis.x*s;this.y=axis.y*s;this.z=axis.z*s;this.w=Math.cos(angle);return this},multiply:function(q){return this.multiplyQuaternions(this,q)},multiplyQuaternions:function(a,b){var qax=a.x,qay=a.y,qaz=a.z;a=a.w;var qbx=b.x,qby=b.y,qbz=b.z;b=b.w;this.x=qax*b+a*qbx+qay*qbz-qaz*qby;this.y=qay*b+a*qby+qaz*qbx-qax*
qbz;this.z=qaz*b+a*qbz+qax*qby-qay*qbx;this.w=a*b-qax*qbx-qay*qby-qaz*qbz;return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;this.normalize();return this},normalize:function(){var l=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===l?(this.z=this.y=this.x=0,this.w=1):(l=1/l,this.x*=l,this.y*=l,this.z*=l,this.w*=l);return this},slerp:function(qb,t){if(0===t)return this;if(1===t)return this.copy(qb);var x=this.x,y=this.y,z=this.z,w=this.w,cosHalfTheta=w*qb.w+x*qb.x+
y*qb.y+z*qb.z;0>cosHalfTheta?(this.w=-qb.w,this.x=-qb.x,this.y=-qb.y,this.z=-qb.z,cosHalfTheta=-cosHalfTheta):this.copy(qb);if(1<=cosHalfTheta)return this.w=w,this.x=x,this.y=y,this.z=z,this;qb=Math.acos(cosHalfTheta);var sinHalfTheta=Math.sqrt(1-cosHalfTheta*cosHalfTheta);if(.001>Math.abs(sinHalfTheta))return this.w=.5*(w+this.w),this.x=.5*(x+this.x),this.y=.5*(y+this.y),this.z=.5*(z+this.z),this;cosHalfTheta=Math.sin((1-t)*qb)/sinHalfTheta;t=Math.sin(t*qb)/sinHalfTheta;this.w=w*cosHalfTheta+this.w*
t;this.x=x*cosHalfTheta+this.x*t;this.y=y*cosHalfTheta+this.y*t;this.z=z*cosHalfTheta+this.z*t;return this},setFromUnitVectors:function(){var v1,r;return function(vFrom,vTo){void 0===v1&&(v1=new Vector3);r=vFrom.dot(vTo)+1;1E-6>r?(r=0,Math.abs(vFrom.x)>Math.abs(vFrom.z)?v1.set(-vFrom.y,vFrom.x,0):v1.set(0,-vFrom.z,vFrom.y)):v1.crossVectors(vFrom,vTo);this.x=v1.x;this.y=v1.y;this.z=v1.z;this.w=r;this.normalize();return this}}()};var DEFAULT_ANDROID=new Device({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),
DEFAULT_IOS=new Device({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Viewers={CardboardV1:new CardboardViewer({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new CardboardViewer({id:"CardboardV2",label:"Cardboard I/O 2015",
fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-9.904169E-4,6.183535E-5,-1.6981803E-6]})};DeviceInfo.prototype.updateDeviceParams=function(deviceParams){this.device=this.determineDevice_(deviceParams)||this.device};DeviceInfo.prototype.getDevice=function(){return this.device};DeviceInfo.prototype.setViewer=function(viewer){this.viewer=
viewer;this.distortion=new Distortion(this.viewer.distortionCoefficients)};DeviceInfo.prototype.determineDevice_=function(deviceParams){if(!deviceParams){if(isIOS())return console.warn("Using fallback iOS device measurements."),DEFAULT_IOS;console.warn("Using fallback Android device measurements.");return DEFAULT_ANDROID}var metersPerPixelX=.0254/deviceParams.xdpi,metersPerPixelY=.0254/deviceParams.ydpi,width=getScreenWidth(),height=getScreenHeight();return new Device({widthMeters:metersPerPixelX*
width,heightMeters:metersPerPixelY*height,bevelMeters:.001*deviceParams.bevelMm})};DeviceInfo.prototype.getDistortedFieldOfViewLeftEye=function(){var viewer=this.viewer,device=this.device,distortion=this.distortion,eyeToScreenDistance=viewer.screenLensDistance,innerDist=viewer.interLensDistance/2,bottomDist=viewer.baselineLensDistance-device.bevelMeters,topDist=device.heightMeters-bottomDist;device=radToDeg*Math.atan(distortion.distort((device.widthMeters-viewer.interLensDistance)/2/eyeToScreenDistance));
innerDist=radToDeg*Math.atan(distortion.distort(innerDist/eyeToScreenDistance));bottomDist=radToDeg*Math.atan(distortion.distort(bottomDist/eyeToScreenDistance));distortion=radToDeg*Math.atan(distortion.distort(topDist/eyeToScreenDistance));return{leftDegrees:Math.min(device,viewer.fov),rightDegrees:Math.min(innerDist,viewer.fov),downDegrees:Math.min(bottomDist,viewer.fov),upDegrees:Math.min(distortion,viewer.fov)}};DeviceInfo.prototype.getLeftEyeVisibleTanAngles=function(){var viewer=this.viewer,
device=this.device,distortion=this.distortion,fovLeft=Math.tan(-degToRad*viewer.fov),fovTop=Math.tan(degToRad*viewer.fov),fovRight=Math.tan(degToRad*viewer.fov),fovBottom=Math.tan(-degToRad*viewer.fov),halfWidth=device.widthMeters/4,halfHeight=device.heightMeters/2,centerX=viewer.interLensDistance/2-halfWidth,centerY=-(viewer.baselineLensDistance-device.bevelMeters-halfHeight),centerZ=viewer.screenLensDistance;viewer=distortion.distort((centerX-halfWidth)/centerZ);device=distortion.distort((centerY+
halfHeight)/centerZ);halfWidth=distortion.distort((centerX+halfWidth)/centerZ);distortion=distortion.distort((centerY-halfHeight)/centerZ);halfHeight=new Float32Array(4);halfHeight[0]=Math.max(fovLeft,viewer);halfHeight[1]=Math.min(fovTop,device);halfHeight[2]=Math.min(fovRight,halfWidth);halfHeight[3]=Math.max(fovBottom,distortion);return halfHeight};DeviceInfo.prototype.getLeftEyeNoLensTanAngles=function(){var viewer=this.viewer,device=this.device,distortion=this.distortion,result=new Float32Array(4),
fovLeft=distortion.distortInverse(Math.tan(-degToRad*viewer.fov)),fovTop=distortion.distortInverse(Math.tan(degToRad*viewer.fov)),fovRight=distortion.distortInverse(Math.tan(degToRad*viewer.fov));distortion=distortion.distortInverse(Math.tan(-degToRad*viewer.fov));var halfWidth=device.widthMeters/4,halfHeight=device.heightMeters/2,centerX=viewer.interLensDistance/2-halfWidth;device=-(viewer.baselineLensDistance-device.bevelMeters-halfHeight);viewer=viewer.screenLensDistance;result[0]=Math.max(fovLeft,
(centerX-halfWidth)/viewer);result[1]=Math.min(fovTop,(device+halfHeight)/viewer);result[2]=Math.min(fovRight,(centerX+halfWidth)/viewer);result[3]=Math.max(distortion,(device-halfHeight)/viewer);return result};DeviceInfo.prototype.getLeftEyeVisibleScreenRect=function(undistortedFrustum){var viewer=this.viewer,device=this.device,dist=viewer.screenLensDistance,eyeX=(device.widthMeters-viewer.interLensDistance)/2;viewer=viewer.baselineLensDistance-device.bevelMeters;var left=(undistortedFrustum[0]*
dist+eyeX)/device.widthMeters,bottom=(undistortedFrustum[3]*dist+viewer)/device.heightMeters;return{x:left,y:bottom,width:(undistortedFrustum[2]*dist+eyeX)/device.widthMeters-left,height:(undistortedFrustum[1]*dist+viewer)/device.heightMeters-bottom}};DeviceInfo.prototype.getFieldOfViewLeftEye=function(opt_isUndistorted){return opt_isUndistorted?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()};DeviceInfo.prototype.getFieldOfViewRightEye=function(opt_isUndistorted){opt_isUndistorted=
this.getFieldOfViewLeftEye(opt_isUndistorted);return{leftDegrees:opt_isUndistorted.rightDegrees,rightDegrees:opt_isUndistorted.leftDegrees,upDegrees:opt_isUndistorted.upDegrees,downDegrees:opt_isUndistorted.downDegrees}};DeviceInfo.prototype.getUndistortedFieldOfViewLeftEye=function(){var p=this.getUndistortedParams_();return{leftDegrees:radToDeg*Math.atan(p.outerDist),rightDegrees:radToDeg*Math.atan(p.innerDist),downDegrees:radToDeg*Math.atan(p.bottomDist),upDegrees:radToDeg*Math.atan(p.topDist)}};
DeviceInfo.prototype.getUndistortedViewportLeftEye=function(){var p=this.getUndistortedParams_(),device=this.device,eyeToScreenDistance=this.viewer.screenLensDistance,xPxPerTanAngle=device.width/(device.widthMeters/eyeToScreenDistance);device=device.height/(device.heightMeters/eyeToScreenDistance);eyeToScreenDistance=Math.round((p.eyePosX-p.outerDist)*xPxPerTanAngle);var y=Math.round((p.eyePosY-p.bottomDist)*device);return{x:eyeToScreenDistance,y:y,width:Math.round((p.eyePosX+p.innerDist)*xPxPerTanAngle)-
eyeToScreenDistance,height:Math.round((p.eyePosY+p.topDist)*device)-y}};DeviceInfo.prototype.getUndistortedParams_=function(){var viewer=this.viewer,device=this.device,eyeToScreenDistance=viewer.screenLensDistance,halfLensDistance=viewer.interLensDistance/2/eyeToScreenDistance,screenHeight=device.heightMeters/eyeToScreenDistance,eyePosX=device.widthMeters/eyeToScreenDistance/2-halfLensDistance;device=(viewer.baselineLensDistance-device.bevelMeters)/eyeToScreenDistance;viewer=this.distortion.distortInverse(Math.tan(degToRad*
viewer.fov));return{outerDist:Math.min(eyePosX,viewer),innerDist:Math.min(halfLensDistance,viewer),topDist:Math.min(screenHeight-device,viewer),bottomDist:Math.min(device,viewer),eyePosX:eyePosX,eyePosY:device}};DeviceInfo.Viewers=Viewers;var DPDB_CACHE={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",
rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},
{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},
{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},
{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],
dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,
ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,
ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},
{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,
405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],
dpi:[403,400],bw:2,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,
444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,
bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],
dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,
518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],
dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,
520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},
{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",
rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1E3},
{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},
{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,
1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,
2688]}],dpi:458,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},
{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};Dpdb.prototype.getDeviceParams=function(){return this.deviceParams};Dpdb.prototype.recalculateDeviceParams_=function(){var newDeviceParams=this.calcDeviceParams_();if(newDeviceParams){if(this.deviceParams=newDeviceParams,this.onDeviceParamsUpdated)this.onDeviceParamsUpdated(this.deviceParams)}else console.error("Failed to recalculate device parameters.")};Dpdb.prototype.calcDeviceParams_=function(){var db=this.dpdb;if(!db)return console.error("DPDB not available."),
null;if(1!=db.format)return console.error("DPDB has unexpected format version."),null;if(!db.devices||!db.devices.length)return console.error("DPDB does not have a devices section."),null;var userAgent=navigator.userAgent||navigator.vendor||window.opera,width=getScreenWidth(),height=getScreenHeight();if(!db.devices)return console.error("DPDB has no devices section."),null;for(var i=0;i<db.devices.length;i++){var device=db.devices[i];if(!device.rules)console.warn("Device["+i+"] has no rules section.");
else if("ios"!=device.type&&"android"!=device.type)console.warn("Device["+i+"] has invalid type.");else if(isIOS()==("ios"==device.type)){for(var matched=!1,j=0;j<device.rules.length;j++)if(this.ruleMatches_(device.rules[j],userAgent,width,height)){matched=!0;break}if(matched)return new DeviceParams({xdpi:device.dpi[0]||device.dpi,ydpi:device.dpi[1]||device.dpi,bevelMm:device.bw})}}console.warn("No DPDB device match.");return null};Dpdb.prototype.ruleMatches_=function(rule,ua,screenWidth,screenHeight){if(!rule.ua&&
!rule.res)return!1;rule.ua&&"SM"===rule.ua.substring(0,2)&&(rule.ua=rule.ua.substring(0,7));if(rule.ua&&0>ua.indexOf(rule.ua))return!1;if(rule.res){if(!rule.res[0]||!rule.res[1])return!1;ua=rule.res[0];rule=rule.res[1];if(Math.min(screenWidth,screenHeight)!=Math.min(ua,rule)||Math.max(screenWidth,screenHeight)!=Math.max(ua,rule))return!1}return!0};SensorSample.prototype.set=function(sample,timestampS){this.sample=sample;this.timestampS=timestampS};SensorSample.prototype.copy=function(sensorSample){this.set(sensorSample.sample,
sensorSample.timestampS)};ComplementaryFilter.prototype.addAccelMeasurement=function(vector,timestampS){this.currentAccelMeasurement.set(vector,timestampS)};ComplementaryFilter.prototype.addGyroMeasurement=function(vector,timestampS){this.currentGyroMeasurement.set(vector,timestampS);vector=timestampS-this.previousGyroMeasurement.timestampS;isNaN(vector)||.001>=vector||1<vector||this.run_();this.previousGyroMeasurement.copy(this.currentGyroMeasurement)};ComplementaryFilter.prototype.run_=function(){if(this.isOrientationInitialized){var gyroDeltaQ=
this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS);this.gyroIntegralQ.multiply(gyroDeltaQ);this.filterQ.copy(this.previousFilterQ);this.filterQ.multiply(gyroDeltaQ);gyroDeltaQ=new Quaternion;gyroDeltaQ.copy(this.filterQ);gyroDeltaQ.inverse();this.estimatedGravity.set(0,0,-1);this.estimatedGravity.applyQuaternion(gyroDeltaQ);this.estimatedGravity.normalize();this.measuredGravity.copy(this.currentAccelMeasurement.sample);
this.measuredGravity.normalize();gyroDeltaQ=new Quaternion;gyroDeltaQ.setFromUnitVectors(this.estimatedGravity,this.measuredGravity);gyroDeltaQ.inverse();this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",radToDeg*getQuaternionAngle(gyroDeltaQ),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var targetQ=new Quaternion;
targetQ.copy(this.filterQ);targetQ.multiply(gyroDeltaQ);this.filterQ.slerp(targetQ,1-this.kFilter);this.previousFilterQ.copy(this.filterQ)}else this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0};ComplementaryFilter.prototype.getOrientation=function(){return this.filterQ};ComplementaryFilter.prototype.accelToQuaternion_=function(accel){var normAccel=new Vector3;normAccel.copy(accel);normAccel.normalize();
accel=new Quaternion;accel.setFromUnitVectors(new Vector3(0,0,-1),normAccel);accel.inverse();return accel};ComplementaryFilter.prototype.gyroToQuaternionDelta_=function(gyro,dt){var quat=new Quaternion,axis=new Vector3;axis.copy(gyro);axis.normalize();quat.setFromAxisAngle(axis,gyro.length()*dt);return quat};PosePredictor.prototype.getPrediction=function(currentQ,gyro,timestampS){if(!this.previousTimestampS)return this.previousQ.copy(currentQ),this.previousTimestampS=timestampS,currentQ;var axis=
new Vector3;axis.copy(gyro);axis.normalize();gyro=gyro.length();if(gyro<20*degToRad)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(radToDeg*gyro).toFixed(1)),this.outQ.copy(currentQ),this.previousQ.copy(currentQ),this.outQ;this.deltaQ.setFromAxisAngle(axis,gyro*this.predictionTimeS);this.outQ.copy(this.previousQ);this.outQ.multiply(this.deltaQ);this.previousQ.copy(currentQ);this.previousTimestampS=timestampS;return this.outQ};FusionPoseSensor.prototype.getPosition=function(){return null};
FusionPoseSensor.prototype.getOrientation=function(){var orientation=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var z=(new Quaternion).setFromAxisAngle(new Vector3(0,0,-1),0),y=new Quaternion;-90===window.orientation?y.setFromAxisAngle(new Vector3(0,1,0),Math.PI/-2):y.setFromAxisAngle(new Vector3(0,1,0),Math.PI/2);return z.multiply(y)}();this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||
function(){var q=new Quaternion;q.setFromAxisAngle(new Vector3(1,0,0),-Math.PI/2);return q}();orientation=this._deviceOrientationQ;var out=new Quaternion;out.copy(orientation);out.multiply(this.deviceOrientationFilterToWorldQ);out.multiply(this.resetQ);out.multiply(this.worldToScreenQ);out.multiplyQuaternions(this.deviceOrientationFixQ,out);this.yawOnly&&(out.x=0,out.z=0,out.normalize());this.orientationOut_[0]=out.x;this.orientationOut_[1]=out.y;this.orientationOut_[2]=out.z;this.orientationOut_[3]=
out.w;return this.orientationOut_}orientation=this.filter.getOrientation();orientation=this.posePredictor.getPrediction(orientation,this.gyroscope,this.previousTimestampS);out=new Quaternion;out.copy(this.filterToWorldQ);out.multiply(this.resetQ);out.multiply(orientation);out.multiply(this.worldToScreenQ);this.yawOnly&&(out.x=0,out.z=0,out.normalize());this.orientationOut_[0]=out.x;this.orientationOut_[1]=out.y;this.orientationOut_[2]=out.z;this.orientationOut_[3]=out.w;return this.orientationOut_};
FusionPoseSensor.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation());this.resetQ.x=0;this.resetQ.y=0;this.resetQ.z*=-1;this.resetQ.normalize();isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ);this.resetQ.multiply(this.originalPoseAdjustQ)};FusionPoseSensor.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new Quaternion;var alpha=e.alpha,beta=e.beta;e=e.gamma;alpha=(alpha||0)*Math.PI/180;beta=(beta||0)*Math.PI/
180;e=(e||0)*Math.PI/180;this._deviceOrientationQ.setFromEulerYXZ(beta,alpha,-e)};FusionPoseSensor.prototype.onDeviceMotion_=function(deviceMotion){this.updateDeviceMotion_(deviceMotion)};FusionPoseSensor.prototype.updateDeviceMotion_=function(deviceMotion){var accGravity=deviceMotion.accelerationIncludingGravity,rotRate=deviceMotion.rotationRate;deviceMotion=deviceMotion.timeStamp/1E3;var deltaS=deviceMotion-this.previousTimestampS;0>deltaS?warnOnce("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"):
.001>=deltaS||1<deltaS?warnOnce("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."):(this.accelerometer.set(-accGravity.x,-accGravity.y,-accGravity.z),rotRate&&(isR7()?this.gyroscope.set(-rotRate.beta,rotRate.alpha,rotRate.gamma):this.gyroscope.set(rotRate.alpha,rotRate.beta,rotRate.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,deviceMotion)),
this.filter.addAccelMeasurement(this.accelerometer,deviceMotion));this.previousTimestampS=deviceMotion};FusionPoseSensor.prototype.onOrientationChange_=function(screenOrientation){this.setScreenTransform_()};FusionPoseSensor.prototype.onMessage_=function(event){(event=event.data)&&event.type&&"devicemotion"===event.type.toLowerCase()&&this.updateDeviceMotion_(event.deviceMotionEvent)};FusionPoseSensor.prototype.setScreenTransform_=function(){this.worldToScreenQ.set(0,0,0,1);switch(window.orientation){case 90:this.worldToScreenQ.setFromAxisAngle(new Vector3(0,
0,1),-Math.PI/2);break;case -90:this.worldToScreenQ.setFromAxisAngle(new Vector3(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ);this.inverseWorldToScreenQ.inverse()};FusionPoseSensor.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this);this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this);this.onMessageCallback_=this.onMessage_.bind(this);this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this);var JSCompiler_temp;
if(JSCompiler_temp=isIOS()){JSCompiler_temp=window.self!==window.top;var refOrigin=getOriginFromUrl(document.referrer),thisOrigin=getOriginFromUrl(window.location.href);JSCompiler_temp=JSCompiler_temp&&refOrigin!==thisOrigin}JSCompiler_temp&&window.addEventListener("message",this.onMessageCallback_);window.addEventListener("orientationchange",this.onOrientationChangeCallback_);this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",
this.onDeviceMotionCallback_)};FusionPoseSensor.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_);window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_);window.removeEventListener("orientationchange",this.onOrientationChangeCallback_);window.removeEventListener("message",this.onMessageCallback_)};var X_AXIS=new Vector3(1,0,0),Z_AXIS=new Vector3(0,0,1),SENSOR_TO_VR=new Quaternion;SENSOR_TO_VR.setFromAxisAngle(X_AXIS,-Math.PI/
2);SENSOR_TO_VR.multiply((new Quaternion).setFromAxisAngle(Z_AXIS,Math.PI/2));var PoseSensor=function(){function PoseSensor(config){if(!(this instanceof PoseSensor))throw new TypeError("Cannot call a class as a function");this.config=config;this.fusionSensor=this.sensor=null;this._out=new Float32Array(4);this.api=null;this.errors=[];this._sensorQ=new Quaternion;this._outQ=new Quaternion;this._onSensorRead=this._onSensorRead.bind(this);this._onSensorError=this._onSensorError.bind(this);this.init()}
createClass(PoseSensor,[{key:"init",value:function(){var sensor=null;try{sensor=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"}),sensor.addEventListener("error",this._onSensorError)}catch(error){this.errors.push(error),"SecurityError"===error.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===
error.name?this.useDeviceMotion():console.error(error)}sensor&&(this.api="sensor",this.sensor=sensor,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion";this.fusionSensor=new FusionPoseSensor(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG);this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),
this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var q=this.sensor.quaternion;this._sensorQ.set(q[0],q[1],q[2],q[3]);q=this._outQ;q.copy(SENSOR_TO_VR);q.multiply(this._sensorQ);this.config.YAW_ONLY&&(q.x=q.z=0,q.normalize());this._out[0]=q.x;this._out[1]=q.y;this._out[2]=q.z;this._out[3]=q.w;return this._out}},{key:"_onSensorError",
value:function(event){this.errors.push(event.error);"NotAllowedError"===event.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===event.error.name?console.error("Sensor could not be read"):console.error(event.error);this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]);return PoseSensor}();RotateInstructions.prototype.show=function(parent){parent||this.overlay.parentElement?parent&&(this.overlay.parentElement&&this.overlay.parentElement!=parent&&this.overlay.parentElement.removeChild(this.overlay),
parent.appendChild(this.overlay)):document.body.appendChild(this.overlay);this.overlay.style.display="block";parent=this.overlay.querySelector("img").style;isLandscapeMode()?(parent.width="20%",parent.marginLeft="40%",parent.marginTop="3%"):(parent.width="50%",parent.marginLeft="25%",parent.marginTop="25%")};RotateInstructions.prototype.hide=function(){this.overlay.style.display="none"};RotateInstructions.prototype.showTemporarily=function(ms,parent){this.show(parent);this.timer=setTimeout(this.hide.bind(this),
ms)};RotateInstructions.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)};RotateInstructions.prototype.update=function(){this.disableShowTemporarily();!isLandscapeMode()&&isMobile()?this.show():this.hide()};RotateInstructions.prototype.loadIcon_=function(){this.icon="data:image/svg+xml,"+encodeURIComponent("\x3csvg width\x3d'198' height\x3d'240' viewBox\x3d'0 0 198 240' xmlns\x3d'http://www.w3.org/2000/svg'\x3e\x3cg fill\x3d'none' fill-rule\x3d'evenodd'\x3e\x3cpath d\x3d'M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill\x3d'#607D8B'/\x3e\x3cg\x3e\x3cpath d\x3d'M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M128.267 11.565l1.495.434-56.339 32.326' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill\x3d'#607D8B'/\x3e\x3cpath d\x3d'M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill\x3d'#FAFAFA'/\x3e\x3cpath d\x3d'M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill\x3d'#8097A2'/\x3e\x3cpath d\x3d'M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill\x3d'#8097A2'/\x3e\x3cpath d\x3d'M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill\x3d'#FFF'/\x3e\x3cpath d\x3d'M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill\x3d'#8097A2'/\x3e\x3cpath d\x3d'M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill\x3d'#8097A2'/\x3e\x3cpath d\x3d'M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill\x3d'#455A64'/\x3e\x3cpath d\x3d'M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill\x3d'#607D8B'/\x3e\x3c/g\x3e\x3cpath d\x3d'M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill\x3d'#455A64'/\x3e\x3c/g\x3e\x3c/svg\x3e")};
ViewerSelector.prototype.show=function(root){this.root=root;root.appendChild(this.dialog);this.dialog.querySelector("#"+this.selectedKey).checked=!0;this.dialog.style.display="block"};ViewerSelector.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog);this.dialog.style.display="none"};ViewerSelector.prototype.getCurrentViewer=function(){return DeviceInfo.Viewers[this.selectedKey]};ViewerSelector.prototype.getSelectedKey_=function(){var input=this.dialog.querySelector("input[name\x3dfield]:checked");
return input?input.id:null};ViewerSelector.prototype.onChange=function(cb){this.onChangeCallbacks_.push(cb)};ViewerSelector.prototype.fireOnChange_=function(viewer){for(var i=0;i<this.onChangeCallbacks_.length;i++)this.onChangeCallbacks_[i](viewer)};ViewerSelector.prototype.onSave_=function(){if((this.selectedKey=this.getSelectedKey_())&&DeviceInfo.Viewers[this.selectedKey]){this.fireOnChange_(DeviceInfo.Viewers[this.selectedKey]);try{localStorage.setItem("WEBVR_CARDBOARD_VIEWER",this.selectedKey)}catch(error){console.error("Failed to save viewer profile: %s",
error)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")};ViewerSelector.prototype.createDialog_=function(options){var container=document.createElement("div");container.classList.add("webvr-polyfill-viewer-selector");container.style.display="none";var overlay=document.createElement("div"),s=overlay.style;s.position="fixed";s.left=0;s.top=0;s.width="100%";s.height="100%";s.background="rgba(0, 0, 0, 0.3)";overlay.addEventListener("click",this.hide.bind(this));var dialog=
document.createElement("div");s=dialog.style;s.boxSizing="border-box";s.position="fixed";s.top="24px";s.left="50%";s.marginLeft="-140px";s.width="280px";s.padding="24px";s.overflow="hidden";s.background="#fafafa";s.fontFamily="'Roboto', sans-serif";s.boxShadow="0px 5px 20px #666";dialog.appendChild(this.createH1_("Select your viewer"));for(var id in options)dialog.appendChild(this.createChoice_(id,options[id].label));dialog.appendChild(this.createButton_("Save",this.onSave_.bind(this)));container.appendChild(overlay);
container.appendChild(dialog);return container};ViewerSelector.prototype.createH1_=function(name){var h1=document.createElement("h1"),s=h1.style;s.color="black";s.fontSize="20px";s.fontWeight="bold";s.marginTop=0;s.marginBottom="24px";h1.innerHTML=name;return h1};ViewerSelector.prototype.createChoice_=function(id,name){var div=document.createElement("div");div.style.marginTop="8px";div.style.color="black";var input=document.createElement("input");input.style.fontSize="30px";input.setAttribute("id",
id);input.setAttribute("type","radio");input.setAttribute("value",id);input.setAttribute("name","field");var label=document.createElement("label");label.style.marginLeft="4px";label.setAttribute("for",id);label.innerHTML=name;div.appendChild(input);div.appendChild(label);return div};ViewerSelector.prototype.createButton_=function(label,onclick){var button=document.createElement("button");button.innerHTML=label;label=button.style;label.float="right";label.textTransform="uppercase";label.color="#1094f7";
label.fontSize="14px";label.letterSpacing=0;label.border=0;label.background="none";label.marginTop="16px";button.addEventListener("click",onclick);return button};var commonjsGlobal$$1="undefined"!==typeof window?window:"undefined"!==typeof commonjsGlobal?commonjsGlobal:"undefined"!==typeof self?self:{},NoSleep$1=function(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x["default"]:x}(function(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}(function(module$jscomp$0,
exports$jscomp$0){(function(root,factory){module$jscomp$0.exports=factory()})(commonjsGlobal$$1,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=!0;return module.exports}var installedModules={};__webpack_require__.m=modules;__webpack_require__.c=
installedModules;__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module["default"]}:function(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p=
"";return __webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){protoProps&&defineProperties(Constructor.prototype,
protoProps);staticProps&&defineProperties(Constructor,staticProps);return Constructor}}(),mediaFile=__webpack_require__(1),oldIOS="undefined"!==typeof navigator&&10>parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))&&!window.MSStream;exports=function(){function NoSleep(){if(!(this instanceof NoSleep))throw new TypeError("Cannot call a class as a function");oldIOS?this.noSleepTimer=
null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",mediaFile),this.noSleepVideo.addEventListener("timeupdate",function(e){.5<this.noSleepVideo.currentTime&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}_createClass(NoSleep,[{key:"enable",value:function(){oldIOS?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/";window.setTimeout(window.stop,0)},15E3)):this.noSleepVideo.play()}},
{key:"disable",value:function(){oldIOS?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]);return NoSleep}();module.exports=exports},function(module,exports,__webpack_require__){module.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA\x3d"}])})})),
nextDisplayId=1E3,defaultLeftBounds=[0,0,.5,1],defaultRightBounds=[.5,0,.5,1],raf=window.requestAnimationFrame,caf=window.cancelAnimationFrame;VRDisplay.prototype.getFrameData=function(frameData){return frameDataFromPose(frameData,this._getPose(),this)};VRDisplay.prototype.getPose=function(){deprecateWarning("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData");return this._getPose()};VRDisplay.prototype.resetPose=function(){deprecateWarning("VRDisplay.prototype.resetPose");return this._resetPose()};
VRDisplay.prototype.getImmediatePose=function(){deprecateWarning("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData");return this._getPose()};VRDisplay.prototype.requestAnimationFrame=function(callback){return raf(callback)};VRDisplay.prototype.cancelAnimationFrame=function(id){return caf(id)};VRDisplay.prototype.wrapForFullscreen=function(element){if(isIOS())return element;this.fullscreenWrapper_||(this.fullscreenWrapper_=document.createElement("div"),this.fullscreenWrapper_.setAttribute("style",
["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important; left: 0 !important; right: 0 !important; border: 0; margin: 0; padding: 0; z-index: 999999 !important; position: fixed"].join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper"));if(this.fullscreenElement_==element)return this.fullscreenWrapper_;this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_));
this.fullscreenElement_=element;(this.originalParent_=element.parentElement)||document.body.appendChild(element);this.fullscreenWrapper_.parentElement||(element=this.fullscreenElement_.parentElement,element.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),element.removeChild(this.fullscreenElement_));this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild);this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");this.fullscreenElement_&&
this.fullscreenElement_.setAttribute("style",["position: absolute; top: 0; left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0; margin: 0; padding: 0"].join("; ")+";");return this.fullscreenWrapper_};VRDisplay.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var element=this.fullscreenElement_;this.fullscreenElementCachedStyle_?element.setAttribute("style",this.fullscreenElementCachedStyle_):element.removeAttribute("style");
this.fullscreenElementCachedStyle_=this.fullscreenElement_=null;var parent=this.fullscreenWrapper_.parentElement;this.fullscreenWrapper_.removeChild(element);this.originalParent_===parent?parent.insertBefore(element,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(element);parent.removeChild(this.fullscreenWrapper_);return element}};VRDisplay.prototype.requestPresent=function(layers){var wasPresenting=this.isPresenting,self=this;layers instanceof Array||(deprecateWarning("VRDisplay.prototype.requestPresent with non-array argument",
"an array of VRLayers as the first argument"),layers=[layers]);return new Promise(function(resolve,reject){if(self.capabilities.canPresent)if(0==layers.length||layers.length>self.capabilities.maxLayers)reject(Error("Invalid number of layers."));else{var incomingLayer=layers[0];if(incomingLayer.source){var leftBounds=incomingLayer.leftBounds||defaultLeftBounds,rightBounds=incomingLayer.rightBounds||defaultRightBounds;if(wasPresenting){var layer=self.layer_;layer.source!==incomingLayer.source&&(layer.source=
incomingLayer.source);for(incomingLayer=0;4>incomingLayer;incomingLayer++)layer.leftBounds[incomingLayer]=leftBounds[incomingLayer],layer.rightBounds[incomingLayer]=rightBounds[incomingLayer];self.wrapForFullscreen(self.layer_.source);self.updatePresent_();resolve()}else{self.layer_={predistorted:incomingLayer.predistorted,source:incomingLayer.source,leftBounds:leftBounds.slice(0),rightBounds:rightBounds.slice(0)};self.waitingForPresent_=!1;if(self.layer_&&self.layer_.source){var fullscreenElement=
self.wrapForFullscreen(self.layer_.source);self.addFullscreenListeners_(fullscreenElement,function(){self.isPresenting=fullscreenElement===(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);self.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(error){console.error("screen.orientation.lock() failed due to",error.message)}),self.waitingForPresent_=!1,self.beginPresent_(),
resolve()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),self.removeFullscreenWrapper(),self.disableWakeLock(),self.endPresent_(),self.removeFullscreenListeners_());self.fireVRDisplayPresentChange_()},function(){self.waitingForPresent_&&(self.removeFullscreenWrapper(),self.removeFullscreenListeners_(),self.disableWakeLock(),self.waitingForPresent_=!1,self.isPresenting=!1,reject(Error("Unable to present.")))});if(requestFullscreen(fullscreenElement))self.enableWakeLock(),
self.waitingForPresent_=!0;else if(isIOS()||isWebViewAndroid())self.enableWakeLock(),self.isPresenting=!0,self.beginPresent_(),self.fireVRDisplayPresentChange_(),resolve()}self.waitingForPresent_||isIOS()||(exitFullscreen(),reject(Error("Unable to present.")))}}else resolve()}else reject(Error("VRDisplay is not capable of presenting."))})};VRDisplay.prototype.exitPresent=function(){var wasPresenting=this.isPresenting,self=this;this.isPresenting=!1;this.layer_=null;this.disableWakeLock();return new Promise(function(resolve,
reject){wasPresenting?(!exitFullscreen()&&isIOS()&&(self.endPresent_(),self.fireVRDisplayPresentChange_()),isWebViewAndroid()&&(self.removeFullscreenWrapper(),self.removeFullscreenListeners_(),self.endPresent_(),self.fireVRDisplayPresentChange_()),resolve()):reject(Error("Was not presenting to VRDisplay."))})};VRDisplay.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]};VRDisplay.prototype.fireVRDisplayPresentChange_=function(){var event=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});
window.dispatchEvent(event)};VRDisplay.prototype.fireVRDisplayConnect_=function(){var event=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(event)};VRDisplay.prototype.addFullscreenListeners_=function(element,changeHandler,errorHandler){this.removeFullscreenListeners_();this.fullscreenEventTarget_=element;this.fullscreenChangeHandler_=changeHandler;this.fullscreenErrorHandler_=errorHandler;changeHandler&&(document.fullscreenEnabled?element.addEventListener("fullscreenchange",
changeHandler,!1):document.webkitFullscreenEnabled?element.addEventListener("webkitfullscreenchange",changeHandler,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",changeHandler,!1):document.msFullscreenEnabled&&element.addEventListener("msfullscreenchange",changeHandler,!1));errorHandler&&(document.fullscreenEnabled?element.addEventListener("fullscreenerror",errorHandler,!1):document.webkitFullscreenEnabled?element.addEventListener("webkitfullscreenerror",errorHandler,
!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",errorHandler,!1):document.msFullscreenEnabled&&element.addEventListener("msfullscreenerror",errorHandler,!1))};VRDisplay.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var element=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var changeHandler=this.fullscreenChangeHandler_;element.removeEventListener("fullscreenchange",changeHandler,!1);element.removeEventListener("webkitfullscreenchange",
changeHandler,!1);document.removeEventListener("mozfullscreenchange",changeHandler,!1);element.removeEventListener("msfullscreenchange",changeHandler,!1)}this.fullscreenErrorHandler_&&(changeHandler=this.fullscreenErrorHandler_,element.removeEventListener("fullscreenerror",changeHandler,!1),element.removeEventListener("webkitfullscreenerror",changeHandler,!1),document.removeEventListener("mozfullscreenerror",changeHandler,!1),element.removeEventListener("msfullscreenerror",changeHandler,!1));this.fullscreenErrorHandler_=
this.fullscreenChangeHandler_=this.fullscreenEventTarget_=null}};VRDisplay.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()};VRDisplay.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()};VRDisplay.prototype.beginPresent_=function(){};VRDisplay.prototype.endPresent_=function(){};VRDisplay.prototype.submitFrame=function(pose){};VRDisplay.prototype.getEyeParameters=function(whichEye){return null};var config$jscomp$0={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",
MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};CardboardVRDisplay.prototype=Object.create(VRDisplay.prototype);CardboardVRDisplay.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};CardboardVRDisplay.prototype._resetPose=
function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()};CardboardVRDisplay.prototype._getFieldOfView=function(whichEye){if("left"==whichEye)whichEye=this.deviceInfo_.getFieldOfViewLeftEye();else if("right"==whichEye)whichEye=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",whichEye),null;return whichEye};CardboardVRDisplay.prototype._getEyeOffset=function(whichEye){if("left"==whichEye)whichEye=[.5*-this.deviceInfo_.viewer.interLensDistance,
0,0];else if("right"==whichEye)whichEye=[.5*this.deviceInfo_.viewer.interLensDistance,0,0];else return console.error("Invalid eye provided: %s",whichEye),null;return whichEye};CardboardVRDisplay.prototype.getEyeParameters=function(whichEye){var offset=this._getEyeOffset(whichEye),fieldOfView=this._getFieldOfView(whichEye);whichEye={offset:offset,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};Object.defineProperty(whichEye,
"fieldOfView",{enumerable:!0,get:function(){deprecateWarning("VRFieldOfView","VRFrameData's projection matrices");return fieldOfView}});return whichEye};CardboardVRDisplay.prototype.onDeviceParamsUpdated_=function(newParams){this.config.DEBUG&&console.log("DPDB reported that device params were updated.");this.deviceInfo_.updateDeviceParams(newParams);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)};CardboardVRDisplay.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&
(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)};CardboardVRDisplay.prototype.beginPresent_=function(){var gl=this.layer_.source.getContext("webgl");gl||(gl=this.layer_.source.getContext("experimental-webgl"));gl||(gl=this.layer_.source.getContext("webgl2"));gl&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(gl.canvas.width=getScreenWidth()*this.bufferScale_,gl.canvas.height=getScreenHeight()*this.bufferScale_,
this.cardboardUI_=new CardboardUI(gl)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new CardboardUI(gl)),this.distorter_=new CardboardDistorter(gl,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement);e.stopPropagation();e.preventDefault()}.bind(this),function(e){this.exitPresent();e.stopPropagation();
e.preventDefault()}.bind(this)),this.rotateInstructions_&&(isLandscapeMode()&&isMobile()?this.rotateInstructions_.showTemporarily(3E3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())};
CardboardVRDisplay.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null);this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null);this.rotateInstructions_&&this.rotateInstructions_.hide();this.viewerSelector_.hide();window.removeEventListener("orientationchange",this.orientationHandler);window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)};CardboardVRDisplay.prototype.updatePresent_=function(){this.endPresent_();
this.beginPresent_()};CardboardVRDisplay.prototype.submitFrame=function(pose){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){(pose=this.layer_.source.getContext("webgl"))||(pose=this.layer_.source.getContext("experimental-webgl"));pose||(pose=this.layer_.source.getContext("webgl2"));pose=pose.canvas;if(pose.width!=this.lastWidth||pose.height!=this.lastHeight)this.cardboardUI_.onResize();this.lastWidth=pose.width;this.lastHeight=pose.height;
this.cardboardUI_.render()}};CardboardVRDisplay.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide();this.rotateInstructions_&&this.rotateInstructions_.update();this.onResize_()};CardboardVRDisplay.prototype.onResize_=function(e){this.layer_&&((e=this.layer_.source.getContext("webgl"))||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e.canvas.setAttribute("style","position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; border: 0; margin: 0; padding: 0px; box-sizing: content-box;"),
safariCssSizeWorkaround(e.canvas))};CardboardVRDisplay.prototype.onViewerChanged_=function(viewer){this.deviceInfo_.setViewer(viewer);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_);this.fireVRDisplayDeviceParamsChange_()};CardboardVRDisplay.prototype.fireVRDisplayDeviceParamsChange_=function(){var event=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(event)};CardboardVRDisplay.VRFrameData=function(){this.leftProjectionMatrix=
new Float32Array(16);this.leftViewMatrix=new Float32Array(16);this.rightProjectionMatrix=new Float32Array(16);this.rightViewMatrix=new Float32Array(16);this.pose=null};CardboardVRDisplay.VRDisplay=VRDisplay;return CardboardVRDisplay})})),DefaultConfig={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,
DIRTY_SUBMIT_FRAME_BINDINGS:!1};WebVRPolyfill.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(isMobile()){var vrDisplay=new CardboardVRDisplay({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,
ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(vrDisplay)}this._polyfillDisplaysPopulated=!0;return this.polyfillDisplays};WebVRPolyfill.prototype.enable=function(){this.enabled=!0;if(this.hasNative&&this.native.VRFrameData){var NativeVRFrameData=this.native.VRFrameData,nativeFrameData=new this.native.VRFrameData,
nativeGetFrameData=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(frameData){frameData instanceof NativeVRFrameData?nativeGetFrameData.call(this,frameData):(nativeGetFrameData.call(this,nativeFrameData),frameData.pose=nativeFrameData.pose,copyArray(nativeFrameData.leftProjectionMatrix,frameData.leftProjectionMatrix),copyArray(nativeFrameData.rightProjectionMatrix,frameData.rightProjectionMatrix),copyArray(nativeFrameData.leftViewMatrix,frameData.leftViewMatrix),
copyArray(nativeFrameData.rightViewMatrix,frameData.rightViewMatrix))}}navigator.getVRDisplays=this.getVRDisplays.bind(this);window.VRDisplay=CardboardVRDisplay.VRDisplay;window.VRFrameData=CardboardVRDisplay.VRFrameData};WebVRPolyfill.prototype.getVRDisplays=function(){var _this=this;return this.hasNative?this.native.getVRDisplays.call(navigator).then(function(nativeDisplays){return 0<nativeDisplays.length?nativeDisplays:_this.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())};
WebVRPolyfill.version="0.10.12";WebVRPolyfill.VRFrameData=CardboardVRDisplay.VRFrameData;WebVRPolyfill.VRDisplay=CardboardVRDisplay.VRDisplay;var webvrPolyfill=Object.freeze({default:WebVRPolyfill});"undefined"!==typeof commonjsGlobal&&commonjsGlobal.window&&(commonjsGlobal.document||(commonjsGlobal.document=commonjsGlobal.window.document),commonjsGlobal.navigator||(commonjsGlobal.navigator=commonjsGlobal.window.navigator));return webvrPolyfill&&WebVRPolyfill||webvrPolyfill})}).call(this,"undefined"!==
typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],68:[function(_dereq_,module,exports){function monospace(text,start,end,width){return{start:start,end:start+Math.min(width,end-start)}}var newline=/\n/,whitespace=/\s/;module.exports=function(text,opt){return module.exports.lines(text,opt).map(function(line){return text.substring(line.start,line.end)}).join("\n")};module.exports.lines=function(text,opt){opt=opt||{};if(0===opt.width&&"nowrap"!==
opt.mode)return[];text=text||"";var width="number"===typeof opt.width?opt.width:Number.MAX_VALUE,start=Math.max(0,opt.start||0),end="number"===typeof opt.end?opt.end:text.length,mode=opt.mode;opt=opt.measure||monospace;if("pre"===mode){var lines=[];for(mode=start;start<end&&start<text.length;start++){var chr=text.charAt(start);if((chr=newline.test(chr))||start===end-1)mode=opt(text,mode,chr?start:start+1,width),lines.push(mode),mode=start+1}return lines}lines=start;start=[];"nowrap"===mode&&(width=
Number.MAX_VALUE);for(;lines<end&&lines<text.length;){mode=end;chr=text.indexOf("\n",lines);for(mode=-1===chr||chr>mode?mode:chr;lines<mode&&whitespace.test(text.charAt(lines));)lines++;chr=opt(text,lines,mode,width);var lineEnd=lines+(chr.end-chr.start);chr=lineEnd+1;if(lineEnd<mode){for(;lineEnd>lines&&!whitespace.test(text.charAt(lineEnd));)lineEnd--;if(lineEnd===lines)chr>lines+1&&chr--,lineEnd=chr;else for(chr=lineEnd;lineEnd>lines&&whitespace.test(text.charAt(lineEnd-1));)lineEnd--}lineEnd>=
lines&&(lines=opt(text,lines,lineEnd,width),start.push(lines));lines=chr}return start}},{}],69:[function(_dereq_,module,exports){function isEmpty(obj){for(var i in obj)if(obj.hasOwnProperty(i))return!1;return!0}function initParams(uri,options,callback){var params=uri;isFunction(options)?(callback=options,"string"===typeof uri&&(params={uri:uri})):params=xtend(options,{uri:uri});params.callback=callback;return params}function createXHR(uri,options,callback){options=initParams(uri,options,callback);
return _createXHR(options)}function _createXHR(options){function errorFunc(evt){clearTimeout(timeoutTimer);evt instanceof Error||(evt=Error(""+(evt||"Unknown XMLHttpRequest Error")));evt.statusCode=0;var response=failureResponse;called||(called=!0,options.callback(evt,response,void 0))}function loadFunc(){if(!aborted){clearTimeout(timeoutTimer);var status=options.useXDR&&void 0===xhr.status?200:1223===xhr.status?204:xhr.status;var response=failureResponse,err=null;if(0!==status){if(xhr.response)response=
xhr.response;else if(!(response=xhr.responseText))a:{try{if("document"===xhr.responseType){response=xhr.responseXML;break a}var firefoxBugTakenEffect=xhr.responseXML&&"parsererror"===xhr.responseXML.documentElement.nodeName;if(""===xhr.responseType&&!firefoxBugTakenEffect){response=xhr.responseXML;break a}}catch(e$169){}response=null}if(isJson)try{response=JSON.parse(response)}catch(e$168){}response={body:response,statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr};xhr.getAllResponseHeaders&&
(response.headers=parseHeaders(xhr.getAllResponseHeaders()))}else err=Error("Internal XMLHttpRequest Error");status=response.body;called||(called=!0,options.callback(err,response,status))}}if("undefined"===typeof options.callback)throw Error("callback argument missing");var called=!1,xhr=options.xhr||null;xhr||(xhr=options.cors||options.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var key,aborted,uri=xhr.url=options.uri||options.url,method=xhr.method=options.method||"GET",body=
options.body||options.data,headers=xhr.headers=options.headers||{},sync=!!options.sync,isJson=!1,timeoutTimer,failureResponse={body:void 0,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};"json"in options&&!1!==options.json&&(isJson=!0,headers.accept||headers.Accept||(headers.Accept="application/json"),"GET"!==method&&"HEAD"!==method&&(headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json"),body=JSON.stringify(!0===options.json?body:options.json)));
xhr.onreadystatechange=function(){4===xhr.readyState&&setTimeout(loadFunc,0)};xhr.onload=loadFunc;xhr.onerror=errorFunc;xhr.onprogress=function(){};xhr.onabort=function(){aborted=!0};xhr.ontimeout=errorFunc;xhr.open(method,uri,!sync,options.username,options.password);sync||(xhr.withCredentials=!!options.withCredentials);!sync&&0<options.timeout&&(timeoutTimer=setTimeout(function(){if(!aborted){aborted=!0;xhr.abort("timeout");var e=Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";errorFunc(e)}},
options.timeout));if(xhr.setRequestHeader)for(key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);else if(options.headers&&!isEmpty(options.headers))throw Error("Headers cannot be set on an XDomainRequest object");"responseType"in options&&(xhr.responseType=options.responseType);"beforeSend"in options&&"function"===typeof options.beforeSend&&options.beforeSend(xhr);xhr.send(body||null);return xhr}function noop(){}exports=_dereq_("global/window");var isFunction=_dereq_("is-function"),
parseHeaders=_dereq_("parse-headers"),xtend=_dereq_("xtend");module.exports=createXHR;module.exports.default=createXHR;createXHR.XMLHttpRequest=exports.XMLHttpRequest||noop;createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:exports.XDomainRequest;(function(array,iterator){for(var i=0;i<array.length;i++)iterator(array[i])})("get put post patch head delete".split(" "),function(method){createXHR["delete"===method?"del":method]=function(uri,options,callback){options=
initParams(uri,options,callback);options.method=method.toUpperCase();return _createXHR(options)}})},{"global/window":27,"is-function":33,"parse-headers":47,xtend:71}],70:[function(_dereq_,module,exports){module.exports=function(){return"undefined"!==typeof self.DOMParser?function(str){return(new self.DOMParser).parseFromString(str,"application/xml")}:"undefined"!==typeof self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(str){var xmlDoc=new self.ActiveXObject("Microsoft.XMLDOM");
xmlDoc.async="false";xmlDoc.loadXML(str);return xmlDoc}:function(str){var div=document.createElement("div");div.innerHTML=str;return div}}()},{}],71:[function(_dereq_,module,exports){module.exports=function(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i],key;for(key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};var hasOwnProperty=Object.prototype.hasOwnProperty},{}],72:[function(_dereq_,module,exports){module.exports={name:"aframe",version:"1.1.0",
description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ \x26\x26 npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build \x26\x26 cross-env INSPECTOR_VERSION\x3ddev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js \x26\x26 npm run dist:min \x26\x26 npm run dist:max",
"dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map \x3e dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",
prerelease:"node scripts/release.js 1.0.4 1.1.0",start:"npm run dev","start:https":"cross-env SSL\x3dtrue npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER\x3dtrue npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",
debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.123.1","three-bmfont-text":"dmarcos/three-bmfont-text#1babdf8507c731a18f8af3b807292e2b9740955e","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4",
"browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1",
"karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**",
"dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:"3d aframe cardboard components oculus three three.js rift vive vr web-components webvr".split(" "),"browserify-css":{minify:!0},engines:{node:"\x3e\x3d 4.6.0",npm:"^2.15.9"}}},{}],73:[function(_dereq_,module,exports){function toRadians(obj){obj.x=THREE.Math.degToRad(obj.x);obj.y=THREE.Math.degToRad(obj.y);obj.z=THREE.Math.degToRad(obj.z)}function addEventListeners(el,eventNames,handler){var i;for(i=0;i<eventNames.length;i++)el.addEventListener(eventNames[i],
handler)}function removeEventListeners(el,eventNames,handler){var i;for(i=0;i<eventNames.length;i++)el.removeEventListener(eventNames[i],handler)}function getRawProperty(el,path){var i;var split=splitDot(path);var value=el;for(i=0;i<split.length;i++)value=value[split[i]];if(void 0===value)throw console.log(el),Error("[animation] property ("+path+") could not be found");return value}function setRawProperty(el,path,value,type){var i;path.startsWith("object3D.rotation")&&(value=THREE.Math.degToRad(value));
path=splitDot(path);for(i=0;i<path.length-1;i++)el=el[path[i]];path=path[path.length-1];"color"===type?"r"in el[path]?(el[path].r=value.r,el[path].g=value.g,el[path].b=value.b):(el[path].x=value.r,el[path].y=value.g,el[path].z=value.b):el[path]=value}function splitDot(path){if(path in splitCache)return splitCache[path];splitCache[path]=path.split(".");return splitCache[path]}function isRawProperty(data){return data.isRawProperty||data.property.startsWith("components")||data.property.startsWith("object3D")}
var anime=_dereq_("super-animejs"),components=_dereq_("../core/component").components;exports=_dereq_("../core/component").registerComponent;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils"),colorHelperFrom=new THREE.Color,colorHelperTo=new THREE.Color,getComponentProperty=utils.entity.getComponentProperty,setComponentProperty=utils.entity.setComponentProperty,splitCache={};module.exports.Component=exports("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1E3},
easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(value){return!0===value||"true"===value?!0:!1===value||"false"===value?!1:parseInt(value,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var self=this;this.eventDetail={name:this.attrName};this.time=0;this.animation=
null;this.animationIsPlaying=!1;this.onStartEvent=this.onStartEvent.bind(this);this.beginAnimation=this.beginAnimation.bind(this);this.pauseAnimation=this.pauseAnimation.bind(this);this.resumeAnimation=this.resumeAnimation.bind(this);this.fromColor={};this.toColor={};this.targets={};this.targetsArray=[];this.updateConfigForDefault=this.updateConfigForDefault.bind(this);this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this);this.config={complete:function(){self.animationIsPlaying=!1;
self.el.emit("animationcomplete",self.eventDetail,!1);self.id&&self.el.emit("animationcomplete__"+self.id,self.eventDetail,!1)}}},update:function(oldData){oldData=this.config;var data=this.data;this.animationIsPlaying=!1;this.data.enabled&&data.property&&(oldData.autoplay=!1,oldData.direction=data.dir,oldData.duration=data.dur,oldData.easing=data.easing,oldData.elasticity=data.elasticity,oldData.loop=data.loop,oldData.round=data.round,this.createAndStartAnimation())},tick:function(t,dt){this.animationIsPlaying&&
(this.time+=dt,this.animation.tick(this.time))},remove:function(){this.pauseAnimation();this.removeEventListeners()},pause:function(){this.paused=!0;this.pausedWasPlaying=this.animationIsPlaying;this.pauseAnimation();this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var data=this.data;this.updateConfig();this.animationIsPlaying=!1;this.animation=
anime(this.config);this.animation.began=!0;this.removeEventListeners();this.addEventListeners();!data.autoplay||data.startEvents&&data.startEvents.length||(data.delay?setTimeout(this.beginAnimation,data.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig();this.animation.began=!0;this.time=0;this.animationIsPlaying=!0;this.stopRelatedAnimations();this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=
!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=anime(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){var config=this.config,data=this.data,el=this.el,key;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){var from=""===data.from?getRawProperty(el,data.property):data.from;var to=data.to;this.setColorConfig(from,to);from=
this.fromColor;to=this.toColor;this.targetsArray.length=0;this.targetsArray.push(from);config.targets=this.targetsArray;for(key in to)config[key]=to[key];config.update=function(){var lastValue={};return function(anim){anim=anim.animatables[0].target;anim.r===lastValue.r&&anim.g===lastValue.g&&anim.b===lastValue.b||setRawProperty(el,data.property,anim,data.type)}}()}},updateConfigForDefault:function(){var config=this.config,data=this.data,el=this.el,isBoolean;if(!this.waitComponentInitRawProperty(this.updateConfigForDefault)){var from=
""===data.from?isRawProperty(data)?getRawProperty(el,data.property):getComponentProperty(el,data.property):data.from;var to=data.to;isNaN(from||to)?(from=from?from.toString():from,to=to?to.toString():to):(from=parseFloat(from),to=parseFloat(to));if(isBoolean="true"===data.to||"false"===data.to||!0===data.to||!1===data.to)from="true"===data.from||!0===data.from?1:0,to="true"===data.to||!0===data.to?1:0;this.targets.aframeProperty=from;config.targets=this.targets;config.aframeProperty=to;config.update=
function(){var lastValue;return function(anim){anim=anim.animatables[0].target.aframeProperty;anim!==lastValue&&(lastValue=anim,isBoolean&&(anim=1<=anim),isRawProperty(data)?setRawProperty(el,data.property,anim,data.type):setComponentProperty(el,data.property,anim))}}()}},updateConfigForVector:function(){var config=this.config,data=this.data,el=this.el,key;var from=""!==data.from?utils.coordinates.parse(data.from):getComponentProperty(el,data.property);var to=utils.coordinates.parse(data.to);"rotation"===
data.property&&(toRadians(from),toRadians(to));this.targetsArray.length=0;this.targetsArray.push(from);config.targets=this.targetsArray;for(key in to)config[key]=to[key];config.update="position"===data.property||"rotation"===data.property||"scale"===data.property?function(){var lastValue={};return function(anim){anim=anim.animatables[0].target;"scale"===data.property&&(anim.x=Math.max(1E-4,anim.x),anim.y=Math.max(1E-4,anim.y),anim.z=Math.max(1E-4,anim.z));if(anim.x!==lastValue.x||anim.y!==lastValue.y||
anim.z!==lastValue.z)lastValue.x=anim.x,lastValue.y=anim.y,lastValue.z=anim.z,el.object3D[data.property].set(anim.x,anim.y,anim.z)}}():function(){var lastValue={};return function(anim){anim=anim.animatables[0].target;if(anim.x!==lastValue.x||anim.y!==lastValue.y||anim.z!==lastValue.z)lastValue.x=anim.x,lastValue.y=anim.y,lastValue.z=anim.z,setComponentProperty(el,data.property,anim)}}()},updateConfig:function(){var propType=this.el;var split=this.data.property.split(".");var componentName=split[0];
split=split[1];propType=propType.components[componentName]||components[componentName];propType=!propType||split&&!propType.schema[split]?null:split?propType.schema[split].type:propType.schema.type;isRawProperty(this.data)&&"color"===this.data.type?this.updateConfigForRawColor():"vec2"===propType||"vec3"===propType||"vec4"===propType?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(cb){var data=this.data,el=this.el,self=this;if(""!==data.from||!data.property.startsWith("components"))return!1;
var componentName=splitDot(data.property)[1];if(el.components[componentName])return!1;el.addEventListener("componentinitialized",function wait(evt){evt.detail.name===componentName&&(cb(),self.animation=anime(self.config),el.removeEventListener("componentinitialized",wait))});return!0},stopRelatedAnimations:function(){var componentName;for(componentName in this.el.components){var component=this.el.components[componentName];componentName!==this.attrName&&"animation"===component.name&&component.animationIsPlaying&&
component.data.property===this.data.property&&(component.animationIsPlaying=!1)}},addEventListeners:function(){var data=this.data,el=this.el;addEventListeners(el,data.startEvents,this.onStartEvent);addEventListeners(el,data.pauseEvents,this.pauseAnimation);addEventListeners(el,data.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var data=this.data,el=this.el;removeEventListeners(el,data.startEvents,this.onStartEvent);removeEventListeners(el,data.pauseEvents,this.pauseAnimation);
removeEventListeners(el,data.resumeEvents,this.resumeAnimation)},setColorConfig:function(from,to){colorHelperFrom.set(from);colorHelperTo.set(to);from=this.fromColor;to=this.toColor;from.r=colorHelperFrom.r;from.g=colorHelperFrom.g;from.b=colorHelperFrom.b;to.r=colorHelperTo.r;to.g=colorHelperTo.g;to.b=colorHelperTo.b}})},{"../core/component":130,"../lib/three":178,"../utils":204,"super-animejs":56}],74:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var THREE=
_dereq_("../lib/three");module.exports.Component=exports("camera",{schema:{active:{default:!0},far:{default:1E4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var el=this.el;var camera=this.camera=new THREE.PerspectiveCamera;el.setObject3D("camera",camera)},update:function(oldData){var data=this.data,camera=this.camera;camera.aspect=data.aspect||window.innerWidth/window.innerHeight;camera.far=data.far;camera.fov=data.fov;camera.near=
data.near;camera.zoom=data.zoom;camera.updateProjectionMatrix();this.updateActiveCamera(oldData);this.updateSpectatorCamera(oldData)},updateActiveCamera:function(oldData){var data=this.data,el=this.el,system=this.system;oldData&&oldData.active===data.active||data.spectator||(data.active&&system.activeCameraEl!==el?system.setActiveCamera(el):data.active||system.activeCameraEl!==el||system.disableActiveCamera())},updateSpectatorCamera:function(oldData){var data=this.data,el=this.el,system=this.system;
oldData&&oldData.spectator===data.spectator||(data.spectator&&system.spectatorCameraEl!==el?system.setSpectatorCamera(el):data.spectator||system.spectatorCameraEl!==el||system.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":130,"../lib/three":178}],75:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var utils=_dereq_("../utils/"),bind=utils.bind,JSCompiler_object_inline_DOWN_4318=["mousedown","touchstart"],
JSCompiler_object_inline_UP_4319=["mouseup","touchend"],JSCompiler_object_inline_DOWN_4320=["selectstart"],JSCompiler_object_inline_UP_4321=["selectend"];module.exports.Component=exports("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:utils.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var self=this;this.fuseTimeout=void 0;this.intersectedEl=
this.cursorDownEl=null;this.canvasBounds=document.body.getBoundingClientRect();this.isCursorDown=!1;this.updateCanvasBounds=utils.debounce(function(){self.canvasBounds=self.el.sceneEl.canvas.getBoundingClientRect()},500);this.eventDetail={};this.intersectedEventDetail={cursorEl:this.el};this.onCursorDown=bind(this.onCursorDown,this);this.onCursorUp=bind(this.onCursorUp,this);this.onIntersection=bind(this.onIntersection,this);this.onIntersectionCleared=bind(this.onIntersectionCleared,this);this.onMouseMove=
bind(this.onMouseMove,this);this.onEnterVR=bind(this.onEnterVR,this)},update:function(oldData){this.data.rayOrigin!==oldData.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var el=this.el;el.removeState("cursor-hovering");el.removeState("cursor-fusing");clearTimeout(this.fuseTimeout);this.intersectedEl&&this.intersectedEl.removeState("cursor-hovered");this.removeEventListeners()},addEventListeners:function(){function addCanvasListeners(){canvas=
el.sceneEl.canvas;data.downEvents.length||data.upEvents.length||(JSCompiler_object_inline_DOWN_4318.forEach(function(downEvent){canvas.addEventListener(downEvent,self.onCursorDown)}),JSCompiler_object_inline_UP_4319.forEach(function(upEvent){canvas.addEventListener(upEvent,self.onCursorUp)}))}var canvas,data=this.data,el=this.el,self=this;(canvas=el.sceneEl.canvas)?addCanvasListeners():el.sceneEl.addEventListener("render-target-loaded",addCanvasListeners);data.downEvents.forEach(function(downEvent){el.addEventListener(downEvent,
self.onCursorDown)});data.upEvents.forEach(function(upEvent){el.addEventListener(upEvent,self.onCursorUp)});el.addEventListener("raycaster-intersection",this.onIntersection);el.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared);el.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds);el.sceneEl.addEventListener("enter-vr",this.onEnterVR);window.addEventListener("resize",this.updateCanvasBounds);window.addEventListener("scroll",this.updateCanvasBounds);this.updateMouseEventListeners()},
removeEventListeners:function(){var canvas,data=this.data,el=this.el,self=this;!(canvas=el.sceneEl.canvas)||data.downEvents.length||data.upEvents.length||(JSCompiler_object_inline_DOWN_4318.forEach(function(downEvent){canvas.removeEventListener(downEvent,self.onCursorDown)}),JSCompiler_object_inline_UP_4319.forEach(function(upEvent){canvas.removeEventListener(upEvent,self.onCursorUp)}));data.downEvents.forEach(function(downEvent){el.removeEventListener(downEvent,self.onCursorDown)});data.upEvents.forEach(function(upEvent){el.removeEventListener(upEvent,
self.onCursorUp)});el.removeEventListener("raycaster-intersection",this.onIntersection);el.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared);canvas.removeEventListener("mousemove",this.onMouseMove);canvas.removeEventListener("touchstart",this.onMouseMove);canvas.removeEventListener("touchmove",this.onMouseMove);el.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds);el.sceneEl.removeEventListener("enter-vr",this.onEnterVR);window.removeEventListener("resize",
this.updateCanvasBounds);window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var el=this.el;var canvas=el.sceneEl.canvas;canvas.removeEventListener("mousemove",this.onMouseMove);canvas.removeEventListener("touchmove",this.onMouseMove);el.setAttribute("raycaster","useWorldCoordinates",!1);"mouse"===this.data.rayOrigin&&(canvas.addEventListener("mousemove",this.onMouseMove,!1),canvas.addEventListener("touchmove",this.onMouseMove,!1),el.setAttribute("raycaster",
"useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var direction=new THREE.Vector3,mouse=new THREE.Vector2,origin=new THREE.Vector3,rayCasterConfig={origin:origin,direction:direction};return function(evt){var bounds=this.canvasBounds,camera=this.el.sceneEl.camera;camera.parent.updateMatrixWorld();var point="touchmove"===evt.type||"touchstart"===evt.type?evt.touches.item(0):evt;var left=point.clientX-bounds.left;point=point.clientY-bounds.top;mouse.x=left/bounds.width*2-1;
mouse.y=2*-(point/bounds.height)+1;origin.setFromMatrixPosition(camera.matrixWorld);direction.set(mouse.x,mouse.y,.5).unproject(camera).sub(origin).normalize();this.el.setAttribute("raycaster",rayCasterConfig);"touchmove"===evt.type&&evt.preventDefault()}}(),onCursorDown:function(evt){this.isCursorDown=!0;"mouse"===this.data.rayOrigin&&"touchstart"===evt.type&&(this.onMouseMove(evt),this.el.components.raycaster.checkIntersections(),evt.preventDefault());this.twoWayEmit("mousedown");this.cursorDownEl=
this.intersectedEl},onCursorUp:function(evt){if(this.isCursorDown){this.isCursorDown=!1;var data=this.data;this.twoWayEmit("mouseup");this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit("mouseup",this.intersectedEventDetail));data.fuse&&"mouse"!==data.rayOrigin||!this.intersectedEl||this.cursorDownEl!==this.intersectedEl||this.twoWayEmit("click");this.cursorDownEl=null;"touchend"===evt.type&&evt.preventDefault()}},onIntersection:function(evt){var index=
evt.detail.els[0]===this.el?1:0;var intersection=evt.detail.intersections[index];if((index=evt.detail.els[index])&&this.intersectedEl!==index){if(this.intersectedEl&&(evt=this.el.components.raycaster.getIntersection(this.intersectedEl))&&evt.distance<=intersection.distance)return;this.clearCurrentIntersection(!0);this.setIntersection(index,intersection)}},onIntersectionCleared:function(evt){-1!==evt.detail.clearedEls.indexOf(this.intersectedEl)&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);
var xrSession=this.el.sceneEl.xrSession,self=this;xrSession&&"mouse"!==this.data.rayOrigin&&(JSCompiler_object_inline_DOWN_4320.forEach(function(downEvent){xrSession.addEventListener(downEvent,self.onCursorDown)}),JSCompiler_object_inline_UP_4321.forEach(function(upEvent){xrSession.addEventListener(upEvent,self.onCursorUp)}))},setIntersection:function(intersectedEl,intersection){var cursorEl=this.el;intersection=this.data;var self=this;this.intersectedEl!==intersectedEl&&(this.intersectedEl=intersectedEl,
cursorEl.addState("cursor-hovering"),intersectedEl.addState("cursor-hovered"),this.twoWayEmit("mouseenter"),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.add("a-mouse-cursor-hover"),0!==intersection.fuseTimeout&&intersection.fuse&&(cursorEl.addState("cursor-fusing"),this.twoWayEmit("fusing"),this.fuseTimeout=setTimeout(function(){cursorEl.removeState("cursor-fusing");self.twoWayEmit("click")},intersection.fuseTimeout)))},clearCurrentIntersection:function(ignoreRemaining){var intersection=
this.el;this.intersectedEl&&(this.intersectedEl.removeState("cursor-hovered"),intersection.removeState("cursor-hovering"),intersection.removeState("cursor-fusing"),this.twoWayEmit("mouseleave"),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.remove("a-mouse-cursor-hover"),this.intersectedEl=null,clearTimeout(this.fuseTimeout),!0!==ignoreRemaining&&(ignoreRemaining=this.el.components.raycaster.intersections,0!==ignoreRemaining.length&&(intersection=
ignoreRemaining[ignoreRemaining[0].object.el===intersection?1:0])&&this.setIntersection(intersection.object.el,intersection)))},twoWayEmit:function(evtName){var el=this.el,intersectedEl=this.intersectedEl;var intersection=this.el.components.raycaster.getIntersection(intersectedEl);this.eventDetail.intersectedEl=intersectedEl;this.eventDetail.intersection=intersection;el.emit(evtName,this.eventDetail);intersectedEl&&(this.intersectedEventDetail.intersection=intersection,intersectedEl.emit(evtName,
this.intersectedEventDetail))}})},{"../core/component":130,"../utils/":204}],76:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,onButtonEvent=trackedControlsUtils.onButtonEvent,GAMEPAD_ID_PREFIX=(_dereq_=_dereq_("../utils/").device.isWebXRAvailable)?
"google-daydream":"Daydream Controller";trackedControlsUtils={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]};var INPUT_MAPPING_WEBXR={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]};module.exports.Component=exports("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},
armModel:{default:!0}},mapping:_dereq_?INPUT_MAPPING_WEBXR:trackedControlsUtils,bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=
function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.controllerPresent=!1;this.lastControllerCheck=0;this.bindMethods()},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",
this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("model-loaded",this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",
this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("model-loaded",this.onModelLoaded);el.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();
this.removeControllersUpdateListener()},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{armModel:data.armModel,hand:data.hand,idPrefix:GAMEPAD_ID_PREFIX,id:GAMEPAD_ID_PREFIX,orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.obj",mtl:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",
this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(evt){evt=evt.detail.model;if(this.data.model){var buttonMeshes=this.buttonMeshes={};buttonMeshes.menu=evt.getObjectByName("AppButton_AppButton_Cylinder.004");buttonMeshes.system=evt.getObjectByName("HomeButton_HomeButton_Cylinder.005");buttonMeshes.trackpad=
evt.getObjectByName("TouchPad_TouchPad_Cylinder.003");buttonMeshes.touchpad=evt.getObjectByName("TouchPad_TouchPad_Cylinder.003");evt.position.set(0,0,-.04)}},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id];button&&this.el.emit(button+"changed",evt.detail.state)},updateModel:function(buttonName,evtName){this.data.model&&this.updateButtonModel(buttonName,evtName)},updateButtonModel:function(buttonName,
state){var buttonMeshes=this.buttonMeshes;if(buttonMeshes&&buttonMeshes[buttonName]){switch(state){case "down":state=this.data.buttonHighlightColor;break;case "touchstart":state=this.data.buttonTouchedColor;break;default:state=this.data.buttonColor}buttonMeshes[buttonName].material.color.set(state)}}})},{"../core/component":130,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],77:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=
_dereq_("../utils/bind"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,onButtonEvent=trackedControlsUtils.onButtonEvent,GAMEPAD_ID_PREFIX=(_dereq_=_dereq_("../utils/").device.isWebXRAvailable)?"samsung-gearvr":"Gear VR";trackedControlsUtils={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]};var INPUT_MAPPING_WEBXR={axes:{touchpad:[0,1]},buttons:["trigger",
"none","touchpad","none","menu"]};module.exports.Component=exports("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:_dereq_?INPUT_MAPPING_WEBXR:trackedControlsUtils,bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,
this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,
"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.controllerPresent=!1;this.lastControllerCheck=0;this.bindMethods()},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("model-loaded",
this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("model-loaded",this.onModelLoaded);el.removeEventListener("axismove",
this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{armModel:data.armModel,hand:data.hand,idPrefix:GAMEPAD_ID_PREFIX,
id:GAMEPAD_ID_PREFIX,orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.obj",mtl:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,
!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(evt){evt=evt.detail.model;if(this.data.model){var buttonMeshes=this.buttonMeshes={};buttonMeshes.trigger=evt.children[2];buttonMeshes.trackpad=evt.children[1];buttonMeshes.touchpad=evt.children[1]}},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id];button&&this.el.emit(button+"changed",evt.detail.state)},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},updateModel:function(buttonName,
evtName){this.data.model&&this.updateButtonModel(buttonName,evtName)},updateButtonModel:function(buttonName,state){var buttonMeshes=this.buttonMeshes;if(buttonMeshes&&buttonMeshes[buttonName]){switch(state){case "down":state=this.data.buttonHighlightColor;break;case "touchstart":state=this.data.buttonTouchedColor;break;default:state=this.data.buttonColor}buttonMeshes[buttonName].material.color.set(state)}}})},{"../core/component":130,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],
78:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind");_dereq_=_dereq_("../utils/tracked-controls");var checkControllerPresentAndSetup=_dereq_.checkControllerPresentAndSetup,emitIfAxesChanged=_dereq_.emitIfAxesChanged,onButtonEvent=_dereq_.onButtonEvent;module.exports.Component=exports("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"}},
mapping:{axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]},bindMethods:function(){this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,
"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.controllerPresent=!1;this.lastControllerCheck=0;this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",
this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",
this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){var data=this.data;checkControllerPresentAndSetup(this,"generic",{hand:data.hand?data.hand:void 0,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},
injectTrackedControls:function(){var el=this.el,data=this.data;this.el.components["tracked-controls"]?this.removeEventListeners():(el.setAttribute("tracked-controls",{hand:data.hand,idPrefix:"generic",orientationOffset:data.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel())},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",
this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id];button&&this.el.emit(button+"changed",evt.detail.state)},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},initDefaultModel:function(){var modelEl=this.modelEl=document.createElement("a-entity");modelEl.setAttribute("geometry",{primitive:"sphere",radius:.03});modelEl.setAttribute("material",{color:this.data.color});
this.el.appendChild(modelEl)}})},{"../core/component":130,"../utils/bind":198,"../utils/tracked-controls":213}],79:[function(_dereq_,module,exports){var geometries=_dereq_("../core/geometry").geometries;exports=_dereq_("../core/geometry").geometryNames;var registerComponent=_dereq_("../core/component").registerComponent,THREE=_dereq_("../lib/three"),dummyGeometry=new THREE.Geometry;module.exports.Component=registerComponent("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:exports,
schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(previousData){var data=this.data,el=this.el,system=this.system;this.geometry&&(system.unuseGeometry(previousData),this.geometry=null);this.geometry=system.getOrCreateGeometry(data);(previousData=el.getObject3D("mesh"))?previousData.geometry=this.geometry:(previousData=new THREE.Mesh,previousData.geometry=this.geometry,el.setObject3D("mesh",previousData))},remove:function(){this.system.unuseGeometry(this.data);
this.el.getObject3D("mesh").geometry=dummyGeometry;this.geometry=null},updateSchema:function(data){var currentGeometryType=this.oldData&&this.oldData.primitive;data=data.primitive;var schema=geometries[data]&&geometries[data].schema;if(!schema)throw Error("Unknown geometry schema `"+data+"`");currentGeometryType&&currentGeometryType===data||this.extendSchema(schema)}})},{"../core/component":130,"../core/geometry":131,"../lib/three":178}],80:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;
var THREE=_dereq_("../lib/three"),warn=_dereq_("../utils/").debug("components:gltf-model:warn");module.exports.Component=exports("gltf-model",{schema:{type:"model"},init:function(){var dracoLoader=this.system.getDRACOLoader();this.model=null;this.loader=new THREE.GLTFLoader;dracoLoader&&this.loader.setDRACOLoader(dracoLoader)},update:function(){var self=this,el=this.el,src=this.data;src&&(this.remove(),this.loader.load(src,function(gltfModel){self.model=gltfModel.scene||gltfModel.scenes[0];self.model.animations=
gltfModel.animations;el.setObject3D("mesh",self.model);el.emit("model-loaded",{format:"gltf",model:self.model})},void 0,function(error){warn(error&&error.message?error.message:"Failed to load glTF model");el.emit("model-error",{format:"gltf",src:src})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":130,"../lib/three":178,"../utils/":204}],81:[function(_dereq_,module,exports){function getGestureEventName(gesture,active){if(gesture){gesture=EVENTS[gesture];
if("grip"===gesture)return gesture+(active?"close":"open");if("point"===gesture)return gesture+(active?"up":"down");if("pointing"===gesture||"pistol"===gesture)return gesture+(active?"start":"end")}}_dereq_=_dereq_("../core/component").registerComponent;var MODEL_URLS={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",
highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},EVENTS={Fist:"grip","Thumb Up":"pistol",Point:"pointing"};module.exports.Component=_dereq_("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var self=this,el=this.el;this.gesture="Open";this.pressedButtons={};this.touchedButtons={};
this.loader=new THREE.GLTFLoader;this.loader.setCrossOrigin("anonymous");this.onGripDown=function(){self.handleButton("grip","down")};this.onGripUp=function(){self.handleButton("grip","up")};this.onTrackpadDown=function(){self.handleButton("trackpad","down")};this.onTrackpadUp=function(){self.handleButton("trackpad","up")};this.onTrackpadTouchStart=function(){self.handleButton("trackpad","touchstart")};this.onTrackpadTouchEnd=function(){self.handleButton("trackpad","touchend")};this.onTriggerDown=
function(){self.handleButton("trigger","down")};this.onTriggerUp=function(){self.handleButton("trigger","up")};this.onTriggerTouchStart=function(){self.handleButton("trigger","touchstart")};this.onTriggerTouchEnd=function(){self.handleButton("trigger","touchend")};this.onGripTouchStart=function(){self.handleButton("grip","touchstart")};this.onGripTouchEnd=function(){self.handleButton("grip","touchend")};this.onThumbstickDown=function(){self.handleButton("thumbstick","down")};this.onThumbstickUp=function(){self.handleButton("thumbstick",
"up")};this.onAorXTouchStart=function(){self.handleButton("AorX","touchstart")};this.onAorXTouchEnd=function(){self.handleButton("AorX","touchend")};this.onBorYTouchStart=function(){self.handleButton("BorY","touchstart")};this.onBorYTouchEnd=function(){self.handleButton("BorY","touchend")};this.onSurfaceTouchStart=function(){self.handleButton("surface","touchstart")};this.onSurfaceTouchEnd=function(){self.handleButton("surface","touchend")};this.onControllerConnected=this.onControllerConnected.bind(this);
this.onControllerDisconnected=this.onControllerDisconnected.bind(this);el.addEventListener("controllerconnected",this.onControllerConnected);el.addEventListener("controllerdisconnected",this.onControllerDisconnected);el.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(time,delta){(time=this.el.getObject3D("mesh"))&&time.mixer&&time.mixer.update(delta/1E3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=
!1},addEventListeners:function(){var el=this.el;el.addEventListener("gripdown",this.onGripDown);el.addEventListener("gripup",this.onGripUp);el.addEventListener("trackpaddown",this.onTrackpadDown);el.addEventListener("trackpadup",this.onTrackpadUp);el.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart);el.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd);el.addEventListener("triggerdown",this.onTriggerDown);el.addEventListener("triggerup",this.onTriggerUp);el.addEventListener("triggertouchstart",
this.onTriggerTouchStart);el.addEventListener("triggertouchend",this.onTriggerTouchEnd);el.addEventListener("griptouchstart",this.onGripTouchStart);el.addEventListener("griptouchend",this.onGripTouchEnd);el.addEventListener("thumbstickdown",this.onThumbstickDown);el.addEventListener("thumbstickup",this.onThumbstickUp);el.addEventListener("abuttontouchstart",this.onAorXTouchStart);el.addEventListener("abuttontouchend",this.onAorXTouchEnd);el.addEventListener("bbuttontouchstart",this.onBorYTouchStart);
el.addEventListener("bbuttontouchend",this.onBorYTouchEnd);el.addEventListener("xbuttontouchstart",this.onAorXTouchStart);el.addEventListener("xbuttontouchend",this.onAorXTouchEnd);el.addEventListener("ybuttontouchstart",this.onBorYTouchStart);el.addEventListener("ybuttontouchend",this.onBorYTouchEnd);el.addEventListener("surfacetouchstart",this.onSurfaceTouchStart);el.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var el=this.el;el.removeEventListener("gripdown",
this.onGripDown);el.removeEventListener("gripup",this.onGripUp);el.removeEventListener("trackpaddown",this.onTrackpadDown);el.removeEventListener("trackpadup",this.onTrackpadUp);el.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart);el.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd);el.removeEventListener("triggerdown",this.onTriggerDown);el.removeEventListener("triggerup",this.onTriggerUp);el.removeEventListener("triggertouchstart",this.onTriggerTouchStart);el.removeEventListener("triggertouchend",
this.onTriggerTouchEnd);el.removeEventListener("griptouchstart",this.onGripTouchStart);el.removeEventListener("griptouchend",this.onGripTouchEnd);el.removeEventListener("thumbstickdown",this.onThumbstickDown);el.removeEventListener("thumbstickup",this.onThumbstickUp);el.removeEventListener("abuttontouchstart",this.onAorXTouchStart);el.removeEventListener("abuttontouchend",this.onAorXTouchEnd);el.removeEventListener("bbuttontouchstart",this.onBorYTouchStart);el.removeEventListener("bbuttontouchend",
this.onBorYTouchEnd);el.removeEventListener("xbuttontouchstart",this.onAorXTouchStart);el.removeEventListener("xbuttontouchend",this.onAorXTouchEnd);el.removeEventListener("ybuttontouchstart",this.onBorYTouchStart);el.removeEventListener("ybuttontouchend",this.onBorYTouchEnd);el.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart);el.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(previousHand){var el=this.el,hand=this.data.hand,handModelStyle=this.data.handModelStyle,
handColor=this.data.color,self=this;var controlConfiguration={hand:hand,model:!1};hand!==previousHand&&(previousHand=MODEL_URLS[handModelStyle+hand.charAt(0).toUpperCase()+hand.slice(1)],this.loader.load(previousHand,function(gltf){var mesh=gltf.scene.children[0],handModelOrientation="left"===hand?Math.PI/2:-Math.PI/2;mesh.mixer=new THREE.AnimationMixer(mesh);self.clips=gltf.animations;el.setObject3D("mesh",mesh);mesh.children[1].material.color=new THREE.Color(handColor);mesh.position.set(0,0,0);
mesh.rotation.set(0,0,handModelOrientation);el.setAttribute("magicleap-controls",controlConfiguration);el.setAttribute("vive-controls",controlConfiguration);el.setAttribute("oculus-touch-controls",controlConfiguration);el.setAttribute("windows-motion-controls",controlConfiguration)}))},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(button,evt){var isPressed="down"===evt,isTouched="touchstart"===evt;if(0===evt.indexOf("touch")){if(isTouched===this.touchedButtons[button])return;
this.touchedButtons[button]=isTouched}else{if(isPressed===this.pressedButtons[button])return;this.pressedButtons[button]=isPressed}button=this.gesture;this.gesture=this.determineGesture();this.gesture!==button&&(this.animateGesture(this.gesture,button),this.emitGestureEvents(this.gesture,button))},determineGesture:function(){var gesture,isGripActive=this.pressedButtons.grip,isSurfaceActive=this.pressedButtons.surface||this.touchedButtons.surface,isTrackpadActive=this.pressedButtons.trackpad||this.touchedButtons.trackpad,
isTriggerActive=this.pressedButtons.trigger||this.touchedButtons.trigger,isABXYActive=this.touchedButtons.AorX||this.touchedButtons.BorY,trackedControls=this.el.components["tracked-controls"];(trackedControls=trackedControls&&trackedControls.controller)&&(trackedControls.id&&0===trackedControls.id.indexOf("OpenVR ")||trackedControls.profiles&&trackedControls.profiles[0]&&"htc-vive-controller-mv"===trackedControls.profiles[0])?isGripActive||isTriggerActive?gesture="Fist":isTrackpadActive&&(gesture=
"Point"):isGripActive?gesture=isSurfaceActive||isABXYActive||isTrackpadActive?isTriggerActive?"Fist":"Point":isTriggerActive?"Thumb Up":"Point + Thumb":isTriggerActive&&(gesture="Hold");return gesture},getClip:function(gesture){var i;for(i=0;i<this.clips.length;i++){var clip=this.clips[i];if(clip.name===gesture)return clip}},animateGesture:function(gesture,lastGesture){gesture?this.playAnimation(gesture||"Open",lastGesture,!1):this.playAnimation(lastGesture,lastGesture,!0)},emitGestureEvents:function(gesture,
lastGesture){var el=this.el;lastGesture!==gesture&&((lastGesture=getGestureEventName(lastGesture,!1))&&el.emit(lastGesture),(lastGesture=getGestureEventName(gesture,!0))&&el.emit(lastGesture))},playAnimation:function(gesture,lastGesture,reverse){var mesh=this.el.getObject3D("mesh");if(mesh){mesh.mixer.stopAllAction();var clip=this.getClip(gesture);var toAction=mesh.mixer.clipAction(clip);toAction.clampWhenFinished=!0;toAction.loop=THREE.LoopRepeat;toAction.repetitions=0;toAction.timeScale=reverse?
-1:1;toAction.time=reverse?clip.duration:0;toAction.weight=1;lastGesture&&gesture!==lastGesture?(clip=this.getClip(lastGesture),gesture=mesh.mixer.clipAction(clip),gesture.weight=.15,gesture.play(),toAction.play(),gesture.crossFadeTo(toAction,.15,!0)):(mesh.mixer.stopAllAction(),toAction.play())}}})},{"../core/component":130}],82:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),checkControllerPresentAndSetup=_dereq_("../utils/tracked-controls").checkControllerPresentAndSetup,
BONE_PREFIX={left:"b_l_",right:"b_r_"},BONE_MAPPING=["wrist","thumb1","thumb2","thumb3","thumb_null",null,"index1","index2","index3","index_null",null,"middle1","middle2","middle3","middle_null",null,"ring1","ring2","ring3","ring_null","pinky0","pinky1","pinky2","pinky3","pinky_null"];module.exports.Component=exports("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=
bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var i=0;i<this.jointEls.length;++i)this.jointEls[i].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var i=0;i<this.jointEls.length;++i)this.jointEls[i].object3D.visible=
!1},init:function(){var sceneEl=this.el.sceneEl,webXROptionalAttributes=sceneEl.getAttribute("webxr").optionalFeatures;webXROptionalAttributes.push("hand-tracking");sceneEl.setAttribute("webxr",{optionalFeatures:webXROptionalAttributes});this.onModelLoaded=this.onModelLoaded.bind(this);this.jointEls=[];this.isPinched=this.controllerPresent=!1;this.pinchEventDetail={position:new THREE.Vector3};this.indexTipPosition=new THREE.Vector3;this.bindMethods();this.updateReferenceSpace=this.updateReferenceSpace.bind(this);
this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace);this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var self=this,xrSession=this.el.sceneEl.xrSession;this.referenceSpace=void 0;if(xrSession){var referenceSpaceType=self.el.sceneEl.systems.webxr.sessionReferenceSpaceType;xrSession.requestReferenceSpace(referenceSpaceType).then(function(referenceSpace){self.referenceSpace=referenceSpace.getOffsetReferenceSpace(new XRRigidTransform({x:0,
y:1.5,z:0}))}).catch(function(error){self.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(referenceSpaceType,"tracked-controls-webxr uses reference space "+referenceSpaceType);throw error;})}},checkIfControllerPresent:function(){var data=this.data;checkControllerPresentAndSetup(this,"",{hand:data.hand?data.hand:void 0,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},tick:function(){var controller=this.el.components["tracked-controls"]&&
this.el.components["tracked-controls"].controller,frame=this.el.sceneEl.frame,trackedControlsWebXR=this.el.components["tracked-controls-webxr"];controller&&frame&&trackedControlsWebXR&&controller.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),frame.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){"dots"===this.data.modelStyle&&this.updateHandDotsModel();"mesh"===this.data.modelStyle&&this.updateHandMeshModel()},updateHandMeshModel:function(){var controller=
this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,referenceSpace=this.referenceSpace;if(controller&&this.mesh&&referenceSpace){this.mesh.visible=!1;for(var i=0;i<controller.hand.length;i++)if(controller.hand[i]){var jointPose=this.el.sceneEl.frame.getJointPose(controller.hand[i],referenceSpace);if(null!=BONE_MAPPING[i]){var bone=this.getBone(BONE_PREFIX[this.data.hand]+BONE_MAPPING[i]);null!=bone&&jointPose&&(jointPose=jointPose.transform,this.mesh.visible=
!0,bone.position.copy(jointPose.position).multiplyScalar(100),bone.quaternion.set(jointPose.orientation.x,jointPose.orientation.y,jointPose.orientation.z,jointPose.orientation.w))}}}},getBone:function(name){for(var bones=this.bones,i=0;i<bones.length;i++)if(bones[i].name===name)return bones[i];return null},updateHandDotsModel:function(){for(var frame=this.el.sceneEl.frame,controller=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,referenceSpace=this.el.components["tracked-controls-webxr"].system.referenceSpace,
i=0;i<this.jointEls.length;++i){var jointEl=this.jointEls[i];jointEl.object3D.visible=!!controller.hand[i];if(controller.hand[i]){var object3D=jointEl.object3D,pose=frame.getJointPose(controller.hand[i],referenceSpace);jointEl.object3D.visible=!!pose;pose&&(object3D.matrix.elements=pose.transform.matrix,object3D.matrix.decompose(object3D.position,object3D.rotation,object3D.scale),jointEl.setAttribute("scale",{x:pose.radius,y:pose.radius,z:pose.radius}))}}},detectGesture:function(){this.detectPinch()},
detectPinch:function(){var thumbTipPosition=new THREE.Vector3;return function(){var frame=this.el.sceneEl.frame,indexTipPosition=this.indexTipPosition,controller=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,trackedControlsWebXR=this.el.components["tracked-controls-webxr"],referenceSpace=this.referenceSpace||trackedControlsWebXR.system.referenceSpace;controller.hand[XRHand.INDEX_PHALANX_TIP]&&controller.hand[XRHand.THUMB_PHALANX_TIP]&&(trackedControlsWebXR=
frame.getJointPose(controller.hand[XRHand.INDEX_PHALANX_TIP],referenceSpace),frame=frame.getJointPose(controller.hand[XRHand.THUMB_PHALANX_TIP],referenceSpace),trackedControlsWebXR&&frame&&(thumbTipPosition.copy(frame.transform.position),indexTipPosition.copy(trackedControlsWebXR.transform.position),frame=indexTipPosition.distanceTo(thumbTipPosition),.015>frame&&!1===this.isPinched&&(this.isPinched=!0,this.pinchEventDetail.position.copy(indexTipPosition).lerp(thumbTipPosition,.5),this.pinchEventDetail.position.y+=
1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),.03<frame&&!0===this.isPinched&&(this.isPinched=!1,this.pinchEventDetail.position.copy(indexTipPosition).lerp(thumbTipPosition,.5),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(indexTipPosition).lerp(thumbTipPosition,.5),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),indexTipPosition.y+=1.5))}}(),pause:function(){this.removeEventListeners();
this.removeControllersUpdateListener()},injectTrackedControls:function(){this.el.setAttribute("tracked-controls",{hand:this.data.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0});this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent();
var controller=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;this.el.getObject3D("mesh")&&(controller&&controller.hand&&controller.hand[0]||this.el.removeObject3D("mesh"))},initDefaultModel:function(){"dots"===this.data.modelStyle&&this.initDotsModel();"mesh"===this.data.modelStyle&&this.initMeshHandModel()},initDotsModel:function(){if(0===this.jointEls.length)for(var i=0;25>i;++i){var jointEl=this.jointEl=document.createElement("a-entity");jointEl.setAttribute("geometry",
{primitive:"sphere",radius:1});jointEl.setAttribute("material",{color:this.data.modelColor});jointEl.object3D.visible=!1;this.el.appendChild(jointEl);this.jointEls.push(jointEl)}},initMeshHandModel:function(){this.el.setAttribute("gltf-model","left"===this.data.hand?"https://cdn.aframe.io/controllers/oculus-hands/unity/left.glb":"https://cdn.aframe.io/controllers/oculus-hands/unity/right.glb")},onModelLoaded:function(){var mesh=this.mesh=this.el.getObject3D("mesh").children[0],skinnedMesh=this.skinnedMesh=
mesh.children[24];this.skinnedMesh&&(this.bones=skinnedMesh.skeleton.bones,this.el.removeObject3D("mesh"),mesh.position.set(0,1.5,0),mesh.rotation.set(0,0,0),skinnedMesh.frustumCulled=!1,skinnedMesh.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",mesh))}})},{"../core/component":130,"../utils/bind":198,"../utils/tracked-controls":213}],83:[function(_dereq_,module,exports){_dereq_("./animation");_dereq_("./camera");_dereq_("./cursor");_dereq_("./daydream-controls");
_dereq_("./gearvr-controls");_dereq_("./geometry");_dereq_("./generic-tracked-controller-controls");_dereq_("./gltf-model");_dereq_("./hand-tracking-controls");_dereq_("./hand-controls");_dereq_("./layer");_dereq_("./laser-controls");_dereq_("./light");_dereq_("./line");_dereq_("./link");_dereq_("./look-controls");_dereq_("./magicleap-controls");_dereq_("./material");_dereq_("./obj-model");_dereq_("./oculus-go-controls");_dereq_("./oculus-touch-controls");_dereq_("./position");_dereq_("./raycaster");
_dereq_("./rotation");_dereq_("./scale");_dereq_("./shadow");_dereq_("./sound");_dereq_("./text");_dereq_("./tracked-controls");_dereq_("./tracked-controls-webvr");_dereq_("./tracked-controls-webxr");_dereq_("./visible");_dereq_("./valve-index-controls");_dereq_("./vive-controls");_dereq_("./vive-focus-controls");_dereq_("./wasd-controls");_dereq_("./windows-motion-controls");_dereq_("./scene/background");_dereq_("./scene/debug");_dereq_("./scene/device-orientation-permission-ui");_dereq_("./scene/embedded");
_dereq_("./scene/inspector");_dereq_("./scene/fog");_dereq_("./scene/keyboard-shortcuts");_dereq_("./scene/pool");_dereq_("./scene/screenshot");_dereq_("./scene/stats");_dereq_("./scene/vr-mode-ui")},{"./animation":73,"./camera":74,"./cursor":75,"./daydream-controls":76,"./gearvr-controls":77,"./generic-tracked-controller-controls":78,"./geometry":79,"./gltf-model":80,"./hand-controls":81,"./hand-tracking-controls":82,"./laser-controls":84,"./layer":85,"./light":86,"./line":87,"./link":88,"./look-controls":89,
"./magicleap-controls":90,"./material":91,"./obj-model":92,"./oculus-go-controls":93,"./oculus-touch-controls":94,"./position":95,"./raycaster":96,"./rotation":97,"./scale":98,"./scene/background":99,"./scene/debug":100,"./scene/device-orientation-permission-ui":101,"./scene/embedded":102,"./scene/fog":103,"./scene/inspector":104,"./scene/keyboard-shortcuts":105,"./scene/pool":106,"./scene/screenshot":107,"./scene/stats":108,"./scene/vr-mode-ui":109,"./shadow":110,"./sound":111,"./text":112,"./tracked-controls":115,
"./tracked-controls-webvr":113,"./tracked-controls-webxr":114,"./valve-index-controls":116,"./visible":117,"./vive-controls":118,"./vive-focus-controls":119,"./wasd-controls":120,"./windows-motion-controls":121}],84:[function(_dereq_,module,exports){module=_dereq_("../core/component").registerComponent;var utils=_dereq_("../utils/");module("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){function createRay(evt){var controllerConfig=
config[evt.detail.name];if(controllerConfig){var raycasterConfig=utils.extend({showLine:!0},controllerConfig.raycaster||{});evt.detail.rayOrigin&&(raycasterConfig.origin=evt.detail.rayOrigin.origin,raycasterConfig.direction=evt.detail.rayOrigin.direction,raycasterConfig.showLine=!0);evt.detail.rayOrigin||!self.modelReady?el.setAttribute("raycaster",raycasterConfig):el.setAttribute("raycaster","showLine",!0);el.setAttribute("cursor",utils.extend({fuse:!1},controllerConfig.cursor))}}var config=this.config,
data=this.data,el=this.el,self=this;data={hand:data.hand,model:data.model};el.setAttribute("daydream-controls",data);el.setAttribute("gearvr-controls",data);el.setAttribute("magicleap-controls",data);el.setAttribute("oculus-go-controls",data);el.setAttribute("oculus-touch-controls",data);el.setAttribute("valve-index-controls",data);el.setAttribute("vive-controls",data);el.setAttribute("vive-focus-controls",data);el.setAttribute("windows-motion-controls",data);el.setAttribute("generic-tracked-controller-controls",
data);el.addEventListener("controllerconnected",createRay);el.addEventListener("controllerdisconnected",function(){el.setAttribute("raycaster","showLine",!1)});el.addEventListener("controllermodelready",function(evt){createRay(evt);self.modelReady=!0})},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],
upEvents:["triggerup"]}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5E-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],
upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":130,"../utils/":204}],85:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var warn=_dereq_("../utils/").debug("components:layer:warn");module.exports.Component=exports("layer",{schema:{type:{default:"quad",
oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var gl=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion;this.position=new THREE.Vector3;this.bindMethods();this.needsRedraw=!1;this.frameBuffer=gl.createFramebuffer();gl=this.el.sceneEl.getAttribute("webxr").requiredFeatures;gl.push("layers");this.el.sceneEl.getAttribute("webxr","requiredFeatures",gl);this.el.sceneEl.addEventListener("enter-vr",
this.onEnterVR);this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this);this.onEnterVR=this.onEnterVR.bind(this);this.onExitVR=this.onExitVR.bind(this)},update:function(oldData){this.data.src!==oldData.src&&this.updateSrc()},updateSrc:function(){var type=this.data.type;this.texture=void 0;"quad"===type?this.loadQuadImage():"monocubemap"!==type&&"stereocubemap"!==type||this.loadCubeMapImages()},loadCubeMapImages:function(){var type=
this.data.type,xrGLFactory=this.xrGLFactory,frame=this.el.sceneEl.frame,src=this.data.src;this.visibilityChanged=!1;this.layer&&(this.pendingCubeMapUpdate=src.complete?!1:!0,this.loadingScreen=this.loadingScreen?!1:!0,"monocubemap"===type?(type=xrGLFactory.getSubImage(this.layer,frame),this.loadCubeMapImage(type.colorTexture,src,0)):(type=xrGLFactory.getSubImage(this.layer,frame,"left"),this.loadCubeMapImage(type.colorTexture,src,0),type=xrGLFactory.getSubImage(this.layer,frame,"right"),this.loadCubeMapImage(type.colorTexture,
src,6)))},loadQuadImage:function(){var src=this.data.src,self=this;this.el.sceneEl.systems.material.loadTexture(src,{src:src},function(texture){self.el.sceneEl.renderer.initTexture(texture);self.texture=texture;"VIDEO"===src.tagName&&setTimeout(function(){self.textureIsVideo=!0},1E3);self.layer&&(self.layer.height=self.data.height/2||self.texture.image.height/1E3,self.layer.width=self.data.width/2||self.texture.image.width/1E3,self.needsRedraw=!0);self.updateQuadPanel()})},preGenerateCubeMapTextures:function(src,
callback){"monocubemap"===this.data.type?this.generateCubeMapTextures(src,0,callback):(this.generateCubeMapTextures(src,0,callback),this.generateCubeMapTextures(src,6,callback))},generateCubeMapTextures:function(src,faceOffset,callback){for(var data=this.data,cubeFaceSize=this.cubeFaceSize,textureSourceCubeFaceSize=Math.min(src.width,src.height),cubefaceTextures=[],i=0;6>i;i++){var tempCanvas=document.createElement("CANVAS");tempCanvas.width=tempCanvas.height=cubeFaceSize;var tempCanvasContext=tempCanvas.getContext("2d");
!data.rotateCubemap||2!==i&&3!==i||(tempCanvasContext.save(),tempCanvasContext.translate(cubeFaceSize,cubeFaceSize),tempCanvasContext.rotate(Math.PI));tempCanvasContext.drawImage(src,(i+faceOffset)*textureSourceCubeFaceSize,0,textureSourceCubeFaceSize,textureSourceCubeFaceSize,0,0,cubeFaceSize,cubeFaceSize);tempCanvasContext.restore();callback&&callback();cubefaceTextures.push(tempCanvas)}data.rotateCubemap&&(src=cubefaceTextures[0],faceOffset=cubefaceTextures[1],cubefaceTextures[0]=faceOffset,cubefaceTextures[1]=
src,src=cubefaceTextures[4],faceOffset=cubefaceTextures[5],cubefaceTextures[4]=faceOffset,cubefaceTextures[5]=src);callback&&callback();return cubefaceTextures},loadCubeMapImage:function(layerColorTexture,src,faceOffset){var gl=this.el.sceneEl.renderer.getContext();gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!1);gl.bindTexture(gl.TEXTURE_CUBE_MAP,layerColorTexture);var errorCode=0;(!src.complete||this.loadingScreen?this.loadingScreenImages:this.generateCubeMapTextures(src,faceOffset)).forEach(function(canvas,
i){gl.texSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,0,0,gl.RGBA,gl.UNSIGNED_BYTE,canvas);errorCode=gl.getError()});0!==errorCode&&console.log("renderingError, WebGL Error Code: "+errorCode);gl.bindTexture(gl.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),this.needsRedraw||
this.layer.needsRedraw||this.textureIsVideo)&&("quad"===this.data.type&&this.draw(),this.needsRedraw=!1)},initLayer:function(){var self=this,type=this.data.type;this.el.sceneEl.xrSession.onvisibilitychange=function(evt){self.visibilityChanged="hidden"!==evt.session.visibilityState};"quad"===type?this.initQuadLayer():"monocubemap"!==type&&"stereocubemap"!==type||this.initCubeMapLayer()},initQuadLayer:function(){var sceneEl=this.el.sceneEl,gl=sceneEl.renderer.getContext();gl=this.xrGLFactory=new XRWebGLBinding(sceneEl.xrSession,
gl);this.texture&&(this.layer=gl.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1E3,width:this.data.width/2||this.texture.image.width/1E3}),sceneEl.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var src=this.data.src,sceneEl=this.el.sceneEl,gl=sceneEl.renderer.getContext(),glSizeLimit=gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);src=this.cubeFaceSize=Math.min(glSizeLimit,Math.min(src.width,src.height));
this.layer=(this.xrGLFactory=new XRWebGLBinding(sceneEl.xrSession,gl)).createCubeLayer({space:this.referenceSpace,viewPixelWidth:src,viewPixelHeight:src,layout:"monocubemap"===this.data.type?"mono":"stereo",isStatic:!1});this.initLoadingScreenImages();this.loadCubeMapImages();sceneEl.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var cubeFaceSize=this.cubeFaceSize,loadingScreenImages=this.loadingScreenImages=[],i=0;6>i;i++){var tempCanvas=document.createElement("CANVAS");
tempCanvas.width=tempCanvas.height=cubeFaceSize;var tempCanvasContext=tempCanvas.getContext("2d");tempCanvas.width=tempCanvas.height=cubeFaceSize;tempCanvasContext.fillStyle="black";tempCanvasContext.fillRect(0,0,cubeFaceSize,cubeFaceSize);2!==i&&3!==i&&(tempCanvasContext.translate(cubeFaceSize,0),tempCanvasContext.scale(-1,1),tempCanvasContext.fillStyle="white",tempCanvasContext.font="30px Arial",tempCanvasContext.fillText("Loading",cubeFaceSize/2,cubeFaceSize/2));loadingScreenImages.push(tempCanvas)}},
destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(enable){this.layerEnabled=enable;this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var quadPanelEl=this.quadPanelEl;this.quadPanelEl||(quadPanelEl=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(quadPanelEl));
quadPanelEl.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0});quadPanelEl.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1E3,width:this.data.width||this.texture.image.height/1E3})},draw:function(){var sceneEl=this.el.sceneEl,gl=this.el.sceneEl.renderer.getContext(),glayer=this.xrGLFactory.getSubImage(this.layer,sceneEl.frame);sceneEl=sceneEl.renderer.properties.get(this.texture).__webglTexture;var previousFrameBuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);
gl.viewport(glayer.viewport.x,glayer.viewport.y,glayer.viewport.width,glayer.viewport.height);gl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,glayer.colorTexture,0);var textureEl=this.data.src,xrReadFramebuffer=gl.createFramebuffer(),x1offset=glayer.viewport.x,y1offset=glayer.viewport.y,x2offset=glayer.viewport.x+glayer.viewport.width;glayer=glayer.viewport.y+glayer.viewport.height;"VIDEO"===textureEl.tagName&&(gl.bindTexture(gl.TEXTURE_2D,
sceneEl),gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,textureEl.width,textureEl.height,gl.RGB,gl.UNSIGNED_BYTE,textureEl));gl.bindFramebuffer(gl.READ_FRAMEBUFFER,xrReadFramebuffer);gl.framebufferTexture2D(gl.READ_FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,sceneEl,0);gl.readBuffer(gl.COLOR_ATTACHMENT0);gl.blitFramebuffer(0,0,textureEl.width,textureEl.height,x1offset,y1offset,x2offset,glayer,gl.COLOR_BUFFER_BIT,gl.NEAREST);gl.bindFramebuffer(gl.READ_FRAMEBUFFER,null);gl.deleteFramebuffer(xrReadFramebuffer);
gl.bindFramebuffer(gl.FRAMEBUFFER,previousFrameBuffer)},updateTransform:function(){var el=this.el,position=this.position,quaternion=this.quaternion;el.object3D.updateMatrixWorld();position.setFromMatrixPosition(el.object3D.matrixWorld);quaternion.setFromRotationMatrix(el.object3D.matrixWorld);this.layerEnabled||position.set(0,0,1E8);this.layer.transform=new XRRigidTransform(position,quaternion)},onEnterVR:function(){var sceneEl=this.el.sceneEl,xrSession=sceneEl.xrSession;sceneEl.hasWebXR&&XRWebGLBinding&&
xrSession?(xrSession.requestReferenceSpace("local").then(this.onRequestedReferenceSpace),this.layerEnabled=this.needsRedraw=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()):warn("The layer component requires WebXR and the layers API enabled")},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0);this.destroyLayer()},onRequestedReferenceSpace:function(referenceSpace){this.referenceSpace=referenceSpace}})},{"../core/component":130,
"../utils/":204}],86:[function(_dereq_,module,exports){var bind=_dereq_("../utils/bind"),diff=_dereq_("../utils").diff;exports=_dereq_("../utils/debug");var registerComponent=_dereq_("../core/component").registerComponent,THREE=_dereq_("../lib/three"),degToRad=THREE.Math.degToRad,warn=exports("components:light:warn");module.exports.Component=registerComponent("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,
if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,
if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},
init:function(){var el=this.el;this.defaultTarget=this.light=null;this.rendererSystem=this.el.sceneEl.systems.renderer;this.system.registerLight(el)},update:function(oldData){var data=this.data;oldData=diff(data,oldData);var light=this.light,rendererSystem=this.rendererSystem,self=this;if(!light||"type"in oldData)this.setLight(this.data),this.updateShadow();else{var shadowsLoaded=!1;Object.keys(oldData).forEach(function(key){var value=data[key];switch(key){case "color":light.color.set(value);rendererSystem.applyColorCorrection(light.color);
break;case "groundColor":light.groundColor.set(value);rendererSystem.applyColorCorrection(light.groundColor);break;case "angle":light.angle=degToRad(value);break;case "target":if(null===value){if("spot"===data.type||"directional"===data.type)light.target=self.defaultTarget}else if(value.hasLoaded)self.onSetTarget(value,light);else value.addEventListener("loaded",bind(self.onSetTarget,self,value,light));break;case "castShadow":case "shadowBias":case "shadowCameraFar":case "shadowCameraFov":case "shadowCameraNear":case "shadowCameraTop":case "shadowCameraRight":case "shadowCameraBottom":case "shadowCameraLeft":case "shadowCameraVisible":case "shadowMapHeight":case "shadowMapWidth":case "shadowRadius":shadowsLoaded||
(self.updateShadow(),shadowsLoaded=!0);break;default:light[key]=value}})}},setLight:function(data){var el=this.el,newLight=this.getLight(data);newLight&&(this.light&&el.removeObject3D("light"),this.light=newLight,this.light.el=el,el.setObject3D("light",this.light),"spot"!==data.type&&"directional"!==data.type&&"hemisphere"!==data.type||el.getObject3D("light").translateY(-1),"spot"===data.type&&(el.setObject3D("light-target",this.defaultTarget),el.getObject3D("light-target").position.set(0,0,-1)))},
updateShadow:function(){var el=this.el,data=this.data,light=this.light;light.castShadow=data.castShadow;var cameraHelper=el.getObject3D("cameraHelper");data.shadowCameraVisible&&!cameraHelper?el.setObject3D("cameraHelper",new THREE.CameraHelper(light.shadow.camera)):!data.shadowCameraVisible&&cameraHelper&&el.removeObject3D("cameraHelper");if(!data.castShadow)return light;light.shadow.bias=data.shadowBias;light.shadow.radius=data.shadowRadius;light.shadow.mapSize.height=data.shadowMapHeight;light.shadow.mapSize.width=
data.shadowMapWidth;light.shadow.camera.near=data.shadowCameraNear;light.shadow.camera.far=data.shadowCameraFar;light.shadow.camera instanceof THREE.OrthographicCamera?(light.shadow.camera.top=data.shadowCameraTop,light.shadow.camera.right=data.shadowCameraRight,light.shadow.camera.bottom=data.shadowCameraBottom,light.shadow.camera.left=data.shadowCameraLeft):light.shadow.camera.fov=data.shadowCameraFov;light.shadow.camera.updateProjectionMatrix();cameraHelper&&cameraHelper.update()},getLight:function(data){var angle=
data.angle,color=new THREE.Color(data.color);this.rendererSystem.applyColorCorrection(color);color=color.getHex();var decay=data.decay,distance=data.distance,groundColor=new THREE.Color(data.groundColor);this.rendererSystem.applyColorCorrection(groundColor);groundColor=groundColor.getHex();var intensity=data.intensity,type=data.type,target=data.target;switch(type.toLowerCase()){case "ambient":return new THREE.AmbientLight(color,intensity);case "directional":data=new THREE.DirectionalLight(color,intensity);
this.defaultTarget=data.target;if(target)if(target.hasLoaded)this.onSetTarget(target,data);else target.addEventListener("loaded",bind(this.onSetTarget,this,target,data));return data;case "hemisphere":return new THREE.HemisphereLight(color,groundColor,intensity);case "point":return new THREE.PointLight(color,intensity,distance,decay);case "spot":data=new THREE.SpotLight(color,intensity,distance,degToRad(angle),data.penumbra,decay);this.defaultTarget=data.target;if(target)if(target.hasLoaded)this.onSetTarget(target,
data);else target.addEventListener("loaded",bind(this.onSetTarget,this,target,data));return data;default:warn("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",type)}},onSetTarget:function(targetEl,light){light.target=targetEl.object3D},remove:function(){var el=this.el;el.removeObject3D("light");el.getObject3D("cameraHelper")&&el.removeObject3D("cameraHelper")}})},{"../core/component":130,"../lib/three":178,"../utils":204,"../utils/bind":198,"../utils/debug":200}],
87:[function(_dereq_,module,exports){function isEqualVec3(a,b){return a&&b?a.x===b.x&&a.y===b.y&&a.z===b.z:!1}_dereq_=_dereq_("../core/component").registerComponent;module.exports.Component=_dereq_("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var data=this.data;this.rendererSystem=this.el.sceneEl.systems.renderer;var material=
this.material=new THREE.LineBasicMaterial({color:data.color,opacity:data.opacity,transparent:1>data.opacity,visible:data.visible});data=this.geometry=new THREE.BufferGeometry;data.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3));this.rendererSystem.applyColorCorrection(material.color);this.line=new THREE.Line(data,material);this.el.setObject3D(this.attrName,this.line)},update:function(oldData){var data=this.data,geometry=this.geometry,geoNeedsUpdate=!1,material=this.material,
positionArray=geometry.attributes.position.array;isEqualVec3(data.start,oldData.start)||(positionArray[0]=data.start.x,positionArray[1]=data.start.y,positionArray[2]=data.start.z,geoNeedsUpdate=!0);isEqualVec3(data.end,oldData.end)||(positionArray[3]=data.end.x,positionArray[4]=data.end.y,positionArray[5]=data.end.z,geoNeedsUpdate=!0);geoNeedsUpdate&&(geometry.attributes.position.needsUpdate=!0,geometry.computeBoundingSphere());material.color.setStyle(data.color);this.rendererSystem.applyColorCorrection(material.color);
material.opacity=data.opacity;material.transparent=1>data.opacity;material.visible=data.visible},remove:function(){this.el.removeObject3D("line",this.line)}})},{"../core/component":130}],88:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var registerShader=_dereq_("../core/shader").registerShader,THREE=_dereq_("../lib/three");module.exports.Component=exports("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},
highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this);this.previousQuaternion=void 0;this.quaternionClone=new THREE.Quaternion;this.hiddenEls=[]},update:function(oldData){var data=this.data,el=this.el;if(data.visualAspectEnabled){this.initVisualAspect();
var backgroundColor=data.highlighted?data.highlightedColor:data.backgroundColor;var strokeColor=data.highlighted?data.highlightedColor:data.borderColor;el.setAttribute("material","backgroundColor",backgroundColor);el.setAttribute("material","strokeColor",strokeColor);data.on!==oldData.on&&this.updateEventListener();void 0!==oldData.peekMode&&data.peekMode!==oldData.peekMode&&this.updatePeekMode();data.image&&oldData.image!==data.image&&el.setAttribute("material","pano","string"===typeof data.image?
data.image:data.image.src)}},updatePeekMode:function(){var el=this.el,sphereEl=this.sphereEl;this.data.peekMode?(this.hideAll(),el.getObject3D("mesh").visible=!1,sphereEl.setAttribute("visible",!0)):(this.showAll(),el.getObject3D("mesh").visible=!0,sphereEl.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var el=this.el;el.isPlaying&&(this.removeEventListener(),el.addEventListener(this.data.on,this.navigate))},
removeEventListener:function(){var on=this.data.on;on&&this.el.removeEventListener(on,this.navigate)},initVisualAspect:function(){var el=this.el;if(this.data.visualAspectEnabled&&!this.visualAspectInitialized){var textEl=this.textEl=this.textEl||document.createElement("a-entity");var sphereEl=this.sphereEl=this.sphereEl||document.createElement("a-entity");var semiSphereEl=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity");el.setAttribute("geometry",{primitive:"circle",radius:1,
segments:64});el.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"});textEl.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4});textEl.setAttribute("position","0 1.5 0");el.appendChild(textEl);semiSphereEl.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360});semiSphereEl.setAttribute("material",{shader:"portal",
borderEnabled:0,pano:this.data.image,side:"back"});semiSphereEl.setAttribute("rotation","0 180 0");semiSphereEl.setAttribute("position","0 0 0");semiSphereEl.setAttribute("visible",!1);el.appendChild(semiSphereEl);sphereEl.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64});sphereEl.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"});sphereEl.setAttribute("visible",!1);el.appendChild(sphereEl);this.visualAspectInitialized=
!0}},navigate:function(){window.location=this.data.href},tick:function(){var cameraWorldPosition=new THREE.Vector3,elWorldPosition=new THREE.Vector3,quaternion=new THREE.Quaternion,scale=new THREE.Vector3;return function(){var el=this.el,object3D=el.object3D,camera=el.sceneEl.camera,textEl=this.textEl;if(this.data.visualAspectEnabled){object3D.updateMatrixWorld();camera.parent.updateMatrixWorld();camera.updateMatrixWorld();object3D.matrix.decompose(elWorldPosition,quaternion,scale);elWorldPosition.setFromMatrixPosition(object3D.matrixWorld);
cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);var distance=elWorldPosition.distanceTo(cameraWorldPosition);if(20<distance)this.previousQuaternion||(this.quaternionClone.copy(quaternion),this.previousQuaternion=this.quaternionClone),object3D.lookAt(cameraWorldPosition);else{camera=this.calculateCameraPortalOrientation();if(.5>distance){if(!0===this.semiSphereEl.getAttribute("visible"))return;textEl.setAttribute("text","width",1.5);0>=camera?(textEl.setAttribute("position","0 0 0.75"),
textEl.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(textEl.setAttribute("position","0 0 -0.75"),textEl.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0"));el.getObject3D("mesh").visible=!1;this.semiSphereEl.setAttribute("visible",!0);this.peekCameraPortalOrientation=camera}else 0>=camera?textEl.setAttribute("rotation","0 180 0"):textEl.setAttribute("rotation","0 0 0"),textEl.setAttribute("text","width",5),textEl.setAttribute("position",
"0 1.5 0"),el.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(object3D.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}}(),hideAll:function(){var el=this.el,hiddenEls=this.hiddenEls,self=this;0<hiddenEls.length||el.sceneEl.object3D.traverse(function(object){object&&object.el&&object.el.hasAttribute("link-controls")||!object.el||object===el.sceneEl.object3D||object.el===el||object.el===
self.sphereEl||object.el===el.sceneEl.cameraEl||!1===object.el.getAttribute("visible")||object.el===self.textEl||object.el===self.semiSphereEl||(object.el.setAttribute("visible",!1),hiddenEls.push(object.el))})},showAll:function(){this.hiddenEls.forEach(function(el){el.setAttribute("visible",!0)});this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var mat4=new THREE.Matrix4,cameraPosition=new THREE.Vector3,portalNormal=new THREE.Vector3(0,0,1),portalPosition=new THREE.Vector3(0,0,0);return function(){var el=
this.el,camera=el.sceneEl.camera;cameraPosition.set(0,0,0);portalNormal.set(0,0,1);portalPosition.set(0,0,0);el.object3D.matrixWorld.extractRotation(mat4);portalNormal.applyMatrix4(mat4);el.object3D.updateMatrixWorld();el.object3D.localToWorld(portalPosition);camera.parent.parent.updateMatrixWorld();camera.parent.updateMatrixWorld();camera.updateMatrixWorld();camera.localToWorld(cameraPosition);cameraPosition.sub(portalPosition).normalize();portalNormal.normalize();return Math.sign(portalNormal.dot(cameraPosition))}}(),
remove:function(){this.removeEventListener()}});registerShader("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:"vec3 portalPosition;\nvarying vec3 vWorldPosition;\nvarying float vDistanceToCenter;\nvarying float vDistance;\nvoid main() {\nvDistanceToCenter \x3d clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);\nportalPosition \x3d (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;\nvDistance \x3d length(portalPosition - cameraPosition);\nvWorldPosition \x3d (modelMatrix * vec4(position, 1.0)).xyz;\ngl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
fragmentShader:"#define RECIPROCAL_PI2 0.15915494\nuniform sampler2D pano;\nuniform vec3 strokeColor;\nuniform vec3 backgroundColor;\nuniform float borderEnabled;\nvarying float vDistanceToCenter;\nvarying float vDistance;\nvarying vec3 vWorldPosition;\nvoid main() {\nvec3 direction \x3d normalize(vWorldPosition - cameraPosition);\nvec2 sampleUV;\nfloat borderThickness \x3d clamp(exp(-vDistance / 50.0), 0.6, 0.95);\nsampleUV.y \x3d clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);\nsampleUV.x \x3d atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;\nif (vDistanceToCenter \x3e borderThickness \x26\x26 borderEnabled \x3d\x3d 1.0) {\ngl_FragColor \x3d vec4(strokeColor, 1.0);\n} else {\ngl_FragColor \x3d mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));\n}\n}"})},
{"../core/component":130,"../core/shader":140,"../lib/three":178}],89:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/"),bind=utils.bind,PI_2=Math.PI/2;module.exports.Component=exports("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},
mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0;this.previousHMDPosition=new THREE.Vector3;this.hmdQuaternion=new THREE.Quaternion;this.magicWindowAbsoluteEuler=new THREE.Euler;this.magicWindowDeltaEuler=new THREE.Euler;this.position=new THREE.Vector3;this.magicWindowObject=new THREE.Object3D;this.rotation={};this.deltaRotation={};this.savedPose=null;this.pointerLocked=!1;this.setupMouseControls();this.bindMethods();this.previousMouseEvent={};this.setupMagicWindowControls();this.savedPose=
{position:new THREE.Vector3,rotation:new THREE.Euler};if(this.el.sceneEl.is("vr-mode"))this.onEnterVR()},setupMagicWindowControls:function(){var data=this.data;if(utils.device.isMobile()){var magicWindowControls=this.magicWindowControls=new THREE.DeviceOrientationControls(this.magicWindowObject);"undefined"!==typeof DeviceOrientationEvent&&DeviceOrientationEvent.requestPermission&&(magicWindowControls.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?magicWindowControls.enabled=
data.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){magicWindowControls.enabled=data.magicWindowTrackingEnabled}))}},update:function(oldData){var data=this.data;data.enabled!==oldData.enabled&&this.updateGrabCursor(data.enabled);oldData&&!data.magicWindowTrackingEnabled&&oldData.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0));this.magicWindowControls&&(this.magicWindowControls.enabled=
data.magicWindowTrackingEnabled);oldData&&!data.pointerLockEnabled!==oldData.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(t){this.data.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners();this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners();this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=
bind(this.onMouseDown,this);this.onMouseMove=bind(this.onMouseMove,this);this.onMouseUp=bind(this.onMouseUp,this);this.onTouchStart=bind(this.onTouchStart,this);this.onTouchMove=bind(this.onTouchMove,this);this.onTouchEnd=bind(this.onTouchEnd,this);this.onEnterVR=bind(this.onEnterVR,this);this.onExitVR=bind(this.onExitVR,this);this.onPointerLockChange=bind(this.onPointerLockChange,this);this.onPointerLockError=bind(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1;this.pitchObject=
new THREE.Object3D;this.yawObject=new THREE.Object3D;this.yawObject.position.y=10;this.yawObject.add(this.pitchObject)},addEventListeners:function(){var sceneEl=this.el.sceneEl,canvasEl=sceneEl.canvas;canvasEl?(canvasEl.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),canvasEl.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",
this.onTouchEnd),sceneEl.addEventListener("enter-vr",this.onEnterVR),sceneEl.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))):sceneEl.addEventListener("render-target-loaded",bind(this.addEventListeners,this))},removeEventListeners:function(){var sceneEl=
this.el.sceneEl,canvasEl=sceneEl&&sceneEl.canvas;canvasEl&&(canvasEl.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),canvasEl.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),sceneEl.removeEventListener("enter-vr",this.onEnterVR),sceneEl.removeEventListener("exit-vr",this.onExitVR),
document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var poseMatrix=new THREE.Matrix4;return function(){var object3D=this.el.object3D,pitchObject=this.pitchObject,yawObject=this.yawObject,sceneEl=this.el.sceneEl;sceneEl.is("vr-mode")&&sceneEl.checkHeadsetConnected()?sceneEl.hasWebXR&&(pitchObject=
sceneEl.renderer.xr.getCameraPose())&&(poseMatrix.elements=pitchObject.transform.matrix,poseMatrix.decompose(object3D.position,object3D.rotation,object3D.scale)):(this.updateMagicWindowOrientation(),object3D.rotation.x=this.magicWindowDeltaEuler.x+pitchObject.rotation.x,object3D.rotation.y=this.magicWindowDeltaEuler.y+yawObject.rotation.y,object3D.rotation.z=this.magicWindowDeltaEuler.z)}}(),updateMagicWindowOrientation:function(){var magicWindowAbsoluteEuler=this.magicWindowAbsoluteEuler,magicWindowDeltaEuler=
this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),magicWindowAbsoluteEuler.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),this.previousMagicWindowYaw||0===magicWindowAbsoluteEuler.y||(this.previousMagicWindowYaw=magicWindowAbsoluteEuler.y),this.previousMagicWindowYaw&&(magicWindowDeltaEuler.x=magicWindowAbsoluteEuler.x,magicWindowDeltaEuler.y+=magicWindowAbsoluteEuler.y-this.previousMagicWindowYaw,magicWindowDeltaEuler.z=
magicWindowAbsoluteEuler.z,this.previousMagicWindowYaw=magicWindowAbsoluteEuler.y))},onMouseMove:function(evt){var pitchObject=this.pitchObject;var movementY=this.previousMouseEvent;var yawObject=this.yawObject;if(this.data.enabled&&(this.mouseDown||this.pointerLocked)){if(this.pointerLocked){var movementX=evt.movementX||evt.mozMovementX||0;movementY=evt.movementY||evt.mozMovementY||0}else movementX=evt.screenX-movementY.screenX,movementY=evt.screenY-movementY.screenY;this.previousMouseEvent.screenX=
evt.screenX;this.previousMouseEvent.screenY=evt.screenY;evt=this.data.reverseMouseDrag?1:-1;yawObject.rotation.y+=.002*movementX*evt;pitchObject.rotation.x+=.002*movementY*evt;pitchObject.rotation.x=Math.max(-PI_2,Math.min(PI_2,pitchObject.rotation.x))}},onMouseDown:function(evt){var sceneEl=this.el.sceneEl;!this.data.enabled||!this.data.mouseEnabled||sceneEl.is("vr-mode")&&sceneEl.checkHeadsetConnected()||0!==evt.button||(sceneEl=sceneEl&&sceneEl.canvas,this.mouseDown=!0,this.previousMouseEvent.screenX=
evt.screenX,this.previousMouseEvent.screenY=evt.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(sceneEl.requestPointerLock?sceneEl.requestPointerLock():sceneEl.mozRequestPointerLock&&sceneEl.mozRequestPointerLock()))},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1;this.hideGrabbingCursor()},onTouchStart:function(evt){1===
evt.touches.length&&this.data.touchEnabled&&!this.el.sceneEl.is("vr-mode")&&(this.touchStart={x:evt.touches[0].pageX,y:evt.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(evt){this.touchStarted&&this.data.touchEnabled&&(this.yawObject.rotation.y-=2*Math.PI*(evt.touches[0].pageX-this.touchStart.x)/this.el.sceneEl.canvas.clientWidth*.5*(this.data.reverseTouchDrag?1:-1),this.touchStart={x:evt.touches[0].pageX,y:evt.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var sceneEl=
this.el.sceneEl;sceneEl.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),sceneEl.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!(!document.pointerLockElement&&!document.mozPointerLockElement)},
onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock();this.pointerLocked=!1},updateGrabCursor:function(enabled){function enableGrabCursor(){sceneEl.canvas.classList.add("a-grab-cursor")}function disableGrabCursor(){sceneEl.canvas.classList.remove("a-grab-cursor")}var sceneEl=this.el.sceneEl;sceneEl.canvas?enabled?enableGrabCursor():disableGrabCursor():enabled?sceneEl.addEventListener("render-target-loaded",enableGrabCursor):sceneEl.addEventListener("render-target-loaded",
disableGrabCursor)},saveCameraPose:function(){var el=this.el;this.savedPose.position.copy(el.object3D.position);this.savedPose.rotation.copy(el.object3D.rotation);this.hasSavedPose=!0},restoreCameraPose:function(){var el=this.el,savedPose=this.savedPose;this.hasSavedPose&&(el.object3D.position.copy(savedPose.position),el.object3D.rotation.copy(savedPose.rotation),this.hasSavedPose=!1)}})},{"../core/component":130,"../lib/three":178,"../utils/":204}],90:[function(_dereq_,module,exports){var bind=_dereq_("../utils/bind");
exports=_dereq_("../core/component").registerComponent;_dereq_=_dereq_("../utils/tracked-controls");var checkControllerPresentAndSetup=_dereq_.checkControllerPresentAndSetup,emitIfAxesChanged=_dereq_.emitIfAxesChanged,onButtonEvent=_dereq_.onButtonEvent;module.exports.Component=exports("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]},init:function(){var self=this;this.controllerPresent=
!1;this.lastControllerCheck=0;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.previousButtonValues={};this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},update:function(){var data=
this.data;this.controllerIndex="right"===data.hand?0:"left"===data.hand?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,
this);this.onAxisMoved=bind(this.onAxisMoved,this)},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("axismove",this.onAxisMoved);el.addEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!0},
removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("axismove",this.onAxisMoved);el.removeEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,
"magicleap-one",{index:this.controllerIndex,hand:this.data.hand})},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{idPrefix:"magicleap-one",hand:data.hand,controller:this.controllerIndex,orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,
!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id];if(button){if("trigger"===button){var analogValue=evt.detail.state.value;console.log("analog value of trigger press: "+analogValue)}this.el.emit(button+"changed",evt.detail.state)}},onModelLoaded:function(evt){evt.detail.model.scale.set(.01,
.01,.01)},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},updateModel:function(buttonName,evtName){},setButtonColor:function(buttonName,color){}})},{"../core/component":130,"../utils/bind":198,"../utils/tracked-controls":213}],91:[function(_dereq_,module,exports){function parseBlending(blending){switch(blending){case "none":return THREE.NoBlending;case "additive":return THREE.AdditiveBlending;case "subtractive":return THREE.SubtractiveBlending;case "multiply":return THREE.MultiplyBlending;
default:return THREE.NormalBlending}}function disposeMaterial(material,system){material.dispose();system.unregisterMaterial(material)}exports=_dereq_("../utils/");var component=_dereq_("../core/component"),THREE=_dereq_("../lib/three");_dereq_=_dereq_("../core/shader");var error=exports.debug("components:material:error");exports=component.registerComponent;var shaders=_dereq_.shaders;module.exports.Component=exports("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},
flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:_dereq_.shaderNames,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},
init:function(){this.material=null},update:function(oldData){var data=this.data;this.shader&&data.shader===oldData.shader||this.updateShader(data.shader);this.shader.update(this.data);this.updateMaterial(oldData)},updateSchema:function(data){var schema;var newShader=data&&data.shader;data=this.oldData&&this.oldData.shader;var shader=newShader||data;(schema=shaders[shader]&&shaders[shader].schema)||error("Unknown shader schema "+shader);data&&newShader===data||(this.extendSchema(schema),this.updateBehavior())},
updateBehavior:function(){function tickTime(time,delta){for(var key in tickProperties)tickProperties[key]=time;self.shader.update(tickProperties)}var key$jscomp$0,sceneEl=this.el.sceneEl,schema=this.schema,self=this;this.tick=void 0;var tickProperties={};for(key$jscomp$0 in schema)"time"===schema[key$jscomp$0].type&&(this.tick=tickTime,tickProperties[key$jscomp$0]=!0);sceneEl&&(this.tick?sceneEl.addBehavior(this):sceneEl.removeBehavior(this))},updateShader:function(shaderName){var data=this.data,
Shader=shaders[shaderName]&&shaders[shaderName].Shader;if(!Shader)throw Error("Unknown shader "+shaderName);shaderName=this.shader=new Shader;shaderName.el=this.el;shaderName.init(data);this.setMaterial(shaderName.material);this.updateSchema(data)},updateMaterial:function(oldData){var data=this.data,material=this.material,oldDataHasKeys;material.alphaTest=data.alphaTest;material.depthTest=!1!==data.depthTest;material.depthWrite=!1!==data.depthWrite;material.opacity=data.opacity;material.flatShading=
data.flatShading;a:switch(data.side){case "back":var JSCompiler_inline_result=THREE.BackSide;break a;case "double":JSCompiler_inline_result=THREE.DoubleSide;break a;default:JSCompiler_inline_result=THREE.FrontSide}material.side=JSCompiler_inline_result;material.transparent=!1!==data.transparent||1>data.opacity;a:switch(data.vertexColors){case "face":JSCompiler_inline_result=THREE.FaceColors;break a;case "vertex":JSCompiler_inline_result=THREE.VertexColors;break a;default:JSCompiler_inline_result=
THREE.NoColors}material.vertexColors=JSCompiler_inline_result;material.visible=data.visible;material.blending=parseBlending(data.blending);material.dithering=data.dithering;for(oldDataHasKeys in oldData)break;!oldDataHasKeys||oldData.alphaTest===data.alphaTest&&oldData.side===data.side&&oldData.vertexColors===data.vertexColors||(material.needsUpdate=!0)},remove:function(){var defaultMaterial=new THREE.MeshBasicMaterial,material=this.material,object3D=this.el.getObject3D("mesh");object3D&&(object3D.material=
defaultMaterial);disposeMaterial(material,this.system)},setMaterial:function(material){var el=this.el;var mesh=this.system;this.material&&disposeMaterial(this.material,mesh);this.material=material;mesh.registerMaterial(material);(mesh=el.getObject3D("mesh"))?mesh.material=material:el.addEventListener("object3dset",function waitForMesh(evt){"mesh"===evt.detail.type&&evt.target===el&&(el.getObject3D("mesh").material=material,el.removeEventListener("object3dset",waitForMesh))})}})},{"../core/component":130,
"../core/shader":140,"../lib/three":178,"../utils/":204}],92:[function(_dereq_,module,exports){exports=_dereq_("../utils/debug");var registerComponent=_dereq_("../core/component").registerComponent,THREE=_dereq_("../lib/three"),warn=exports("components:obj-model:warn");module.exports.Component=registerComponent("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var self=this;this.model=null;this.objLoader=new THREE.OBJLoader;this.mtlLoader=new THREE.MTLLoader(this.objLoader.manager);
this.mtlLoader.crossOrigin="";this.el.addEventListener("componentinitialized",function(evt){self.model&&"material"===evt.detail.name&&self.applyMaterial()})},update:function(){var data=this.data;data.obj&&(this.resetMesh(),this.loadObj(data.obj,data.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(objUrl,mtlUrl){var self=this,el=this.el,mtlLoader=this.mtlLoader,objLoader=this.objLoader,rendererSystem=this.el.sceneEl.systems.renderer,
BASE_PATH=mtlUrl.substr(0,mtlUrl.lastIndexOf("/")+1);mtlUrl?(el.hasAttribute("material")&&warn("Material component properties are ignored when a .MTL is provided"),mtlLoader.setResourcePath(BASE_PATH),mtlLoader.load(mtlUrl,function(materials){materials.preload();objLoader.setMaterials(materials);objLoader.load(objUrl,function(objModel){self.model=objModel;self.model.traverse(function(object){object.isMesh&&(object=object.material,object.color&&rendererSystem.applyColorCorrection(object.color),object.map&&
rendererSystem.applyColorCorrection(object.map),object.emissive&&rendererSystem.applyColorCorrection(object.emissive),object.emissiveMap&&rendererSystem.applyColorCorrection(object.emissiveMap))});el.setObject3D("mesh",objModel);el.emit("model-loaded",{format:"obj",model:objModel})})})):objLoader.load(objUrl,function(objModel){self.model=objModel;self.applyMaterial();el.setObject3D("mesh",objModel);el.emit("model-loaded",{format:"obj",model:objModel})})},applyMaterial:function(){var material=this.el.components.material;
material&&this.model.traverse(function(child){child instanceof THREE.Mesh&&(child.material=material.material)})}})},{"../core/component":130,"../lib/three":178,"../utils/debug":200}],93:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,
onButtonEvent=trackedControlsUtils.onButtonEvent,GAMEPAD_ID_PREFIX=(_dereq_=_dereq_("../utils/").device.isWebXRAvailable)?"oculus-go":"Oculus Go";trackedControlsUtils={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]};var INPUT_MAPPING_WEBXR={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]};module.exports.Component=exports("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",
default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:_dereq_?INPUT_MAPPING_WEBXR:trackedControlsUtils,bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=
this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.controllerPresent=!1;this.lastControllerCheck=0;this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},addEventListeners:function(){var el=
this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("model-loaded",this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);
el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("model-loaded",this.onModelLoaded);el.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent();
this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{armModel:data.armModel,hand:data.hand,idPrefix:GAMEPAD_ID_PREFIX,orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",
this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(evt){evt=evt.detail.model;if(this.data.model){var buttonMeshes=this.buttonMeshes={};buttonMeshes.trigger=evt.getObjectByName("oculus_go_button_trigger");buttonMeshes.trackpad=evt.getObjectByName("oculus_go_touchpad");buttonMeshes.touchpad=evt.getObjectByName("oculus_go_touchpad")}},
onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id];button&&this.el.emit(button+"changed",evt.detail.state)},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},updateModel:function(buttonName,evtName){this.data.model&&this.updateButtonModel(buttonName,evtName)},updateButtonModel:function(buttonName,state){var buttonMeshes=this.buttonMeshes;if(buttonMeshes&&buttonMeshes[buttonName]){switch(state){case "down":state=this.data.buttonHighlightColor;break;
case "touchstart":state=this.data.buttonTouchedColor;break;default:state=this.data.buttonColor}buttonName=buttonMeshes[buttonName];buttonName.material.color.set(state);this.rendererSystem.applyColorCorrection(buttonName.material.color)}}})},{"../core/component":130,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],94:[function(_dereq_,module,exports){var bind=_dereq_("../utils/bind");exports=_dereq_("../core/component").registerComponent;var THREE=_dereq_("../lib/three"),trackedControlsUtils=
_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,onButtonEvent=trackedControlsUtils.onButtonEvent,isWebXRAvailable=_dereq_("../utils/").device.isWebXRAvailable,GAMEPAD_ID_PREFIX=isWebXRAvailable?"oculus-touch":"Oculus Touch";_dereq_={left:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,
y:-.8,z:-1}},modelPivotOffset:new THREE.Vector3(-.005,.003,-.055),modelPivotRotation:new THREE.Euler(0,0,0)},right:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new THREE.Vector3(.005,.003,-.055),modelPivotRotation:new THREE.Euler(0,0,0)}};trackedControlsUtils={left:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-left.gltf",rayOrigin:{origin:{x:.002,
y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new THREE.Vector3(-.005,.036,-.037),modelPivotRotation:new THREE.Euler(Math.PI/4.5,0,0)},right:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new THREE.Vector3(.005,.036,-.037),modelPivotRotation:new THREE.Euler(Math.PI/4.5,0,0)}};var CONTROLLER_PROPERTIES={"oculus-touch":isWebXRAvailable?trackedControlsUtils:
_dereq_,"oculus-touch-v2":{left:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new THREE.Vector3(0,0,0),modelPivotRotation:new THREE.Euler(0,0,0)},right:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new THREE.Vector3(0,0,0),modelPivotRotation:new THREE.Euler(0,
0,0)}},"oculus-touch-v3":{left:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new THREE.Vector3(.01,-.01,.05),modelPivotRotation:new THREE.Euler(Math.PI/4,0,0)},right:{modelUrl:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new THREE.Vector3(-.01,-.01,.05),modelPivotRotation:new THREE.Euler(Math.PI/
4,0,0)}}};THREE={left:{axes:{thumbstick:[0,1]},buttons:"thumbstick trigger grip xbutton ybutton surface".split(" ")},right:{axes:{thumbstick:[0,1]},buttons:"thumbstick trigger grip abutton bbutton surface".split(" ")}};_dereq_={left:{axes:{thumbstick:[2,3]},buttons:"trigger grip none thumbstick xbutton ybutton surface".split(" ")},right:{axes:{thumbstick:[2,3]},buttons:"trigger grip none thumbstick abutton bbutton surface".split(" ")}};module.exports.Component=exports("oculus-touch-controls",{schema:{hand:{default:"left"},
buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:isWebXRAvailable?_dereq_:THREE,bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=
bind(this.checkIfControllerPresent,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self,self.data.hand)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self,self.data.hand)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self,self.data.hand)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,
"touchend",self,self.data.hand)};this.controllerPresent=!1;this.lastControllerCheck=0;this.previousButtonValues={};this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);
el.addEventListener("axismove",this.onAxisMoved);el.addEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("axismove",
this.onAxisMoved);el.removeEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},loadModel:function(controller){var data=this.data,controllerId;data.model&&(this.displayModel=CONTROLLER_PROPERTIES[data.controllerType]||
CONTROLLER_PROPERTIES["oculus-touch"],"auto"===data.controllerType&&((controllerId=this.el.sceneEl.systems["tracked-controls-webvr"])&&controllerId.vrDisplay?/^Oculus Quest$/.test(controllerId.vrDisplay.displayName)&&(this.displayModel=CONTROLLER_PROPERTIES["oculus-touch-v2"]):(controllerId="oculus-touch",controllerId=-1!==controller.profiles.indexOf("oculus-touch-v2")?"oculus-touch-v2":controllerId,controllerId=-1!==controller.profiles.indexOf("oculus-touch-v3")?"oculus-touch-v3":controllerId,this.displayModel=
CONTROLLER_PROPERTIES[controllerId])),this.el.setAttribute("gltf-model",this.displayModel[data.hand].modelUrl))},injectTrackedControls:function(controller){var data=this.data,webVRId="right"===data.hand?"Oculus Touch (Right)":"Oculus Touch (Left)";this.el.setAttribute("tracked-controls",{id:isWebXRAvailable?"oculus-touch":webVRId,hand:data.hand,orientationOffset:data.orientationOffset,handTrackingEnabled:!1});this.loadModel(controller)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",
this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(evt){var button=this.mapping[this.data.hand].buttons[evt.detail.id],buttonMeshes=this.buttonMeshes;if(button){if("trigger"===button||"grip"===button)var analogValue=evt.detail.state.value;buttonMeshes&&("trigger"===button&&buttonMeshes.trigger&&(buttonMeshes.trigger.rotation.x=
this.originalXRotationTrigger-Math.PI/26*analogValue),"grip"===button&&buttonMeshes.grip&&(buttonMeshes.grip.position.x=this.originalXPositionGrip+("left"===this.data.hand?-1:1)*analogValue*.004));this.el.emit(button+"changed",evt.detail.state)}},onModelLoaded:function(evt){evt=this.controllerObject3D=evt.detail.model;if(this.data.model){var buttonMeshes=this.buttonMeshes={};buttonMeshes.grip=evt.getObjectByName("buttonHand");this.originalXPositionGrip=buttonMeshes.grip&&buttonMeshes.grip.position.x;
buttonMeshes.thumbstick=evt.getObjectByName("stick");buttonMeshes.trigger=evt.getObjectByName("buttonTrigger");this.originalXRotationTrigger=buttonMeshes.trigger&&buttonMeshes.trigger.rotation.x;buttonMeshes.xbutton=evt.getObjectByName("buttonX");buttonMeshes.abutton=evt.getObjectByName("buttonA");buttonMeshes.ybutton=evt.getObjectByName("buttonY");buttonMeshes.bbutton=evt.getObjectByName("buttonB");evt.position.copy(this.displayModel[this.data.hand].modelPivotOffset);evt.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation);
this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping[this.data.hand].axes,evt)},updateModel:function(buttonName,evtName){this.data.model&&this.updateButtonModel(buttonName,evtName)},updateButtonModel:function(buttonName,state){state="up"===state||"touchend"===state?this.data.buttonColor:"touchstart"===state?this.data.buttonTouchColor:this.data.buttonHighlightColor;
var buttonMeshes=this.buttonMeshes;this.data.model&&buttonMeshes&&buttonMeshes[buttonName]&&(buttonName=buttonMeshes[buttonName],buttonName.material.color.set(state),this.rendererSystem.applyColorCorrection(buttonName.material.color))}})},{"../core/component":130,"../lib/three":178,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],95:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/component").registerComponent;module.exports.Component=_dereq_("position",{schema:{type:"vec3"},
update:function(){var data=this.data;this.el.object3D.position.set(data.x,data.y,data.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":130}],96:[function(_dereq_,module,exports){function copyArray(a,b){var i;a.length=b.length;for(i=0;i<b.length;i++)a[i]=b[i]}exports=_dereq_("../core/component").registerComponent;var THREE=_dereq_("../lib/three"),warn=_dereq_("../utils/").debug("components:raycaster:warn"),OBSERVER_SELECTOR_RE=/^[\w\s-.,[\]#]*$/,OBSERVER_CONFIG={childList:!0,
attributes:!0,subtree:!0};module.exports.Component=exports("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1E3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[];this.unitLineEndVec3=new THREE.Vector3;this.intersectedEls=[];this.intersections=[];this.newIntersectedEls=
[];this.newIntersections=[];this.objects=[];this.prevCheckTime=void 0;this.prevIntersectedEls=[];this.rawIntersections=[];this.raycaster=new THREE.Raycaster;this.updateOriginDirection();this.setDirty=this.setDirty.bind(this);this.updateLine=this.updateLine.bind(this);this.observer=new MutationObserver(this.setDirty);this.dirty=!0;this.lineEndVec3=new THREE.Vector3;this.otherLineEndVec3=new THREE.Vector3;this.lineData={end:this.lineEndVec3};this.getIntersection=this.getIntersection.bind(this);this.intersectedDetail=
{el:this.el,getIntersection:this.getIntersection};this.intersectedClearedDetail={el:this.el};this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls};this.intersectionDetail={}},update:function(oldData){var data=this.data,el=this.el,raycaster=this.raycaster;raycaster.far=data.far;raycaster.near=data.near;!data.showLine||data.far===oldData.far&&data.origin===oldData.origin&&data.direction===oldData.direction&&oldData.showLine||(this.unitLineEndVec3.copy(data.origin).add(data.direction).normalize(),
this.drawLine());!data.showLine&&oldData.showLine&&el.removeAttribute("line");data.objects===oldData.objects||OBSERVER_SELECTOR_RE.test(data.objects)||warn('[raycaster] Selector "'+data.objects+'" may not update automatically with DOM changes.');data.objects||warn('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster\x3d"objects: [data-raycastable]".');data.autoRefresh!==oldData.autoRefresh&&
el.isPlaying&&(data.autoRefresh?this.addEventListeners():this.removeEventListeners());oldData.enabled&&!data.enabled&&this.clearAllIntersections();this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line");this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,OBSERVER_CONFIG),this.el.sceneEl.addEventListener("object3dset",
this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect();this.el.sceneEl.removeEventListener("object3dset",this.setDirty);this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var data=this.data;data=data.objects?this.el.sceneEl.querySelectorAll(data.objects):this.el.sceneEl.querySelectorAll("*");this.objects=this.flattenObject3DMaps(data);
this.dirty=!1},tock:function(time){var data=this.data,prevCheckTime=this.prevCheckTime;!data.enabled||prevCheckTime&&time-prevCheckTime<data.interval||(this.prevCheckTime=time,this.checkIntersections())},checkIntersections:function(){var clearedIntersectedEls=this.clearedIntersectedEls,el=this.el,data=this.data,i,intersectedEls=this.intersectedEls,intersections=this.intersections,newIntersectedEls=this.newIntersectedEls,newIntersections=this.newIntersections,prevIntersectedEls=this.prevIntersectedEls,
rawIntersections=this.rawIntersections;this.dirty&&this.refreshObjects();copyArray(this.prevIntersectedEls,this.intersectedEls);this.updateOriginDirection();rawIntersections.length=0;this.raycaster.intersectObjects(this.objects,!0,rawIntersections);intersections.length=0;for(i=intersectedEls.length=0;i<rawIntersections.length;i++){var intersection=rawIntersections[i];data.showLine&&intersection.object===el.getObject3D("line")||!intersection.object.el||(intersections.push(intersection),intersectedEls.push(intersection.object.el))}newIntersections.length=
0;for(i=newIntersectedEls.length=0;i<intersections.length;i++)-1===prevIntersectedEls.indexOf(intersections[i].object.el)&&(newIntersections.push(intersections[i]),newIntersectedEls.push(intersections[i].object.el));for(i=clearedIntersectedEls.length=0;i<prevIntersectedEls.length;i++)-1===intersectedEls.indexOf(prevIntersectedEls[i])&&(prevIntersectedEls[i].emit("raycaster-intersected-cleared",this.intersectedClearedDetail),clearedIntersectedEls.push(prevIntersectedEls[i]));clearedIntersectedEls.length&&
el.emit("raycaster-intersection-cleared",this.intersectionClearedDetail);for(i=0;i<newIntersectedEls.length;i++)newIntersectedEls[i].emit("raycaster-intersected",this.intersectedDetail);newIntersections.length&&(this.intersectionDetail.els=newIntersectedEls,this.intersectionDetail.intersections=newIntersections,el.emit("raycaster-intersection",this.intersectionDetail));data.showLine&&setTimeout(this.updateLine)},updateLine:function(){var el=this.el,intersections=this.intersections,lineLength;intersections.length&&
(lineLength=intersections[0].object.el===el&&intersections[1]?intersections[1].distance:intersections[0].distance);this.drawLine(lineLength)},getIntersection:function(el){var i;for(i=0;i<this.intersections.length;i++){var intersection=this.intersections[i];if(intersection.object.el===el)return intersection}return null},updateOriginDirection:function(){var direction=new THREE.Vector3,originVec3=new THREE.Vector3;return function(){var el=this.el,data=this.data;if(data.useWorldCoordinates)this.raycaster.set(data.origin,
data.direction);else{el.object3D.updateMatrixWorld();originVec3.setFromMatrixPosition(el.object3D.matrixWorld);if(0!==data.origin.x||0!==data.origin.y||0!==data.origin.z)originVec3=el.object3D.localToWorld(originVec3.copy(data.origin));direction.copy(data.direction).transformDirection(el.object3D.matrixWorld).normalize();this.raycaster.set(originVec3,direction)}}}(),drawLine:function(length){var data=this.data,el=this.el;var endVec3=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3;
void 0===length&&(length=Infinity===data.far?1E3:data.far);this.lineData.start=data.origin;this.lineData.end=endVec3.copy(this.unitLineEndVec3).multiplyScalar(length);this.lineData.color=data.lineColor;el.setAttribute("line",this.lineData)},flattenObject3DMaps:function(els){var key,i,objects=this.objects;for(i=objects.length=0;i<els.length;i++)if(els[i].isEntity&&els[i].object3D)for(key in els[i].object3DMap)objects.push(els[i].getObject3D(key));return objects},clearAllIntersections:function(){var i;
for(i=0;i<this.intersectedEls.length;i++)this.intersectedEls[i].emit("raycaster-intersected-cleared",this.intersectedClearedDetail);copyArray(this.clearedIntersectedEls,this.intersectedEls);this.intersectedEls.length=0;this.intersections.length=0;this.el.emit("raycaster-intersection-cleared",this.intersectionClearedDetail)}})},{"../core/component":130,"../lib/three":178,"../utils/":204}],97:[function(_dereq_,module,exports){var degToRad=_dereq_("../lib/three").Math.degToRad;_dereq_=_dereq_("../core/component").registerComponent;
module.exports.Component=_dereq_("rotation",{schema:{type:"vec3"},update:function(){var data=this.data,object3D=this.el.object3D;object3D.rotation.set(degToRad(data.x),degToRad(data.y),degToRad(data.z));object3D.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":130,"../lib/three":178}],98:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/component").registerComponent;module.exports.Component=_dereq_("scale",{schema:{type:"vec3",default:{x:1,
y:1,z:1}},update:function(){var data=this.data;this.el.object3D.scale.set(0===data.x?1E-5:data.x,0===data.y?1E-5:data.y,0===data.z?1E-5:data.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":130}],99:[function(_dereq_,module,exports){exports=_dereq_("../../core/component").registerComponent;var COMPONENTS=_dereq_("../../core/component").components;module.exports.Component=exports("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var data=
this.data;this.el.object3D.background=data.transparent?null:new THREE.Color(data.color)},remove:function(){this.el.object3D.background=this.data.transparent?null:COMPONENTS[this.name].schema.color.default}})},{"../../core/component":130}],100:[function(_dereq_,module,exports){_dereq_=_dereq_("../../core/component").registerComponent;module.exports.Component=_dereq_("debug",{schema:{default:!0}})},{"../../core/component":130}],101:[function(_dereq_,module,exports){function createPermissionDialog(denyText,
allowText,dialogText,onAllowClicked,onDenyClicked){var buttonsContainer=document.createElement("div");buttonsContainer.classList.add("a-dialog-buttons-container");var denyButton=document.createElement("button");denyButton.classList.add("a-dialog-button","a-dialog-deny-button");denyButton.setAttribute(constants.AFRAME_INJECTED,"");denyButton.innerHTML=denyText;buttonsContainer.appendChild(denyButton);denyText=document.createElement("button");denyText.classList.add("a-dialog-button","a-dialog-allow-button");
denyText.setAttribute(constants.AFRAME_INJECTED,"");denyText.innerHTML=allowText;buttonsContainer.appendChild(denyText);denyText.addEventListener("click",function(evt){evt.stopPropagation();onAllowClicked()});denyButton.addEventListener("click",function(evt){evt.stopPropagation();onDenyClicked()});return createDialog(dialogText,buttonsContainer)}function createAlertDialog(closeText,dialogText,onOkClicked){var buttonsContainer=document.createElement("div");buttonsContainer.classList.add("a-dialog-buttons-container");
var okButton=document.createElement("button");okButton.classList.add("a-dialog-button","a-dialog-ok-button");okButton.setAttribute(constants.AFRAME_INJECTED,"");okButton.innerHTML=closeText;buttonsContainer.appendChild(okButton);okButton.addEventListener("click",function(evt){evt.stopPropagation();onOkClicked()});return createDialog(dialogText,buttonsContainer)}function createDialog(text,buttonsContainerEl){var modalContainer=document.createElement("div");modalContainer.classList.add("a-modal");modalContainer.setAttribute(constants.AFRAME_INJECTED,
"");var dialog=document.createElement("div");dialog.className="a-dialog";dialog.setAttribute(constants.AFRAME_INJECTED,"");modalContainer.appendChild(dialog);var dialogTextContainer=document.createElement("div");dialogTextContainer.classList.add("a-dialog-text-container");dialog.appendChild(dialogTextContainer);var dialogText=document.createElement("div");dialogText.classList.add("a-dialog-text");dialogText.innerHTML=text;dialogTextContainer.appendChild(dialogText);dialog.appendChild(buttonsContainerEl);
return modalContainer}exports=_dereq_("../../core/component").registerComponent;var utils=_dereq_("../../utils/"),bind=utils.bind,constants=_dereq_("../../constants/");module.exports.Component=exports("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},mobileDesktopMessage:{default:"Set your browser to request the mobile version of the site and reload the page to enjoy immersive mode."},
httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var self=this;this.data.enabled&&("localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"http:"===location.protocol&&this.showHTTPAlert(),utils.device.isMobileDeviceRequestingDesktopSite()?this.showMobileDesktopModeAlert():"undefined"!==typeof DeviceOrientationEvent&&
DeviceOrientationEvent.requestPermission?(this.onDeviceMotionDialogAllowClicked=bind(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=bind(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){self.devicePermissionDialogEl=createPermissionDialog(self.data.denyButtonText,self.data.allowButtonText,self.data.deviceMotionMessage,self.onDeviceMotionDialogAllowClicked,self.onDeviceMotionDialogDenyClicked);self.el.appendChild(self.devicePermissionDialogEl)}).then(function(){self.el.emit("deviceorientationpermissiongranted");
self.permissionGranted=!0})):this.permissionGranted=!0)},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showMobileDesktopModeAlert:function(){var self=this,safariIpadAlertEl=createAlertDialog(self.data.cancelButtonText,self.data.mobileDesktopMessage,function(){self.el.removeChild(safariIpadAlertEl)});this.el.appendChild(safariIpadAlertEl)},showHTTPAlert:function(){var self=this,httpAlertEl=
createAlertDialog(self.data.cancelButtonText,self.data.httpsMessage,function(){self.el.removeChild(httpAlertEl)});this.el.appendChild(httpAlertEl)},onDeviceMotionDialogAllowClicked:function(){var self=this;this.el.emit("deviceorientationpermissionrequested");DeviceOrientationEvent.requestPermission().then(function(response){"granted"===response?(self.el.emit("deviceorientationpermissiongranted"),self.permissionGranted=!0):self.el.emit("deviceorientationpermissionrejected");self.remove()}).catch(console.error)}})},
{"../../constants/":122,"../../core/component":130,"../../utils/":204}],102:[function(_dereq_,module,exports){_dereq_=_dereq_("../../core/component").registerComponent;module.exports.Component=_dereq_("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var sceneEl=this.el,enterVREl=sceneEl.querySelector(".a-enter-vr");!0===this.data?(enterVREl&&enterVREl.classList.add("embedded"),sceneEl.removeFullScreenStyles()):(enterVREl&&enterVREl.classList.remove("embedded"),sceneEl.addFullScreenStyles())}})},
{"../../core/component":130}],103:[function(_dereq_,module,exports){function getFog(data){var fog="exponential"===data.type?new THREE.FogExp2(data.color,data.density):new THREE.Fog(data.color,data.near,data.far);fog.name=data.type;return fog}exports=_dereq_("../../core/component").registerComponent;var THREE=_dereq_("../../lib/three"),warn=_dereq_("../../utils/debug")("components:fog:warn");module.exports.Component=exports("fog",{schema:{color:{type:"color",default:"#000"},density:{default:2.5E-4},
far:{default:1E3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var data=this.data,el=this.el,fog=this.el.object3D.fog;el.isScene?fog&&data.type===fog.name?Object.keys(this.schema).forEach(function(key){var value=data[key];"color"===key&&(value=new THREE.Color(value));fog[key]=value}):(el.object3D.fog=getFog(data),el.systems.material.updateMaterials()):warn("Fog component can only be applied to \x3ca-scene\x3e")},remove:function(){var fog=this.el.object3D.fog;
fog&&(fog.far=0,fog.near=.1)}})},{"../../core/component":130,"../../lib/three":178,"../../utils/debug":200}],104:[function(_dereq_,module,exports){(function(process){var AFRAME_INJECTED=_dereq_("../../constants").AFRAME_INJECTED,pkg=_dereq_("../../../package"),registerComponent=_dereq_("../../core/component").registerComponent,utils=_dereq_("../../utils/");pkg="https://unpkg.com/aframe-inspector@"+function(version){version=version.split(".");version[2]="x";return version.join(".")}(pkg.version)+"/dist/aframe-inspector.min.js";
module.exports.Component=registerComponent("inspector",{schema:{url:{default:"dev"===process.env.INSPECTOR_VERSION?"https://aframe.io/aframe-inspector/dist/aframe-inspector.js":pkg}},init:function(){this.firstPlay=!0;this.onKeydown=this.onKeydown.bind(this);this.onMessage=this.onMessage.bind(this);this.initOverlay();window.addEventListener("keydown",this.onKeydown);window.addEventListener("message",this.onMessage)},play:function(){if(this.firstPlay){var urlParam=utils.getUrlParameter("inspector");
"false"!==urlParam&&urlParam&&(this.openInspector(),this.firstPlay=!1)}},initOverlay:function(){this.loadingMessageEl=document.createElement("div");this.loadingMessageEl.classList.add("a-inspector-loader");this.loadingMessageEl.innerHTML='Loading Inspector\x3cspan class\x3d"dots"\x3e\x3cspan\x3e.\x3c/span\x3e\x3cspan\x3e.\x3c/span\x3e\x3cspan\x3e.\x3c/span\x3e\x3c/span\x3e'},remove:function(){this.removeEventListeners()},onKeydown:function(evt){73===evt.keyCode&&evt.ctrlKey&&evt.altKey&&this.openInspector()},
showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(evt){"INJECT_AFRAME_INSPECTOR"===evt.data&&this.openInspector()},openInspector:function(focusEl){var self=this;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected)AFRAME.INSPECTOR.open(focusEl);else{this.showLoader();var script=document.createElement("script");script.src=this.data.url;script.setAttribute("data-name","aframe-inspector");script.setAttribute(AFRAME_INJECTED,
"");script.onload=function(){AFRAME.INSPECTOR.open(focusEl);self.hideLoader();self.removeEventListeners()};script.onerror=function(){self.loadingMessageEl.innerHTML="Error loading Inspector"};document.head.appendChild(script);AFRAME.inspectorInjected=!0}},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown);window.removeEventListener("message",this.onMessage)}})}).call(this,_dereq_("_process"))},{"../../../package":72,"../../constants":122,"../../core/component":130,
"../../utils/":204,_process:49}],105:[function(_dereq_,module,exports){exports=_dereq_("../../core/component").registerComponent;var shouldCaptureKeyEvent=_dereq_("../../utils/").shouldCaptureKeyEvent;module.exports.Component=exports("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(oldData){this.enterVREnabled=this.data.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",
this.onKeyup)},onKeyup:function(evt){var scene=this.el;shouldCaptureKeyEvent(evt)&&(this.enterVREnabled&&70===evt.keyCode&&scene.enterVR(),this.enterVREnabled&&27===evt.keyCode&&scene.exitVR())}})},{"../../core/component":130,"../../utils/":204}],106:[function(_dereq_,module,exports){exports=_dereq_("../../utils/debug");_dereq_=_dereq_("../../core/component").registerComponent;var warn=exports("components:pool:warn");module.exports.Component=_dereq_("pool",{schema:{container:{default:""},mixin:{default:""},
size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var i;this.availableEls=[];this.usedEls=[];this.data.mixin||warn("No mixin provided for pool component.");this.data.container&&((this.container=document.querySelector(this.data.container))||warn("Container "+this.data.container+" not found."));this.container=this.container||this.el;for(i=0;i<this.data.size;++i)this.createEntity()},update:function(oldData){var data=this.data;oldData.mixin===data.mixin&&oldData.size===data.size||
this.initPool()},createEntity:function(){var el=document.createElement("a-entity");el.play=this.wrapPlay(el.play);el.setAttribute("mixin",this.data.mixin);el.object3D.visible=!1;el.pause();this.container.appendChild(el);this.availableEls.push(el)},wrapPlay:function(playMethod){var usedEls=this.usedEls;return function(){-1!==usedEls.indexOf(this)&&playMethod.call(this)}},requestEntity:function(){if(0===this.availableEls.length){if(!1===this.data.dynamic){warn("Requested entity from empty pool: "+this.attrName);
return}warn("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}var el=this.availableEls.shift();this.usedEls.push(el);el.object3D.visible=!0;return el},returnEntity:function(el){var index=this.usedEls.indexOf(el);if(-1===index)warn("The returned entity was not previously pooled from "+this.attrName);else return this.usedEls.splice(index,1),this.availableEls.push(el),el.object3D.visible=
!1,el.pause(),el}})},{"../../core/component":130,"../../utils/debug":200}],107:[function(_dereq_,module,exports){exports=_dereq_("../../core/component").registerComponent;var THREE=_dereq_("../../lib/three");module.exports.Component=exports("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){function setup(){var gl=el.renderer.getContext();gl&&(self.cubeMapSize=gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE),self.material=new THREE.RawShaderMaterial({uniforms:{map:{type:"t",
value:null}},vertexShader:"attribute vec3 position;\nattribute vec2 uv;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nvarying vec2 vUv;\nvoid main()  {\n  vUv \x3d vec2( 1.- uv.x, uv.y );\n  gl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform samplerCube map;\nvarying vec2 vUv;\n#define M_PI 3.141592653589793238462643383279\nvoid main() {\n  vec2 uv \x3d vUv;\n  float longitude \x3d uv.x * 2. * M_PI - M_PI + M_PI / 2.;\n  float latitude \x3d uv.y * M_PI;\n  vec3 dir \x3d vec3(\n    - sin( longitude ) * sin( latitude ),\n    cos( latitude ),\n    - cos( longitude ) * sin( latitude )\n  );\n  normalize( dir );\n  gl_FragColor \x3d vec4( textureCube( map, dir ).rgb, 1.0 );\n}",
side:THREE.DoubleSide}),self.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),self.material),self.quad.visible=!1,self.camera=new THREE.OrthographicCamera(-.5,.5,.5,-.5,-1E4,1E4),self.canvas=document.createElement("canvas"),self.ctx=self.canvas.getContext("2d"),el.object3D.add(self.quad),self.onKeyDown=self.onKeyDown.bind(self))}var el=this.el,self=this;el.renderer?setup():el.addEventListener("render-target-loaded",setup)},getRenderTarget:function(width,height){return new THREE.WebGLRenderTarget(width,
height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,wrapS:THREE.ClampToEdgeWrapping,wrapT:THREE.ClampToEdgeWrapping,format:THREE.RGBAFormat,type:THREE.UnsignedByteType})},resize:function(width,height){this.quad.scale.set(width,height,1);this.camera.left=-1*width/2;this.camera.right=width/2;this.camera.top=height/2;this.camera.bottom=-1*height/2;this.camera.updateProjectionMatrix();this.canvas.width=width;this.canvas.height=height},play:function(){window.addEventListener("keydown",this.onKeyDown)},
onKeyDown:function(evt){var shortcutPressed=83===evt.keyCode&&evt.ctrlKey&&evt.altKey;this.data&&shortcutPressed&&this.capture(evt.shiftKey?"equirectangular":"perspective")},setCapture:function(projection){var el=this.el;if("perspective"===projection){this.quad.visible=!1;var camera=this.data.camera&&this.data.camera.components.camera.camera||el.camera;el={width:this.data.width,height:this.data.height}}else{camera=this.camera;var cubeCamera=new THREE.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,
2048),{format:THREE.RGBFormat,generateMipmaps:!0,minFilter:THREE.LinearMipmapLinearFilter,encoding:THREE.sRGBEncoding});cubeCamera=new THREE.CubeCamera(el.camera.near,el.camera.far,cubeCamera);el.camera.getWorldPosition(cubeCamera.position);el.camera.getWorldQuaternion(cubeCamera.quaternion);cubeCamera.update(el.renderer,el.object3D);this.quad.material.uniforms.map.value=cubeCamera.renderTarget.texture;el={width:this.data.width,height:this.data.height};this.quad.visible=!0}return{camera:camera,size:el,
projection:projection}},capture:function(projection){var isVREnabled=this.el.renderer.xr.enabled,renderer=this.el.renderer;renderer.xr.enabled=!1;projection=this.setCapture(projection);this.renderCapture(projection.camera,projection.size,projection.projection);this.saveCapture();renderer.xr.enabled=isVREnabled},getCanvas:function(projection){var isVREnabled=this.el.renderer.xr.enabled,renderer=this.el.renderer;projection=this.setCapture(projection);renderer.xr.enabled=!1;this.renderCapture(projection.camera,
projection.size,projection.projection);renderer.xr.enabled=isVREnabled;return this.canvas},renderCapture:function(camera,size,projection){var autoClear=this.el.renderer.autoClear,el=this.el,renderer=el.renderer;var output=this.getRenderTarget(size.width,size.height);var pixels=new Uint8Array(4*size.width*size.height);this.resize(size.width,size.height);renderer.autoClear=!0;renderer.clear();renderer.setRenderTarget(output);renderer.render(el.object3D,camera);renderer.autoClear=autoClear;renderer.readRenderTargetPixels(output,
0,0,size.width,size.height,pixels);renderer.setRenderTarget(null);"perspective"===projection&&(pixels=this.flipPixelsVertically(pixels,size.width,size.height));camera=new ImageData(new Uint8ClampedArray(pixels),size.width,size.height);this.quad.visible=!1;this.ctx.putImageData(camera,0,0)},flipPixelsVertically:function(pixels,width,height){for(var flippedPixels=pixels.slice(0),x=0;x<width;++x)for(var y=0;y<height;++y)flippedPixels[4*x+y*width*4]=pixels[4*x+(height-y)*width*4],flippedPixels[4*x+1+
y*width*4]=pixels[4*x+1+(height-y)*width*4],flippedPixels[4*x+2+y*width*4]=pixels[4*x+2+(height-y)*width*4],flippedPixels[4*x+3+y*width*4]=pixels[4*x+3+(height-y)*width*4];return flippedPixels},saveCapture:function(){this.canvas.toBlob(function(blob){var fileName="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",linkEl=document.createElement("a");blob=URL.createObjectURL(blob);linkEl.href=blob;linkEl.setAttribute("download",fileName);linkEl.innerHTML="downloading...";linkEl.style.display=
"none";document.body.appendChild(linkEl);setTimeout(function(){linkEl.click();document.body.removeChild(linkEl)},1)},"image/png")}})},{"../../core/component":130,"../../lib/three":178}],108:[function(_dereq_,module,exports){exports=_dereq_("../../core/component").registerComponent;var RStats=_dereq_("../../../vendor/rStats"),utils=_dereq_("../../utils");_dereq_("../../../vendor/rStats.extras");_dereq_("../../lib/rStatsAframe");var AFrameStats=window.aframeStats,bind=utils.bind,ThreeStats=window.threeStats;
module.exports.Component=exports("stats",{schema:{default:!0},init:function(){var scene=this.el;if("false"!==utils.getUrlParameter("stats")){var threeStats=new ThreeStats(scene.renderer),aframeStats=new AFrameStats(scene);this.stats=new RStats({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:scene.isMobile?[]:[threeStats,aframeStats]});this.statsEl=document.querySelector(".rs-base");this.hideBound=bind(this.hide,this);this.showBound=bind(this.show,
this);scene.addEventListener("enter-vr",this.hideBound);scene.addEventListener("exit-vr",this.showBound)}},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound);this.el.removeEventListener("exit-vr",this.showBound);this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var stats=this.stats;stats&&(stats("rAF").tick(),stats("FPS").frame(),stats().update())},hide:function(){this.statsEl.classList.add("a-hidden")},
show:function(){this.statsEl.classList.remove("a-hidden")}})},{"../../../vendor/rStats":216,"../../../vendor/rStats.extras":215,"../../core/component":130,"../../lib/rStatsAframe":177,"../../utils":204}],109:[function(_dereq_,module,exports){function createEnterVRButton(onClick){var wrapper=document.createElement("div");wrapper.classList.add("a-enter-vr");wrapper.setAttribute(constants.AFRAME_INJECTED,"");var vrButton=document.createElement("button");vrButton.className="a-enter-vr-button";vrButton.setAttribute("title",
"Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information.");vrButton.setAttribute(constants.AFRAME_INJECTED,"");utils.device.isMobile()&&applyStickyHoverFix(vrButton);wrapper.appendChild(vrButton);vrButton.addEventListener("click",function(evt){onClick();evt.stopPropagation()});return wrapper}function createEnterARButton(onClick){var wrapper=document.createElement("div");wrapper.classList.add("a-enter-ar");wrapper.setAttribute(constants.AFRAME_INJECTED,
"");var arButton=document.createElement("button");arButton.className="a-enter-ar-button";arButton.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information.");arButton.setAttribute(constants.AFRAME_INJECTED,"");utils.device.isMobile()&&applyStickyHoverFix(arButton);wrapper.appendChild(arButton);arButton.addEventListener("click",function(evt){onClick();evt.stopPropagation()});return wrapper}function applyStickyHoverFix(buttonEl){buttonEl.addEventListener("touchstart",
function(){buttonEl.classList.remove("resethover")});buttonEl.addEventListener("touchend",function(){buttonEl.classList.add("resethover")})}exports=_dereq_("../../core/component").registerComponent;var constants=_dereq_("../../constants/"),utils=_dereq_("../../utils/"),bind=utils.bind;module.exports.Component=exports("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var self=this,sceneEl=this.el;"false"!==utils.getUrlParameter("ui")&&
(this.insideLoader=!1,this.orientationModalEl=this.enterAREl=this.enterVREl=null,this.bindMethods(),sceneEl.addEventListener("enter-vr",this.updateEnterInterfaces),sceneEl.addEventListener("exit-vr",this.updateEnterInterfaces),sceneEl.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(event){"loaderReady"===event.data.type&&(self.insideLoader=!0,self.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},
bindMethods:function(){this.onEnterVRButtonClick=bind(this.onEnterVRButtonClick,this);this.onEnterARButtonClick=bind(this.onEnterARButtonClick,this);this.onModalClick=bind(this.onModalClick,this);this.toggleOrientationModalIfNeeded=bind(this.toggleOrientationModalIfNeeded,this);this.updateEnterInterfaces=bind(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var data=
this.data,sceneEl=this.el;if(!data.enabled||this.insideLoader||"false"===utils.getUrlParameter("ui"))return this.remove();if(!(this.enterVREl||this.enterAREl||this.orientationModalEl)){data.enterVRButton?(this.enterVREl=document.querySelector(data.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=createEnterVRButton(this.onEnterVRButtonClick),sceneEl.appendChild(this.enterVREl));data.enterARButton?(this.enterAREl=document.querySelector(data.enterARButton),
this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=createEnterARButton(this.onEnterARButtonClick),sceneEl.appendChild(this.enterAREl));data=this.onModalClick;var modal=document.createElement("div");modal.className="a-orientation-modal";modal.classList.add("a-hidden");modal.setAttribute(constants.AFRAME_INJECTED,"");var exit=document.createElement("button");exit.setAttribute(constants.AFRAME_INJECTED,"");exit.innerHTML="Exit VR";exit.addEventListener("click",data);
modal.appendChild(exit);this.orientationModalEl=modal;sceneEl.appendChild(this.orientationModalEl);this.updateEnterInterfaces()}},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(uiElement){uiElement&&uiElement.parentNode&&uiElement.parentNode.removeChild(uiElement)})},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded();this.toggleEnterARButtonIfNeeded();this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){this.enterVREl&&
(this.el.is("vr-mode")?this.enterVREl.classList.add("a-hidden"):this.enterVREl.classList.remove("a-hidden"))},toggleEnterARButtonIfNeeded:function(){this.enterAREl&&(this.el.is("vr-mode")||!utils.device.checkARSupport()?this.enterAREl.classList.add("a-hidden"):this.enterAREl.classList.remove("a-hidden"))},toggleOrientationModalIfNeeded:function(){var sceneEl=this.el,orientationModalEl=this.orientationModalEl;orientationModalEl&&sceneEl.isMobile&&(!utils.device.isLandscape()&&sceneEl.is("vr-mode")?
orientationModalEl.classList.remove("a-hidden"):orientationModalEl.classList.add("a-hidden"))}})},{"../../constants/":122,"../../core/component":130,"../../utils/":204}],110:[function(_dereq_,module,exports){exports=_dereq_("../core/component");var THREE=_dereq_("../lib/three"),bind=_dereq_("../utils/bind");_dereq_=exports.registerComponent;module.exports.Component=_dereq_("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=bind(this.update,this);this.el.addEventListener("object3dset",
this.onMeshChanged);this.system.setShadowMapEnabled(!0)},update:function(){var data=this.data;this.updateDescendants(data.cast,data.receive)},remove:function(){this.el.removeEventListener("object3dset",this.onMeshChanged);this.updateDescendants(!1,!1)},updateDescendants:function(cast,receive){var sceneEl=this.el.sceneEl;this.el.object3D.traverse(function(node){if(node instanceof THREE.Mesh&&(node.castShadow=cast,node.receiveShadow=receive,sceneEl.hasLoaded&&node.material)){node=Array.isArray(node.material)?
node.material:[node.material];for(var i=0;i<node.length;i++)node[i].needsUpdate=!0}})}})},{"../core/component":130,"../lib/three":178,"../utils/bind":198}],111:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var debug=_dereq_("../utils/debug"),THREE=_dereq_("../lib/three"),warn=debug("components:sound:warn");module.exports.Component=exports("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},
maxDistance:{default:1E4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var self=this;this.listener=null;this.audioLoader=new THREE.AudioLoader;this.pool=new THREE.Group;this.mustPlay=this.loaded=!1;this.playSoundBound=function(){self.playSound()}},update:function(oldData){var data=this.data,i,srcChanged=data.src!==oldData.src;if(srcChanged){if(!data.src)return;this.setupSound()}for(i=
0;i<this.pool.children.length;i++){var sound=this.pool.children[i];data.positional&&(sound.setDistanceModel(data.distanceModel),sound.setMaxDistance(data.maxDistance),sound.setRefDistance(data.refDistance),sound.setRolloffFactor(data.rolloffFactor));sound.setLoop(data.loop);sound.setVolume(data.volume);sound.isPaused=!1}data.on!==oldData.on&&this.updateEventListener(oldData.on);if(srcChanged){var self=this;this.loaded=!1;this.audioLoader.load(data.src,function(buffer){for(i=0;i<self.pool.children.length;i++)sound=
self.pool.children[i],sound.setBuffer(buffer);self.loaded=!0;THREE.Cache.remove(data.src);(self.data.autoplay||self.mustPlay)&&self.playSound();self.el.emit("sound-loaded",self.evtDetail,!1)})}},pause:function(){this.stopSound();this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound();this.updateEventListener()},remove:function(){var i;this.removeEventListener();this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(i=0;i<this.pool.children.length;i++){var sound=
this.pool.children[i];sound.disconnect()}}catch(e$170){warn("Audio source not properly disconnected")}},updateEventListener:function(oldEvt){var el=this.el;oldEvt&&el.removeEventListener(oldEvt,this.playSoundBound);el.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var el=this.el;var i=el.sceneEl;var self=this;0<this.pool.children.length&&(this.stopSound(),el.removeObject3D("sound"));
var listener=this.listener=i.audioListener||new THREE.AudioListener;i.audioListener=listener;i.camera&&i.camera.add(listener);i.addEventListener("camera-set-active",function(evt){evt.detail.cameraEl.getObject3D("camera").add(listener)});this.pool=new THREE.Group;for(i=0;i<this.data.poolSize;i++){var sound=this.data.positional?new THREE.PositionalAudio(listener):new THREE.Audio(listener);this.pool.add(sound)}el.setObject3D(this.attrName,this.pool);for(i=0;i<this.pool.children.length;i++)sound=this.pool.children[i],
sound.onEnded=function(){this.isPlaying=!1;self.el.emit("sound-ended",self.evtDetail,!1)}},pauseSound:function(){var i;this.isPlaying=!1;for(i=0;i<this.pool.children.length;i++){var sound=this.pool.children[i];sound.source&&sound.source.buffer&&sound.isPlaying&&!sound.isPaused&&(sound.isPaused=!0,sound.pause())}},playSound:function(processSound){var i;if(this.loaded){var found=!1;this.isPlaying=!0;for(i=0;i<this.pool.children.length;i++){var sound=this.pool.children[i];sound.isPlaying||!sound.buffer||
found||(processSound&&processSound(sound),sound.play(),sound.isPaused=!1,found=!0)}found?this.mustPlay=!1:warn("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el)}else warn("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0},stopSound:function(){var i;this.isPlaying=!1;for(i=0;i<this.pool.children.length;i++){var sound=this.pool.children[i];if(!sound.source||!sound.source.buffer)break;
sound.stop()}}})},{"../core/component":130,"../lib/three":178,"../utils/debug":200}],112:[function(_dereq_,module,exports){function loadFont(src,yOffset){return new Promise(function(resolve,reject){loadBMFont(src,function(err,font){err?(error("Error loading font",src),reject(err)):(0<=src.indexOf("/Roboto-msdf.json")&&(yOffset=30),yOffset&&font.chars.map(function(ch){ch.yoffset+=yOffset}),resolve(font))})})}function loadTexture(src){return new Promise(function(resolve,reject){(new THREE.ImageLoader).load(src,
function(image){resolve(image)},void 0,function(){error("Error loading font image",src);reject(null)})})}function computeFontWidthFactor(font){var sum=0,digitsum=0,digits=0;font.chars.map(function(ch){sum+=ch.xadvance;48<=ch.id&&57>=ch.id&&(digits++,digitsum+=ch.xadvance)});return digits?digitsum/digits:sum/font.chars.length}var createTextGeometry=_dereq_("three-bmfont-text"),loadBMFont=_dereq_("load-bmfont");exports=_dereq_("../core/component").registerComponent;var coreShader=_dereq_("../core/shader"),
THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/"),error=utils.debug("components:text:error"),shaders=coreShader.shaders,warn=utils.debug("components:text:warn"),FONTS={aileronsemibold:"https://cdn.aframe.io/fonts/Aileron-Semibold.fnt",dejavu:"https://cdn.aframe.io/fonts/DejaVu-sdf.fnt",exo2bold:"https://cdn.aframe.io/fonts/Exo2Bold.fnt",exo2semibold:"https://cdn.aframe.io/fonts/Exo2SemiBold.fnt",kelsonsans:"https://cdn.aframe.io/fonts/KelsonSans.fnt",monoid:"https://cdn.aframe.io/fonts/Monoid.fnt",
mozillavr:"https://cdn.aframe.io/fonts/mozillavr.fnt",roboto:"https://cdn.aframe.io/fonts/Roboto-msdf.json",sourcecodepro:"https://cdn.aframe.io/fonts/SourceCodePro.fnt"},MSDF_FONTS=["roboto"];module.exports.FONTS=FONTS;var cache$jscomp$0=new function(){var cache=this.cache={};this.get=function(key,promiseGenerator){if(key in cache)return cache[key];cache[key]=promiseGenerator();return cache[key]}},fontWidthFactors={},textures={},protocolRe=/^\w+:/;module.exports.Component=exports("text",{multiple:!0,
schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:"roboto"},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",
oneOf:shaders},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={};this.geometry=createTextGeometry();this.createOrUpdateMaterial();this.mesh=
new THREE.Mesh(this.geometry,this.material);this.el.setObject3D(this.attrName,this.mesh)},update:function(oldData){var data=this.data,font=this.currentFont;textures[data.font]?this.texture=textures[data.font]:(this.texture=textures[data.font]=new THREE.Texture,this.texture.anisotropy=16);this.createOrUpdateMaterial();oldData.font!==data.font?this.updateFont():font&&(this.updateGeometry(this.geometry,font),this.updateLayout())},remove:function(){this.geometry.dispose();this.geometry=null;this.el.removeObject3D(this.attrName);
this.material.dispose();this.material=null;this.texture.dispose();this.texture=null;this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var data=this.data,material=this.material,shaderData=this.shaderData;var shaderName=data.shader;-1!==MSDF_FONTS.indexOf(data.font)||0<=data.font.indexOf("-msdf.")?shaderName="msdf":data.font in FONTS&&-1===MSDF_FONTS.indexOf(data.font)&&(shaderName="sdf");var hasChangedShader=(this.shaderObject&&this.shaderObject.name)!==shaderName;shaderData.alphaTest=
data.alphaTest;shaderData.color=data.color;shaderData.map=this.texture;shaderData.opacity=data.opacity;a:switch(data.side){case "back":var JSCompiler_inline_result=THREE.FrontSide;break a;case "double":JSCompiler_inline_result=THREE.DoubleSide;break a;default:JSCompiler_inline_result=THREE.BackSide}shaderData.side=JSCompiler_inline_result;shaderData.transparent=data.transparent;shaderData.negate=data.negate;hasChangedShader?(data=this.el,shaderName=new shaders[shaderName].Shader,shaderName.el=data,
shaderName.init(shaderData),shaderName.update(shaderData),data=shaderName.material,data.transparent=shaderData.transparent,this.material=data,this.shaderObject=shaderName,this.material.side=shaderData.side,this.mesh&&(this.mesh.material=this.material)):(this.shaderObject.update(shaderData),material.transparent=shaderData.transparent,material.side=shaderData.side)},updateFont:function(){var data=this.data,el=this.el,geometry=this.geometry,self=this;data.font||warn("No font specified. Using the default font.");
this.mesh.visible=!1;var fontSrc=this.lookupFont(data.font||"roboto")||data.font;cache$jscomp$0.get(fontSrc,function(){return loadFont(fontSrc,data.yOffset)}).then(function(font){if(1!==font.pages.length)throw Error("Currently only single-page bitmap fonts are supported.");fontWidthFactors[fontSrc]||(font.widthFactor=fontWidthFactors[font]=computeFontWidthFactor(font));self.updateGeometry(geometry,font);self.currentFont=font;self.updateLayout();var fontImgSrc=self.getFontImageSrc();cache$jscomp$0.get(fontImgSrc,
function(){return loadTexture(fontImgSrc)}).then(function(image){var texture=self.texture;texture.image=image;texture.needsUpdate=!0;textures[data.font]=texture;self.texture=texture;self.mesh.visible=!0;el.emit("textfontset",{font:data.font,fontObj:font})}).catch(function(err){error(err.message);error(err.stack)})}).catch(function(err){error(err.message);error(err.stack)})},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var fontSrc=this.lookupFont(this.data.font||"roboto")||
this.data.font,imageSrc=this.currentFont.pages[0];return imageSrc.match(protocolRe)&&0!==imageSrc.indexOf("http")?fontSrc.replace(/(\.fnt)|(\.json)/,".png"):THREE.LoaderUtils.extractUrlBase(fontSrc)+imageSrc},updateLayout:function(){var anchor=this.el;var data=this.data,geometry=this.geometry,mesh=this.mesh;if(geometry.layout){var baseline=anchor.getAttribute("geometry");var width=data.width||baseline&&baseline.width||1;var textScale=width/(data.wrapPixels||(.5+data.wrapCount)*this.currentFont.widthFactor);
geometry=geometry.layout;var height=textScale*(geometry.height+geometry.descender);baseline&&"plane"===baseline.primitive&&(baseline.width||anchor.setAttribute("geometry","width",width),baseline.height||anchor.setAttribute("geometry","height",height));anchor="align"===data.anchor?data.align:data.anchor;if("left"===anchor)anchor=0;else if("right"===anchor)anchor=-1*geometry.width;else if("center"===anchor)anchor=-1*geometry.width/2;else throw new TypeError("Invalid text.anchor property value",anchor);
baseline=data.baseline;if("bottom"===baseline)geometry=0;else if("top"===baseline)geometry=-1*geometry.height+geometry.ascender;else if("center"===baseline)geometry=-1*geometry.height/2;else throw new TypeError("Invalid text.baseline property value",baseline);mesh.position.x=anchor*textScale+data.xOffset;mesh.position.y=geometry*textScale;mesh.position.z=data.zOffset;mesh.scale.set(textScale,-1*textScale,textScale)}},lookupFont:function(key){return FONTS[key]},updateGeometry:function(){var geometryUpdateBase=
{},geometryUpdateData={},newLineRegex=/\\n/g,tabRegex=/\\t/g;return function(geometry,font){var data=this.data;geometryUpdateData.font=font;geometryUpdateData.lineHeight=data.lineHeight&&isFinite(data.lineHeight)?data.lineHeight:font.common.lineHeight;geometryUpdateData.text=data.value.toString().replace(newLineRegex,"\n").replace(tabRegex,"\t");geometryUpdateData.width=data.wrapPixels||(.5+data.wrapCount)*font.widthFactor;geometry.update(utils.extend(geometryUpdateBase,data,geometryUpdateData))}}()})},
{"../core/component":130,"../core/shader":140,"../lib/three":178,"../utils/":204,"load-bmfont":37,"three-bmfont-text":62}],113:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var controllerUtils=_dereq_("../utils/tracked-controls"),DEFAULT_CAMERA_HEIGHT=_dereq_("../constants").DEFAULT_CAMERA_HEIGHT,THREE=_dereq_("../lib/three"),DEFAULT_HANDEDNESS=_dereq_("../constants").DEFAULT_HANDEDNESS,EMPTY_DAYDREAM_TOUCHES={touches:[]};module.exports.Component=exports("tracked-controls-webvr",
{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0];this.buttonStates=this.el.components["tracked-controls"].buttonStates={};this.changedAxes=[];this.targetControllerNumber=this.data.controller;this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes};
this.deltaControllerPosition=new THREE.Vector3;this.controllerQuaternion=new THREE.Quaternion;this.controllerEuler=new THREE.Euler;this.updateGamepad();this.buttonEventDetails={}},tick:function(time,delta){(time=this.el.getObject3D("mesh"))&&time.update&&time.update(delta/1E3);this.updateGamepad();this.updatePose();this.updateButtons()},defaultUserHeight:function(){return DEFAULT_CAMERA_HEIGHT},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var data=
this.data;this.controller=data=controllerUtils.findMatchingControllerWebVR(this.system.controllers,data.id,data.idPrefix,data.hand,data.controller);this.el.components["tracked-controls"].controller=data;this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(controllerPosition){var controller=this.controller,controllerEuler=this.controllerEuler,controllerQuaternion=this.controllerQuaternion,deltaControllerPosition=this.deltaControllerPosition;var headObject3D=this.getHeadElement().object3D;
var userHeight=this.defaultUserHeight();var pose=controller.pose;controller=(controller?controller.hand:void 0)||DEFAULT_HANDEDNESS;controllerPosition.copy(headObject3D.position);deltaControllerPosition.set(.175*("left"===controller?-1:"right"===controller?1:0),-.3,-.03);deltaControllerPosition.multiplyScalar(userHeight);deltaControllerPosition.applyAxisAngle(headObject3D.up,headObject3D.rotation.y);controllerPosition.add(deltaControllerPosition);deltaControllerPosition.set(0,0,-.175);deltaControllerPosition.multiplyScalar(userHeight);
pose.orientation?controllerQuaternion.fromArray(pose.orientation):controllerQuaternion.copy(headObject3D.quaternion);controllerEuler.setFromQuaternion(controllerQuaternion);controllerEuler.set(controllerEuler.x,controllerEuler.y,0);deltaControllerPosition.applyEuler(controllerEuler);controllerPosition.add(deltaControllerPosition)},updatePose:function(){var controller=this.controller,data=this.data,object3D=this.el.object3D,vrDisplay=this.system.vrDisplay;controller&&(controller=controller.pose,controller.position?
object3D.position.fromArray(controller.position):data.armModel&&this.applyArmModel(object3D.position),controller.orientation&&object3D.quaternion.fromArray(controller.orientation),vrDisplay&&controller.position&&(data=this.el.sceneEl.renderer.xr.getStandingMatrix(),object3D.matrix.compose(object3D.position,object3D.quaternion,object3D.scale),object3D.matrix.multiplyMatrices(data,object3D.matrix),object3D.matrix.decompose(object3D.position,object3D.quaternion,object3D.scale)),object3D.rotateX(this.data.orientationOffset.x*
THREE.Math.DEG2RAD),object3D.rotateY(this.data.orientationOffset.y*THREE.Math.DEG2RAD),object3D.rotateZ(this.data.orientationOffset.z*THREE.Math.DEG2RAD))},updateButtons:function(){var controller=this.controller,id;if(controller){for(id=0;id<controller.buttons.length;++id){this.buttonStates[id]||(this.buttonStates[id]={pressed:!1,touched:!1,value:0});this.buttonEventDetails[id]||(this.buttonEventDetails[id]={id:id,state:this.buttonStates[id]});var buttonState=controller.buttons[id];this.handleButton(id,
buttonState)}this.handleAxes()}},handleButton:function(id,buttonState){if(!(this.handlePress(id,buttonState)|this.handleTouch(id,buttonState)|this.handleValue(id,buttonState)))return!1;this.el.emit("buttonchanged",this.buttonEventDetails[id],!1);return!0},handleAxes:function(){var changed=!1,controllerAxes=this.controller.axes,i,previousAxis=this.axis,changedAxes=this.changedAxes;this.changedAxes.splice(0,this.changedAxes.length);for(i=0;i<controllerAxes.length;++i)changedAxes.push(previousAxis[i]!==
controllerAxes[i]),changedAxes[i]&&(changed=!0);if(!changed)return!1;this.axis.splice(0,this.axis.length);for(i=0;i<controllerAxes.length;i++)this.axis.push(controllerAxes[i]);this.el.emit("axismove",this.axisMoveEventDetail,!1);return!0},handlePress:function(id,buttonState){var previousButtonState=this.buttonStates[id];if(buttonState.pressed===previousButtonState.pressed)return!1;this.el.emit(buttonState.pressed?"buttondown":"buttonup",this.buttonEventDetails[id],!1);previousButtonState.pressed=
buttonState.pressed;return!0},handleTouch:function(id,buttonState){var previousButtonState=this.buttonStates[id];if(buttonState.touched===previousButtonState.touched)return!1;this.el.emit(buttonState.touched?"touchstart":"touchend",this.buttonEventDetails[id],!1,EMPTY_DAYDREAM_TOUCHES);previousButtonState.touched=buttonState.touched;return!0},handleValue:function(id,buttonState){id=this.buttonStates[id];if(buttonState.value===id.value)return!1;id.value=buttonState.value;return!0}})},{"../constants":122,
"../core/component":130,"../lib/three":178,"../utils/tracked-controls":213}],114:[function(_dereq_,module,exports){var controllerUtils=_dereq_("../utils/tracked-controls");_dereq_=_dereq_("../core/component").registerComponent;module.exports.Component=_dereq_("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this);
this.buttonEventDetails={};this.buttonStates=this.el.components["tracked-controls"].buttonStates={};this.axis=this.el.components["tracked-controls"].axis=[0,0,0];this.changedAxes=[];this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var sceneEl=this.el.sceneEl;this.updateController();sceneEl.addEventListener("controllersupdated",this.updateController)},pause:function(){this.el.sceneEl.removeEventListener("controllersupdated",
this.updateController)},isControllerPresent:function(evt){return!this.controller||this.controller.gamepad||"none"!==evt.inputSource.handedness&&evt.inputSource.handedness!==this.data.hand?!1:!0},updateController:function(){this.controller=controllerUtils.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled);this.el.components["tracked-controls"].controller=this.controller;this.data.autoHide&&
(this.el.object3D.visible=!!this.controller)},tick:function(){var sceneEl=this.el.sceneEl,controller=this.controller,frame=sceneEl.frame;controller&&sceneEl.frame&&this.system.referenceSpace&&!controller.hand&&(this.pose=frame.getPose(controller.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var object3D=this.el.object3D,pose=this.pose;pose&&(object3D.matrix.elements=pose.transform.matrix,object3D.matrix.decompose(object3D.position,object3D.rotation,
object3D.scale))},updateButtons:function(){var id;var buttonState=this.controller;if(buttonState&&buttonState.gamepad){var gamepad=buttonState.gamepad;for(id=0;id<gamepad.buttons.length;++id)this.buttonStates[id]||(this.buttonStates[id]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[id]||(this.buttonEventDetails[id]={id:id,state:this.buttonStates[id]}),buttonState=gamepad.buttons[id],this.handleButton(id,buttonState);this.handleAxes()}},handleButton:function(id,buttonState){if(!(this.handlePress(id,
buttonState)|this.handleTouch(id,buttonState)|this.handleValue(id,buttonState)))return!1;this.el.emit("buttonchanged",this.buttonEventDetails[id],!1);return!0},handleAxes:function(){var changed=!1,controllerAxes=this.controller.gamepad.axes,i,previousAxis=this.axis,changedAxes=this.changedAxes;this.changedAxes.splice(0,this.changedAxes.length);for(i=0;i<controllerAxes.length;++i)changedAxes.push(previousAxis[i]!==controllerAxes[i]),changedAxes[i]&&(changed=!0);if(!changed)return!1;this.axis.splice(0,
this.axis.length);for(i=0;i<controllerAxes.length;i++)this.axis.push(controllerAxes[i]);this.el.emit("axismove",this.axisMoveEventDetail,!1);return!0},handlePress:function(id,buttonState){var previousButtonState=this.buttonStates[id];if(buttonState.pressed===previousButtonState.pressed)return!1;this.el.emit(buttonState.pressed?"buttondown":"buttonup",this.buttonEventDetails[id],!1);previousButtonState.pressed=buttonState.pressed;return!0},handleTouch:function(id,buttonState){var previousButtonState=
this.buttonStates[id];if(buttonState.touched===previousButtonState.touched)return!1;this.el.emit(buttonState.touched?"touchstart":"touchend",this.buttonEventDetails[id],!1);previousButtonState.touched=buttonState.touched;return!0},handleValue:function(id,buttonState){id=this.buttonStates[id];if(buttonState.value===id.value)return!1;id.value=buttonState.value;return!0}})},{"../core/component":130,"../utils/tracked-controls":213}],115:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/component").registerComponent;
module.exports.Component=_dereq_("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var data=this.data,el=this.el;el.sceneEl.hasWebXR?el.setAttribute("tracked-controls-webxr",{id:data.id,hand:data.hand,index:data.controller,
iterateControllerProfiles:data.iterateControllerProfiles,handTrackingEnabled:data.handTrackingEnabled}):el.setAttribute("tracked-controls-webvr",data)}})},{"../core/component":130}],116:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),THREE=_dereq_("../lib/three"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,
onButtonEvent=trackedControlsUtils.onButtonEvent,INDEX_CONTROLLER_MODEL_URL={left:"https://cdn.aframe.io/controllers/valve/index/valve-index-left.glb",right:"https://cdn.aframe.io/controllers/valve/index/valve-index-right.glb"};_dereq_=_dereq_("../utils/").device.isWebXRAvailable;trackedControlsUtils={left:{x:-2.3692678902063457E-4,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}};var INDEX_CONTROLLER_POSITION_OFFSET_WEBXR={left:{x:0,
y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},INDEX_CONTROLLER_ROTATION_OFFSET_WEBVR={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},INDEX_CONTROLLER_ROTATION_OFFSET_WEBXR={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},INDEX_CONTROLLER_ROTATION_OFFSET=_dereq_?INDEX_CONTROLLER_ROTATION_OFFSET_WEBXR:INDEX_CONTROLLER_ROTATION_OFFSET_WEBVR,
INDEX_CONTROLLER_POSITION_OFFSET=_dereq_?INDEX_CONTROLLER_POSITION_OFFSET_WEBXR:trackedControlsUtils;module.exports.Component=exports("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var self=this;this.controllerPresent=
!1;this.lastControllerCheck=0;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.previousButtonValues={};this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},play:function(){this.checkIfControllerPresent();
this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},addEventListeners:function(){var el=this.el;
el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("model-loaded",this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);
el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("model-loaded",this.onModelLoaded);el.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){var data=this.data;checkControllerPresentAndSetup(this,"valve",{index:"right"===data.hand?0:"left"===
data.hand?1:2,iterateControllerProfiles:!0,hand:data.hand})},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{idPrefix:"valve",controller:"right"===data.hand?1:"left"===data.hand?0:2,hand:data.hand,orientationOffset:data.orientationOffset});this.loadModel()},loadModel:function(){var data=this.data;data.model&&this.el.setAttribute("gltf-model",""+INDEX_CONTROLLER_MODEL_URL[data.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",
this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id],buttonMeshes=this.buttonMeshes;if(button){if("trigger"===button){var analogValue=evt.detail.state.value;buttonMeshes&&buttonMeshes.trigger&&(buttonMeshes.trigger.rotation.x=this.triggerOriginalRotationX-
Math.PI/40*analogValue)}this.el.emit(button+"changed",evt.detail.state)}},onModelLoaded:function(evt){var controllerObject3D=evt.detail.model,self=this;this.data.model&&(evt=this.buttonMeshes={},evt.grip={left:controllerObject3D.getObjectByName("leftgrip"),right:controllerObject3D.getObjectByName("rightgrip")},evt.menu=controllerObject3D.getObjectByName("menubutton"),evt.system=controllerObject3D.getObjectByName("systembutton"),evt.trackpad=controllerObject3D.getObjectByName("touchpad"),evt.trigger=
controllerObject3D.getObjectByName("trigger"),this.triggerOriginalRotationX=evt.trigger.rotation.x,Object.keys(evt).forEach(function(buttonName){self.setButtonColor(buttonName,self.data.buttonColor)}),controllerObject3D.position.copy(INDEX_CONTROLLER_POSITION_OFFSET[this.data.hand]),controllerObject3D.rotation.copy(INDEX_CONTROLLER_ROTATION_OFFSET[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new THREE.Vector3(0,0,0)}))},onAxisMoved:function(evt){emitIfAxesChanged(this,
this.mapping.axes,evt)},updateModel:function(buttonName,evtName){this.data.model&&-1===evtName.indexOf("touch")&&this.setButtonColor(buttonName,"up"===evtName?this.data.buttonColor:this.data.buttonHighlightColor)},setButtonColor:function(buttonName,color){}})},{"../core/component":130,"../lib/three":178,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],117:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/component").registerComponent;module.exports.Component=_dereq_("visible",
{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":130}],118:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,onButtonEvent=trackedControlsUtils.onButtonEvent,GAMEPAD_ID_PREFIX=(_dereq_=
_dereq_("../utils/").device.isWebXRAvailable)?"htc-vive-controller-mv":"OpenVR ";trackedControlsUtils={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]};var INPUT_MAPPING_WEBXR={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]};module.exports.Component=exports("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},
mapping:_dereq_?INPUT_MAPPING_WEBXR:trackedControlsUtils,init:function(){var self=this;this.controllerPresent=!1;this.lastControllerCheck=0;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};
this.previousButtonValues={};this.rendererSystem=this.el.sceneEl.systems.renderer;this.bindMethods()},update:function(){var data=this.data;this.controllerIndex="right"===data.hand?0:"left"===data.hand?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,
this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("touchstart",this.onButtonTouchStart);
el.addEventListener("model-loaded",this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("model-loaded",
this.onModelLoaded);el.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,{index:this.controllerIndex,hand:this.data.hand})},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{idPrefix:GAMEPAD_ID_PREFIX,hand:data.hand,controller:this.controllerIndex,orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("obj-model",
{obj:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",mtl:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(evt){var button=this.mapping.buttons[evt.detail.id],
buttonMeshes=this.buttonMeshes;if(button){if("trigger"===button){var analogValue=evt.detail.state.value;buttonMeshes&&buttonMeshes.trigger&&(buttonMeshes.trigger.rotation.x=Math.PI/12*-analogValue)}this.el.emit(button+"changed",evt.detail.state)}},onModelLoaded:function(evt){var controllerObject3D=evt.detail.model,self=this;this.data.model&&(evt=this.buttonMeshes={},evt.grip={left:controllerObject3D.getObjectByName("leftgrip"),right:controllerObject3D.getObjectByName("rightgrip")},evt.menu=controllerObject3D.getObjectByName("menubutton"),
evt.system=controllerObject3D.getObjectByName("systembutton"),evt.trackpad=controllerObject3D.getObjectByName("touchpad"),evt.trigger=controllerObject3D.getObjectByName("trigger"),Object.keys(evt).forEach(function(buttonName){self.setButtonColor(buttonName,self.data.buttonColor)}),controllerObject3D.position.set(0,-.015,.04))},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},updateModel:function(buttonName,evtName){this.data.model&&-1===evtName.indexOf("touch")&&this.setButtonColor(buttonName,
"up"===evtName?this.data.buttonColor:this.data.buttonHighlightColor)},setButtonColor:function(buttonName,color){var buttonMeshes=this.buttonMeshes,rendererSystem=this.rendererSystem;buttonMeshes&&("grip"===buttonName?(buttonMeshes.grip.left.material.color.set(color),buttonMeshes.grip.right.material.color.set(color),rendererSystem.applyColorCorrection(buttonMeshes.grip.left.material.color),rendererSystem.applyColorCorrection(buttonMeshes.grip.right.material.color)):(buttonMeshes[buttonName].material.color.set(color),
rendererSystem.applyColorCorrection(buttonMeshes[buttonName].material.color)))}})},{"../core/component":130,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],119:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind");_dereq_=_dereq_("../utils/tracked-controls");var checkControllerPresentAndSetup=_dereq_.checkControllerPresentAndSetup,emitIfAxesChanged=_dereq_.emitIfAxesChanged,onButtonEvent=_dereq_.onButtonEvent;
module.exports.Component=exports("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,
this);this.removeControllersUpdateListener=bind(this.removeControllersUpdateListener,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,
"touchend",self)};this.controllerPresent=!1;this.lastControllerCheck=0;this.bindMethods()},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("model-loaded",this.onModelLoaded);el.addEventListener("axismove",this.onAxisMoved);
this.controllerEventsActive=!0;this.addControllersUpdateListener()},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("model-loaded",this.onModelLoaded);el.removeEventListener("axismove",this.onAxisMoved);
this.controllerEventsActive=!1;this.removeControllersUpdateListener()},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,"HTC Vive Focus",this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{armModel:data.armModel,idPrefix:"HTC Vive Focus",
orientationOffset:data.orientationOffset});this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(evt){evt=
evt.detail.model;if(this.data.model){var buttonMeshes=this.buttonMeshes={};buttonMeshes.trigger=evt.getObjectByName("BumperKey");buttonMeshes.triggerPressed=evt.getObjectByName("BumperKey_Press");buttonMeshes.triggerPressed&&(buttonMeshes.triggerPressed.visible=!1);buttonMeshes.trackpad=evt.getObjectByName("TouchPad");buttonMeshes.trackpadPressed=evt.getObjectByName("TouchPad_Press");buttonMeshes.trackpadPressed&&(buttonMeshes.trackpadPressed.visible=!1)}},onButtonChanged:function(evt){var button=
this.mapping.buttons[evt.detail.id];button&&this.el.emit(button+"changed",evt.detail.state)},onAxisMoved:function(evt){emitIfAxesChanged(this,this.mapping.axes,evt)},updateModel:function(buttonName,evtName){this.data.model&&this.updateButtonModel(buttonName,evtName)},updateButtonModel:function(buttonName,state){var buttonMeshes=this.buttonMeshes,pressedName=buttonName+"Pressed";if(buttonMeshes&&buttonMeshes[buttonName]&&buttonMeshes[pressedName]){switch(state){case "down":var color=this.data.buttonHighlightColor;
break;case "touchstart":color=this.data.buttonTouchedColor}color&&buttonMeshes[pressedName].material.color.set(color);buttonMeshes[pressedName].visible=!!color;buttonMeshes[buttonName].visible=!color}}})},{"../core/component":130,"../utils/bind":198,"../utils/tracked-controls":213}],120:[function(_dereq_,module,exports){var KEYCODE_TO_CODE=_dereq_("../constants").keyboardevent.KEYCODE_TO_CODE;exports=_dereq_("../core/component").registerComponent;var THREE=_dereq_("../lib/three");_dereq_=_dereq_("../utils/");
var bind=_dereq_.bind,shouldCaptureKeyEvent=_dereq_.shouldCaptureKeyEvent,KEYS="KeyW KeyA KeyS KeyD ArrowUp ArrowLeft ArrowRight ArrowDown".split(" ");module.exports.Component=exports("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={};this.easing=1.1;this.velocity=
new THREE.Vector3;this.onBlur=bind(this.onBlur,this);this.onFocus=bind(this.onFocus,this);this.onKeyDown=bind(this.onKeyDown,this);this.onKeyUp=bind(this.onKeyUp,this);this.onVisibilityChange=bind(this.onVisibilityChange,this);this.attachVisibilityEventListeners()},tick:function(time,delta){time=this.data;var el=this.el,velocity=this.velocity,JSCompiler_temp;if(JSCompiler_temp=!velocity[time.adAxis]&&!velocity[time.wsAxis])a:{for(var key in this.keys){JSCompiler_temp=!1;break a}JSCompiler_temp=!0}JSCompiler_temp||
(delta/=1E3,this.updateVelocity(delta),(velocity[time.adAxis]||velocity[time.wsAxis])&&el.object3D.position.add(this.getMovementVector(delta)))},remove:function(){this.removeKeyEventListeners();this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={};this.removeKeyEventListeners()},updateVelocity:function(delta){var data=this.data,keys=this.keys,velocity=this.velocity;var adAxis=data.adAxis;var wsAxis=data.wsAxis;if(.2<delta)velocity[adAxis]=
0,velocity[wsAxis]=0;else{var acceleration=Math.pow(1/this.easing,60*delta);0!==velocity[adAxis]&&(velocity[adAxis]*=acceleration);0!==velocity[wsAxis]&&(velocity[wsAxis]*=acceleration);1E-5>Math.abs(velocity[adAxis])&&(velocity[adAxis]=0);1E-5>Math.abs(velocity[wsAxis])&&(velocity[wsAxis]=0);if(data.enabled){acceleration=data.acceleration;if(data.adEnabled){var adSign=data.adInverted?-1:1;if(keys.KeyA||keys.ArrowLeft)velocity[adAxis]-=adSign*acceleration*delta;if(keys.KeyD||keys.ArrowRight)velocity[adAxis]+=
adSign*acceleration*delta}if(data.wsEnabled){adAxis=data.wsInverted?-1:1;if(keys.KeyW||keys.ArrowUp)velocity[wsAxis]-=adAxis*acceleration*delta;if(keys.KeyS||keys.ArrowDown)velocity[wsAxis]+=adAxis*acceleration*delta}}}},getMovementVector:function(){var directionVector=new THREE.Vector3(0,0,0),rotationEuler=new THREE.Euler(0,0,0,"YXZ");return function(delta){var rotation=this.el.getAttribute("rotation");directionVector.copy(this.velocity);directionVector.multiplyScalar(delta);if(!rotation)return directionVector;
rotationEuler.set(THREE.Math.degToRad(this.data.fly?rotation.x:0),THREE.Math.degToRad(rotation.y),0);directionVector.applyEuler(rotationEuler);return directionVector}}(),attachVisibilityEventListeners:function(){window.addEventListener("blur",this.onBlur);window.addEventListener("focus",this.onFocus);document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur);window.removeEventListener("focus",this.onFocus);
document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown);window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown);window.removeEventListener("keyup",this.onKeyUp)},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){if(document.hidden)this.onBlur();else this.onFocus()},onKeyDown:function(event){shouldCaptureKeyEvent(event)&&
(event=event.code||KEYCODE_TO_CODE[event.keyCode],-1!==KEYS.indexOf(event)&&(this.keys[event]=!0))},onKeyUp:function(event){delete this.keys[event.code||KEYCODE_TO_CODE[event.keyCode]]}})},{"../constants":122,"../core/component":130,"../lib/three":178,"../utils/":204}],121:[function(_dereq_,module,exports){exports=_dereq_("../core/component").registerComponent;var bind=_dereq_("../utils/bind"),trackedControlsUtils=_dereq_("../utils/tracked-controls"),checkControllerPresentAndSetup=trackedControlsUtils.checkControllerPresentAndSetup,
emitIfAxesChanged=trackedControlsUtils.emitIfAxesChanged,onButtonEvent=trackedControlsUtils.onButtonEvent;trackedControlsUtils=_dereq_("../utils/");var debug=trackedControlsUtils.debug("components:windows-motion-controls:debug"),warn=trackedControlsUtils.debug("components:windows-motion-controls:warn");trackedControlsUtils=_dereq_("../constants").DEFAULT_HANDEDNESS;var MODEL_FILENAMES={left:"left.glb",right:"right.glb",default:"universal.glb"};_dereq_=_dereq_("../utils/").device.isWebXRAvailable;
var GAMEPAD_ID_PATTERN=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,GAMEPAD_ID_PREFIX=_dereq_?"windows-mixed-reality":"Spatial Controller (Spatial Interaction Source) ",INPUT_MAPPING_WEBVR={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},
INPUT_MAPPING_WEBXR={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"};module.exports.Component=exports("windows-motion-controls",{schema:{hand:{default:trackedControlsUtils},pair:{default:0},model:{default:!0},
hideDisconnected:{default:!0}},mapping:_dereq_?INPUT_MAPPING_WEBXR:INPUT_MAPPING_WEBVR,bindMethods:function(){this.onModelError=bind(this.onModelError,this);this.onModelLoaded=bind(this.onModelLoaded,this);this.onControllersUpdate=bind(this.onControllersUpdate,this);this.checkIfControllerPresent=bind(this.checkIfControllerPresent,this);this.onAxisMoved=bind(this.onAxisMoved,this)},init:function(){var self=this,el=this.el;this.onButtonChanged=bind(this.onButtonChanged,this);this.onButtonDown=function(evt){onButtonEvent(evt.detail.id,
"down",self)};this.onButtonUp=function(evt){onButtonEvent(evt.detail.id,"up",self)};this.onButtonTouchStart=function(evt){onButtonEvent(evt.detail.id,"touchstart",self)};this.onButtonTouchEnd=function(evt){onButtonEvent(evt.detail.id,"touchend",self)};this.onControllerConnected=function(){self.setModelVisibility(!0)};this.onControllerDisconnected=function(){self.setModelVisibility(!1)};this.controllerPresent=!1;this.lastControllerCheck=0;this.previousButtonValues={};this.bindMethods();this.loadedMeshInfo=
{buttonMeshes:null,axisMeshes:null};this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1};el.addEventListener("controllerconnected",this.onControllerConnected);el.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var el=this.el;el.addEventListener("buttonchanged",this.onButtonChanged);el.addEventListener("buttondown",this.onButtonDown);el.addEventListener("buttonup",this.onButtonUp);el.addEventListener("touchstart",
this.onButtonTouchStart);el.addEventListener("touchend",this.onButtonTouchEnd);el.addEventListener("axismove",this.onAxisMoved);el.addEventListener("model-error",this.onModelError);el.addEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!0},removeEventListeners:function(){var el=this.el;el.removeEventListener("buttonchanged",this.onButtonChanged);el.removeEventListener("buttondown",this.onButtonDown);el.removeEventListener("buttonup",this.onButtonUp);el.removeEventListener("touchstart",
this.onButtonTouchStart);el.removeEventListener("touchend",this.onButtonTouchEnd);el.removeEventListener("axismove",this.onAxisMoved);el.removeEventListener("model-error",this.onModelError);el.removeEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=!1},checkIfControllerPresent:function(){checkControllerPresentAndSetup(this,GAMEPAD_ID_PREFIX,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},
pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh)this.modelReady();else{var sourceUrl=this.createControllerModelUrl();this.loadModel(sourceUrl)}},createControllerModelUrl:function(forceDefault){var trackedControlsComponent=this.el.components["tracked-controls"],controller=trackedControlsComponent?trackedControlsComponent.controller:null;trackedControlsComponent="default";var hand=
this.data.hand;controller&&!window.hasNativeWebXRImplementation&&(hand=controller.hand,forceDefault||(trackedControlsComponent=(forceDefault=controller.id.match(GAMEPAD_ID_PATTERN))&&forceDefault[0]||trackedControlsComponent));return"https://cdn.aframe.io/controllers/microsoft/"+trackedControlsComponent+"/"+(MODEL_FILENAMES[hand]||MODEL_FILENAMES.default)},injectTrackedControls:function(){var data=this.data;this.el.setAttribute("tracked-controls",{idPrefix:GAMEPAD_ID_PREFIX,controller:data.pair,hand:data.hand,
armModel:!1});this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(evt){var defaultUrl=this.createControllerModelUrl(!0);evt.detail.src!==defaultUrl?(warn("Failed to load controller model for device, attempting to load default."),
this.loadModel(defaultUrl)):warn("Failed to load default controller model.")},loadModel:function(url){this.el.setAttribute("gltf-model","url("+url+")")},onModelLoaded:function(evt){function getImmediateChildByName(object3d,value){for(var i=0,l=object3d.children.length;i<l;i++){var obj=object3d.children[i];if(obj&&obj.name===value)return obj}}evt=this.controllerModel=evt.detail.model;var loadedMeshInfo=this.loadedMeshInfo,i$jscomp$0,meshName,mesh;debug("Processing model");loadedMeshInfo.buttonMeshes=
{};loadedMeshInfo.axisMeshes={};if(evt){for(i$jscomp$0=0;i$jscomp$0<this.mapping.buttons.length;i$jscomp$0++)(meshName=this.mapping.buttonMeshNames[this.mapping.buttons[i$jscomp$0]])?(mesh=evt.getObjectByName(meshName))?(mesh={index:i$jscomp$0,value:getImmediateChildByName(mesh,"VALUE"),pressed:getImmediateChildByName(mesh,"PRESSED"),unpressed:getImmediateChildByName(mesh,"UNPRESSED")},mesh.value&&mesh.pressed&&mesh.unpressed?loadedMeshInfo.buttonMeshes[this.mapping.buttons[i$jscomp$0]]=mesh:warn("Missing button submesh under mesh with name: "+
meshName+"(VALUE: "+!!mesh.value+", PRESSED: "+!!mesh.pressed+", UNPRESSED:"+!!mesh.unpressed+")")):warn("Missing button mesh with name: "+meshName):debug("Skipping unknown button at index: "+i$jscomp$0+" with mapped name: "+this.mapping.buttons[i$jscomp$0]);for(i$jscomp$0=0;i$jscomp$0<this.mapping.axisMeshNames.length;i$jscomp$0++)(meshName=this.mapping.axisMeshNames[i$jscomp$0])?(mesh=evt.getObjectByName(meshName))?(mesh={index:i$jscomp$0,value:getImmediateChildByName(mesh,"VALUE"),min:getImmediateChildByName(mesh,
"MIN"),max:getImmediateChildByName(mesh,"MAX")},mesh.value&&mesh.min&&mesh.max?loadedMeshInfo.axisMeshes[i$jscomp$0]=mesh:warn("Missing axis submesh under mesh with name: "+meshName+"(VALUE: "+!!mesh.value+", MIN: "+!!mesh.min+", MAX:"+!!mesh.max+")")):warn("Missing axis mesh with name: "+meshName):debug("Skipping unknown axis at index: "+i$jscomp$0);this.calculateRayOriginFromMesh(evt);this.setModelVisibility()}debug("Model load complete.")},calculateRayOriginFromMesh:function(){var quaternion=new THREE.Quaternion;
return function(rootNode){var mesh;this.rayOrigin.origin.set(0,0,0);this.rayOrigin.direction.set(0,0,-1);this.rayOrigin.createdFromMesh=!0;if(mesh=rootNode.getObjectByName(this.mapping.pointingPoseMeshName)){var parent=rootNode.parent;parent&&(rootNode.parent=null,rootNode.updateMatrixWorld(!0),rootNode.parent=parent);mesh.getWorldPosition(this.rayOrigin.origin);mesh.getWorldQuaternion(quaternion);this.rayOrigin.direction.applyQuaternion(quaternion);parent&&rootNode.updateMatrixWorld(!0)}else debug("Mesh does not contain pointing origin data, defaulting to none.");
this.modelReady()}}(),lerpAxisTransform:function(){var quaternion=new THREE.Quaternion;return function(axis,axisValue){var axisMeshInfo=this.loadedMeshInfo.axisMeshes[axis];if(axisMeshInfo){axis=axisMeshInfo.min;var max=axisMeshInfo.max;axisMeshInfo=axisMeshInfo.value;axisValue=.5*axisValue+.5;axisMeshInfo.setRotationFromQuaternion(quaternion.copy(axis.quaternion).slerp(max.quaternion,axisValue));axisMeshInfo.position.lerpVectors(axis.position,max.position,axisValue)}}}(),lerpButtonTransform:function(){var quaternion=
new THREE.Quaternion;return function(buttonName,buttonValue){var buttonMeshInfo=this.loadedMeshInfo.buttonMeshes[buttonName];if(buttonMeshInfo){buttonName=buttonMeshInfo.unpressed;var max=buttonMeshInfo.pressed;buttonMeshInfo=buttonMeshInfo.value;buttonMeshInfo.setRotationFromQuaternion(quaternion.copy(buttonName.quaternion).slerp(max.quaternion,buttonValue));buttonMeshInfo.position.lerpVectors(buttonName.position,max.position,buttonValue)}}}(),modelReady:function(){this.el.emit("controllermodelready",
{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(evt){var buttonName=this.mapping.buttons[evt.detail.id];buttonName&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(buttonName,evt.detail.state.value),this.el.emit(buttonName+"changed",evt.detail.state))},onAxisMoved:function(evt){var numAxes=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var axis=0;axis<numAxes;axis++)this.lerpAxisTransform(axis,
evt.detail.axis[axis]||0);emitIfAxesChanged(this,this.mapping.axes,evt)},setModelVisibility:function(visible){var model=this.el.getObject3D("mesh");this.modelVisible=visible=void 0!==visible?visible:this.modelVisible;model&&(model.visible=visible)}})},{"../constants":122,"../core/component":130,"../utils/":204,"../utils/bind":198,"../utils/tracked-controls":213}],122:[function(_dereq_,module,exports){module.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",
keyboardevent:_dereq_("./keyboardevent")}},{"./keyboardevent":123}],123:[function(_dereq_,module,exports){module.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],124:[function(_dereq_,module,exports){function mediaElementLoaded(el){if(el.hasAttribute("autoplay")||"auto"===el.getAttribute("preload"))return new Promise(function(resolve,reject){function checkProgress(){for(var secondsBuffered=0,i=0;i<el.buffered.length;i++)secondsBuffered+=
el.buffered.end(i)-el.buffered.start(i);secondsBuffered>=el.duration&&("VIDEO"===el.tagName&&(THREE.Cache.files[el.getAttribute("src")]=el),resolve())}if(4===el.readyState)return resolve();if(el.error)return reject();el.addEventListener("loadeddata",checkProgress,!1);el.addEventListener("progress",checkProgress,!1);el.addEventListener("error",reject,!1)})}function fixUpMediaElement(mediaEl){var newMediaEl=setCrossOrigin(mediaEl);newMediaEl.tagName&&"video"===newMediaEl.tagName.toLowerCase()&&(newMediaEl.setAttribute("playsinline",
""),newMediaEl.setAttribute("webkit-playsinline",""));newMediaEl!==mediaEl&&(mediaEl.parentNode.appendChild(newMediaEl),mediaEl.parentNode.removeChild(mediaEl));return newMediaEl}function setCrossOrigin(mediaEl){if(mediaEl.hasAttribute("crossorigin"))return mediaEl;var src=mediaEl.getAttribute("src");if(null!==src){if(-1===src.indexOf("://"))return mediaEl;var domain=-1<src.indexOf("://")?src.split("/")[2]:src.split("/")[0];if(domain.substring(0,domain.indexOf(":"))===window.location.host)return mediaEl}warn('Cross-origin element (e.g., \x3cimg\x3e) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., \x3cimg crossorigin\x3d"anonymous"\x3e)',
src);mediaEl.crossOrigin="anonymous";return mediaEl.cloneNode(!0)}function inferResponseType(src){var fileName=getFileNameFromURL(src),dotLastIndex=fileName.lastIndexOf(".");return 0<=dotLastIndex&&".glb"===fileName.slice(dotLastIndex,src.search(/\?|#|$/))?"arraybuffer":"text"}function getFileNameFromURL(url){var parser=document.createElement("a");parser.href=url;parser=parser.search.replace(/^\?/,"");url=url.replace(parser,"").replace("?","");return url.substring(url.lastIndexOf("/")+1)}var ANode=
_dereq_("./a-node"),bind=_dereq_("../utils/bind");exports=_dereq_("../utils/debug");var registerElement=_dereq_("./a-register-element").registerElement,THREE=_dereq_("../lib/three"),fileLoader=new THREE.FileLoader,warn=exports("core:a-assets:warn");module.exports=registerElement("a-assets",{prototype:Object.create(ANode.prototype,{createdCallback:{value:function(){this.isAssets=!0;this.fileLoader=fileLoader;this.timeout=null}},attachedCallback:{value:function(){var self=this,i,loaded=[];if(!this.parentNode.isScene)throw Error("\x3ca-assets\x3e must be a child of a \x3ca-scene\x3e.");
var imgEls=this.querySelectorAll("img");for(i=0;i<imgEls.length;i++){var imgEl=fixUpMediaElement(imgEls[i]);loaded.push(new Promise(function(resolve,reject){THREE.Cache.files[imgEls[i].getAttribute("src")]=imgEl;imgEl.onload=resolve;imgEl.onerror=reject}))}var mediaEls=this.querySelectorAll("audio, video");for(i=0;i<mediaEls.length;i++){var mediaEl=fixUpMediaElement(mediaEls[i]);mediaEl.src||mediaEl.srcObject||warn("Audio/video asset has neither `src` nor `srcObject` attributes.");loaded.push(mediaElementLoaded(mediaEl))}Promise.all(loaded).then(bind(this.load,
this));var timeout=parseInt(this.getAttribute("timeout"),10)||3E3;this.timeout=setTimeout(function(){self.hasLoaded||(warn("Asset loading timed out in ",timeout,"ms"),self.emit("timeout"),self.load())},timeout)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){ANode.prototype.load.call(this,null,function(el){return el.isAssetItem&&el.hasAttribute("src")})}}})});registerElement("a-asset-item",{prototype:Object.create(ANode.prototype,{createdCallback:{value:function(){this.data=
null;this.isAssetItem=!0}},attachedCallback:{value:function(){var self=this,src=this.getAttribute("src");fileLoader.setResponseType(this.getAttribute("response-type")||inferResponseType(src));fileLoader.load(src,function(response){self.data=response;setTimeout(function(){ANode.prototype.load.call(self)})},function(xhr){self.emit("progress",{loadedBytes:xhr.loaded,totalBytes:xhr.total,xhr:xhr})},function(xhr){self.emit("error",{xhr:xhr})})}}})});module.exports.inferResponseType=inferResponseType;module.exports.getFileNameFromURL=
getFileNameFromURL},{"../lib/three":178,"../utils/bind":198,"../utils/debug":200,"./a-node":128,"./a-register-element":129}],125:[function(_dereq_,module,exports){exports=_dereq_("../utils/debug");_dereq_=_dereq_("./a-register-element").registerElement;var warn=exports("core:cubemap:warn");module.exports=_dereq_("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var elements=
this.querySelectorAll("[src]"),i,srcs=[];if(6===elements.length){for(i=0;i<elements.length;i++)srcs.push(elements[i].getAttribute("src"));return srcs}warn("\x3ca-cubemap\x3e did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":200,"./a-register-element":129}],126:[function(_dereq_,module,exports){function checkComponentDefined(el,name){if(el.components[name]&&el.components[name].attrValue)return!0;el=el.mixinEls;var i,inMixin=!1;for(i=
0;i<el.length&&!(inMixin=el[i].hasAttribute(name));++i);return inMixin}function isComponent(componentName){-1!==componentName.indexOf("__")&&(componentName=utils.split(componentName,"__")[0]);return COMPONENTS[componentName]?!0:!1}var ANode=_dereq_("./a-node"),COMPONENTS=_dereq_("./component").components;exports=_dereq_("./a-register-element").registerElement;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/"),debug=utils.debug("core:a-entity:debug"),warn=utils.debug("core:a-entity:warn"),
OBJECT3D_COMPONENTS=["position","rotation","scale","visible"],ONCE={once:!0};_dereq_=Object.create(ANode.prototype,{createdCallback:{value:function(){this.components={};this.initializingComponents={};this.componentsToUpdate={};this.isEntity=!0;this.isPlaying=!1;this.object3D=new THREE.Group;this.object3D.el=this;this.object3DMap={};this.parentEl=null;this.rotationObj={};this.states=[]}},attributeChangedCallback:{value:function(attr,oldVal,newVal){var component=this.components[attr];component&&component.justInitialized&&
""===newVal?delete component.justInitialized:(component||null!==newVal)&&this.setEntityAttribute(attr,oldVal,newVal)}},attachedCallback:{value:function(){var assetsEl=this.sceneEl;var self=this;this.addToParent();this.isScene||(assetsEl?(assetsEl=assetsEl.querySelector("a-assets"))&&!assetsEl.hasLoaded?assetsEl.addEventListener("loaded",function(){self.load()}):this.load():this.load())}},detachedCallback:{value:function(){var componentName;if(this.parentEl){for(componentName in this.components)this.removeComponent(componentName,
!1);this.isScene||(this.removeFromParent(),ANode.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(type){return this.object3DMap[type]}},setObject3D:{value:function(type,obj){var oldObj,self=this;if(!(obj instanceof THREE.Object3D))throw Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");(oldObj=this.getObject3D(type))&&this.object3D.remove(oldObj);obj.el=this;obj.children.length&&obj.traverse(function(child){child.el=
self});this.object3D.add(obj);this.object3DMap[type]=obj;this.emit("object3dset",{object:obj,type:type})}},removeObject3D:{value:function(type){var obj=this.getObject3D(type);obj?(this.object3D.remove(obj),delete this.object3DMap[type],this.emit("object3dremove",{type:type})):warn("Tried to remove `Object3D` of type:",type,"which was not defined.")}},getOrCreateObject3D:{value:function(type,Constructor){var object3D=this.getObject3D(type);!object3D&&Constructor&&(object3D=new Constructor,this.setObject3D(type,
object3D));warn("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead.");return object3D}},add:{value:function(el){if(!el.object3D)throw Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(el.object3D);this.emit("child-attached",{el:el})}},addToParent:{value:function(){var parentNode=this.parentEl=this.parentNode;parentNode&&parentNode.add&&!this.attachedToParent&&(parentNode.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var parentEl=
this.parentEl;this.parentEl.remove(this);this.attachedToParent=!1;this.parentEl=null;parentEl.emit("child-detached",{el:this})}},load:{value:function(){var self=this;!this.hasLoaded&&this.parentEl&&ANode.prototype.load.call(this,function(){self.parentEl&&(self.updateComponents(),(self.isScene||self.parentEl.isPlaying)&&self.play())})},writable:window.debug},remove:{value:function(el){el?this.object3D.remove(el.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var children=
this.children,childEntities=[],i=0;i<children.length;i++){var child=children[i];child instanceof AEntity&&childEntities.push(child)}return childEntities}},initComponent:{value:function(attrName,data,isDependency){var componentId=utils.split(attrName,"__");var componentName=componentId[0];componentId=2<componentId.length?componentId.slice(1).join("__"):componentId[1];if(COMPONENTS[componentName]&&(checkComponentDefined(this,attrName)||void 0!==data||isDependency)&&!(attrName in this.components)){this.initComponentDependencies(componentName);
if(componentId&&!COMPONENTS[componentName].multiple)throw Error("Trying to initialize multiple components of type `"+componentName+"`. There can only be one component of this type per entity.");data=new COMPONENTS[componentName].Component(this,data,componentId);this.isPlaying&&data.play();this.hasAttribute(attrName)||(data.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,attrName,""));debug("Component initialized: %s",attrName)}},writable:window.debug},initComponentDependencies:{value:function(name){var i;
if(COMPONENTS[name]&&(name=COMPONENTS[name].dependencies))for(i=0;i<name.length;i++)this.initComponent(name[i],window.HTMLElement.prototype.getAttribute.call(this,name[i])||void 0,!0)}},removeComponent:{value:function(name,destroy){var component;if(component=this.components[name])component.initialized?(component.pause(),component.remove(),destroy&&(component.destroy(),delete this.components[name]),this.emit("componentremoved",component.evtDetail,!1)):this.addEventListener("componentinitialized",function tryRemoveLater(evt){evt.detail.name===
name&&(this.removeComponent(name,destroy),this.removeEventListener("componentinitialized",tryRemoveLater))})},writable:window.debug},updateComponents:{value:function(){var data,componentsToUpdate=this.componentsToUpdate;if(this.hasLoaded){for(data=0;data<this.mixinEls.length;data++)for(name in this.mixinEls[data].componentCache)isComponent(name)&&(componentsToUpdate[name]=!0);if(this.getExtraComponents){var extraComponents=this.getExtraComponents();for(name in extraComponents)isComponent(name)&&(componentsToUpdate[name]=
!0)}for(data=0;data<this.attributes.length;++data){var name=this.attributes[data].name;-1===OBJECT3D_COMPONENTS.indexOf(name)&&isComponent(name)&&(componentsToUpdate[name]=!0)}for(data=0;data<OBJECT3D_COMPONENTS.length;data++)name=OBJECT3D_COMPONENTS[data],this.hasAttribute(name)&&this.updateComponent(name,this.getDOMAttribute(name));for(name in componentsToUpdate){data=this.getDOMAttribute(name);var extraData=extraComponents&&extraComponents[name];data=extraData?extraData.constructor===Object?utils.extend(extraData,
utils.styleParser.parse(data||{})):data||extraData:data;this.updateComponent(name,data);delete componentsToUpdate[name]}}},writable:window.debug},updateComponent:{value:function(attr,attrValue,clobber){var component=this.components[attr];component?null!==attrValue||checkComponentDefined(this,attr)?component.updateProperties(attrValue,clobber):this.removeComponent(attr,!0):this.initComponent(attr,attrValue,!1)}},removeAttribute:{value:function(attr,propertyName){var component=this.components[attr];
component&&void 0===propertyName&&this.removeComponent(attr,!0);component&&void 0!==propertyName?component.resetProperty(propertyName):("mixin"===attr&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,attr))}},play:{value:function(){var i;if(!this.isPlaying&&this.hasLoaded){this.isPlaying=!0;for(entities in this.components)this.components[entities].play();var entities=this.getChildEntities();for(i=0;i<entities.length;i++)entities[i].play();this.emit("play")}},writable:!0},
pause:{value:function(){var i;if(this.isPlaying){this.isPlaying=!1;for(entities in this.components)this.components[entities].pause();var entities=this.getChildEntities();for(i=0;i<entities.length;i++)entities[i].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(attr,oldVal,newVal){COMPONENTS[attr]||this.components[attr]?this.updateComponent(attr,newVal):"mixin"===attr&&newVal!==this.computedMixinStr&&this.mixinUpdate(newVal,oldVal)}},mixinUpdate:{value:function(){var componentsUpdated=
[];return function(newMixins,oldMixins){var component,mixinEl,i,self=this;if(this.hasLoaded){oldMixins=oldMixins||this.getAttribute("mixin");var mixinIds=this.updateMixins(newMixins,oldMixins);for(i=componentsUpdated.length=0;i<this.mixinEls.length;i++)for(component in this.mixinEls[i].componentCache)-1===componentsUpdated.indexOf(component)&&(this.components[component]?this.components[component].handleMixinUpdate():this.initComponent(component,null),componentsUpdated.push(component));for(i=0;i<mixinIds.oldMixinIds.length;i++)if(mixinEl=
document.getElementById(mixinIds.oldMixinIds[i]))for(component in mixinEl.componentCache)-1===componentsUpdated.indexOf(component)&&this.components[component]&&(this.getDOMAttribute(component)?this.components[component].handleMixinUpdate():this.removeComponent(component,!0))}else this.addEventListener("loaded",function(){self.mixinUpdate(newMixins,oldMixins)},ONCE)}}()},setAttribute:{value:function(){var singlePropUpdate={};return function(attrName,arg1,arg2){var componentName=attrName.indexOf("__");
componentName=0<componentName?attrName.substring(0,componentName):attrName;if(COMPONENTS[componentName]){!this.components[attrName]&&this.hasAttribute(attrName)&&this.updateComponent(attrName,window.HTMLElement.prototype.getAttribute.call(this,attrName));if("undefined"!==typeof arg2&&"string"===typeof arg1&&0<arg1.length&&"string"===typeof utils.styleParser.parse(arg1)){for(newAttrValue in singlePropUpdate)delete singlePropUpdate[newAttrValue];var newAttrValue=singlePropUpdate;newAttrValue[arg1]=
arg2;arg1=!1}else newAttrValue=arg1,arg1=!0===arg2;this.updateComponent(attrName,newAttrValue,arg1);this.sceneEl&&this.sceneEl.getAttribute("debug")&&this.components[attrName].flushToDOM()}else"mixin"===attrName&&this.mixinUpdate(arg1),ANode.prototype.setAttribute.call(this,attrName,arg1)}}(),writable:window.debug},flushToDOM:{value:function(recursive){var components=this.components,children=this.children,i;for(i in components)components[i].flushToDOM();if(recursive)for(i=0;i<children.length;++i)components=
children[i],components.flushToDOM&&components.flushToDOM(recursive)}},getAttribute:{value:function(attr){if("position"===attr)return this.object3D.position;if("rotation"===attr){attr=THREE.Math.radToDeg;var component=this.object3D.rotation;var rotationObj=this.rotationObj;rotationObj.x=attr(component.x);rotationObj.y=attr(component.y);rotationObj.z=attr(component.z);return rotationObj}return"scale"===attr?this.object3D.scale:"visible"===attr?this.object3D.visible:(component=this.components[attr])?
component.data:window.HTMLElement.prototype.getAttribute.call(this,attr)},writable:window.debug},getDOMAttribute:{value:function(attr){var component=this.components[attr];return component?component.attrValue:window.HTMLElement.prototype.getAttribute.call(this,attr)},writable:window.debug},addState:{value:function(state){this.is(state)||(this.states.push(state),this.emit("stateadded",state))}},removeState:{value:function(state){var stateIndex=this.states.indexOf(state);-1!==stateIndex&&(this.states.splice(stateIndex,
1),this.emit("stateremoved",state))}},is:{value:function(state){return-1!==this.states.indexOf(state)}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var key;if(this.parentNode)warn("Entity can only be destroyed if detached from scenegraph.");else for(key in this.components)this.components[key].destroy()}}});var AEntity=exports("a-entity",{prototype:_dereq_});module.exports=AEntity},{"../lib/three":178,"../utils/":204,"./a-node":128,"./a-register-element":129,
"./component":130}],127:[function(_dereq_,module,exports){exports=_dereq_("./a-node");var registerElement=_dereq_("./a-register-element").registerElement,components=_dereq_("./component").components,utils=_dereq_("../utils");module.exports=registerElement("a-mixin",{prototype:Object.create(exports.prototype,{createdCallback:{value:function(){this.componentCache={};this.id=this.getAttribute("id");this.isMixin=!0}},attributeChangedCallback:{value:function(attr,oldVal,newVal){this.cacheAttribute(attr,
newVal);this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene();this.cacheAttributes();this.updateEntities();this.load()}},setAttribute:{value:function(attr,value){window.HTMLElement.prototype.setAttribute.call(this,attr,value);this.cacheAttribute(attr,value)}},cacheAttribute:{value:function(attr,value){var component=utils.split(attr,"__")[0];if(component=components[component])void 0===value&&(value=window.HTMLElement.prototype.getAttribute.call(this,attr)),this.componentCache[attr]=
component.parseAttrValueForCache(value)}},getAttribute:{value:function(attr){return this.componentCache[attr]||window.HTMLElement.prototype.getAttribute.call(this,attr)}},cacheAttributes:{value:function(){var attributes=this.attributes,i;for(i=0;i<attributes.length;i++){var attrName=attributes[i].name;this.cacheAttribute(attrName)}}},updateEntities:{value:function(){var i;if(this.sceneEl){var entities=this.sceneEl.querySelectorAll("[mixin~\x3d"+this.id+"]");for(i=0;i<entities.length;i++){var entity=
entities[i];entity.hasLoaded&&!entity.isMixin&&entity.mixinUpdate(this.id)}}}}})})},{"../utils":204,"./a-node":128,"./a-register-element":129,"./component":130}],128:[function(_dereq_,module,exports){exports=_dereq_("./a-register-element").registerElement;var isNode=_dereq_("./a-register-element").isNode,utils=_dereq_("../utils/"),warn=utils.debug("core:a-node:warn"),error=utils.debug("core:a-node:error");module.exports=exports("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr=
"";this.hasLoaded=!1;this.isNode=!0;this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var mixins;(this.sceneEl=this.closestScene())||warn("You are attempting to attach \x3c"+this.tagName+"\x3e outside of an A-Frame scene. Append this element to `\x3ca-scene\x3e` instead.");this.hasLoaded=!1;this.emit("nodeready",void 0,!1);this.isMixin||(mixins=this.getAttribute("mixin"))&&this.updateMixins(mixins)},writable:window.debug},attributeChangedCallback:{value:function(attr,oldVal,
newVal){newVal!==this.computedMixinStr&&("mixin"!==attr||this.isMixin||this.updateMixins(newVal,oldVal))}},closestScene:{value:function(){for(var element=this;element&&!element.isScene;)element=element.parentElement;return element}},closest:{value:function(selector){for(var matches=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,element=this;element&&!matches.call(element,selector);)element=element.parentElement;return element}},detachedCallback:{value:function(){this.hasLoaded=
!1}},load:{value:function(cb,childFilter){var self=this;this.hasLoaded||(childFilter=childFilter||isNode,childFilter=this.getChildren().filter(childFilter).map(function(child){return new Promise(function(resolve){if(child.hasLoaded)return resolve();child.addEventListener("loaded",resolve)})}),Promise.all(childFilter).then(function(){self.hasLoaded=!0;cb&&cb();self.emit("loaded",void 0,!1)}).catch(function(err){error("Failure loading node: ",err)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,
0)}},updateMixins:{value:function(){var newMixinIdArray=[],oldMixinIdArray=[],mixinIds={};return function(newMixins,oldMixins){newMixinIdArray.length=0;oldMixinIdArray.length=0;newMixins=newMixins?utils.split(newMixins.trim(),/\s+/):newMixinIdArray;var oldMixinIds=oldMixins?utils.split(oldMixins.trim(),/\s+/):oldMixinIdArray;mixinIds.newMixinIds=newMixins;mixinIds.oldMixinIds=oldMixinIds;for(oldMixins=0;oldMixins<oldMixinIds.length;oldMixins++)-1===newMixins.indexOf(oldMixinIds[oldMixins])&&this.unregisterMixin(oldMixinIds[oldMixins]);
this.computedMixinStr="";for(oldMixins=this.mixinEls.length=0;oldMixins<newMixins.length;oldMixins++)this.registerMixin(document.getElementById(newMixins[oldMixins]));this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr));return mixinIds}}()},registerMixin:{value:function(mixinEl){var compositedMixinIds,i;if(mixinEl){if(compositedMixinIds=mixinEl.getAttribute("mixin"))for(compositedMixinIds=utils.split(compositedMixinIds.trim(),
/\s+/),i=0;i<compositedMixinIds.length;i++)this.registerMixin(document.getElementById(compositedMixinIds[i]));this.computedMixinStr=this.computedMixinStr+" "+mixinEl.id;this.mixinEls.push(mixinEl)}}},setAttribute:{value:function(attr,newValue){"mixin"===attr&&this.updateMixins(newValue);window.HTMLElement.prototype.setAttribute.call(this,attr,newValue)}},unregisterMixin:{value:function(mixinId){var i,mixinEls=this.mixinEls;for(i=0;i<mixinEls.length;++i){var mixinEl=mixinEls[i];if(mixinId===mixinEl.id){mixinEls.splice(i,
1);break}}}},emit:{value:function(){var data={};return function(name,detail,bubbles,extraData){void 0===bubbles&&(bubbles=!0);data.bubbles=!!bubbles;data.detail=detail;extraData&&(data=utils.extend({},extraData,data));this.dispatchEvent(new CustomEvent(name,data))}}(),writable:window.debug}})})},{"../utils/":204,"./a-register-element":129}],129:[function(_dereq_,module,exports){function wrapANodeMethods(obj){var newObj={};wrapMethods(newObj,["attachedCallback","attributeChangedCallback","createdCallback",
"detachedCallback"],obj,ANode.prototype);copyProperties(obj,newObj);return newObj}function wrapAEntityMethods(obj){var newObj={};wrapMethods(newObj,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],obj,ANode.prototype);wrapMethods(newObj,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],obj,AEntity.prototype);copyProperties(obj,newObj);return newObj}function wrapMethods(targetObj,methodList,derivedObj,baseObj){methodList.forEach(function(methodName){wrapMethod(targetObj,
methodName,derivedObj,baseObj)})}function wrapMethod(obj,methodName,derivedObj,baseObj){var derivedMethod=derivedObj[methodName],baseMethod=baseObj[methodName];derivedMethod&&baseMethod&&derivedMethod!==baseMethod&&(obj[methodName]={value:function(){baseMethod.apply(this,arguments);return derivedMethod.apply(this,arguments)},writable:window.debug})}function copyProperties(source,destination){Object.getOwnPropertyNames(source).forEach(function(prop){if(!destination[prop]){var desc=Object.getOwnPropertyDescriptor(source,
prop);destination[prop]={value:source[prop],writable:desc.writable}}})}_dereq_("document-register-element");var knownTags=module.exports.knownTags={};module.exports.isNode=function(node){return node.tagName.toLowerCase()in knownTags||node.isNode};module.exports.registerElement=function(tagName,obj){var proto=Object.getPrototypeOf(obj.prototype),newObj=obj,isANode=ANode&&proto===ANode.prototype,isAEntity=AEntity&&proto===AEntity.prototype;if(isANode||isAEntity)knownTags[tagName.toLowerCase()]=!0;isANode&&
(newObj=wrapANodeMethods(obj.prototype),newObj={prototype:Object.create(proto,newObj)});isAEntity&&(newObj=wrapAEntityMethods(obj.prototype),newObj={prototype:Object.create(proto,newObj)});Object.getOwnPropertyNames(newObj.prototype).forEach(function(propName){var propVal=newObj.prototype[propName];"function"===typeof propVal&&(propVal.displayName=propName)});return document.registerElement(tagName,newObj)};module.exports.wrapMethods=wrapMethods;var ANode=_dereq_("./a-node");var AEntity=_dereq_("./a-entity")},
{"./a-entity":126,"./a-node":128,"document-register-element":12}],130:[function(_dereq_,module,exports){function eventsBind(component,events){for(var eventName in events)component.events[eventName]=events[eventName].bind(component)}function copyData(dest,sourceData){var key;for(key in sourceData)if(void 0!==sourceData[key]){var parsedProperty=sourceData[key];dest[key]=isObjectOrArray(parsedProperty)?utils.clone(parsedProperty):parsedProperty}return dest}function extendProperties(dest,source,isObjectBased){var key;
if(isObjectBased&&source.constructor===Object){for(key in source)void 0!==source[key]&&(dest[key]=source[key]&&source[key].constructor===Object?utils.clone(source[key]):source[key]);return dest}return source}function wrapPause(pauseMethod){return function(){var sceneEl=this.el.sceneEl;this.isPlaying&&(pauseMethod.call(this),this.isPlaying=!1,this.eventsDetach(),(this.tick||this.tock)&&sceneEl.removeBehavior(this))}}function wrapPlay(playMethod){return function(){var sceneEl=this.el.sceneEl,shouldPlay=
this.el.isPlaying&&!this.isPlaying;this.initialized&&shouldPlay&&(playMethod.call(this),this.isPlaying=!0,this.eventsAttach(),(this.tick||this.tock)&&sceneEl.addBehavior(this))}}function isObject(value){return value&&value.constructor===Object&&!(value instanceof window.HTMLElement)}function isObjectOrArray(value){return value&&(value.constructor===Object||value.constructor===Array)&&!(value instanceof window.HTMLElement)}exports=_dereq_("./schema");var scenes=_dereq_("./scene/scenes"),systems=_dereq_("./system"),
utils=_dereq_("../utils/"),components=module.exports.components={},parseProperties=exports.parseProperties,parseProperty=exports.parseProperty,processSchema=exports.process,isSingleProp=exports.isSingleProperty,stringifyProperties=exports.stringifyProperties,stringifyProperty=exports.stringifyProperty,styleParser=utils.styleParser,warn=utils.debug("core:component:warn"),aframeScript=document.currentScript,upperCaseRegExp=/[A-Z]+/,objectPools={},Component=module.exports.Component=function(el,attrValue,
id){var self=this;this.el=el;this.id=id;this.attrName=this.name+(id?"__"+id:"");this.evtDetail={id:this.id,name:this.name};this.initialized=!1;this.isSinglePropertyObject=(this.isSingleProperty=isSingleProp(this.schema))&&isObject(parseProperty(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement);this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject;this.el.components[this.attrName]=this;this.objectPool=objectPools[this.name];id=this.events;this.events={};eventsBind(this,
id);this.attrValue=void 0;this.isObjectBased?(this.nextData=this.objectPool.use(),utils.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),utils.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),utils.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),utils.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):this.parsingAttrValue=this.previousOldData=
this.oldData=this.nextData=void 0;this.throttledEmitComponentChanged=utils.throttle(function(){el.emit("componentchanged",self.evtDetail,!1)},200);this.updateProperties(attrValue)};Component.prototype={schema:{},init:function(){},events:{},update:function(prevData){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(value,silent){var schema=this.schema;return this.isSingleProperty?parseProperty(value,schema):parseProperties(styleParser.parse(value),
schema,!0,this.name,silent)},stringify:function(data){var schema=this.schema;if("string"===typeof data)return data;if(this.isSingleProperty)return stringifyProperty(data,schema);data=stringifyProperties(data,schema);return styleParser.stringify(data)},updateCachedAttrValue:function(value,clobber){var property;if(void 0!==value)if(null===value)this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;else{if(value instanceof Object&&!(value instanceof window.HTMLElement)){var tempObject=
this.objectPool.use();value=utils.extend(tempObject,value)}else value=this.parseAttrValueForCache(value);if(this.isObjectBased&&!clobber&&this.attrValue)for(property in this.attrValue)void 0===value[property]&&(value[property]=this.attrValue[property]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use());utils.objectPool.clearObject(this.attrValue);this.attrValue=extendProperties(this.attrValue,value,this.isObjectBased);utils.objectPool.clearObject(tempObject)}},parseAttrValueForCache:function(value){if("string"!==
typeof value)return value;if(this.isSingleProperty){var parsedValue=this.schema.parse(value);"string"===typeof parsedValue&&(parsedValue=value)}else utils.objectPool.clearObject(this.parsingAttrValue),parsedValue=styleParser.parse(value,this.parsingAttrValue);return parsedValue},flushToDOM:function(isDefault){isDefault=isDefault?this.data:this.attrValue;null!==isDefault&&void 0!==isDefault&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(isDefault))},updateProperties:function(attrValue,
clobber){this.el.hasLoaded?(null!==attrValue&&(attrValue=this.parseAttrValueForCache(attrValue)),this.updateCachedAttrValue(attrValue,clobber),this.initialized?(this.updateComponent(attrValue,clobber),this.callUpdateHandler()):this.initComponent()):this.updateCachedAttrValue(attrValue)},initComponent:function(){var el=this.el;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0));this.data=this.buildData(this.attrValue);if(!el.initializingComponents[this.name]){el.initializingComponents[this.name]=
!0;this.init();this.initialized=!0;delete el.initializingComponents[this.name];this.oldData=extendProperties(this.oldData,this.data,this.isObjectBased);var initialOldData=this.isObjectBased?this.objectPool.use():void 0;this.update(initialOldData);this.isObjectBased&&this.objectPool.recycle(initialOldData);el.isPlaying&&this.play();el.emit("componentinitialized",this.evtDetail,!1)}},updateComponent:function(attrValue,clobber){var key;if(clobber)this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,
!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);else if(this.isSingleProperty)this.isObjectBased&&parseProperty(attrValue,this.schema),this.data=attrValue;else{parseProperties(attrValue,this.schema,!0,this.name);if(this.schemaChangeKeys.length)for(key in attrValue)if(this.schema[key].schemaChange){var mayNeedSchemaUpdate=!0;break}if(mayNeedSchemaUpdate)this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);else for(key in attrValue)void 0!==
attrValue[key]&&(this.data[key]=attrValue[key])}},callUpdateHandler:function(){this.previousOldData instanceof Object&&utils.objectPool.clearObject(this.previousOldData);this.isObjectBased?copyData(this.previousOldData,this.oldData):this.previousOldData=this.oldData;var hasComponentChanged=!utils.deepEqual(this.oldData,this.data);if(this.isPositionRotationScale||hasComponentChanged)this.oldData instanceof Object&&utils.objectPool.clearObject(this.oldData),this.oldData=extendProperties(this.oldData,
this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged()},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue);this.callUpdateHandler()},resetProperty:function(propertyName){if(this.isObjectBased){if(!(propertyName in this.attrValue))return;delete this.attrValue[propertyName];this.data[propertyName]=this.schema[propertyName].default}else this.data=this.attrValue=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(schemaAddon){var extendedSchema=
utils.extend({},components[this.name].schema);utils.extend(extendedSchema,schemaAddon);this.schema=processSchema(extendedSchema);this.el.emit("schemachanged",this.evtDetail)},buildData:function(newData,clobber,silent){var key;var data=this.nextData;var schema=this.schema,mixinEls=this.el.mixinEls;var componentDefined=newData&&newData.constructor===Array?newData.length:void 0!==newData&&null!==newData;this.isObjectBased&&utils.objectPool.clearObject(data);if(this.isSingleProperty)data=this.isObjectBased?
copyData(data,schema.default):isObjectOrArray(schema.default)?utils.clone(schema.default):schema.default;else for(key in clobber=!clobber&&this.attrValue,data=clobber instanceof Object?copyData(data,clobber):data,schema)clobber=schema[key].default,void 0===data[key]&&(data[key]=isObjectOrArray(clobber)?utils.clone(clobber):clobber);for(clobber=0;clobber<mixinEls.length;clobber++)(key=mixinEls[clobber].getAttribute(this.attrName))&&(data=extendProperties(data,key,this.isObjectBased));if(componentDefined){if(this.isSingleProperty)return isObject(newData)?
(copyData(this.parsingAttrValue,newData),parseProperty(this.parsingAttrValue,schema)):parseProperty(newData,schema);data=extendProperties(data,newData,this.isObjectBased)}else if(this.isSingleProperty)return parseProperty(data,schema);return parseProperties(data,schema,void 0,this.name,silent)},eventsAttach:function(){var eventName;this.eventsDetach();for(eventName in this.events)this.el.addEventListener(eventName,this.events[eventName])},eventsDetach:function(){for(var eventName in this.events)this.el.removeEventListener(eventName,
this.events[eventName])},destroy:function(){this.objectPool.recycle(this.attrValue);this.objectPool.recycle(this.oldData);this.objectPool.recycle(this.parsingAttrValue);this.attrValue=this.oldData=this.parsingAttrValue=void 0}};if(window.debug)var registrationOrderWarnings=module.exports.registrationOrderWarnings={};module.exports.registerComponent=function(name,definition){var propertyName,proto={};document.currentScript&&document.currentScript!==aframeScript&&scenes.forEach(function(sceneEl){sceneEl.hasLoaded||
document.currentScript.compareDocumentPosition(sceneEl)===Node.DOCUMENT_POSITION_FOLLOWING||(warn("The component `"+name+"` was registered in a \x3cscript\x3e tag after the scene. Component \x3cscript\x3e tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(registrationOrderWarnings[name]=!0))});!0===upperCaseRegExp.test(name)&&warn("The component name `"+name+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+
name.toLowerCase()+"`");if(-1!==name.indexOf("__"))throw Error("The component name `"+name+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");Object.keys(definition).forEach(function(key){proto[key]={value:definition[key],writable:!0}});if(components[name])throw Error("The component `"+name+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");
var NewComponent=function(el,attr,id){Component.call(this,el,attr,id)};NewComponent.prototype=Object.create(Component.prototype,proto);NewComponent.prototype.name=name;NewComponent.prototype.isPositionRotationScale="position"===name||"rotation"===name||"scale"===name;NewComponent.prototype.constructor=NewComponent;NewComponent.prototype.system=systems&&systems.systems[name];NewComponent.prototype.play=wrapPlay(NewComponent.prototype.play);NewComponent.prototype.pause=wrapPause(NewComponent.prototype.pause);
var schema=utils.extend(processSchema(NewComponent.prototype.schema,NewComponent.prototype.name));var schemaIsSingleProp=isSingleProp(NewComponent.prototype.schema);if(!schemaIsSingleProp)for(propertyName in NewComponent.prototype.schemaChangeKeys=[],schema)schema[propertyName].schemaChange&&NewComponent.prototype.schemaChangeKeys.push(propertyName);objectPools[name]=utils.objectPool.createPool();components[name]={Component:NewComponent,dependencies:NewComponent.prototype.dependencies,isSingleProp:schemaIsSingleProp,
multiple:NewComponent.prototype.multiple,name:name,parse:NewComponent.prototype.parse,parseAttrValueForCache:NewComponent.prototype.parseAttrValueForCache,schema:schema,stringify:NewComponent.prototype.stringify,type:NewComponent.prototype.type};return NewComponent}},{"../utils/":204,"./scene/scenes":137,"./schema":139,"./system":141}],131:[function(_dereq_,module,exports){var processSchema=_dereq_("./schema").process,geometries=module.exports.geometries={},geometryNames=module.exports.geometryNames=
[],THREE=_dereq_("../lib/three"),Geometry=module.exports.Geometry=function(){};Geometry.prototype={schema:{},init:function(data){return this.geometry=new THREE.Geometry},update:function(data){}};module.exports.registerGeometry=function(name,definition){var proto={};Object.keys(definition).forEach(function(key){proto[key]={value:definition[key],writable:!0}});if(geometries[name])throw Error("The geometry `"+name+"` has been already registered");var NewGeometry=function(){Geometry.call(this)};NewGeometry.prototype=
Object.create(Geometry.prototype,proto);NewGeometry.prototype.name=name;NewGeometry.prototype.constructor=NewGeometry;geometries[name]={Geometry:NewGeometry,schema:processSchema(NewGeometry.prototype.schema)};geometryNames.push(name);return NewGeometry}},{"../lib/three":178,"./schema":139}],132:[function(_dereq_,module,exports){function registerPropertyType(type,defaultValue,parse,stringify){"type"in propertyTypes?error("Property type "+type+" is already registered."):propertyTypes[type]={default:defaultValue,
parse:parse||defaultParse,stringify:stringify||defaultStringify}}function assetParse(value){var el;if("string"!==typeof value)return value;if(el=value.match(urlRegex))return el[1];if("#"===value.charAt(0)){if(el=document.getElementById(value.substring(1)))return"CANVAS"===el.tagName||"VIDEO"===el.tagName||"IMG"===el.tagName?el:el.getAttribute("src");warn('"'+value+'" asset not found.')}else return value}function defaultParse(value){return value}function defaultStringify(value){return null===value?
"null":value.toString()}function intParse(value){return parseInt(value,10)}function vecParse(value){return coordinates.parse(value,this.default)}function isValidDefaultCoordinate(possibleCoordinates,dimensions){if(null===possibleCoordinates)return!0;if("object"!==typeof possibleCoordinates||Object.keys(possibleCoordinates).length!==dimensions)return!1;var y=possibleCoordinates.y,z=possibleCoordinates.z,w=possibleCoordinates.w;return"number"!==typeof possibleCoordinates.x||"number"!==typeof y||2<dimensions&&
"number"!==typeof z||3<dimensions&&"number"!==typeof w?!1:!0}var coordinates=_dereq_("../utils/coordinates");_dereq_=_dereq_("debug");var error=_dereq_("core:propertyTypes:warn"),warn=_dereq_("core:propertyTypes:warn"),propertyTypes=module.exports.propertyTypes={},nonCharRegex=/[,> .[\]:]/,urlRegex=/\url\((.+)\)/;registerPropertyType("audio","",assetParse);registerPropertyType("array",[],function(value){return Array.isArray(value)?value:value&&"string"===typeof value?value.split(",").map(function(str){return str.trim()}):
[]},function(value){return value.join(", ")});registerPropertyType("asset","",assetParse);registerPropertyType("boolean",!1,function(value){return"false"!==value&&!1!==value});registerPropertyType("color","#FFF",defaultParse,defaultStringify);registerPropertyType("int",0,intParse);registerPropertyType("number",0,function(value){return parseFloat(value,10)});registerPropertyType("map","",assetParse);registerPropertyType("model","",assetParse);registerPropertyType("selector",null,function(value){return value?
"string"!==typeof value?value:"#"!==value[0]||nonCharRegex.test(value)?document.querySelector(value):document.getElementById(value.substring(1)):null},function(value){return value.getAttribute?"#"+value.getAttribute("id"):defaultStringify(value)});registerPropertyType("selectorAll",null,function(value){return value?"string"!==typeof value?value:Array.prototype.slice.call(document.querySelectorAll(value),0):null},function(value){return value instanceof Array?value.map(function(element){return"#"+element.getAttribute("id")}).join(", "):
defaultStringify(value)});registerPropertyType("src","",function(value){warn("`src` property type is deprecated. Use `asset` instead.");return assetParse(value)});registerPropertyType("string","",defaultParse,defaultStringify);registerPropertyType("time",0,intParse);registerPropertyType("vec2",{x:0,y:0},vecParse,coordinates.stringify);registerPropertyType("vec3",{x:0,y:0,z:0},vecParse,coordinates.stringify);registerPropertyType("vec4",{x:0,y:0,z:0,w:1},vecParse,coordinates.stringify);module.exports.registerPropertyType=
registerPropertyType;module.exports.isValidDefaultValue=function(type,defaultVal){return"audio"===type&&"string"!==typeof defaultVal||"array"===type&&!Array.isArray(defaultVal)||"asset"===type&&"string"!==typeof defaultVal||"boolean"===type&&"boolean"!==typeof defaultVal||"color"===type&&"string"!==typeof defaultVal||"int"===type&&"number"!==typeof defaultVal||"number"===type&&"number"!==typeof defaultVal||"map"===type&&"string"!==typeof defaultVal||"model"===type&&"string"!==typeof defaultVal||"selector"===
type&&"string"!==typeof defaultVal&&null!==defaultVal||"selectorAll"===type&&"string"!==typeof defaultVal&&null!==defaultVal||"src"===type&&"string"!==typeof defaultVal||"string"===type&&"string"!==typeof defaultVal||"time"===type&&"number"!==typeof defaultVal?!1:"vec2"===type?isValidDefaultCoordinate(defaultVal,2):"vec3"===type?isValidDefaultCoordinate(defaultVal,3):"vec4"===type?isValidDefaultCoordinate(defaultVal,4):!0};module.exports.isValidDefaultCoordinate=isValidDefaultCoordinate},{"../utils/coordinates":199,
debug:8}],133:[function(_dereq_,module,exports){function getCanvasSize(canvasEl,embedded,maxSize,isVR){if(!canvasEl.parentElement)return{height:0,width:0};if(embedded)return{height:canvasEl.parentElement.offsetHeight,width:canvasEl.parentElement.offsetWidth};embedded=window.devicePixelRatio;canvasEl={height:document.body.offsetHeight,width:document.body.offsetWidth};!maxSize||isVR||-1===maxSize.width&&-1===maxSize.height||canvasEl.width*embedded<maxSize.width&&canvasEl.height*embedded<maxSize.height||
(isVR=canvasEl.width/canvasEl.height,canvasEl.width*embedded>maxSize.width&&-1!==maxSize.width&&(canvasEl.width=Math.round(maxSize.width/embedded),canvasEl.height=Math.round(maxSize.width/isVR/embedded)),canvasEl.height*embedded>maxSize.height&&-1!==maxSize.height&&(canvasEl.height=Math.round(maxSize.height/embedded),canvasEl.width=Math.round(maxSize.height*isVR/embedded)));return canvasEl}function setupCanvas(sceneEl){function onFullScreenChange(){document.fullscreenElement||document.mozFullScreenElement||
document.webkitFullscreenElement||sceneEl.exitVR();document.activeElement.blur();document.body.focus()}var canvasEl=document.createElement("canvas");canvasEl.classList.add("a-canvas");canvasEl.dataset.aframeCanvas=!0;sceneEl.appendChild(canvasEl);document.addEventListener("fullscreenchange",onFullScreenChange);document.addEventListener("mozfullscreenchange",onFullScreenChange);document.addEventListener("webkitfullscreenchange",onFullScreenChange);document.addEventListener("MSFullscreenChange",onFullScreenChange);
canvasEl.addEventListener("touchmove",function(event){event.preventDefault()});sceneEl.canvas=canvasEl;sceneEl.emit("render-target-loaded",{target:canvasEl});setTimeout(bind(sceneEl.resize,sceneEl),0)}var initMetaTags=_dereq_("./metaTags").inject,initWakelock=_dereq_("./wakelock"),loadingScreen=_dereq_("./loadingScreen");exports=_dereq_("../a-register-element");var scenes=_dereq_("./scenes"),systems$jscomp$0=_dereq_("../system").systems,THREE=_dereq_("../../lib/three"),utils=_dereq_("../../utils/"),
AEntity=_dereq_("../a-entity"),ANode=_dereq_("../a-node"),initPostMessageAPI=_dereq_("./postMessage"),bind=utils.bind,isIOS=utils.device.isIOS(),isMobile=utils.device.isMobile(),isWebXRAvailable=utils.device.isWebXRAvailable;exports=exports.registerElement;var warn=utils.debug("core:a-scene:warn");isIOS&&_dereq_("../../utils/ios-orientationchange-blank-bug");module.exports.AScene=exports("a-scene",{prototype:Object.create(AEntity.prototype,{createdCallback:{value:function(){this.clock=new THREE.Clock;
this.isIOS=isIOS;this.isMobile=isMobile;this.hasWebXR=isWebXRAvailable;this.isAR=!1;this.isScene=!0;this.object3D=new THREE.Scene;var self=this;this.object3D.onAfterRender=function(renderer,scene,camera){self.isPlaying&&self.tock(self.time,self.delta,camera)};this.resize=bind(this.resize,this);this.render=bind(this.render,this);this.systems={};this.systemNames=[];this.time=this.delta=0;this.behaviors={tick:[],tock:[]};this.isPlaying=this.hasLoaded=!1;this.originalHTML=this.innerHTML;this.setAttribute("inspector",
"");this.setAttribute("keyboard-shortcuts","");this.setAttribute("screenshot","");this.setAttribute("vr-mode-ui","");this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var self=this,embedded=this.hasAttribute("embedded");setupCanvas(this);this.setupRenderer();loadingScreen.setup(this,
getCanvasSize);this.resize();embedded||this.addFullScreenStyles();initPostMessageAPI(this);initMetaTags(this);initWakelock(this);this.onVRPresentChangeBound=bind(this.onVRPresentChange,this);window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound);this.enterVRBound=function(){self.enterVR()};this.exitVRBound=function(){self.exitVR()};this.exitVRTrueBound=function(){self.exitVR(!0)};this.pointerRestrictedBound=function(){self.pointerRestricted()};this.pointerUnrestrictedBound=
function(){self.pointerUnrestricted()};isWebXRAvailable||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound));window.addEventListener("sessionend",this.resize);this.addEventListener("cameraready",function(){self.attachedCallbackPostCamera()});this.initSystems();
this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){self.enterVR()})}},attachedCallbackPostCamera:{value:function(){var self=this;window.addEventListener("load",void 0);window.addEventListener("resize",function(){self.isIOS?setTimeout(self.resize,100):self.resize()});this.play();scenes.push(this)},writable:window.debug},initSystems:{value:function(){var name;this.initSystem("camera");for(name in systems$jscomp$0)"camera"!==name&&this.initSystem(name)}},
initSystem:{value:function(name){this.systems[name]||(this.systems[name]=new systems$jscomp$0[name](this),this.systemNames.push(name))}},detachedCallback:{value:function(){var sceneIndex=scenes.indexOf(this);scenes.splice(sceneIndex,1);window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound);window.removeEventListener("vrdisplayactivate",this.enterVRBound);window.removeEventListener("vrdisplaydeactivate",this.exitVRBound);window.removeEventListener("vrdisplayconnect",this.enterVRBound);
window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound);window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound);window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound);window.removeEventListener("sessionend",this.resize)}},addBehavior:{value:function(behavior){var behaviorArr=this.behaviors;for(var behaviorType in behaviorArr)behavior[behaviorType]&&(behaviorArr=this.behaviors[behaviorType],-1===behaviorArr.indexOf(behavior)&&
behaviorArr.push(behavior))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:utils.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){if(!this.hasWebXR)throw Error("Failed to enter AR mode, WebXR not supported.");if(!utils.device.checkARSupport())throw Error("Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.");return this.enterVR(!0)}},enterVR:{value:function(useAR){function enterVRSuccess(resolve){if(window.hasNativeWebVRImplementation&&
!window.hasNativeWebXRImplementation){var event=new CustomEvent("vrdisplaypresentchange",{detail:{display:utils.device.getVRDisplay()}});window.dispatchEvent(event)}self.emit("enter-vr",{target:self});!isWebXRAvailable&&self.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape");self.addFullScreenStyles();self.isMobile||self.checkHeadsetConnected()||(event=self.canvas,(event.requestFullscreen||event.webkitRequestFullscreen||event.mozRequestFullScreen||event.msRequestFullscreen).apply(event,
[{navigationUI:"hide"}]));self.renderer.setAnimationLoop(self.render);self.resize();resolve&&resolve()}function enterVRFailure(err){self.removeState("vr-mode");if(err&&err.message)throw Error("Failed to enter VR mode (`requestPresent`): "+err.message);throw Error("Failed to enter VR mode (`requestPresent`).");}var self=this,vrManager=self.renderer.xr;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){vrManager.enabled=!0;if(this.hasWebXR){this.xrSession&&
this.xrSession.removeEventListener("end",this.exitVRBound);vrManager.setReferenceSpaceType(this.sceneEl.systems.webxr.sessionReferenceSpaceType);var xrMode=useAR?"immersive-ar":"immersive-vr";var xrInit=this.sceneEl.systems.webxr.sessionConfiguration;return new Promise(function(resolve,reject){navigator.xr.requestSession(xrMode,xrInit).then(function(xrSession){self.xrSession=xrSession;vrManager.layersEnabled=-1!==xrInit.requiredFeatures.indexOf("layers");vrManager.setSession(xrSession);xrSession.addEventListener("end",
self.exitVRBound);useAR?self.addState("ar-mode"):self.addState("vr-mode");enterVRSuccess(resolve)},function(error){throw Error("Failed to enter "+("immersive-ar"===xrMode?"AR":"VR")+" mode (`requestSession`) "+error);})})}var vrDisplay=utils.device.getVRDisplay();self.addState("vr-mode");vrManager.setDevice(vrDisplay);if(vrDisplay.isPresenting&&!window.hasNativeWebVRImplementation)return enterVRSuccess(),Promise.resolve();var rendererSystem=this.getAttribute("renderer");return vrDisplay.requestPresent([{source:this.canvas,
attributes:{highRefreshRate:rendererSystem.highRefreshRate,foveationLevel:rendererSystem.foveationLevel}}]).then(enterVRSuccess,enterVRFailure)}enterVRSuccess();return Promise.resolve()},writable:!0},exitVR:{value:function(){function exitVRSuccess(){self.removeState("vr-mode");self.removeState("ar-mode");self.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();self.hasAttribute("embedded")&&self.removeFullScreenStyles();self.resize();self.isIOS&&utils.forceCanvasResizeSafariMobile(self.canvas);
self.renderer.setPixelRatio(window.devicePixelRatio);self.emit("exit-vr",{target:self})}function exitVRFailure(err){if(err&&err.message)throw Error("Failed to exit VR mode (`exitPresent`): "+err.message);throw Error("Failed to exit VR mode (`exitPresent`).");}var self=this,vrManager=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){vrManager.enabled=!1;var vrDisplay=utils.device.getVRDisplay();
if(this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,vrManager.setSession(null);else if(vrDisplay.isPresenting)return vrDisplay.exitPresent().then(exitVRSuccess,exitVRFailure)}else if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&
document.webkitExitFullscreen();exitVRSuccess();return Promise.resolve()},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var pointerLockElement=this.getPointerLockElement();pointerLockElement&&pointerLockElement!==this.canvas&&document.exitPointerLock&&document.exitPointerLock();this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var pointerLockElement=this.getPointerLockElement();pointerLockElement&&pointerLockElement===this.canvas&&
document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(evt){(evt=evt.display||evt.detail.display)&&evt.isPresenting?this.enterVR():this.exitVR()}},getAttribute:{value:function(attr){var system=this.systems[attr];return system?system.data:AEntity.prototype.getAttribute.call(this,attr)}},getComputedAttribute:{value:function(attr){warn("`getComputedAttribute` is deprecated. Use `getAttribute` instead.");this.getAttribute(attr)}},getDOMAttribute:{value:function(attr){var system=
this.systems[attr];return system?system.data:AEntity.prototype.getDOMAttribute.call(this,attr)}},setAttribute:{value:function(attr,value,componentPropValue){var system=this.systems[attr];system?(ANode.prototype.setAttribute.call(this,attr,value),system.updateProperties(value)):AEntity.prototype.setAttribute.call(this,attr,value,componentPropValue)}},removeBehavior:{value:function(behavior){var behaviorType;var behaviorArr=this.behaviors;for(behaviorType in behaviorArr)if(behavior[behaviorType]){behaviorArr=
this.behaviors[behaviorType];var index=behaviorArr.indexOf(behavior);-1!==index&&behaviorArr.splice(index,1)}}},resize:{value:function(){var camera=this.camera,canvas=this.canvas;var embedded=this.renderer.xr.isPresenting;embedded=this.renderer.xr.enabled&&embedded;!camera||!canvas||this.is("vr-mode")&&(this.isMobile||embedded)||(embedded=this.getAttribute("embedded")&&!this.is("vr-mode"),canvas=getCanvasSize(canvas,embedded,this.maxCanvasSize,this.is("vr-mode")),camera.aspect=canvas.width/canvas.height,
camera.updateProjectionMatrix(),this.renderer.setSize(canvas.width,canvas.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var self=this;var rendererConfig={alpha:!0,antialias:!isMobile,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"};this.maxCanvasSize={height:1920,width:1920};if(this.hasAttribute("renderer")){var rendererAttr=this.getAttribute("renderer");rendererAttr=utils.styleParser.parse(rendererAttr);rendererAttr.precision&&
(rendererConfig.precision=rendererAttr.precision+"p");rendererAttr.antialias&&"auto"!==rendererAttr.antialias&&(rendererConfig.antialias="true"===rendererAttr.antialias);rendererAttr.logarithmicDepthBuffer&&"auto"!==rendererAttr.logarithmicDepthBuffer&&(rendererConfig.logarithmicDepthBuffer="true"===rendererAttr.logarithmicDepthBuffer);rendererAttr.alpha&&(rendererConfig.alpha="true"===rendererAttr.alpha);this.maxCanvasSize={width:rendererAttr.maxCanvasWidth?parseInt(rendererAttr.maxCanvasWidth):
this.maxCanvasSize.width,height:rendererAttr.maxCanvasHeight?parseInt(rendererAttr.maxCanvasHeight):this.maxCanvasSize.height}}var renderer=this.renderer=new THREE.WebGLRenderer(rendererConfig);renderer.setPixelRatio(window.devicePixelRatio);renderer.sortObjects=!1;this.camera&&renderer.xr.setPoseTarget(this.camera.el.object3D);this.addEventListener("camera-set-active",function(){renderer.xr.setPoseTarget(self.camera.el.object3D)})},writable:window.debug},play:{value:function(){var self=this,sceneEl=
this;this.renderStarted?AEntity.prototype.play.call(this):(this.addEventListener("loaded",function(){var renderer=this.renderer,vrDisplay,vrManager=this.renderer.xr;AEntity.prototype.play.call(this);sceneEl.renderStarted||(sceneEl.resize(),sceneEl.renderer&&(window.performance&&window.performance.mark("render-started"),loadingScreen.remove(),(vrDisplay=utils.device.getVRDisplay())&&vrDisplay.isPresenting&&(vrManager.setDevice(vrDisplay),vrManager.enabled=!0,sceneEl.enterVR()),renderer.setAnimationLoop(this.render),
sceneEl.renderStarted=!0,sceneEl.emit("renderstart")))}),setTimeout(function(){AEntity.prototype.load.call(self)}))}},updateComponent:{value:function(componentName){componentName in systems$jscomp$0||AEntity.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(time,timeDelta){var i,systems=this.systems;for(i=0;i<this.behaviors.tick.length;i++)this.behaviors.tick[i].el.isPlaying&&this.behaviors.tick[i].tick(time,timeDelta);for(i=0;i<this.systemNames.length;i++)systems[this.systemNames[i]].tick&&
systems[this.systemNames[i]].tick(time,timeDelta)}},tock:{value:function(time,timeDelta,camera){var i,systems=this.systems;for(i=0;i<this.behaviors.tock.length;i++)this.behaviors.tock[i].el.isPlaying&&this.behaviors.tock[i].tock(time,timeDelta,camera);for(i=0;i<this.systemNames.length;i++)systems[this.systemNames[i]].tock&&systems[this.systemNames[i]].tock(time,timeDelta,camera)}},render:{value:function(time,frame){time=this.renderer;this.frame=frame;this.delta=1E3*this.clock.getDelta();this.time=
1E3*this.clock.elapsedTime;this.isPlaying&&this.tick(this.time,this.delta);frame=null;this.is("ar-mode")&&(frame=this.object3D.background,this.object3D.background=null);time.render(this.object3D,this.camera);frame&&(this.object3D.background=frame)},writable:!0}})});module.exports.setupCanvas=setupCanvas},{"../../lib/three":178,"../../utils/":204,"../../utils/ios-orientationchange-blank-bug":205,"../a-entity":126,"../a-node":128,"../a-register-element":129,"../system":141,"./loadingScreen":134,"./metaTags":135,
"./postMessage":136,"./scenes":137,"./wakelock":138}],134:[function(_dereq_,module,exports){function resize(camera){var embedded=sceneEl.hasAttribute("embedded");embedded=getSceneCanvasSize(sceneEl.canvas,embedded,sceneEl.maxCanvasSize,sceneEl.is("vr-mode"));camera.aspect=embedded.width/embedded.height;camera.updateProjectionMatrix();sceneEl.renderer.setSize(embedded.width,embedded.height,!1)}var styleParser=_dereq_("../../utils/").styleParser,sceneEl,titleEl,getSceneCanvasSize;module.exports.setup=
function(el,getCanvasSize){sceneEl=el;getSceneCanvasSize=getCanvasSize;var loaderAttribute=sceneEl.hasAttribute("loading-screen")?styleParser.parse(sceneEl.getAttribute("loading-screen")):void 0;getCanvasSize=loaderAttribute&&loaderAttribute.dotsColor||"white";el=loaderAttribute&&loaderAttribute.backgroundColor||"#24CAFF";if(void 0===loaderAttribute||"true"===loaderAttribute.enabled||void 0===loaderAttribute.enabled){var loaderScene=new THREE.Scene;loaderAttribute=new THREE.SphereGeometry(.2,36,18,
0,2*Math.PI,0,Math.PI);getCanvasSize=new THREE.MeshBasicMaterial({color:getCanvasSize});var sphereMesh1=new THREE.Mesh(loaderAttribute,getCanvasSize);var sphereMesh2=sphereMesh1.clone();var sphereMesh3=sphereMesh1.clone();var camera=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5E-4,1E4);var clock=new THREE.Clock;var time=0;var render=function(){sceneEl.renderer.render(loaderScene,camera);time=clock.getElapsedTime()%4;sphereMesh1.visible=1<=time;sphereMesh2.visible=2<=time;sphereMesh3.visible=
3<=time};loaderScene.background=new THREE.Color(el);loaderScene.add(camera);sphereMesh1.position.set(-1,0,-15);sphereMesh2.position.set(0,0,-15);sphereMesh3.position.set(1,0,-15);camera.add(sphereMesh1);camera.add(sphereMesh2);camera.add(sphereMesh3);titleEl=document.createElement("div");titleEl.className="a-loader-title";titleEl.innerHTML=document.title;titleEl.style.display="none";sceneEl.appendChild(titleEl);setTimeout(function(){sceneEl.hasLoaded||(resize(camera),titleEl.style.display="block",
window.addEventListener("resize",function(){resize(camera)}),sceneEl.renderer.setAnimationLoop(render))},200)}};module.exports.remove=function(){window.removeEventListener("resize",resize);titleEl&&(titleEl.style.display="none")}},{"../../utils/":204}],135:[function(_dereq_,module,exports){function Meta(attrs){return{tagName:"meta",attributes:attrs,exists:function(){return document.querySelector('meta[name\x3d"'+attrs.name+'"]')}}}var constants=_dereq_("../../constants/"),extend=_dereq_("../../utils").extend,
MOBILE_HEAD_TAGS=module.exports.MOBILE_HEAD_TAGS=[Meta({name:"viewport",content:"width\x3ddevice-width,initial-scale\x3d1,maximum-scale\x3d1,shrink-to-fit\x3dno,user-scalable\x3dno,minimal-ui,viewport-fit\x3dcover"}),Meta({name:"mobile-web-app-capable",content:"yes"}),Meta({name:"theme-color",content:"black"})],MOBILE_IOS_HEAD_TAGS=[Meta({name:"apple-mobile-web-app-capable",content:"yes"}),Meta({name:"apple-mobile-web-app-status-bar-style",content:"black"}),function(attrs){return{tagName:"link",attributes:attrs,
exists:function(){return document.querySelector('link[rel\x3d"'+attrs.rel+'"]')}}}({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];module.exports.inject=function(scene){function createAndInjectTag(tagObj){if(tagObj&&!tagObj.exists()){if(tagObj&&tagObj.tagName){var meta=document.createElement(tagObj.tagName);meta.setAttribute(constants.AFRAME_INJECTED,"");tag=extend(meta,tagObj.attributes)}else tag=void 0;tag&&(headScriptEl?headScriptEl.parentNode.insertBefore(tag,headScriptEl):
headEl.appendChild(tag),headTags.push(tag))}}var headEl=document.head,headScriptEl=headEl.querySelector("script"),tag,headTags=[];MOBILE_HEAD_TAGS.forEach(createAndInjectTag);scene.isIOS&&MOBILE_IOS_HEAD_TAGS.forEach(createAndInjectTag);return headTags}},{"../../constants/":122,"../../utils":204}],136:[function(_dereq_,module,exports){function postMessageAPIHandler(event){if(event.data)switch(event.data.type){case "vr":switch(event.data.data){case "enter":this.enterVR();break;case "exit":this.exitVR()}}}
var bind=_dereq_("../../utils/bind"),isIframed=_dereq_("../../utils/").isIframed;module.exports=function(scene){isIframed()&&window.addEventListener("message",bind(postMessageAPIHandler,scene))}},{"../../utils/":204,"../../utils/bind":198}],137:[function(_dereq_,module,exports){module.exports=[]},{}],138:[function(_dereq_,module,exports){var Wakelock=_dereq_("../../../vendor/wakelock/wakelock");module.exports=function(scene){if(scene.isMobile){var wakelock=scene.wakelock=new Wakelock;scene.addEventListener("enter-vr",
function(){wakelock.request()});scene.addEventListener("exit-vr",function(){wakelock.release()})}}},{"../../../vendor/wakelock/wakelock":219}],139:[function(_dereq_,module,exports){function isSingleProperty(schema){return"type"in schema?"string"===typeof schema.type:"default"in schema}function processPropertyDefinition(propDefinition,componentName){var defaultVal=propDefinition.default,propType,typeName=propDefinition.type;propDefinition.type?"bool"===propDefinition.type?typeName="boolean":"float"===
propDefinition.type&&(typeName="number"):typeName=void 0===defaultVal||"boolean"!==typeof defaultVal&&"number"!==typeof defaultVal?Array.isArray(defaultVal)?"array":"string":typeof defaultVal;(propType=propertyTypes[typeName])||warn("Unknown property type for component `"+componentName+"`: "+typeName);var isCustomType=!!propDefinition.parse;propDefinition.parse=propDefinition.parse||propType.parse;propDefinition.stringify=propDefinition.stringify||propType.stringify;propDefinition.type=typeName;"default"in
propDefinition?isCustomType||isValidDefaultValue(typeName,defaultVal)||warn("Default value `"+defaultVal+"` does not match type `"+typeName+"` in component `"+componentName+"`"):propDefinition.default=propType.default;return propDefinition}function parseProperty(value,propDefinition){if(void 0===value||null===value||""===value)value=propDefinition.default,Array.isArray(value)&&(value=value.slice());return propDefinition.parse(value,propDefinition.default)}function stringifyProperty(value,propDefinition){return"object"!==
typeof value?value:propDefinition&&null!==value?propDefinition.stringify(value):JSON.stringify(value)}exports=_dereq_("../utils/");_dereq_=_dereq_("./propertyTypes");exports=exports.debug;var isValidDefaultValue=_dereq_.isValidDefaultValue,propertyTypes=_dereq_.propertyTypes,warn=exports("core:schema:warn");module.exports.isSingleProperty=isSingleProperty;module.exports.process=function(schema,componentName){var propName;if(isSingleProperty(schema))return processPropertyDefinition(schema,componentName);
for(propName in schema)schema[propName]=processPropertyDefinition(schema[propName],componentName);return schema};module.exports.processPropertyDefinition=processPropertyDefinition;module.exports.parseProperties=function(){var propNames=[];return function(propData,schema,getPartialData,componentName,silent){propNames.length=0;for(propName in getPartialData?propData:schema)getPartialData&&void 0===propData[propName]||propNames.push(propName);if(null===propData||"object"!==typeof propData)return propData;
for(propName in propData)void 0===propData[propName]||schema[propName]||silent||warn("Unknown property `"+propName+"` for component/system `"+componentName+"`.");for(getPartialData=0;getPartialData<propNames.length;getPartialData++){var propName=propNames[getPartialData];componentName=schema[propName];silent=propData[propName];if(!schema[propName])return;propData[propName]=parseProperty(silent,componentName)}return propData}}();module.exports.parseProperty=parseProperty;module.exports.stringifyProperties=
function(propData,schema){var propName,propValue,stringifiedData={};for(propName in propData){var propDefinition=schema[propName];var value=propValue=propData[propName];"object"===typeof value&&(value=stringifyProperty(propValue,propDefinition),propDefinition||warn("Unknown component property: "+propName));stringifiedData[propName]=value}return stringifiedData};module.exports.stringifyProperty=stringifyProperty},{"../utils/":204,"./propertyTypes":132}],140:[function(_dereq_,module,exports){var processSchema=
_dereq_("./schema").process,shaders=module.exports.shaders={},shaderNames=module.exports.shaderNames=[],THREE=_dereq_("../lib/three"),utils=_dereq_("../utils"),propertyToThreeMapping={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},Shader=module.exports.Shader=function(){};Shader.prototype={schema:{},vertexShader:"void main() {gl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);}",
init:function(data){this.attributes=this.initVariables(data,"attribute");this.uniforms=this.initVariables(data,"uniform");return this.material=new (this.raw?THREE.RawShaderMaterial:THREE.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})},initVariables:function(data,type){var key;data=this.schema;var variables={};for(key in data)if(data[key].is===type){var varType=propertyToThreeMapping[data[key].type];variables[key]={type:varType,value:void 0}}return variables},
update:function(data){this.updateVariables(data,"attribute");this.updateVariables(data,"uniform")},updateVariables:function(data,type){var key,schema=this.schema;var variables="uniform"===type?this.uniforms:this.attributes;for(key in data)if(schema[key]&&schema[key].is===type)if("map"===schema[key].type){if(variables[key]&&variables[key].value!==data[key]){var materialKey="_texture_"+key;this.setMapOnTextureLoad(variables,key,materialKey);utils.material.updateMapMaterialFromData(materialKey,key,this,
data)}}else variables[key].value=this.parseValue(schema[key].type,data[key]),variables[key].needsUpdate=!0},parseValue:function(type,value){switch(type){case "vec2":return new THREE.Vector2(value.x,value.y);case "vec3":return new THREE.Vector3(value.x,value.y,value.z);case "vec4":return new THREE.Vector4(value.x,value.y,value.z,value.w);case "color":return type=new THREE.Color(value),new THREE.Vector3(type.r,type.g,type.b);case "map":return THREE.ImageUtils.loadTexture(value);default:return value}},
setMapOnTextureLoad:function(variables,key,materialKey){var self=this;this.el.addEventListener("materialtextureloaded",function(){variables[key].value=self.material[materialKey];variables[key].needsUpdate=!0})}};module.exports.registerShader=function(name,definition){var proto={};Object.keys(definition).forEach(function(key){proto[key]={value:definition[key],writable:!0}});if(shaders[name])throw Error("The shader "+name+" has been already registered");var NewShader=function(){Shader.call(this)};NewShader.prototype=
Object.create(Shader.prototype,proto);NewShader.prototype.name=name;NewShader.prototype.constructor=NewShader;shaders[name]={Shader:NewShader,schema:processSchema(NewShader.prototype.schema)};shaderNames.push(name);return NewShader}},{"../lib/three":178,"../utils":204,"./schema":139}],141:[function(_dereq_,module,exports){var components=_dereq_("./component"),schema$jscomp$0=_dereq_("./schema"),utils=_dereq_("../utils/"),parseProperties=schema$jscomp$0.parseProperties,parseProperty=schema$jscomp$0.parseProperty,
processSchema=schema$jscomp$0.process,isSingleProp=schema$jscomp$0.isSingleProperty,styleParser=utils.styleParser,systems=module.exports.systems={},System=module.exports.System=function(sceneEl){var component=components&&components.components[this.name];this.sceneEl=this.el=sceneEl;component&&(component.Component.prototype.system=this);this.buildData();this.init();this.update({})};System.prototype={schema:{},init:function(){},update:function(oldData){},updateProperties:function(rawData){var oldData=
this.data;Object.keys(schema$jscomp$0).length&&(this.buildData(rawData),this.update(oldData))},buildData:function(rawData){var schema=this.schema;Object.keys(schema).length&&(rawData=rawData||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),isSingleProp(schema)?this.data=parseProperty(rawData,schema):this.data=parseProperties(styleParser.parse(rawData)||{},schema))},tick:void 0,tock:void 0,play:function(){},pause:function(){}};module.exports.registerSystem=function(name,definition){var proto=
{},scenes=utils.findAllScenes(document);Object.keys(definition).forEach(function(key){proto[key]={value:definition[key],writable:!0}});if(systems[name])throw Error("The system `"+name+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");var i=function(sceneEl){System.call(this,sceneEl)};i.prototype=Object.create(System.prototype,proto);i.prototype.name=name;i.prototype.constructor=i;i.prototype.schema=utils.extend(processSchema(i.prototype.schema));
systems[name]=i;for(i=0;i<scenes.length;i++)scenes[i].initSystem(name)}},{"../utils/":204,"./component":130,"./schema":139}],142:[function(_dereq_,module,exports){_dereq_("./pivot")},{"./pivot":143}],143:[function(_dereq_,module,exports){module=_dereq_("../../core/component").registerComponent;var THREE=_dereq_("../../lib/three"),originalPosition=new THREE.Vector3,originalRotation=new THREE.Vector3;module("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var data=this.data,el=
this.el,originalParent=el.object3D.parent,originalGroup=el.object3D,outerGroup=new THREE.Group;originalPosition.copy(originalGroup.position);originalRotation.copy(originalGroup.rotation);originalParent.remove(originalGroup);outerGroup.add(originalGroup);originalParent.add(outerGroup);el.object3D=outerGroup;originalGroup.position.set(-1*data.x,-1*data.y,-1*data.z);outerGroup.position.set(data.x+originalPosition.x,data.y+originalPosition.y,data.z+originalPosition.z);outerGroup.rotation.copy(originalGroup.rotation);
originalGroup.rotation.set(0,0,0)}})},{"../../core/component":130,"../../lib/three":178}],144:[function(_dereq_,module,exports){function addMapping(prop){var htmlAttrName=prop.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===prop&&(htmlAttrName="material-fog");"visible"===prop&&(htmlAttrName="material-visible");materialMappings[htmlAttrName]="material."+prop}exports=_dereq_("../../core/component").components;var shaders=_dereq_("../../core/shader").shaders,utils=_dereq_("../../utils/"),materialMappings=
{};Object.keys(exports.material.schema).forEach(addMapping);Object.keys(shaders.standard.schema).forEach(addMapping);module.exports=function(){return{defaultComponents:{material:{}},mappings:utils.extend({},materialMappings)}}},{"../../core/component":130,"../../core/shader":140,"../../utils/":204}],145:[function(_dereq_,module,exports){_dereq_("./primitives/a-camera");_dereq_("./primitives/a-cursor");_dereq_("./primitives/a-curvedimage");_dereq_("./primitives/a-gltf-model");_dereq_("./primitives/a-image");
_dereq_("./primitives/a-light");_dereq_("./primitives/a-link");_dereq_("./primitives/a-obj-model");_dereq_("./primitives/a-sky");_dereq_("./primitives/a-sound");_dereq_("./primitives/a-text");_dereq_("./primitives/a-video");_dereq_("./primitives/a-videosphere");_dereq_("./primitives/meshPrimitives")},{"./primitives/a-camera":147,"./primitives/a-cursor":148,"./primitives/a-curvedimage":149,"./primitives/a-gltf-model":150,"./primitives/a-image":151,"./primitives/a-light":152,"./primitives/a-link":153,
"./primitives/a-obj-model":154,"./primitives/a-sky":155,"./primitives/a-sound":156,"./primitives/a-text":157,"./primitives/a-video":158,"./primitives/a-videosphere":159,"./primitives/meshPrimitives":160}],146:[function(_dereq_,module,exports){function addComponentMapping(componentName,mappings){Object.keys(components[componentName].schema).map(function(prop){var attrName=prop.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==mappings[attrName]&&(attrName=componentName+"-"+prop);mappings[attrName]=
componentName+"."+prop})}var AEntity=_dereq_("../../core/a-entity"),components=_dereq_("../../core/component").components,registerElement=_dereq_("../../core/a-register-element").registerElement,utils=_dereq_("../../utils/");_dereq_=utils.debug;var setComponentProperty=utils.entity.setComponentProperty,log=_dereq_("extras:primitives:debug"),warn=_dereq_("extras:primitives:warn"),primitives=module.exports.primitives={};module.exports.registerPrimitive=function(name$jscomp$0,definition){name$jscomp$0=
name$jscomp$0.toLowerCase();log("Registering \x3c%s\x3e",name$jscomp$0);definition.defaultAttributes&&warn("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var primitive=registerElement(name$jscomp$0,{prototype:Object.create(AEntity.prototype,{defaultComponentsFromPrimitive:{value:definition.defaultComponents||definition.defaultAttributes||{}},deprecated:{value:definition.deprecated||null},deprecatedMappings:{value:definition.deprecatedMappings||{}},mappings:{value:definition.mappings||
{}},createdCallback:{value:function(){definition.deprecated&&console.warn(definition.deprecated);this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var mappings=this.mappings,self=this;Object.keys(mappings).forEach(function(key){key!==key.toLowerCase()&&warn("Mapping keys should be specified in lower case. The mapping key "+key+" may not be recognized");if(components[key]){var newAttribute=mappings[key].replace(".","-");mappings[newAttribute]=mappings[key];delete mappings[key];
console.warn("The primitive "+self.tagName.toLowerCase()+" has a mapping collision. The attribute "+key+" has the same name as a registered component and has been renamed to "+newAttribute)}})}},getExtraComponents:{value:function(){function copy(value){return null!==value&&value.constructor===Object?utils.extendDeep({},value):value}var attr,i,mapping,self=this;var data=utils.clone(this.defaultComponentsFromPrimitive);if(attr=this.getAttribute("mixin"))attr=attr.trim().split(" "),attr.forEach(function(mixinId){var mixinComponents=
self.sceneEl.querySelector("#"+mixinId).componentCache;Object.keys(mixinComponents).forEach(function(name){var JSCompiler_inline_result=data[name];var extension=mixinComponents[name];JSCompiler_inline_result="undefined"===typeof JSCompiler_inline_result?copy(extension):"undefined"===typeof extension?copy(JSCompiler_inline_result):null!==JSCompiler_inline_result&&JSCompiler_inline_result.constructor===Object&&null!==extension&&extension.constructor===Object?utils.extendDeep(JSCompiler_inline_result,
extension):copy(extension);data[name]=JSCompiler_inline_result})});for(i=0;i<this.attributes.length;i++)if(attr=this.attributes[i],mapping=this.mappings[attr.name])mapping=utils.entity.getComponentPropertyPath(mapping),mapping.constructor===Array?(data[mapping[0]]=data[mapping[0]]||{},data[mapping[0]][mapping[1]]=attr.value.trim()):data[mapping]=attr.value.trim();return data}},attributeChangedCallback:{value:function(attr,oldVal,value){oldVal=this.mappings[attr];attr in this.deprecatedMappings&&console.warn(this.deprecatedMappings[attr]);
attr&&oldVal&&setComponentProperty(this,oldVal,value)}}})});return primitives[name$jscomp$0]=primitive};module.exports.definePrimitive=function(tagName,defaultComponents,mappings){mappings=mappings||{};Object.keys(defaultComponents).map(function(componentName){addComponentMapping(componentName,mappings)});module.exports.registerPrimitive(tagName,utils.extendDeep({},null,{defaultComponents:defaultComponents,mappings:mappings}))}},{"../../core/a-entity":126,"../../core/a-register-element":129,"../../core/component":130,
"../../utils/":204}],147:[function(_dereq_,module,exports){_dereq_=_dereq_("../primitives").registerPrimitive;_dereq_("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",
zoom:"camera.zoom"}})},{"../primitives":146}],148:[function(_dereq_,module,exports){module=_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;_dereq_=_dereq_("../../../utils/");exports("a-cursor",_dereq_.extendDeep({},module(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",
interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],149:[function(_dereq_,module,exports){module=_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;_dereq_=_dereq_("../../../utils/");exports("a-curvedimage",_dereq_.extendDeep({},module(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",
side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],150:[function(_dereq_,module,exports){_dereq_=_dereq_("../primitives").registerPrimitive;_dereq_("a-gltf-model",{mappings:{src:"gltf-model"}})},
{"../primitives":146}],151:[function(_dereq_,module,exports){module=_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;_dereq_=_dereq_("../../../utils/");exports("a-image",_dereq_.extendDeep({},module(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],152:[function(_dereq_,module,
exports){_dereq_=_dereq_("../primitives").registerPrimitive;_dereq_("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":146}],153:[function(_dereq_,module,exports){_dereq_=_dereq_("../primitives").registerPrimitive;_dereq_("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},
mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":146}],154:[function(_dereq_,module,exports){module=_dereq_("../getMeshMixin")();exports=_dereq_("../primitives").registerPrimitive;_dereq_=_dereq_("../../../utils/");exports("a-obj-model",_dereq_.extendDeep({},module,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],155:[function(_dereq_,module,exports){module=
_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;var utils=_dereq_("../../../utils/");_dereq_=_dereq_("./meshPrimitives");exports("a-sky",utils.extendDeep({},module(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:utils.extendDeep({},_dereq_["a-sphere"].prototype.mappings)}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146,
"./meshPrimitives":160}],156:[function(_dereq_,module,exports){_dereq_=_dereq_("../primitives").registerPrimitive;_dereq_("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":146}],157:[function(_dereq_,module,exports){_dereq_=_dereq_("../primitives").definePrimitive;_dereq_("a-text",{text:{anchor:"align",width:5}})},{"../primitives":146}],158:[function(_dereq_,module,exports){module=
_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;_dereq_=_dereq_("../../../utils/");exports("a-video",_dereq_.extendDeep({},module(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],159:[function(_dereq_,module,exports){module=_dereq_("../getMeshMixin");exports=_dereq_("../primitives").registerPrimitive;
_dereq_=_dereq_("../../../utils/");exports("a-videosphere",_dereq_.extendDeep({},module(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],160:[function(_dereq_,module,exports){function unCamelCase(str){return str.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()}var getMeshMixin=_dereq_("../getMeshMixin"),geometries=_dereq_("../../../core/geometry").geometries;exports=_dereq_("../../../core/geometry").geometryNames;var registerPrimitive=_dereq_("../primitives").registerPrimitive,utils=_dereq_("../../../utils/"),meshPrimitives=module.exports={};exports.forEach(function(geometryName){var geometry=geometries[geometryName],geometryHyphened=unCamelCase(geometryName),mappings={};Object.keys(geometry.schema).forEach(function(property){mappings[unCamelCase(property)]=
"geometry."+property});geometry="a-"+geometryHyphened;geometryName=registerPrimitive(geometry,utils.extendDeep({},getMeshMixin(),{defaultComponents:{geometry:{primitive:geometryName}},mappings:mappings}));meshPrimitives[geometry]=geometryName})},{"../../../core/geometry":131,"../../../utils/":204,"../getMeshMixin":144,"../primitives":146}],161:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");module("box",{schema:{depth:{default:1,
min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(data){this.geometry=new THREE.BoxGeometry(data.width,data.height,data.depth,data.segmentsWidth,data.segmentsHeight,data.segmentsDepth)}})},{"../core/geometry":131,"../lib/three":178}],162:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=
_dereq_("../lib/three"),degToRad=THREE.Math.degToRad;module("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(data){this.geometry=new THREE.CircleGeometry(data.radius,data.segments,degToRad(data.thetaStart),degToRad(data.thetaLength))}})},{"../core/geometry":131,"../lib/three":178}],163:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three"),
degToRad=THREE.Math.degToRad;module("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(data){this.geometry=new THREE.CylinderGeometry(data.radiusTop,data.radiusBottom,data.height,data.segmentsRadial,data.segmentsHeight,data.openEnded,degToRad(data.thetaStart),degToRad(data.thetaLength))}})},
{"../core/geometry":131,"../lib/three":178}],164:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three"),degToRad=THREE.Math.degToRad;module("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(data){this.geometry=new THREE.CylinderGeometry(data.radius,
data.radius,data.height,data.segmentsRadial,data.segmentsHeight,data.openEnded,degToRad(data.thetaStart),degToRad(data.thetaLength))}})},{"../core/geometry":131,"../lib/three":178}],165:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");module("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(data){this.geometry=new THREE.DodecahedronGeometry(data.radius,data.detail)}})},{"../core/geometry":131,
"../lib/three":178}],166:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");module("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(data){this.geometry=new THREE.IcosahedronGeometry(data.radius,data.detail)}})},{"../core/geometry":131,"../lib/three":178}],167:[function(_dereq_,module,exports){_dereq_("./box.js");_dereq_("./circle.js");_dereq_("./cone.js");_dereq_("./cylinder.js");
_dereq_("./dodecahedron.js");_dereq_("./icosahedron.js");_dereq_("./octahedron.js");_dereq_("./plane.js");_dereq_("./ring.js");_dereq_("./sphere.js");_dereq_("./tetrahedron.js");_dereq_("./torus.js");_dereq_("./torusKnot.js");_dereq_("./triangle.js")},{"./box.js":161,"./circle.js":162,"./cone.js":163,"./cylinder.js":164,"./dodecahedron.js":165,"./icosahedron.js":166,"./octahedron.js":168,"./plane.js":169,"./ring.js":170,"./sphere.js":171,"./tetrahedron.js":172,"./torus.js":173,"./torusKnot.js":174,
"./triangle.js":175}],168:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");module("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(data){this.geometry=new THREE.OctahedronGeometry(data.radius,data.detail)}})},{"../core/geometry":131,"../lib/three":178}],169:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");
module("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(data){this.geometry=new THREE.PlaneGeometry(data.width,data.height,data.segmentsWidth,data.segmentsHeight)}})},{"../core/geometry":131,"../lib/three":178}],170:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three"),degToRad=THREE.Math.degToRad;module("ring",
{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(data){this.geometry=new THREE.RingGeometry(data.radiusInner,data.radiusOuter,data.segmentsTheta,data.segmentsPhi,degToRad(data.thetaStart),degToRad(data.thetaLength))}})},{"../core/geometry":131,"../lib/three":178}],171:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;
var THREE=_dereq_("../lib/three"),degToRad=THREE.Math.degToRad;module("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(data){this.geometry=new THREE.SphereGeometry(data.radius,data.segmentsWidth,data.segmentsHeight,degToRad(data.phiStart),degToRad(data.phiLength),degToRad(data.thetaStart),degToRad(data.thetaLength))}})},
{"../core/geometry":131,"../lib/three":178}],172:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=_dereq_("../lib/three");module("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(data){this.geometry=new THREE.TetrahedronGeometry(data.radius,data.detail)}})},{"../core/geometry":131,"../lib/three":178}],173:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;var THREE=
_dereq_("../lib/three"),degToRad=THREE.Math.degToRad;module("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(data){this.geometry=new THREE.TorusGeometry(data.radius,2*data.radiusTubular,data.segmentsRadial,data.segmentsTubular,degToRad(data.arc))}})},{"../core/geometry":131,"../lib/three":178}],174:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;
var THREE=_dereq_("../lib/three");module("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(data){this.geometry=new THREE.TorusKnotGeometry(data.radius,2*data.radiusTubular,data.segmentsTubular,data.segmentsRadial,data.p,data.q)}})},{"../core/geometry":131,"../lib/three":178}],175:[function(_dereq_,module,exports){module=_dereq_("../core/geometry").registerGeometry;
var THREE=_dereq_("../lib/three"),quaternion=new THREE.Quaternion,rotateVector=new THREE.Vector3(0,0,1),uvMinVector=new THREE.Vector2,uvMaxVector=new THREE.Vector2,uvScaleVector=new THREE.Vector2;module("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(data){var triangle=new THREE.Triangle;triangle.a.set(data.vertexA.x,data.vertexA.y,data.vertexA.z);triangle.b.set(data.vertexB.x,
data.vertexB.y,data.vertexB.z);triangle.c.set(data.vertexC.x,data.vertexC.y,data.vertexC.z);var normal=triangle.getNormal(new THREE.Vector3);quaternion.setFromUnitVectors(normal,rotateVector);var uvA=triangle.a.clone().applyQuaternion(quaternion);var uvB=triangle.b.clone().applyQuaternion(quaternion);var uvC=triangle.c.clone().applyQuaternion(quaternion);uvMinVector.set(Math.min(uvA.x,uvB.x,uvC.x),Math.min(uvA.y,uvB.y,uvC.y));uvMaxVector.set(Math.max(uvA.x,uvB.x,uvC.x),Math.max(uvA.y,uvB.y,uvC.y));
uvScaleVector.set(0,0).subVectors(uvMaxVector,uvMinVector);uvA=(new THREE.Vector2).subVectors(uvA,uvMinVector).divide(uvScaleVector);uvB=(new THREE.Vector2).subVectors(uvB,uvMinVector).divide(uvScaleVector);uvC=(new THREE.Vector2).subVectors(uvC,uvMinVector).divide(uvScaleVector);data=this.geometry=new THREE.Geometry;data.vertices.push(triangle.a);data.vertices.push(triangle.b);data.vertices.push(triangle.c);data.faces.push(new THREE.Face3(0,1,2,normal));data.faceVertexUvs[0]=[[uvA,uvB,uvC]]}})},
{"../core/geometry":131,"../lib/three":178}],176:[function(_dereq_,module,exports){window.Promise=window.Promise||_dereq_("promise-polyfill");window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices;window.hasNativeWebXRImplementation=void 0!==navigator.xr;if(!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){exports=_dereq_("./utils/isIOSOlderThan10")(window.navigator.userAgent)?1/window.devicePixelRatio:1;var WebVRPolyfill=_dereq_("webvr-polyfill");
window.webvrpolyfill=new WebVRPolyfill({BUFFER_SCALE:exports,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova})}exports=_dereq_("./utils/");var debug=exports.debug;exports.isIE11&&(_dereq_("custom-event-polyfill"),_dereq_("../vendor/starts-with-polyfill"));WebVRPolyfill=debug("A-Frame:error");debug=debug("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&debug("Put the A-Frame \x3cscript\x3e tag in the \x3chead\x3e of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML.");
window.cordova||"file:"!==window.location.protocol||WebVRPolyfill("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server.");_dereq_("present");exports.device.isBrowserEnvironment&&(_dereq_("./style/aframe.css"),_dereq_("./style/rStats.css"));WebVRPolyfill=_dereq_("./core/scene/a-scene").AScene;debug=
_dereq_("./core/component").components;var registerComponent=_dereq_("./core/component").registerComponent,registerGeometry=_dereq_("./core/geometry").registerGeometry,registerPrimitive=_dereq_("./extras/primitives/primitives").registerPrimitive,registerShader=_dereq_("./core/shader").registerShader,registerSystem=_dereq_("./core/system").registerSystem,shaders=_dereq_("./core/shader").shaders,systems=_dereq_("./core/system").systems,THREE=window.THREE=_dereq_("./lib/three"),pkg=_dereq_("../package");
_dereq_("./components/index");_dereq_("./geometries/index");_dereq_("./shaders/index");_dereq_("./systems/index");var ANode=_dereq_("./core/a-node"),AEntity=_dereq_("./core/a-entity");_dereq_("./core/a-assets");_dereq_("./core/a-cubemap");_dereq_("./core/a-mixin");_dereq_("./extras/components/");_dereq_("./extras/primitives/");console.log("A-Frame Version: 1.1.0 (Date 2020-12-03, Commit #8aefd214)");console.log("THREE Version (https://github.com/supermedium/three.js):",pkg.dependencies["super-three"]);
console.log("WebVR Polyfill Version:",pkg.dependencies["webvr-polyfill"]);module.exports=window.AFRAME={AComponent:_dereq_("./core/component").Component,AEntity:AEntity,ANode:ANode,ANIME:_dereq_("super-animejs"),AScene:WebVRPolyfill,components:debug,coreComponents:Object.keys(debug),geometries:_dereq_("./core/geometry").geometries,registerComponent:registerComponent,registerElement:_dereq_("./core/a-register-element").registerElement,registerGeometry:registerGeometry,registerPrimitive:registerPrimitive,
registerShader:registerShader,registerSystem:registerSystem,primitives:{getMeshMixin:_dereq_("./extras/primitives/getMeshMixin"),primitives:_dereq_("./extras/primitives/primitives").primitives},scenes:_dereq_("./core/scene/scenes"),schema:_dereq_("./core/schema"),shaders:shaders,systems:systems,THREE:THREE,utils:exports,version:pkg.version}},{"../package":72,"../vendor/starts-with-polyfill":217,"./components/index":83,"./core/a-assets":124,"./core/a-cubemap":125,"./core/a-entity":126,"./core/a-mixin":127,
"./core/a-node":128,"./core/a-register-element":129,"./core/component":130,"./core/geometry":131,"./core/scene/a-scene":133,"./core/scene/scenes":137,"./core/schema":139,"./core/shader":140,"./core/system":141,"./extras/components/":142,"./extras/primitives/":145,"./extras/primitives/getMeshMixin":144,"./extras/primitives/primitives":146,"./geometries/index":167,"./lib/three":178,"./shaders/index":180,"./style/aframe.css":185,"./style/rStats.css":186,"./systems/index":190,"./utils/":204,"./utils/isIOSOlderThan10":207,
"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":67}],177:[function(_dereq_,module,exports){window.aframeStats=function(scene){function getEntityCount(){var elements=_scene.querySelectorAll("*");Array.prototype.slice.call(elements).filter(function(el){return el.isEntity});return elements.length}var _rS=null,_scene=scene;return{update:function(){_rS("te").set(getEntityCount());window.performance.getEntriesByName&&_rS("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))},
start:function(){},end:function(){},attach:function(r){_rS=r},values:{te:{caption:"Entities"},lt:{caption:"Load Time"}},groups:[{caption:"A-Frame",values:["te","lt"]}],fractions:[]}};"object"===typeof module&&(module.exports={aframeStats:window.aframeStats})},{}],178:[function(_dereq_,module,exports){exports=("undefined"!==typeof global$jscomp$1?global$jscomp$1:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{}).THREE=_dereq_("super-three");exports.TextureLoader&&(exports.TextureLoader.prototype.crossOrigin=
"anonymous");exports.ImageLoader&&(exports.ImageLoader.prototype.crossOrigin="anonymous");exports.Cache&&(exports.Cache.enabled=!0);_dereq_("../../vendor/DeviceOrientationControls");_dereq_("super-three/examples/js/loaders/DRACOLoader");_dereq_("super-three/examples/js/loaders/GLTFLoader");_dereq_("super-three/examples/js/loaders/OBJLoader");_dereq_("super-three/examples/js/loaders/MTLLoader");exports.DRACOLoader.prototype.crossOrigin="anonymous";exports.GLTFLoader.prototype.crossOrigin="anonymous";
exports.MTLLoader.prototype.crossOrigin="anonymous";exports.OBJLoader.prototype.crossOrigin="anonymous";module.exports=exports},{"../../vendor/DeviceOrientationControls":214,"super-three":57,"super-three/examples/js/loaders/DRACOLoader":58,"super-three/examples/js/loaders/GLTFLoader":59,"super-three/examples/js/loaders/MTLLoader":60,"super-three/examples/js/loaders/OBJLoader":61}],179:[function(_dereq_,module,exports){function getMaterialData(data,materialData){materialData.color.set(data.color);
materialData.fog=data.fog;materialData.wireframe=data.wireframe;materialData.wireframeLinewidth=data.wireframeLinewidth;return materialData}exports=_dereq_("../core/shader").registerShader;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/");module.exports.Shader=exports("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},
init:function(data){this.rendererSystem=this.el.sceneEl.systems.renderer;this.materialData={color:new THREE.Color};this.textureSrc=null;getMaterialData(data,this.materialData);this.rendererSystem.applyColorCorrection(this.materialData.color);this.material=new THREE.MeshBasicMaterial(this.materialData);utils.material.updateMap(this,data)},update:function(data){this.updateMaterial(data);utils.material.updateMap(this,data)},updateMaterial:function(data){var key;getMaterialData(data,this.materialData);
this.rendererSystem.applyColorCorrection(this.materialData.color);for(key in this.materialData)this.material[key]=this.materialData[key]}})},{"../core/shader":140,"../lib/three":178,"../utils/":204}],180:[function(_dereq_,module,exports){_dereq_("./flat");_dereq_("./standard");_dereq_("./sdf");_dereq_("./msdf");_dereq_("./ios10hls")},{"./flat":179,"./ios10hls":181,"./msdf":182,"./sdf":183,"./standard":184}],181:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/shader").registerShader;module.exports.Shader=
_dereq_("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:"varying vec2 vUV;\nvoid main(void) {\n  gl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV \x3d uv;\n}",fragmentShader:"uniform sampler2D src;\nuniform float opacity;\nvarying vec2 vUV;\nvoid main() {\n  vec2 offset \x3d vec2(0, 0);\n  vec2 repeat \x3d vec2(1, 1);\n  vec4 color \x3d texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;\n  gl_FragColor \x3d vec4(color.rgb, opacity);\n}"})},
{"../core/shader":140}],182:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/shader").registerShader;exports=!!document.createElement("canvas").getContext("webgl2");module.exports.Shader=_dereq_("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:exports?"#version 300 es\nin vec2 uv;\nin vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nout vec2 vUV;\nvoid main(void) {\n  gl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV \x3d uv;\n}":
"attribute vec2 uv;\nattribute vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nvarying vec2 vUV;\nvoid main(void) {\n  gl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV \x3d uv;\n}",fragmentShader:exports?"#version 300 es\nprecision highp float;\nuniform bool negate;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nin vec2 vUV;\nout vec4 fragColor;\nfloat median(float r, float g, float b) {\n  return max(min(r, g), min(max(r, g), b));\n}\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\nvoid main() {\n  vec3 sampleColor \x3d texture(map, vUV).rgb;\n  if (negate) { sampleColor \x3d 1.0 - sampleColor; }\n  float sigDist \x3d median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n  float alpha \x3d clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n  float dscale \x3d 0.353505;\n  vec2 duv \x3d dscale * (dFdx(vUV) + dFdy(vUV));\n  float isBigEnough \x3d max(abs(duv.x), abs(duv.y));\n  // Do modified alpha test.\n  if (isBigEnough \x3e BIG_ENOUGH) {\n    float ratio \x3d BIG_ENOUGH / isBigEnough;\n    alpha \x3d ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n  }\n  // Do modified alpha test.\n  if (alpha \x3c alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  fragColor \x3d vec4(color.xyz, alpha * opacity);\n}":
"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives: enable\n#endif\nprecision highp float;\nuniform bool negate;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nvarying vec2 vUV;\nfloat median(float r, float g, float b) {\n  return max(min(r, g), min(max(r, g), b));\n}\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\nvoid main() {\n  vec3 sampleColor \x3d texture2D(map, vUV).rgb;\n  if (negate) { sampleColor \x3d 1.0 - sampleColor; }\n  float sigDist \x3d median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n  float alpha \x3d clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n  float dscale \x3d 0.353505;\n  vec2 duv \x3d dscale * (dFdx(vUV) + dFdy(vUV));\n  float isBigEnough \x3d max(abs(duv.x), abs(duv.y));\n  // Do modified alpha test.\n  if (isBigEnough \x3e BIG_ENOUGH) {\n    float ratio \x3d BIG_ENOUGH / isBigEnough;\n    alpha \x3d ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n  }\n  // Do modified alpha test.\n  if (alpha \x3c alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  gl_FragColor \x3d vec4(color.xyz, alpha * opacity);\n}"})},
{"../core/shader":140}],183:[function(_dereq_,module,exports){_dereq_=_dereq_("../core/shader").registerShader;module.exports.Shader=_dereq_("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:"#version 300 es\nin vec2 uv;\nin vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nout vec2 vUV;\nvoid main(void) {\n  gl_Position \x3d projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV \x3d uv;\n}",
fragmentShader:"#version 300 es\nprecision highp float;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nin vec2 vUV;\nout vec4 fragColor;\n#ifdef GL_OES_standard_derivatives\n  float contour(float width, float value) {\n    return smoothstep(0.5 - value, 0.5 + value, width);\n  }\n#else\n  float aastep(float value, float afwidth) {\n    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);\n  }\n#endif\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\n#define ALL_SMOOTH 0.4\n#define ALL_ROUGH 0.02\n#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))\nvoid main() {\n  #ifdef GL_OES_standard_derivatives\n    vec2 uv \x3d vUV;\n    vec4 texColor \x3d texture(map, uv);\n    float dist \x3d texColor.a;\n    float width \x3d fwidth(dist);\n    float alpha \x3d contour(dist, width);\n    float dscale \x3d 0.353505;\n    vec2 duv \x3d dscale * (dFdx(uv) + dFdy(uv));\n    float isBigEnough \x3d max(abs(duv.x), abs(duv.y));\n    if (isBigEnough \x3e BIG_ENOUGH) {\n      float ratio \x3d BIG_ENOUGH / isBigEnough;\n      alpha \x3d ratio * alpha + (1.0 - ratio) * dist;\n    }\n    if (isBigEnough \x3c\x3d BIG_ENOUGH) {\n      vec4 box \x3d vec4 (uv - duv, uv + duv);\n      alpha \x3d (alpha + 0.5 * (\n        contour(texture(map, box.xy).a, width)\n        + contour(texture(map, box.zw).a, width)\n        + contour(texture(map, box.xw).a, width)\n        + contour(texture(map, box.zy).a, width)\n      )) / 3.0;\n    }\n    if (alpha \x3c alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  #else\n    vec4 texColor \x3d texture(map, vUV);\n    float value \x3d texColor.a;\n    float afwidth \x3d (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));\n    float alpha \x3d aastep(value, afwidth);\n    float ratio \x3d (gl_FragCoord.w \x3e\x3d ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w \x3c ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);\n    if (alpha \x3c alphaTest) { if (ratio \x3e\x3d 1.0) { discard; return; } alpha \x3d 0.0; }\n    alpha \x3d alpha * ratio + (1.0 - ratio) * value;\n    if (ratio \x3c 1.0 \x26\x26 alpha \x3c\x3d DISCARD_ALPHA) { discard; return; }\n  #endif\n  fragColor \x3d vec4(color, opacity * alpha);\n}"})},
{"../core/shader":140}],184:[function(_dereq_,module,exports){function getMaterialData(data,materialData){materialData.color.set(data.color);materialData.emissive.set(data.emissive);materialData.emissiveIntensity=data.emissiveIntensity;materialData.fog=data.fog;materialData.metalness=data.metalness;materialData.roughness=data.roughness;materialData.wireframe=data.wireframe;materialData.wireframeLinewidth=data.wireframeLinewidth;data.normalMap&&(materialData.normalScale=data.normalScale);data.ambientOcclusionMap&&
(materialData.aoMapIntensity=data.ambientOcclusionMapIntensity);data.displacementMap&&(materialData.displacementScale=data.displacementScale,materialData.displacementBias=data.displacementBias);return materialData}exports=_dereq_("../core/shader").registerShader;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/"),CubeLoader=new THREE.CubeTextureLoader,texturePromises={};module.exports.Shader=exports("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},
ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},
metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},
src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(data){this.rendererSystem=this.el.sceneEl.systems.renderer;this.materialData={color:new THREE.Color,emissive:new THREE.Color};getMaterialData(data,this.materialData);this.rendererSystem.applyColorCorrection(this.materialData.color);this.rendererSystem.applyColorCorrection(this.materialData.emissive);this.material=new THREE.MeshStandardMaterial(this.materialData);utils.material.updateMap(this,
data);data.normalMap&&utils.material.updateDistortionMap("normal",this,data);data.displacementMap&&utils.material.updateDistortionMap("displacement",this,data);data.ambientOcclusionMap&&utils.material.updateDistortionMap("ambientOcclusion",this,data);data.metalnessMap&&utils.material.updateDistortionMap("metalness",this,data);data.roughnessMap&&utils.material.updateDistortionMap("roughness",this,data);this.updateEnvMap(data)},update:function(data){this.updateMaterial(data);utils.material.updateMap(this,
data);data.normalMap&&utils.material.updateDistortionMap("normal",this,data);data.displacementMap&&utils.material.updateDistortionMap("displacement",this,data);data.ambientOcclusionMap&&utils.material.updateDistortionMap("ambientOcclusion",this,data);data.metalnessMap&&utils.material.updateDistortionMap("metalness",this,data);data.roughnessMap&&utils.material.updateDistortionMap("roughness",this,data);this.updateEnvMap(data)},updateMaterial:function(data){var key,material=this.material;getMaterialData(data,
this.materialData);this.rendererSystem.applyColorCorrection(this.materialData.color);this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(key in this.materialData)material[key]=this.materialData[key]},updateEnvMap:function(data){var self=this,material=this.material,envMap=data.envMap;data=data.sphericalEnvMap;!envMap&&!data||this.isLoadingEnvMap?(material.envMap=null,material.needsUpdate=!0):(this.isLoadingEnvMap=!0,data?this.el.sceneEl.systems.material.loadTexture(data,{src:data},
function(texture){self.isLoadingEnvMap=!1;texture.mapping=THREE.SphericalReflectionMapping;material.envMap=texture;utils.material.handleTextureEvents(self.el,texture);material.needsUpdate=!0}):texturePromises[envMap]?texturePromises[envMap].then(function(cube){self.isLoadingEnvMap=!1;material.envMap=cube;utils.material.handleTextureEvents(self.el,cube);material.needsUpdate=!0}):texturePromises[envMap]=new Promise(function(resolve){utils.srcLoader.validateCubemapSrc(envMap,function(urls){CubeLoader.load(urls,
function(cube){self.isLoadingEnvMap=!1;material.envMap=cube;utils.material.handleTextureEvents(self.el,cube);resolve(cube)})})}))}})},{"../core/shader":140,"../lib/three":178,"../utils/":204}],185:[function(_dereq_,module,exports){_dereq_("browserify-css").createStyle("html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url(\"data:image/svg+xml,%3Csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'108' height\x3d'62' viewBox\x3d'0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d\x3d'M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill\x3d'%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url(\"data:image/svg+xml,%3Csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'108' height\x3d'62' viewBox\x3d'0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d\x3d'M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill\x3d'%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}",
{href:"src/style/aframe.css"});module.exports="html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url(\"data:image/svg+xml,%3Csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'108' height\x3d'62' viewBox\x3d'0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d\x3d'M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill\x3d'%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url(\"data:image/svg+xml,%3Csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'108' height\x3d'62' viewBox\x3d'0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d\x3d'M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill\x3d'%23fff'/%3E%3Cpath d\x3d'M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill\x3d'%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}"},
{"browserify-css":4}],186:[function(_dereq_,module,exports){_dereq_("browserify-css").createStyle(".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}",
{href:"src/style/rStats.css"});module.exports=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}"},
{"browserify-css":4}],187:[function(_dereq_,module,exports){var constants=_dereq_("../constants/");_dereq_=_dereq_("../core/system").registerSystem;module.exports.System=_dereq_("camera",{init:function(){this.activeCameraEl=null;this.render=this.render.bind(this);this.unwrapRender=this.unwrapRender.bind(this);this.wrapRender=this.wrapRender.bind(this);this.initialCameraFound=!1;this.numUserCamerasChecked=this.numUserCameras=0;this.setupInitialCamera()},setupInitialCamera:function(){var i;var cameraEls=
this.sceneEl;var self=this;if(cameraEls.camera&&!cameraEls.camera.el.getAttribute("camera").spectator)cameraEls.emit("cameraready",{cameraEl:cameraEls.camera.el});else if(cameraEls=cameraEls.querySelectorAll("a-camera, [camera]"),cameraEls.length)for(this.numUserCameras=cameraEls.length,i=0;i<cameraEls.length;i++)cameraEls[i].addEventListener("object3dset",function(evt){"camera"===evt.detail.type&&self.checkUserCamera(this)}),cameraEls[i].isNode?cameraEls[i].load():cameraEls[i].addEventListener("nodeready",
function(){this.load()});else this.createDefaultCamera()},checkUserCamera:function(cameraEl){var sceneEl=this.el.sceneEl;this.numUserCamerasChecked++;if(!this.initialCameraFound){var cameraData=cameraEl.getAttribute("camera");!cameraData.active||cameraData.spectator?this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera():(this.initialCameraFound=!0,sceneEl.camera=cameraEl.getObject3D("camera"),sceneEl.emit("cameraready",{cameraEl:cameraEl}))}},createDefaultCamera:function(){var sceneEl=
this.sceneEl;var defaultCameraEl=document.createElement("a-entity");defaultCameraEl.setAttribute("camera",{active:!0});defaultCameraEl.setAttribute("position",{x:0,y:constants.DEFAULT_CAMERA_HEIGHT,z:0});defaultCameraEl.setAttribute("wasd-controls","");defaultCameraEl.setAttribute("look-controls","");defaultCameraEl.setAttribute(constants.AFRAME_INJECTED,"");defaultCameraEl.addEventListener("object3dset",function(evt){"camera"===evt.detail.type&&(sceneEl.camera=evt.detail.object,sceneEl.emit("cameraready",
{cameraEl:defaultCameraEl}))});sceneEl.appendChild(defaultCameraEl)},disableActiveCamera:function(){var cameraEls=this.sceneEl.querySelectorAll("[camera]");cameraEls[cameraEls.length-1].setAttribute("camera","active",!0)},setActiveCamera:function(newCameraEl){var cameraEl;var cameraEls=this.activeCameraEl;var sceneEl=this.sceneEl;if((cameraEl=newCameraEl.getObject3D("camera"))&&newCameraEl!==this.activeCameraEl){var i=(i=sceneEl.querySelector("[data-aframe-default-camera]"))&&i.querySelector("[camera]");
newCameraEl!==i&&sceneEl.camera&&(i=sceneEl.querySelector("[data-aframe-default-camera]"))&&sceneEl.removeChild(i);this.activeCameraEl=newCameraEl;this.activeCameraEl.play();sceneEl.camera=cameraEl;cameraEls&&cameraEls.setAttribute("camera","active",!1);cameraEls=sceneEl.querySelectorAll("[camera]");for(i=0;i<cameraEls.length;i++)cameraEl=cameraEls[i],cameraEl.isEntity&&newCameraEl!==cameraEl&&(cameraEl.setAttribute("camera","active",!1),cameraEl.pause());sceneEl.emit("camera-set-active",{cameraEl:newCameraEl})}},
setSpectatorCamera:function(newCameraEl){var previousCamera=this.spectatorCameraEl,sceneEl=this.sceneEl;newCameraEl.getObject3D("camera")&&newCameraEl!==this.spectatorCameraEl&&(previousCamera&&previousCamera.setAttribute("camera","spectator",!1),previousCamera=this.spectatorCameraEl=newCameraEl,sceneEl.addEventListener("enter-vr",this.wrapRender),sceneEl.addEventListener("exit-vr",this.unwrapRender),previousCamera.setAttribute("camera","active",!1),previousCamera.play(),sceneEl.emit("camera-set-spectator",
{cameraEl:newCameraEl}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){this.spectatorCameraEl&&!this.originalRender&&(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(scene,camera){var sceneEl=this.sceneEl;var isVREnabled=sceneEl.renderer.xr.enabled;this.originalRender.call(sceneEl.renderer,
scene,camera);this.spectatorCameraEl&&!sceneEl.isMobile&&isVREnabled&&(camera=this.spectatorCameraEl.components.camera.camera,sceneEl.renderer.xr.enabled=!1,this.originalRender.call(sceneEl.renderer,scene,camera),sceneEl.renderer.xr.enabled=isVREnabled)}})},{"../constants/":122,"../core/system":141}],188:[function(_dereq_,module,exports){function createGeometry(data){var geometryType=data.primitive,GeometryClass=geometries[geometryType]&&geometries[geometryType].Geometry,geometryInstance=new GeometryClass;
if(!GeometryClass)throw Error("Unknown geometry `"+geometryType+"`");geometryInstance.init(data);geometryType=geometryInstance.geometry;data.buffer?(data=(new THREE.BufferGeometry).fromGeometry(geometryType),data.metadata={type:geometryType.type,parameters:geometryType.parameters||{}},geometryType.dispose()):data=geometryType;return data}var geometries=_dereq_("../core/geometry").geometries;exports=_dereq_("../core/system").registerSystem;var THREE=_dereq_("../lib/three");module.exports.System=exports("geometry",
{init:function(){this.cache={};this.cacheCount={}},clearCache:function(){this.cache={};this.cacheCount={}},getOrCreateGeometry:function(data){var cache=this.cache;if(data.skipCache)return createGeometry(data);var hash=this.hash(data);var cachedGeometry=cache[hash];var cacheCount=this.cacheCount;cacheCount[hash]=void 0===cacheCount[hash]?1:cacheCount[hash]+1;if(cachedGeometry)return cachedGeometry;cachedGeometry=createGeometry(data);return cache[hash]=cachedGeometry},unuseGeometry:function(data){var cache=
this.cache,cacheCount=this.cacheCount;data.skipCache||(data=this.hash(data),cache[data]&&(cacheCount[data]--,0<cacheCount[data]||(cache[data].dispose(),delete cache[data],delete cacheCount[data])))},hash:function(data){return JSON.stringify(data)}})},{"../core/geometry":131,"../core/system":141,"../lib/three":178}],189:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;var THREE=_dereq_("../lib/three");module.exports.System=exports("gltf-model",{schema:{dracoDecoderPath:{default:""}},
init:function(){var path=this.data.dracoDecoderPath;this.dracoLoader=new THREE.DRACOLoader;this.dracoLoader.setDecoderPath(path)},update:function(){if(!this.dracoLoader){var path=this.data.dracoDecoderPath;this.dracoLoader=new THREE.DRACOLoader;this.dracoLoader.setDecoderPath(path)}},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":141,"../lib/three":178}],190:[function(_dereq_,module,exports){_dereq_("./camera");_dereq_("./geometry");_dereq_("./gltf-model");_dereq_("./light");
_dereq_("./material");_dereq_("./renderer");_dereq_("./shadow");_dereq_("./tracked-controls-webvr");_dereq_("./tracked-controls-webxr");_dereq_("./webxr")},{"./camera":187,"./geometry":188,"./gltf-model":189,"./light":191,"./material":192,"./renderer":193,"./shadow":194,"./tracked-controls-webvr":195,"./tracked-controls-webxr":196,"./webxr":197}],191:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;var bind=_dereq_("../utils/bind"),constants=_dereq_("../constants/");
module.exports.System=exports("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.userDefinedLights=this.defaultLights=!1;this.sceneEl.addEventListener("loaded",bind(this.setupDefaultLights,this))},registerLight:function(el){el.hasAttribute("data-aframe-default-light")||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var sceneEl=this.sceneEl;if(this.defaultLights){var defaultLights=document.querySelectorAll("[data-aframe-default-light]");
for(var i=0;i<defaultLights.length;i++)sceneEl.removeChild(defaultLights[i]);this.defaultLights=!1}},setupDefaultLights:function(){var sceneEl=this.sceneEl;if(!this.userDefinedLights&&!this.defaultLights&&this.data.defaultLightsEnabled){var ambientLight=document.createElement("a-entity");ambientLight.setAttribute("light",{color:"#BBB",type:"ambient"});ambientLight.setAttribute("data-aframe-default-light","");ambientLight.setAttribute(constants.AFRAME_INJECTED,"");sceneEl.appendChild(ambientLight);
ambientLight=document.createElement("a-entity");ambientLight.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0});ambientLight.setAttribute("position",{x:-.5,y:1,z:1});ambientLight.setAttribute("data-aframe-default-light","");ambientLight.setAttribute(constants.AFRAME_INJECTED,"");sceneEl.appendChild(ambientLight);this.defaultLights=!0}}})},{"../constants/":122,"../core/system":141,"../utils/bind":198}],192:[function(_dereq_,module,exports){function calculateVideoCacheHash(data,videoEl){var id=
videoEl.getAttribute("id");if(id)return id;var hash="";var videoAttributes=data||{};for(data=0;data<videoEl.attributes.length;data++)videoAttributes[videoEl.attributes[data].name]=videoEl.attributes[data].value;Object.keys(videoAttributes).sort().forEach(function(name){hash+=name+":"+videoAttributes[name]+";"});return hash}function loadImageTexture(src,data){return new Promise(function(resolve,reject){function resolveTexture(texture){setTextureProperties(texture,data);texture.needsUpdate=!0;resolve(texture)}
"string"!==typeof src?resolveTexture(new THREE.Texture(src)):TextureLoader.load(src,resolveTexture,function(){},function(xhr){error("`$s` could not be fetched (Error code: %s; Response: %s)",xhr.status,xhr.statusText)})})}function setTextureProperties(texture,data){var offset=data.offset||{x:0,y:0},repeat=data.repeat||{x:1,y:1};data.npot&&(texture.wrapS=THREE.ClampToEdgeWrapping,texture.wrapT=THREE.ClampToEdgeWrapping,texture.magFilter=THREE.LinearFilter,texture.minFilter=THREE.LinearFilter);if(1!==
repeat.x||1!==repeat.y)texture.wrapS=THREE.RepeatWrapping,texture.wrapT=THREE.RepeatWrapping,texture.repeat.set(repeat.x,repeat.y);0===offset.x&&0===offset.y||texture.offset.set(offset.x,offset.y)}function createVideoEl(src,width,height){var videoEl=document.createElement("video");videoEl.width=width;videoEl.height=height;videoEl.setAttribute("playsinline","");videoEl.setAttribute("webkit-playsinline","");videoEl.autoplay=!0;videoEl.loop=!0;videoEl.crossOrigin="anonymous";videoEl.addEventListener("error",
function(){warn("`$s` is not a valid video",src)},!0);videoEl.src=src;return videoEl}function fixVideoAttributes(videoEl){videoEl.autoplay=videoEl.hasAttribute("autoplay")&&"false"!==videoEl.getAttribute("autoplay");videoEl.controls=videoEl.hasAttribute("controls")&&"false"!==videoEl.getAttribute("controls");"false"===videoEl.getAttribute("loop")&&videoEl.removeAttribute("loop");"false"===videoEl.getAttribute("preload")&&(videoEl.preload="none");videoEl.crossOrigin=videoEl.crossOrigin||"anonymous";
videoEl.setAttribute("playsinline","");videoEl.setAttribute("webkit-playsinline","");return videoEl}exports=_dereq_("../core/system").registerSystem;var THREE=_dereq_("../lib/three"),utils=_dereq_("../utils/"),isHLS=_dereq_("../utils/material").isHLS,bind=utils.bind;_dereq_=utils.debug;var error=_dereq_("components:texture:error"),TextureLoader=new THREE.TextureLoader,warn=_dereq_("components:texture:warn");TextureLoader.setCrossOrigin("anonymous");module.exports.System=exports("material",{init:function(){this.materials=
{};this.textureCounts={};this.textureCache={};this.sceneEl.addEventListener("materialtextureloaded",bind(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(src$jscomp$0,data,cb){var self=this;"CANVAS"===src$jscomp$0.tagName?this.loadCanvas(src$jscomp$0,data,cb):"VIDEO"===src$jscomp$0.tagName?(src$jscomp$0.src||src$jscomp$0.srcObject||src$jscomp$0.childElementCount||warn("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),
this.loadVideo(src$jscomp$0,data,cb)):utils.srcLoader.validateSrc(src$jscomp$0,function(src){self.loadImage(src,data,cb)},function(src){self.loadVideo(src,data,cb)})},loadImage:function(src,data,handleImageTextureLoaded){var hash=this.hash(data),textureCache=this.textureCache;textureCache[hash]||(textureCache[hash]=loadImageTexture(src,data));textureCache[hash].then(handleImageTextureLoaded)},loadCanvas:function(src,data,cb){src=new THREE.CanvasTexture(src);setTextureProperties(src,data);cb(src)},
loadVideo:function(src,data,cb){function handleVideoTextureLoaded(result){result.texture.needsUpdate=!0;cb(result.texture,result.videoEl)}var textureCache=this.textureCache;if("string"!==typeof src){var videoEl=src;var hash=this.hashVideo(data,videoEl);if(textureCache[hash]){textureCache[hash].then(handleVideoTextureLoaded);return}fixVideoAttributes(videoEl)}videoEl=videoEl||createVideoEl(src,data.width,data.height);hash=this.hashVideo(data,videoEl);textureCache[hash]?textureCache[hash].then(handleVideoTextureLoaded):
(src=new THREE.VideoTexture(videoEl),src.minFilter=THREE.LinearFilter,setTextureProperties(src,data),this.sceneEl.isIOS&&isHLS(videoEl.src||videoEl.getAttribute("src"),videoEl.type||videoEl.getAttribute("type"))&&(src.format=THREE.RGBAFormat,src.needsCorrectionBGRA=!0,src.flipY=!1,src.needsCorrectionFlipY=!0),data={texture:src,videoEl:videoEl},textureCache[hash]=Promise.resolve(data),handleVideoTextureLoaded(data))},hash:function(data){data.src.tagName&&(data=utils.extendDeep({},data),data.src=data.src.src);
return JSON.stringify(data)},hashVideo:function(data,videoEl){return calculateVideoCacheHash(data,videoEl)},registerMaterial:function(material){this.materials[material.uuid]=material},unregisterMaterial:function(material){delete this.materials[material.uuid];var textureCounts=this.textureCounts;Object.keys(material).filter(function(propName){return material[propName]&&material[propName].isTexture}).forEach(function(mapName){textureCounts[material[mapName].uuid]--;0>=textureCounts[material[mapName].uuid]&&
material[mapName].dispose()})},updateMaterials:function(material){var materials=this.materials;Object.keys(materials).forEach(function(uuid){materials[uuid].needsUpdate=!0})},onMaterialTextureLoaded:function(e){this.textureCounts[e.detail.texture.uuid]||(this.textureCounts[e.detail.texture.uuid]=0);this.textureCounts[e.detail.texture.uuid]++}})},{"../core/system":141,"../lib/three":178,"../utils/":204,"../utils/material":208}],193:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;
var utils=_dereq_("../utils/"),THREE=_dereq_("../lib/three");_dereq_=utils.debug;var warn=_dereq_("components:renderer:warn");module.exports.System=exports("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:utils.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium",
"low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var data=this.data,sceneEl=this.el,renderer=sceneEl.renderer;renderer.sortObjects=data.sortObjects;renderer.physicallyCorrectLights=data.physicallyCorrectLights;if(data.colorManagement||data.gammaOutput)renderer.outputEncoding=THREE.sRGBEncoding,data.gammaOutput&&warn('Property `gammaOutput` is deprecated. Use `renderer\x3d"colorManagement: true;"` instead.');
sceneEl.hasAttribute("antialias")&&warn('Component `antialias` is deprecated. Use `renderer\x3d"antialias: true"` instead.');sceneEl.hasAttribute("logarithmicDepthBuffer")&&warn('Component `logarithmicDepthBuffer` is deprecated. Use `renderer\x3d"logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(colorOrTexture){this.data.colorManagement&&colorOrTexture&&(colorOrTexture.isColor?colorOrTexture.convertSRGBToLinear():colorOrTexture.isTexture&&(colorOrTexture.encoding=THREE.sRGBEncoding))}})},
{"../core/system":141,"../lib/three":178,"../utils/":204}],194:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;_dereq_=_dereq_("../lib/three");var SHADOW_MAP_TYPE_MAP={basic:_dereq_.BasicShadowMap,pcf:_dereq_.PCFShadowMap,pcfsoft:_dereq_.PCFSoftShadowMap};module.exports.System=exports("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var sceneEl=this.sceneEl,data=this.data;this.shadowMapEnabled=
!1;sceneEl.renderer&&(sceneEl.renderer.shadowMap.type=SHADOW_MAP_TYPE_MAP[data.type],sceneEl.renderer.shadowMap.autoUpdate=data.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(prevData){prevData.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(enabled){var renderer=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&enabled;renderer&&(renderer.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":141,
"../lib/three":178}],195:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;var utils=_dereq_("../utils"),isWebXRAvailable=utils.device.isWebXRAvailable;module.exports.System=exports("tracked-controls-webvr",{init:function(){var self=this;this.controllers=[];this.isChrome=-1!==navigator.userAgent.indexOf("Chrome");this.updateControllerList();this.throttledUpdateControllerList=utils.throttle(this.updateControllerList,500,this);isWebXRAvailable||navigator.getVRDisplays&&
this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(displays){displays.length&&(self.vrDisplay=displays[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var controllers=this.controllers,gamepad,gamepads,i;if(gamepads=navigator.getGamepads&&navigator.getGamepads()){var prevCount=controllers.length;for(i=controllers.length=0;i<gamepads.length;++i)(gamepad=gamepads[i])&&gamepad.pose&&
controllers.push(gamepad);controllers.length!==prevCount&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":141,"../utils":204}],196:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;var utils=_dereq_("../utils");module.exports.System=exports("tracked-controls-webxr",{init:function(){this.controllers=[];this.oldControllers=[];this.oldControllersLength=0;this.throttledUpdateControllerList=utils.throttle(this.updateControllerList,500,this);this.updateReferenceSpace=
this.updateReferenceSpace.bind(this);this.el.addEventListener("enter-vr",this.updateReferenceSpace);this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var self=this,xrSession=this.el.xrSession;if(xrSession){var refspace=self.el.sceneEl.systems.webxr.sessionReferenceSpaceType;xrSession.requestReferenceSpace(refspace).then(function(referenceSpace){self.referenceSpace=referenceSpace}).catch(function(err){self.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(refspace,
'tracked-controls-webxr uses reference space "'+refspace+'".');throw err;})}else this.referenceSpace=void 0,this.controllers=[],0<this.oldControllersLength&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1))},updateControllerList:function(){var xrSession=this.el.xrSession,oldControllers=this.oldControllers;if(!xrSession)0!==this.oldControllersLength&&(this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1));else if(xrSession.inputSources){this.controllers=
xrSession.inputSources;if(this.oldControllersLength===this.controllers.length){var equal=!0;for(xrSession=0;xrSession<this.controllers.length;++xrSession)if(this.controllers[xrSession]!==oldControllers[xrSession]||this.controllers[xrSession].gamepad!==oldControllers[xrSession].gamepad){equal=!1;break}if(equal)return}for(xrSession=oldControllers.length=0;xrSession<this.controllers.length;xrSession++)oldControllers.push(this.controllers[xrSession]);this.oldControllersLength=this.controllers.length;
this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":141,"../utils":204}],197:[function(_dereq_,module,exports){exports=_dereq_("../core/system").registerSystem;var warn=_dereq_("../utils/").debug("systems:webxr:warn");module.exports.System=exports("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var data=
this.data;this.sessionConfiguration={requiredFeatures:data.requiredFeatures,optionalFeatures:data.optionalFeatures};this.sessionReferenceSpaceType=data.referenceSpaceType;data.overlayElement&&(this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:data.overlayElement})},wasFeatureRequested:function(feature){return"viewer"===feature||"local"===feature||this.sessionConfiguration.requiredFeatures.includes(feature)||this.sessionConfiguration.optionalFeatures.includes(feature)?
!0:!1},warnIfFeatureNotRequested:function(feature,optIntro){this.wasFeatureRequested(feature)||warn((optIntro?optIntro+" ":"")+('Please add the feature "'+feature+"\" to a-scene's webxr system options in requiredFeatures/optionalFeatures."))}})},{"../core/system":141,"../utils/":204}],198:[function(_dereq_,module,exports){module.exports=function(fn,ctx){return function(prependedArgs){return function(){var args=prependedArgs.concat(Array.prototype.slice.call(arguments,0));return fn.apply(ctx,args)}}(Array.prototype.slice.call(arguments,
2))}},{}],199:[function(_dereq_,module,exports){function isCoordinates(value){return regex.test(value)}function parseIfString(val){return null!==val&&void 0!==val&&val.constructor===String?parseFloat(val,10):val}exports=_dereq_("./debug");var extend=_dereq_("object-assign"),warn=exports("utils:coordinates:warn"),COORDINATE_KEYS=["x","y","z","w"],regex=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;module.exports.regex=regex;var whitespaceRegex=/\s+/g;module.exports.parse=
function(value,defaultVec){if(value&&value instanceof Object){var defaultVal=void 0===value.x?defaultVec&&defaultVec.x:value.x;var key=void 0===value.y?defaultVec&&defaultVec.y:value.y;var i=void 0===value.z?defaultVec&&defaultVec.z:value.z;defaultVec=void 0===value.w?defaultVec&&defaultVec.w:value.w;void 0!==defaultVal&&null!==defaultVal&&(value.x=parseIfString(defaultVal));void 0!==key&&null!==key&&(value.y=parseIfString(key));void 0!==i&&null!==i&&(value.z=parseIfString(i));void 0!==defaultVec&&
null!==defaultVec&&(value.w=parseIfString(defaultVec));return value}if(null===value||void 0===value)return"object"===typeof defaultVec?extend({},defaultVec):defaultVec;value=value.trim().split(whitespaceRegex);var vec={};for(i=0;i<COORDINATE_KEYS.length;i++)key=COORDINATE_KEYS[i],value[i]?vec[key]=parseFloat(value[i],10):(defaultVal=defaultVec&&defaultVec[key],void 0!==defaultVal&&(vec[key]=parseIfString(defaultVal)));return vec};module.exports.stringify=function(data){if("object"!==typeof data)return data;
var str=data.x+" "+data.y;null!=data.z&&(str+=" "+data.z);null!=data.w&&(str+=" "+data.w);return str};module.exports.isCoordinates=isCoordinates;module.exports.isCoordinate=function(value){warn("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`");return isCoordinates(value)};module.exports.toVector3=function(vec3){return new THREE.Vector3(vec3.x,vec3.y,vec3.z)}},{"./debug":200,"object-assign":39}],200:[function(_dereq_,module,exports){(function(process){var debugLib=_dereq_("debug"),
JSCompiler_object_inline_colors_4352={debug:"gray",error:"red",info:"gray",warn:"orange"},debug=function(namespace){var d=debugLib(namespace);namespace=namespace.split(":");namespace=namespace[namespace.length-1];d.color=JSCompiler_object_inline_colors_4352&&JSCompiler_object_inline_colors_4352[namespace]||null;return d};_dereq_("object-assign")(debug,debugLib);a:{try{var ls=window.localStorage;break a}catch(e$171){}ls=void 0}ls&&(parseInt(ls.logs,10)||"true"===ls.logs)?debug.enable("*"):debug.enable("*:error,*:info,*:warn");
process.browser&&(window.logs=debug);module.exports=debug}).call(this,_dereq_("_process"))},{_process:49,debug:8,"object-assign":39}],201:[function(_dereq_,module,exports){(function(process){function isTablet(mockUserAgent){return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(mockUserAgent||window.navigator.userAgent)}function isIOS(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function isOculusBrowser(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}function isFirefoxReality(){return/(Mobile VR)/i.test(window.navigator.userAgent)}
function isMobileVR(){return isOculusBrowser()||isFirefoxReality()}function isR7(){return/R7 Build/.test(window.navigator.userAgent)}var error=_dereq_("debug")("device:error"),vrDisplay,supportsVRSession=!1,supportsARSession=!1,isWebXRAvailable=module.exports.isWebXRAvailable=!window.debug&&void 0!==navigator.xr;window.addEventListener("vrdisplayactivate",function(evt){if(!isWebXRAvailable){var canvasEl=document.createElement("canvas");vrDisplay=evt.display;canvasEl.getContext("webgl",{});vrDisplay.requestPresent([{source:canvasEl}]).then(function(){},
function(){})}});if(isWebXRAvailable){var updateEnterInterfaces=function(){var sceneEl=document.querySelector("a-scene");sceneEl?sceneEl.hasLoaded?sceneEl.components["vr-mode-ui"].updateEnterInterfaces():sceneEl.addEventListener("loaded",updateEnterInterfaces):window.addEventListener("DOMContentLoaded",updateEnterInterfaces)},errorHandler=function(err){error("WebXR session support error: "+err.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(supported){supportsVRSession=
supported;updateEnterInterfaces()}).catch(errorHandler),navigator.xr.isSessionSupported("immersive-ar").then(function(supported){supportsARSession=supported;updateEnterInterfaces()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){supportsVRSession=!0;updateEnterInterfaces()}).catch(errorHandler),navigator.xr.supportsSession("immersive-ar").then(function(){supportsARSession=!0;updateEnterInterfaces()}).catch(function(){})):error("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&
navigator.getVRDisplays().then(function(displays){var sceneEl=document.querySelector("a-scene");vrDisplay=displays.length&&displays[0];sceneEl&&sceneEl.emit("displayconnected",{vrDisplay:vrDisplay})});module.exports.getVRDisplay=function(){return vrDisplay};module.exports.checkHeadsetConnected=function(){return supportsVRSession||supportsARSession||!!vrDisplay};module.exports.checkARSupport=function(){return supportsARSession};var isMobile=function(){var _isMobile=!1;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))_isMobile=!0;if(isIOS()||isTablet()||isR7())_isMobile=!0;isMobileVR()&&(_isMobile=!1)})(window.navigator.userAgent||window.navigator.vendor||window.opera);return function(){return _isMobile}}();module.exports.isMobile=isMobile;module.exports.isTablet=isTablet;module.exports.isIOS=isIOS;module.exports.isMobileDeviceRequestingDesktopSite=function(){return!isMobile()&&!isMobileVR()&&void 0!==window.orientation};module.exports.isOculusBrowser=isOculusBrowser;module.exports.isFirefoxReality=isFirefoxReality;
module.exports.isMobileVR=isMobileVR;module.exports.isR7=isR7;module.exports.isLandscape=function(){var orientation=window.orientation;isR7()&&(orientation+=90);return 90===orientation||-90===orientation};module.exports.isBrowserEnvironment=!(process&&!process.browser);module.exports.isNodeEnvironment=!module.exports.isBrowserEnvironment}).call(this,_dereq_("_process"))},{_process:49,debug:8}],202:[function(_dereq_,module,exports){function getComponentPropertyPath(str,delimiter){delimiter=delimiter||
".";propertyPathCache[delimiter]||(propertyPathCache[delimiter]={});-1!==str.indexOf(delimiter)?propertyPathCache[delimiter][str]=str.split(delimiter):propertyPathCache[delimiter][str]=str;return propertyPathCache[delimiter][str]}var propertyPathCache={};module.exports.getComponentPropertyPath=getComponentPropertyPath;module.exports.propertyPathCache=propertyPathCache;module.exports.getComponentProperty=function(el,name,delimiter){delimiter=delimiter||".";return-1!==name.indexOf(delimiter)?(name=
getComponentPropertyPath(name,delimiter),name.constructor===String?el.getAttribute(name):el.getAttribute(name[0])[name[1]]):el.getAttribute(name)};module.exports.setComponentProperty=function(el,name,value,delimiter){delimiter=delimiter||".";-1!==name.indexOf(delimiter)?(name=getComponentPropertyPath(name,delimiter),name.constructor===String?el.setAttribute(name,value):el.setAttribute(name[0],name[1],value)):el.setAttribute(name,value)}},{}],203:[function(_dereq_,module,exports){module.exports=function(canvasEl){var width=
canvasEl.style.width,height=canvasEl.style.height;canvasEl.style.width=parseInt(width,10)+1+"px";canvasEl.style.height=parseInt(height,10)+1+"px";setTimeout(function(){canvasEl.style.width=width;canvasEl.style.height=height},200)}},{}],204:[function(_dereq_,module,exports){exports=_dereq_("./debug");var deepAssign=_dereq_("deep-assign"),device=_dereq_("./device"),objectAssign=_dereq_("object-assign"),objectPool=_dereq_("./object-pool"),warn=exports("utils:warn");module.exports.bind=_dereq_("./bind");
module.exports.coordinates=_dereq_("./coordinates");module.exports.debug=exports;module.exports.device=device;module.exports.entity=_dereq_("./entity");module.exports.forceCanvasResizeSafariMobile=_dereq_("./forceCanvasResizeSafariMobile");module.exports.isIE11=_dereq_("./is-ie11");module.exports.material=_dereq_("./material");module.exports.objectPool=objectPool;module.exports.split=_dereq_("./split").split;module.exports.styleParser=_dereq_("./styleParser");module.exports.trackedControls=_dereq_("./tracked-controls");
module.exports.checkHeadsetConnected=function(){warn("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`");return device.checkHeadsetConnected(arguments)};module.exports.isGearVR=module.exports.device.isGearVR=function(){warn("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")};module.exports.isIOS=function(){warn("`utils.isIOS` has moved to `utils.device.isIOS`");return device.isIOS(arguments)};module.exports.isOculusGo=module.exports.device.isOculusGo=
function(){warn("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")};module.exports.isMobile=function(){warn("`utils.isMobile has moved to `utils.device.isMobile`");return device.isMobile(arguments)};module.exports.throttle=function(functionToThrottle,minimumInterval,optionalContext){var lastTime;optionalContext&&(functionToThrottle=module.exports.bind(functionToThrottle,optionalContext));return function(){var time=Date.now(),sinceLastTime="undefined"===typeof lastTime?minimumInterval:
time-lastTime;if("undefined"===typeof lastTime||sinceLastTime>=minimumInterval)lastTime=time,functionToThrottle.apply(null,arguments)}};module.exports.throttleTick=function(functionToThrottle,minimumInterval,optionalContext){var lastTime;optionalContext&&(functionToThrottle=module.exports.bind(functionToThrottle,optionalContext));return function(time,delta){delta="undefined"===typeof lastTime?delta:time-lastTime;if("undefined"===typeof lastTime||delta>=minimumInterval)lastTime=time,functionToThrottle(time,
delta)}};module.exports.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(function(){timeout=null;immediate||func.apply(context,args)},wait);callNow&&func.apply(context,args)}};module.exports.extend=objectAssign;module.exports.extendDeep=deepAssign;module.exports.clone=function(obj){return JSON.parse(JSON.stringify(obj))};var deepEqual=function(){var arrayPool=objectPool.createPool(function(){return[]});
return function(a,b){var key;if(void 0===a||void 0===b||null===a||null===b||!(a&&b&&a.constructor===Object&&b.constructor===Object||a.constructor===Array&&b.constructor===Array))return a===b;var keysA=arrayPool.use();var keysB=arrayPool.use();keysA.length=0;keysB.length=0;for(key in a)keysA.push(key);for(key in b)keysB.push(key);if(keysA.length!==keysB.length)return arrayPool.recycle(keysA),arrayPool.recycle(keysB),!1;for(key=0;key<keysA.length;++key){var valA=a[keysA[key]];var valB=b[keysA[key]];
if("object"===typeof valA||"object"===typeof valB||Array.isArray(valA)&&Array.isArray(valB)){if(valA!==valB&&!deepEqual(valA,valB))return arrayPool.recycle(keysA),arrayPool.recycle(keysB),!1}else if(valA!==valB)return arrayPool.recycle(keysA),arrayPool.recycle(keysB),!1}arrayPool.recycle(keysA);arrayPool.recycle(keysB);return!0}}();module.exports.deepEqual=deepEqual;module.exports.diff=function(){var keys=[];return function(a,b,targetObject){var i,isComparingObjects;targetObject=targetObject||{};
keys.length=0;for(key in a)keys.push(key);if(!b)return targetObject;for(aVal in b)-1===keys.indexOf(aVal)&&keys.push(aVal);for(i=0;i<keys.length;i++){var key=keys[i];var aVal=a[key];var bVal=b[key];if((isComparingObjects=aVal&&bVal&&aVal.constructor===Object&&bVal.constructor===Object)&&!deepEqual(aVal,bVal)||!isComparingObjects&&aVal!==bVal)targetObject[key]=bVal}return targetObject}}();module.exports.shouldCaptureKeyEvent=function(event){return event.metaKey?!1:document.activeElement===document.body};
module.exports.splitString=function(str,delimiter){"undefined"===typeof delimiter&&(delimiter=" ");str=(str||"").replace(new RegExp(delimiter,"g"),delimiter);return str.split(delimiter)};module.exports.getElData=function(el,defaults){defaults=defaults||{};var data={};Object.keys(defaults).forEach(function(key){el.hasAttribute(key)&&(data[key]=el.getAttribute(key))});return data};module.exports.getUrlParameter=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");name=(new RegExp("[\\?\x26]"+
name+"\x3d([^\x26#]*)")).exec(location.search);return null===name?"":decodeURIComponent(name[1].replace(/\+/g," "))};module.exports.isIframed=function(){return window.top!==window.self};module.exports.findAllScenes=function(el){var matchingElements=[];el=el.getElementsByTagName("*");for(var i=0,n=el.length;i<n;i++)el[i].isScene&&matchingElements.push(el[i]);return matchingElements};module.exports.srcLoader=_dereq_("./src-loader")},{"./bind":198,"./coordinates":199,"./debug":200,"./device":201,"./entity":202,
"./forceCanvasResizeSafariMobile":203,"./is-ie11":206,"./material":208,"./object-pool":209,"./split":210,"./src-loader":211,"./styleParser":212,"./tracked-controls":213,"deep-assign":10,"object-assign":39}],205:[function(_dereq_,module,exports){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial";setTimeout(function(){document.documentElement.style.height="100%";setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],206:[function(_dereq_,module,
exports){_dereq_=-1;exports=navigator.userAgent;if("Microsoft Internet Explorer"===navigator.appName){var re=/MSIE ([0-9]{1,}[\.0-9]{0,})/;null!=re.exec(exports)&&(_dereq_=parseFloat(RegExp.$1))}else"Netscape"===navigator.appName&&(re=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/,null!=re.exec(exports)&&(_dereq_=parseFloat(RegExp.$1)));module.exports=11===_dereq_},{}],207:[function(_dereq_,module,exports){module.exports=function(userAgent){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(userAgent)}},{}],
208:[function(_dereq_,module,exports){function handleTextureEvents(el,texture){texture&&(el.emit("materialtextureloaded",{src:texture.image,texture:texture}),texture.image&&"VIDEO"===texture.image.tagName&&(texture.image.addEventListener("loadeddata",function(){el.components&&el.components.material&&(texture.needsCorrectionBGRA&&texture.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(el.components.material.data.shader)&&el.setAttribute("material","shader","ios10hls"),el.emit("materialvideoloadeddata",
{src:texture.image,texture:texture}))}),texture.image.addEventListener("ended",function(){el.emit("materialvideoended",{src:texture.image,texture:texture})})))}var THREE=_dereq_("../lib/three"),HLS_MIMETYPES=["application/x-mpegurl","application/vnd.apple.mpegurl"],COLOR_MAPS=new Set(["emissiveMap","envMap","map","specularMap"]);module.exports.updateMapMaterialFromData=function(materialName,dataName,shader,data){function checkSetMap(texture){shader.materialSrcs[materialName]===src&&setMap(texture)}
function setMap(texture){(material[materialName]=texture)&&COLOR_MAPS.has(materialName)&&rendererSystem.applyColorCorrection(texture);material.needsUpdate=!0;handleTextureEvents(el,texture)}var el=shader.el,material=shader.material,rendererSystem=el.sceneEl.systems.renderer,src=data[dataName];shader.materialSrcs||(shader.materialSrcs={});src?src!==shader.materialSrcs[materialName]&&(shader.materialSrcs[materialName]=src,src instanceof THREE.Texture?setMap(src):el.sceneEl.systems.material.loadTexture(src,
{src:src,repeat:data.repeat,offset:data.offset,npot:data.npot},checkSetMap)):(delete shader.materialSrcs[materialName],setMap(null))};module.exports.updateMap=function(shader,data){return module.exports.updateMapMaterialFromData("map","src",shader,data)};module.exports.updateDistortionMap=function(longType,shader,data){function setMap(texture){var slot=shortType+"Map";(material[slot]=texture)&&COLOR_MAPS.has(slot)&&rendererSystem.applyColorCorrection(texture);material.needsUpdate=!0;handleTextureEvents(el,
texture)}var shortType=longType;"ambientOcclusion"===longType&&(shortType="ao");var el=shader.el,material=shader.material,rendererSystem=el.sceneEl.systems.renderer,src=data[longType+"Map"],info={};info.src=src;info.offset=data[longType+"TextureOffset"];info.repeat=data[longType+"TextureRepeat"];info.wrap=data[longType+"TextureWrap"];src?src!==shader[longType+"TextureSrc"]&&(shader[longType+"TextureSrc"]=src,el.sceneEl.systems.material.loadTexture(src,info,setMap)):material.map&&setMap(null)};module.exports.handleTextureEvents=
handleTextureEvents;module.exports.isHLS=function(src,type){return type&&HLS_MIMETYPES.includes(type.toLowerCase())||src&&0<src.toLowerCase().indexOf(".m3u8")?!0:!1}},{"../lib/three":178}],209:[function(_dereq_,module,exports){function defaultObjectFactory(){return{}}function clearObject(obj){var key;if(obj&&obj.constructor===Object)for(key in obj)obj[key]=void 0}var EMPTY_SLOT=Object.freeze(Object.create(null));module.exports.createPool=function(objectFactory){function grow(count){count=void 0===
count?objPool.length:count;0<count&&null==nextFreeSlot&&(nextFreeSlot=0);if(0<count){var currentLength=objPool.length;objPool.length+=Number(count);for(count=currentLength;count<objPool.length;count++)objPool[count]=objectFactory()}return objPool.length}var objPool=[],nextFreeSlot=null;objectFactory=objectFactory||defaultObjectFactory;return{grow:grow,pool:objPool,recycle:function(obj){obj instanceof Object&&(null===nextFreeSlot||-1===nextFreeSlot?objPool[objPool.length]=obj:objPool[--nextFreeSlot]=
obj)},size:function(){return objPool.length},use:function(){null!==nextFreeSlot&&nextFreeSlot!==objPool.length||grow(objPool.length||5);var objToUse=objPool[nextFreeSlot];objPool[nextFreeSlot++]=EMPTY_SLOT;clearObject(objToUse);return objToUse}}};module.exports.clearObject=clearObject;module.exports.removeUnusedKeys=function(obj,schema){var key;if(obj&&obj.constructor===Object)for(key in obj)key in schema||delete obj[key]}},{}],210:[function(_dereq_,module,exports){module.exports.split=function(){var splitCache=
{};return function(str,delimiter){delimiter in splitCache||(splitCache[delimiter]={});if(str in splitCache[delimiter])return splitCache[delimiter][str];splitCache[delimiter][str]=str.split(delimiter);return splitCache[delimiter][str]}}()},{}],211:[function(_dereq_,module,exports){function validateSrc(src,isImageCb,isVideoCb){checkIsImage(src,function(isImage){isImage?isImageCb(src):isVideoCb(src)})}function parseUrl(src){if(src=src.match(/\url\((.+)\)/))return src[1]}function checkIsImage(src,onResult){if(src.tagName)onResult("IMG"===
src.tagName);else{var request=new XMLHttpRequest;request.open("HEAD",src);request.addEventListener("load",function(event){200<=request.status&&300>request.status?(event=request.getResponseHeader("Content-Type"),null==event?checkIsImageFallback(src,onResult):event.startsWith("image")?onResult(!0):onResult(!1)):checkIsImageFallback(src,onResult);request.abort()});request.send()}}function checkIsImageFallback(src,onResult){var tester=new Image;tester.addEventListener("load",function(){onResult(!0)});
tester.addEventListener("error",function(){onResult(!1)});tester.src=src}function validateAndGetQuerySelector(selector){try{var el=document.querySelector(selector);el||warn('No element was found matching the selector: "%s"',selector);return el}catch(e$172){warn('"%s" is not a valid selector',selector)}}var warn=_dereq_("./debug")("utils:src-loader:warn");module.exports={parseUrl:parseUrl,validateSrc:validateSrc,validateCubemapSrc:function(src,cb){function isImageCb(url){validatedUrls.push(url);6===
validatedUrls.length&&cb(validatedUrls)}var aCubemap,cubemapSrcRegex="",validatedUrls=[];for(aCubemap=0;5>aCubemap;aCubemap++)cubemapSrcRegex+="(url\\((?:[^\\)]+)\\),\\s*)";if(cubemapSrcRegex=src.match(new RegExp(cubemapSrcRegex+"(url\\((?:[^\\)]+)\\)\\s*)")))for(aCubemap=1;7>aCubemap;aCubemap++)validateSrc(parseUrl(cubemapSrcRegex[aCubemap]),isImageCb);else if(aCubemap=validateAndGetQuerySelector(src)){if("A-CUBEMAP"===aCubemap.tagName&&aCubemap.srcs)return cb(aCubemap.srcs);warn('Selector "%s" does not point to \x3ca-cubemap\x3e',
src)}}}},{"./debug":200}],212:[function(_dereq_,module,exports){function toCamelCase(str){return str.replace(DASH_REGEX,upperCase)}function transformKeysToCamelCase(obj){var key;for(key in obj){var camelKey=toCamelCase(key);key!==camelKey&&(obj[camelKey]=obj[key],delete obj[key])}return obj}function upperCase(str){return str[1].toUpperCase()}var DASH_REGEX=/-([a-z])/g;module.exports.parse=function(value,obj){if("string"!==typeof value)return value;var i,item;obj=obj||{};var chunks=getKeyValueChunks(value);
for(i=0;i<chunks.length;i++)if(item=chunks[i]){var pos=item.indexOf(":");var key=item.substr(0,pos).trim();item=item.substr(pos+1).trim();obj[key]=item}return obj[""]?value:transformKeysToCamelCase(obj)};module.exports.stringify=function(data){if("string"===typeof data)return data;var key,keyCount=0,i=0,str="";for(key in data)keyCount++;for(key in data)str+=key+": "+data[key],i<keyCount-1&&(str+="; "),i++;return str};module.exports.toCamelCase=toCamelCase;module.exports.transformKeysToCamelCase=transformKeysToCamelCase;
var getKeyValueChunks=function(){var chunks=[],hasUnclosedUrl=/url\([^)]+$/;return function(raw){var chunk="",offset=0;for(chunks.length=0;offset<raw.length;){var nextSplit=raw.indexOf(";",offset);-1===nextSplit&&(nextSplit=raw.length);chunk+=raw.substring(offset,nextSplit);hasUnclosedUrl.test(chunk)?chunk+=";":(chunks.push(chunk.trim()),chunk="");offset=nextSplit+1}return chunks}}()},{}],213:[function(_dereq_,module,exports){function isControllerPresentWebVR(component,idPrefix,queryObject){var gamepads=
component.el.sceneEl;component=queryObject.index||0;if(!idPrefix)return!1;gamepads=gamepads&&gamepads.systems["tracked-controls-webvr"];if(!gamepads)return!1;gamepads=gamepads.controllers;return gamepads.length?!!findMatchingControllerWebVR(gamepads,null,idPrefix,queryObject.hand,component):!1}function isControllerPresentWebXR(component,id,queryObject){component=(component=component.el.sceneEl)&&component.systems["tracked-controls-webxr"];return component?(component=component.controllers)&&component.length?
findMatchingControllerWebXR(component,id,queryObject.hand,queryObject.index,queryObject.iterateControllerProfiles,queryObject.handTracking):!1:!1}function findMatchingControllerWebVR(controllers,filterIdExact,filterIdPrefix,filterHand,filterControllerIndex){var i,matchingControllerOccurence=0;for(i=0;i<controllers.length;i++){var controller=controllers[i];if(!filterIdPrefix||controller.id.startsWith(filterIdPrefix))if(filterIdPrefix||controller.id===filterIdExact)if(!filterHand||!controller.hand||
filterHand===controller.hand){if(filterHand&&!controller.hand)var targetControllerMatch=2*filterControllerIndex+(filterHand===DEFAULT_HANDEDNESS?0:1);else return controller;if(matchingControllerOccurence===targetControllerMatch)return controller;++matchingControllerOccurence}}}function findMatchingControllerWebXR(controllers,idPrefix,handedness,index,iterateProfiles,handTracking){var i,j,controllerMatch=!1;for(i=0;i<controllers.length;i++){var controller=controllers[i];var profiles=controller.profiles;
if(handTracking)controllerMatch=controller.hand;else if(iterateProfiles)for(j=0;j<profiles.length&&!(controllerMatch=profiles[j].startsWith(idPrefix));j++);else controllerMatch=0<profiles.length&&profiles[0].startsWith(idPrefix);if(controllerMatch)if(j="right"===controller.handedness||"left"===controller.handedness){if(controller.handedness===handedness)return controllers[i]}else if(i===index)return controllers[i]}}var DEFAULT_HANDEDNESS=_dereq_("../constants").DEFAULT_HANDEDNESS,AXIS_LABELS=["x",
"y","z","w"];module.exports.checkControllerPresentAndSetup=function(component,idPrefix,queryObject){var el=component.el,hasWebXR=el.sceneEl.hasWebXR;idPrefix=(hasWebXR?isControllerPresentWebXR:isControllerPresentWebVR)(component,idPrefix,queryObject);queryObject=!!idPrefix;!component.controllerPresent||component.controllerEventsActive||hasWebXR||component.addEventListeners();if(queryObject===component.controllerPresent)return queryObject;(component.controllerPresent=queryObject)?(component.addEventListeners(),
component.injectTrackedControls(idPrefix),el.emit("controllerconnected",{name:component.name,component:component})):(component.removeEventListeners(),el.emit("controllerdisconnected",{name:component.name,component:component}))};module.exports.isControllerPresentWebVR=isControllerPresentWebVR;module.exports.isControllerPresentWebXR=isControllerPresentWebXR;module.exports.findMatchingControllerWebVR=findMatchingControllerWebVR;module.exports.findMatchingControllerWebXR=findMatchingControllerWebXR;module.exports.emitIfAxesChanged=
function(component,axesMapping,evt){var buttonType,j;for(buttonType in axesMapping){var axes=axesMapping[buttonType];var changed=!1;for(j=0;j<axes.length;j++)evt.detail.changed[axes[j]]&&(changed=!0);if(changed){changed={};for(j=0;j<axes.length;j++)changed[AXIS_LABELS[j]]=evt.detail.axis[axes[j]];component.el.emit(buttonType+"moved",changed)}}};module.exports.onButtonEvent=function(id,evtName,component,hand){id=(hand?component.mapping[hand]:component.mapping).buttons[id];component.el.emit(id+evtName);
component.updateModel&&component.updateModel(id,evtName)}},{"../constants":122}],214:[function(_dereq_,module,exports){THREE.DeviceOrientationControls=function(object){var scope=this;this.object=object;this.object.rotation.reorder("YXZ");this.enabled=!0;this.deviceOrientation={};this.alphaOffset=this.screenOrientation=0;var onDeviceOrientationChangeEvent=function(event){scope.deviceOrientation=event},onScreenOrientationChangeEvent=function(){scope.screenOrientation=window.orientation||0},setObjectQuaternion=
function(){var zee=new THREE.Vector3(0,0,1),euler=new THREE.Euler,q0=new THREE.Quaternion,q1=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(quaternion,alpha,beta,gamma,orient){euler.set(beta,alpha,-gamma,"YXZ");quaternion.setFromEuler(euler);quaternion.multiply(q1);quaternion.multiply(q0.setFromAxisAngle(zee,-orient))}}();this.connect=function(){onScreenOrientationChangeEvent();window.addEventListener("orientationchange",onScreenOrientationChangeEvent,!1);window.addEventListener("deviceorientation",
onDeviceOrientationChangeEvent,!1);scope.enabled=!0};this.disconnect=function(){window.removeEventListener("orientationchange",onScreenOrientationChangeEvent,!1);window.removeEventListener("deviceorientation",onDeviceOrientationChangeEvent,!1);scope.enabled=!1};this.update=function(){if(!1!==scope.enabled){var device=scope.deviceOrientation;if(device){var alpha=device.alpha?THREE.Math.degToRad(device.alpha)+scope.alphaOffset:0,beta=device.beta?THREE.Math.degToRad(device.beta):0;device=device.gamma?
THREE.Math.degToRad(device.gamma):0;var orient=scope.screenOrientation?THREE.Math.degToRad(scope.screenOrientation):0;setObjectQuaternion(scope.object.quaternion,alpha,beta,device,orient)}}};this.dispose=function(){scope.disconnect()};this.connect()}},{}],215:[function(_dereq_,module,exports){window.glStats=function(){function _h(f,c){return function(){c.apply(this,arguments);f.apply(this,arguments)}}var _rS=null,_totalDrawArraysCalls=0,_totalDrawElementsCalls=0,_totalUseProgramCalls=0,_totalFaces=
0,_totalVertices=0,_totalPoints=0,_totalBindTexures=0;WebGLRenderingContext.prototype.drawArrays=_h(WebGLRenderingContext.prototype.drawArrays,function(JSCompiler_OptimizeArgumentsArray_p5,JSCompiler_OptimizeArgumentsArray_p6,JSCompiler_OptimizeArgumentsArray_p7){_totalDrawArraysCalls++;JSCompiler_OptimizeArgumentsArray_p5==this.POINTS?_totalPoints+=JSCompiler_OptimizeArgumentsArray_p7:_totalVertices+=JSCompiler_OptimizeArgumentsArray_p7});WebGLRenderingContext.prototype.drawElements=_h(WebGLRenderingContext.prototype.drawElements,
function(JSCompiler_OptimizeArgumentsArray_p8,JSCompiler_OptimizeArgumentsArray_p9){_totalDrawElementsCalls++;_totalFaces+=JSCompiler_OptimizeArgumentsArray_p9/3;_totalVertices+=JSCompiler_OptimizeArgumentsArray_p9});WebGLRenderingContext.prototype.useProgram=_h(WebGLRenderingContext.prototype.useProgram,function(){_totalUseProgramCalls++});WebGLRenderingContext.prototype.bindTexture=_h(WebGLRenderingContext.prototype.bindTexture,function(){_totalBindTexures++});return{update:function(){_rS("allcalls").set(_totalDrawArraysCalls+
_totalDrawElementsCalls);_rS("drawElements").set(_totalDrawElementsCalls);_rS("drawArrays").set(_totalDrawArraysCalls);_rS("bindTexture").set(_totalBindTexures);_rS("useProgram").set(_totalUseProgramCalls);_rS("glfaces").set(_totalFaces);_rS("glvertices").set(_totalVertices);_rS("glpoints").set(_totalPoints)},start:function(){_totalBindTexures=_totalPoints=_totalVertices=_totalFaces=_totalUseProgramCalls=_totalDrawElementsCalls=_totalDrawArraysCalls=0},end:function(){},attach:function(r){_rS=r},values:{allcalls:{over:3E3,
caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:"allcalls drawelements drawarrays useprogram bindtexture glfaces glvertices glpoints".split(" ")}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}};window.threeStats=function(renderer){var _rS=null;return{update:function(){_rS("renderer.info.memory.geometries").set(renderer.info.memory.geometries);_rS("renderer.info.programs").set(renderer.info.programs.length);
_rS("renderer.info.memory.textures").set(renderer.info.memory.textures);_rS("renderer.info.render.calls").set(renderer.info.render.calls);_rS("renderer.info.render.triangles").set(renderer.info.render.triangles);_rS("renderer.info.render.points").set(renderer.info.render.points)},start:function(){},end:function(){},attach:function(r){_rS=r},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},
"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1E3},"renderer.info.render.points":{caption:"Points"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],fractions:[]}};window.BrowserStats=function(){function _size(v){return Math.round(100*
v/Math.pow(1024,Math.floor(Math.log(v)/log1024)))/100}var _rS=null,_usedJSHeapSize=0,_totalJSHeapSize=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0});0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize \x3d\x3d\x3d 0... performance.memory is only available in Chrome .");var log1024=Math.log(1024);return{update:function(){_usedJSHeapSize=_size(performance.memory.usedJSHeapSize);_totalJSHeapSize=_size(performance.memory.totalJSHeapSize);
_rS("memory").set(_usedJSHeapSize);_rS("total").set(_totalJSHeapSize)},start:function(){_usedJSHeapSize=0},end:function(){},attach:function(r){_rS=r},values:{memory:{caption:"Used Memory",average:!0,avgMs:1E3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}};"object"===typeof module&&(module.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],216:[function(_dereq_,
module,exports){(function(){0=="performance"in window&&(window.performance={});var performance=window.performance;if(0=="now"in performance){var nowOffset=Date.now();performance.timing&&performance.timing.navigationStart&&(nowOffset=performance.timing.navigationStart);performance.now=function(){return Date.now()-nowOffset}}performance.mark||(performance.mark=function(){});performance.measure||(performance.measure=function(){})})();window.rStats=function(settings){function iterateKeys(array,callback){array=
Object.keys(array);for(var j=0,l=array.length;j<l;j++)callback(array[j])}function Graph(_dom,_id,_defArg){_id=_defArg||{};var _canvas=document.createElement("canvas"),_ctx=_canvas.getContext("2d"),_max=0,_current=0;_id=_id.color?_id.color:"#666666";var _dotCanvas=document.createElement("canvas");_defArg=_dotCanvas.getContext("2d");_dotCanvas.width=1;_dotCanvas.height=20;_defArg.fillStyle="#444444";_defArg.fillRect(0,0,1,20);_defArg.fillStyle=_id;_defArg.fillRect(0,10,1,10);_defArg.fillStyle="#ffffff";
_defArg.globalAlpha=.5;_defArg.fillRect(0,10,1,1);_defArg.globalAlpha=1;var _alarmCanvas=document.createElement("canvas");_id=_alarmCanvas.getContext("2d");_alarmCanvas.width=1;_alarmCanvas.height=20;_id.fillStyle="#444444";_id.fillRect(0,0,1,20);_id.fillStyle="#b70000";_id.fillRect(0,10,1,10);_id.globalAlpha=.5;_id.fillStyle="#ffffff";_id.fillRect(0,10,1,1);_id.globalAlpha=1;_canvas.width=200;_canvas.height=10;_canvas.style.width=_canvas.width+"px";_canvas.style.height=_canvas.height+"px";_canvas.className=
"rs-canvas";_dom.appendChild(_canvas);_ctx.fillStyle="#444444";_ctx.fillRect(0,0,_canvas.width,_canvas.height);return{draw:function(v,alarm){_current+=.1*(v-_current);_max*=.99;_current>_max&&(_max=_current);_ctx.drawImage(_canvas,1,0,_canvas.width-1,_canvas.height,0,0,_canvas.width-1,_canvas.height);alarm?_ctx.drawImage(_alarmCanvas,_canvas.width-1,_canvas.height-_current*_canvas.height/_max-10):_ctx.drawImage(_dotCanvas,_canvas.width-1,_canvas.height-_current*_canvas.height/_max-10)}}}function StackGraph(_dom,
_num){var _canvas=document.createElement("canvas"),_ctx=_canvas.getContext("2d");_canvas.width=200;_canvas.height=10*_num;_canvas.style.width=_canvas.width+"px";_canvas.style.height=_canvas.height+"px";_canvas.className="rs-canvas";_dom.appendChild(_canvas);_ctx.fillStyle="#444444";_ctx.fillRect(0,0,_canvas.width,_canvas.height);return{draw:function(v){_ctx.drawImage(_canvas,1,0,_canvas.width-1,_canvas.height,0,0,_canvas.width-1,_canvas.height);var th=0;iterateKeys(v,function(j){var h=v[j]*_canvas.height;
_ctx.fillStyle=_colours[j];_ctx.fillRect(_canvas.width-1,th,1,h);th+=h})}}}function PerfCounter(id,group){function _average(v){_def&&_def.average&&(_accumValue+=v,_accumSamples++,v=performance.now(),v-_accumStart>=(_def.avgMs||1E3)&&(_averageValue=_accumValue/_accumSamples,_accumValue=0,_accumStart=v,_accumSamples=0))}function _start(){_time=performance.now();_settings.userTimingAPI&&performance.mark(_id+"-start");_started=!0}function _end(){_value=performance.now()-_time;_settings.userTimingAPI&&
(performance.mark(_id+"-end"),_started&&performance.measure(_id,_id+"-start",_id+"-end"));_average(_value)}var _id=id,_value=0,_total=0,_averageValue=0,_accumValue=0,_accumStart=performance.now(),_accumSamples=0,_dom=document.createElement("div");id=document.createElement("span");var _spanValue=document.createElement("div"),_spanValueText=document.createTextNode(""),_def=_settings?_settings.values[_id.toLowerCase()]:null,_graph=new Graph(_dom,_id,_def),_started=!1;id.className="rs-counter-id";id.textContent=
_def&&_def.caption?_def.caption:_id;_spanValue.className="rs-counter-value";_spanValue.appendChild(_spanValueText);_dom.appendChild(id);_dom.appendChild(_spanValue);group?group.div.appendChild(_dom):_div.appendChild(_dom);var _time=performance.now();return{set:function(v){_value=v;_average(_value)},start:_start,tick:function(){_end();_start()},end:_end,frame:function(){var t=performance.now(),e=t-_time;_total++;1E3<e&&(_value=_def&&!1===_def.interpolate?_total:1E3*_total/e,_total=0,_time=t,_average(_value))},
value:function(){return _value},draw:function(){_spanValueText.nodeValue=Math.round(100*(_def&&_def.average?_averageValue:_value))/100;var a=_def&&(_def.below&&_value<_def.below||_def.over&&_value>_def.over);_graph.draw(_value,a);_dom.className=a?"rs-counter-base alarm":"rs-counter-base"}}}function _perf(idArg){var id=idArg.toLowerCase();void 0===id&&(id="default");if(_perfCounters[id])return _perfCounters[id];var group=null;_settings&&_settings.groups&&iterateKeys(_settings.groups,function(j){j=
_settings.groups[parseInt(j,10)];group||-1===j.values.indexOf(id.toLowerCase())||(group=j)});idArg=new PerfCounter(id,group);return _perfCounters[id]=idArg}function _update(){iterateKeys(_settings.plugins,function(j){_settings.plugins[j].update()});iterateKeys(_perfCounters,function(j){_perfCounters[j].draw()});_settings&&_settings.fractions&&iterateKeys(_settings.fractions,function(j){var f=_settings.fractions[parseInt(j,10)],v=[],base=_perfCounters[f.base.toLowerCase()];base&&(base=base.value(),
iterateKeys(_settings.fractions[j].steps,function(k){k=_settings.fractions[j].steps[parseInt(k,10)].toLowerCase();(k=_perfCounters[k])&&v.push(k.value()/base)}));f.graph.draw(v)})}var _settings=settings||{},_colours=_settings.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];settings=(_settings.CSSPath?_settings.CSSPath:"")+"rStats.css";(_settings.css||["https://fonts.googleapis.com/css?family\x3dRoboto+Condensed:400,700,300",settings]).forEach(function(uri){var element=document.createElement("link");
element.href=uri;element.rel="stylesheet";element.type="text/css";document.getElementsByTagName("head")[0].appendChild(element)});_settings.values||(_settings.values={});var _base,_div,_perfCounters={};(function(){if(_settings.plugins){_settings.values||(_settings.values={});_settings.groups||(_settings.groups=[]);_settings.fractions||(_settings.fractions=[]);for(var j$jscomp$0=0;j$jscomp$0<_settings.plugins.length;j$jscomp$0++)_settings.plugins[j$jscomp$0].attach(_perf),iterateKeys(_settings.plugins[j$jscomp$0].values,
function(k){_settings.values[k]=_settings.plugins[j$jscomp$0].values[k]}),_settings.groups=_settings.groups.concat(_settings.plugins[j$jscomp$0].groups),_settings.fractions=_settings.fractions.concat(_settings.plugins[j$jscomp$0].fractions)}else _settings.plugins={};_base=document.createElement("div");_base.className="rs-base";_div=document.createElement("div");_div.className="rs-container";_div.style.height="auto";_base.appendChild(_div);document.body.appendChild(_base);_settings&&(_settings.groups&&
iterateKeys(_settings.groups,function(j){j=_settings.groups[parseInt(j,10)];var div=document.createElement("div");div.className="rs-group";j.div=div;var h1=document.createElement("h1");h1.textContent=j.caption;h1.addEventListener("click",function(e){this.classList.toggle("hidden");e.preventDefault()}.bind(div));_div.appendChild(h1);_div.appendChild(div)}),_settings.fractions&&iterateKeys(_settings.fractions,function(j){var f=_settings.fractions[parseInt(j,10)],div=document.createElement("div");div.className=
"rs-fraction";var legend=document.createElement("div");legend.className="rs-legend";var h=0;iterateKeys(_settings.fractions[j].steps,function(k){var p=document.createElement("p");p.textContent=_settings.fractions[j].steps[k];p.style.color=_colours[h];legend.appendChild(p);h++});div.appendChild(legend);div.style.height=10*h+"px";f.div=div;var graph=new StackGraph(div,h);f.graph=graph;_div.appendChild(div)}))})();return function(id){return id?_perf(id):{element:_base,update:_update}}};"object"===typeof module&&
(module.exports=window.rStats)},{}],217:[function(_dereq_,module,exports){String.prototype.startsWith||(String.prototype.startsWith=function(searchString,position){return this.substr(position||0,searchString.length)===searchString})},{}],218:[function(_dereq_,module,exports){module.exports={base64:function(mimeType,base64){return"data:"+mimeType+";base64,"+base64},isMobile:function(){var check=!1,a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))check=!0;return check},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isIFrame:function(){try{return window.self!==window.top}catch(e$173){return!0}},appendQueryParameter:function(url,key,value){var delimiter=0>url.indexOf("?")?"?":"\x26";return url+(delimiter+key+"\x3d"+value)},getQueryParameter:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");name=(new RegExp("[\\?\x26]"+name+"\x3d([^\x26#]*)")).exec(location.search);return null===name?"":decodeURIComponent(name[1].replace(/\+/g,
" "))},isLandscapeMode:function(){return 90==window.orientation||-90==window.orientation}}},{}],219:[function(_dereq_,module,exports){function AndroidWakeLock(){var video=document.createElement("video");video.addEventListener("ended",function(){video.play()});this.request=function(){video.paused&&(video.src=Util.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw\x3d\x3d"),
video.play())};this.release=function(){video.pause();video.src=""}}function iOSWakeLock(){var timer=null;this.request=function(){timer||(timer=setInterval(function(){window.location.href="/";setTimeout(window.stop,0)},15E3))};this.release=function(){timer&&(clearInterval(timer),timer=null)}}var Util=_dereq_("./util.js");module.exports=function(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;return userAgent.match(/iPhone/i)||userAgent.match(/iPod/i)?iOSWakeLock:AndroidWakeLock}()},
{"./util.js":218}]},{},[176])(176)})}
//# sourceMappingURL=module$node_modules$aframe$dist$aframe_master.js.map
